(window["webpackJsonp_AppOp"]=window["webpackJsonp_AppOp"]||[]).push([["chunk-75b59e97"],{"754b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"m-bottom20"},[a("div",{staticClass:"action-box"},[a("el-form",{attrs:{model:e.echartForm,inline:!0,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"节点:"}},[a("el-select",{on:{change:e.podChange},model:{value:e.echartForm.az_id,callback:function(t){e.$set(e.echartForm,"az_id",t)},expression:"echartForm.az_id"}},e._l(e.az_list,(function(e,t){return a("el-option",{key:t,attrs:{label:e.az_name,value:e.az_id}})})),1)],1),a("el-form-item",{attrs:{label:"时间"}},[a("el-date-picker",{staticClass:"date-picker",attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:e.timeChange},model:{value:e.timeList,callback:function(t){e.timeList=t},expression:"timeList"}})],1)],1)],1),a("div",{staticClass:"m-bottom20"},[a("line-echart",{staticClass:"item",attrs:{chart_id:"cloud_inventory",data:e.cloud_inventory_used}})],1),a("div",{staticClass:"action-box"},[a("el-form",{attrs:{model:e.cloudForm,inline:!0,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"节点:"}},[a("el-select",{on:{change:e.az_idChange},model:{value:e.cloudForm.az_id,callback:function(t){e.$set(e.cloudForm,"az_id",t)},expression:"cloudForm.az_id"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._l(e.az_list,(function(e,t){return a("el-option",{key:t,attrs:{label:e.az_name,value:e.az_id}})}))],2)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.searchList}},[e._v("刷新")]),a("el-button",{attrs:{type:"primary"},on:{click:e.exportList}},[e._v("导出")])],1)],1)],1),a("el-table",{attrs:{data:e.cloudList,border:""}},[a("el-table-column",{attrs:{prop:"az_name",label:"节点"}}),a("el-table-column",{attrs:{prop:"total_size",label:"总体可售容量(TB)"}}),a("el-table-column",{attrs:{prop:"sold_size",label:"已售容量(TB)"}}),a("el-table-column",{attrs:{prop:"available_size",label:"剩余可售容量(TB)"}}),a("el-table-column",{attrs:{prop:"sale_rate",label:"售出百分比(%)"}}),a("el-table-column",{attrs:{prop:"update_time",label:"更新时间"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",disabled:!e.authList.includes("available_sale_size")},on:{click:function(a){return e.editNum(t.row)}}},[e._v("编辑")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pageInfo.page_index,"page-sizes":[20,50,100],"page-size":e.pageInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:"编辑云盘可售总量",visible:e.dialogVisible,"width:":"450px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:e.saleNumChangeCancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saleNumChange}},[e._v("确定")])]},proxy:!0}])},[a("el-form",{attrs:{data:e.saleForm}},[a("el-form-item",[e._v(" 节点："+e._s(e.cur_pod)+" ")]),a("el-form-item",[e._v(" 当前总容量："+e._s(e.totalNum)+"TB ")]),a("el-form-item",{attrs:{label:"调整后总容量："}},[a("el-input-number",{staticStyle:{width:"282px"},attrs:{controls:!1,min:0,precision:2},model:{value:e.saleForm.TotalSize,callback:function(t){e.$set(e.saleForm,"TotalSize",t)},expression:"saleForm.TotalSize"}}),e._v("TB ")],1)],1)],1)],1)},n=[],s=a("5530"),o=a("1da1"),l=a("d4ec"),r=a("bee2"),c=a("262e"),u=a("2caf"),_=(a("96cf"),a("b0c0"),a("ac1f"),a("5319"),a("d3b7"),a("25f0"),a("38cf"),a("d81d"),a("9ab4")),d=a("1b40"),m=a("ff48"),h=a("81a9"),g=a("bff7"),b={get_disk_inventory:function(e){return Object(h["a"])(Object(g["a"])("GET","/stock/disk_inventory/",e))},disk_inventory_download:function(e){return Object(h["a"])(Object(g["a"])("GET","/stock/disk_inventory_download/",e))},get_disk_inventory_monitor:function(e){return Object(h["a"])(Object(g["a"])("GET","/stock/disk_inventory_monitor/",e))},set_available_sale_size:function(e){return Object(h["a"])(Object(g["a"])("POST","/ebs/available_sale_size/",e))}},p=a("e99c"),f=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.dialogVisible=!1,e.cur_pod="",e.cur_az_id="",e.totalNum=null,e.az_list=[],e.authList=[],e.echartForm={az_id:"",create_time:"",end_time:""},e.cloudForm={az_id:""},e.saleForm={TotalSize:null},e.pageInfo={page_index:1,page_size:20,total:0},e.cloud_inventory_used={title:"云盘库存",unit:"",xTime:[],yValue:[],legend:[],resize:0},e.cloudList=[],e.timeList=[new Date,new Date],e}return Object(r["a"])(a,[{key:"created",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getCurentTime();case 2:return e.next=4,this.get_az_list();case 4:this.searchList(),this.authList=this.$store.state.auth_info[this.$route.name];case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"dateFormat",value:function(e,t,a){var i=this;if(!e)return"";var n=new Date(t.getTime()-864e5*a),s={y:n.getFullYear(),M:n.getMonth()+1,d:n.getDate(),h:n.getHours(),m:n.getMinutes(),s:n.getSeconds(),S:n.getMilliseconds()};return e.replace(/(y+)|(M+)|(d+)|(h+)|(m+)|(s+)|(S+)/g,(function(e){return i._add0(s[e[0]],e.length)}))}},{key:"_add0",value:function(e,t){e=e.toString();var a=e.length;return a<t?"0".repeat(t-a)+e:e}},{key:"getCurentTime",value:function(){var e=new Date,t=new Date;this.timeList=[this.dateFormat("yyyy-MM-dd hh:mm:ss",e,7),this.dateFormat("yyyy-MM-dd hh:mm:ss",t,0)],this.echartForm.create_time=this.dateFormat("yyyy-MM-dd hh:mm:ss",e,7),this.echartForm.end_time=this.dateFormat("yyyy-MM-dd hh:mm:ss",t,0)}},{key:"timeChange",value:function(e){this.echartForm.create_time=e[0],this.echartForm.end_time=e[1],this.monitoringSearch()}},{key:"handleCurrentChange",value:function(e){this.pageInfo.page_index=e,this.searchList()}},{key:"handleSizeChange",value:function(e){this.pageInfo.page_size=e,this.searchList()}},{key:"az_idChange",value:function(e){this.searchList()}},{key:"searchList",value:function(){var e=this,t={az_id:this.cloudForm.az_id,page_index:this.pageInfo.page_index,page_size:this.pageInfo.page_size};b.get_disk_inventory(t).then((function(t){"Success"===t.code&&(e.cloudList=t.data.result,e.pageInfo.page_index=t.data.page_info.cur_page,e.pageInfo.total=t.data.page_info.count)}))}},{key:"exportList",value:function(){window.location.href="/ecs_business/v1/stock/disk_inventory_download/?az_id=".concat(this.cloudForm.az_id)}},{key:"podChange",value:function(e){this.monitoringSearch()}},{key:"monitoringSearch",value:function(){var e=this,t=Object(s["a"])({},this.echartForm);b.get_disk_inventory_monitor(t).then((function(t){"Success"===t.code?(e.cloud_inventory_used.xTime=t.data.x_time,e.cloud_inventory_used.yValue=[t.data.total_size,t.data.sold_size],e.cloud_inventory_used.legend=["总体可售容量","已售容量"],e.cloud_inventory_used.unit="TB",e.cloud_inventory_used.resize++):e.cloud_inventory_used={title:"云盘库存",unit:"",xTime:[],yValue:[],legend:[],resize:0}}))}},{key:"editNum",value:function(e){this.cur_pod=e.az_name,this.cur_az_id=e.az_id,this.totalNum=e.total_size,this.dialogVisible=!0}},{key:"saleNumChange",value:function(){var e=this,t={az_id:this.cur_az_id,total_size:this.saleForm.TotalSize};b.set_available_sale_size(t).then((function(t){"Success"===t.code&&(e.$message.success(t.message),e.saleNumChangeCancel(),e.searchList())}))}},{key:"saleNumChangeCancel",value:function(){this.cur_pod="",this.totalNum=null,this.saleForm.TotalSize=null,this.dialogVisible=!1}},{key:"get_az_list",value:function(){var e=this,t={region_name:"",az_name:"",page_index:1,page_size:200};p["a"].get_az_list(t).then((function(t){"Success"===t.code&&(t.data.az_list.length>0&&t.data.az_list.map((function(t){"global_close"!==t.status&&e.az_list.push({az_id:t.az_id,az_name:t.az_name})})),e.echartForm.az_id=e.az_list[0].az_id,e.monitoringSearch())}))}}]),a}(d["e"]);f=Object(_["a"])([Object(d["a"])({components:{LineEchart:m["a"]}})],f);var y=f,z=y,v=(a("f72f"),a("2877")),k=Object(v["a"])(z,i,n,!1,null,"908b7436",null);t["default"]=k.exports},9892:function(e,t,a){},e99c:function(e,t,a){"use strict";var i=a("81a9"),n=a("bff7");t["a"]={get_az_list:function(e){return Object(i["a"])(Object(n["a"])("GET","/ecs/manage_az_list/",e))},edit:function(e){return Object(i["a"])(Object(n["a"])("POST","/ecs/az_edit/",e))},sync:function(){return Object(i["a"])(Object(n["a"])("GET","/ecs/sync_az_info/"))},get_backend_types:function(){return Object(i["a"])(Object(n["a"])("GET","/ecs/get_backend_types/"))},get_status:function(){return Object(i["a"])(Object(n["a"])("GET","/ecs/get_az_status_list/"))},del_status:function(e){return Object(i["a"])(Object(n["a"])("POST","/ecs/delete_az/",e))},record:function(e){return Object(i["a"])(Object(n["a"])("GET","/ecs/get_az_history/",e))},get_net_type:function(){return Object(i["a"])(Object(n["a"])("GET","/ecs/get_az_net_types/"))},get_scheduling_policy:function(e){return Object(i["a"])(Object(n["a"])("GET","/ecs/get_scheduling_policy/",e))},set_scheduling_policy:function(e){return Object(i["a"])(Object(n["a"])("POST","/ecs/set_scheduling_policy/",e))},enable_cluster_schedule:function(e){return Object(i["a"])(Object(n["a"])("POST","/ecs/enable_cluster_schedule/",e))},get_image_disk_list:function(e){return Object(i["a"])(Object(n["a"])("POST","/img/get_image_disk_list/",e))},set_image_disk_strategy:function(e){return Object(i["a"])(Object(n["a"])("POST","/img/set_image_disk_strategy/",e))},get_rollback_info:function(e){return Object(i["a"])(Object(n["a"])("POST","/img/get_rollback_snapshot_dict/",e))},rollback_image_disk:function(e){return Object(i["a"])(Object(n["a"])("POST","/img/rollback_image_disk/",e))}}},f72f:function(e,t,a){"use strict";a("9892")}}]);
//# sourceMappingURL=chunk-75b59e97.fcdc76fa.js.map