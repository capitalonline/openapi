(window["webpackJsonp_AppOp"]=window["webpackJsonp_AppOp"]||[]).push([["chunk-4ddb2969"],{1234:function(t,e,a){"use strict";a("1dd4")},"1dd4":function(t,e,a){},"3f7e":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-bottom20"},[a("div",{staticClass:"action-box"},[a("el-form",{attrs:{model:t.echartForm,inline:!0,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"节点:"}},[a("el-select",{on:{change:t.podChange},model:{value:t.echartForm.az_id,callback:function(e){t.$set(t.echartForm,"az_id",e)},expression:"echartForm.az_id"}},t._l(t.az_list,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.az_id}})})),1)],1),a("el-form-item",{attrs:{label:"时间"}},[a("el-date-picker",{staticClass:"date-picker",attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},on:{change:t.timeChange},model:{value:t.timeList,callback:function(e){t.timeList=e},expression:"timeList"}})],1)],1)],1),a("div",{staticClass:"m-bottom20"},[a("line-echart",{staticClass:"item",attrs:{chart_id:"nas_chart",data:t.nas_chart}})],1),a("div",{staticClass:"action-box"},[a("el-form",{attrs:{model:t.tableForm,inline:!0,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"节点:"}},[a("el-select",{on:{change:t.az_idChange},model:{value:t.tableForm.az_id,callback:function(e){t.$set(t.tableForm,"az_id",e)},expression:"tableForm.az_id"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._l(t.az_list,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.az_id}})}))],2)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.FnGetList}},[t._v("刷新")])],1)],1)],1),a("el-table",{attrs:{data:t.list,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"节点"}}),a("el-table-column",{attrs:{prop:"total",label:"总体可售容量(TB)"}}),a("el-table-column",{attrs:{prop:"used",label:"已售容量(TB)"}}),a("el-table-column",{attrs:{prop:"surplus",label:"剩余可售容量(TB)"}}),a("el-table-column",{attrs:{prop:"utilization_rate",label:"售出百分比(%)"}}),a("el-table-column",{attrs:{prop:"create_time",label:"更新时间"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",disabled:!t.operate_auth.includes("update")},on:{click:function(a){return t.FnUpdate(e.row)}}},[t._v("编辑")])]}}])})],1),a("el-pagination",{attrs:{"current-page":t.pageInfo.page_index,"page-sizes":[20,50,100],"page-size":t.pageInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.pageInfo.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("edit",{attrs:{visible:t.visible,data_info:t.data_info},on:{close:t.closeUpdate}})],1)},i=[],r=a("1da1"),s=a("d4ec"),o=a("bee2"),l=a("262e"),c=a("2caf"),u=(a("96cf"),a("b0c0"),a("d81d"),a("ac1f"),a("5319"),a("d3b7"),a("25f0"),a("38cf"),a("9ab4")),d=a("1b40"),h=a("81a9"),p=a("bff7"),m={post_nas_line:function(t){return Object(h["a"])(Object(p["a"])("POST","/stock/stock_line/",t))},get_nas_inventory:function(t){return Object(h["a"])(Object(p["a"])("POST","/stock/stock_table/",t))},post_edit_nas:function(t){return Object(h["a"])(Object(p["a"])("POST","/stock/edit_stock/",t))},post_az_nas:function(){return Object(h["a"])(Object(p["a"])("POST","/stock/az_info/"))}},_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.visible,title:"编辑NAS可售总量"},on:{"update:visible":function(e){t.visible=e},close:t.back}},[a("el-form",{ref:"resetForm",attrs:{model:t.data,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"节点："}},[t._v(t._s(t.data.az_name))]),a("el-form-item",{attrs:{label:"当前总容量："}},[t._v(" "+t._s(t.data.total)+" TB ")]),a("el-form-item",{attrs:{label:"调整后总容量："}},[a("el-input-number",{staticStyle:{width:"282px"},attrs:{controls:!1,min:0,precision:2},model:{value:t.data.newTotal,callback:function(e){t.$set(t.data,"newTotal",e)},expression:"data.newTotal"}}),t._v(" TB ")],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.back}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.FnConfirm}},[t._v("确 定")])],1)],1)},f=[],b=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.data={az_name:"",az_id:"",total:"",newTotal:""},t}return Object(o["a"])(a,[{key:"FnConfirm",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={az_id:this.data.az_id,total:this.data.newTotal},t.next=3,m.post_edit_nas(e);case 3:a=t.sent,"Success"===a.code&&(this.$message.success(a.message),this.back());case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"back",value:function(){}},{key:"FnGetRow",value:function(t){t||(this.data.newTotal=""),this.data.az_name=this.data_info.name,this.data.total=this.data_info.total,this.data.az_id=this.data_info.az_id}}]),a}(d["e"]);Object(u["a"])([Object(d["c"])(Boolean)],b.prototype,"visible",void 0),Object(u["a"])([Object(d["c"])({default:function(){}})],b.prototype,"data_info",void 0),Object(u["a"])([Object(d["b"])("close")],b.prototype,"back",null),Object(u["a"])([Object(d["f"])("visible")],b.prototype,"FnGetRow",null),b=Object(u["a"])([Object(d["a"])({})],b);var v=b,g=v,y=a("2877"),k=Object(y["a"])(g,_,f,!1,null,"0d8b42f2",null),z=k.exports,F=a("ff48"),O=function(t){Object(l["a"])(a,t);var e=Object(c["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.list=[],t.operate_auth=[],t.visible=!1,t.data_info={},t.az_list=[],t.timeList=[new Date,new Date],t.echartForm={az_id:"",create_time:"",end_time:""},t.tableForm={az_id:""},t.pageInfo={page_index:1,page_size:20,total:0},t.nas_chart={title:"NAS库存",unit:"",xTime:[],yValue:[],legend:[],resize:0},t}return Object(o["a"])(a,[{key:"watch_vis",value:function(t){t||this.FnGetList()}},{key:"created",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getCurrentTime();case 2:return t.next=4,this.get_az_info();case 4:return t.next=6,this.FnGetList();case 6:this.operate_auth=this.$store.state.auth_info[this.$route.name];case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"timeChange",value:function(t){this.echartForm.create_time=t[0],this.echartForm.end_time=t[1],this.echartForm.az_id&&this.FnPostLine()}},{key:"FnUpdate",value:function(t){this.visible=!0,this.data_info=t}},{key:"closeUpdate",value:function(){this.visible=!1}},{key:"podChange",value:function(t){this.FnPostLine()}},{key:"az_idChange",value:function(t){this.FnGetList()}},{key:"handleCurrentChange",value:function(t){this.pageInfo.page_index=t,this.FnGetList()}},{key:"handleSizeChange",value:function(t){this.pageInfo.page_size=t,this.FnGetList()}},{key:"FnGetList",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m.get_nas_inventory({az_id:this.tableForm.az_id?this.tableForm.az_id:void 0,page_index:this.pageInfo.page_index,page_size:this.pageInfo.page_size});case 2:e=t.sent,"Success"===e.code&&(this.list=e.data.operation_log_list,this.pageInfo.total=e.data.page_info.count);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"FnPostLine",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m.post_nas_line({az_id:this.echartForm.az_id,create_time_start:this.echartForm.create_time,create_time_end:this.echartForm.end_time});case 2:e=t.sent,"Success"===e.code?(this.nas_chart.xTime=e.data.map((function(t){return t.create_time})),this.nas_chart.yValue=[e.data.map((function(t){return t.total})),e.data.map((function(t){return t.used}))],this.nas_chart.legend=["总体空间容量","已售NAS容量"],this.nas_chart.unit="TB",this.nas_chart.resize++):this.nas_chart={title:"云盘库存",unit:"",xTime:[],yValue:[],legend:[],resize:0};case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"get_az_info",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m.post_az_nas();case 2:e=t.sent,"Success"===e.code&&(this.az_list=e.data);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"dateFormat",value:function(t,e,a){var n=this;if(!t)return"";var i=new Date(e.getTime()-864e5*a),r={y:i.getFullYear(),M:i.getMonth()+1,d:i.getDate(),h:i.getHours(),m:i.getMinutes(),s:i.getSeconds(),S:i.getMilliseconds()};return t.replace(/(y+)|(M+)|(d+)|(h+)|(m+)|(s+)|(S+)/g,(function(t){return n._add0(r[t[0]],t.length)}))}},{key:"_add0",value:function(t,e){t=t.toString();var a=t.length;return a<e?"0".repeat(e-a)+t:t}},{key:"getCurrentTime",value:function(){var t=new Date,e=new Date;this.timeList=[this.dateFormat("yyyy-MM-dd hh:mm:ss",t,7),this.dateFormat("yyyy-MM-dd hh:mm:ss",e,0)],this.echartForm.create_time=this.dateFormat("yyyy-MM-dd hh:mm:ss",t,7),this.echartForm.end_time=this.dateFormat("yyyy-MM-dd hh:mm:ss",e,0)}}]),a}(d["e"]);Object(u["a"])([Object(d["f"])("visible")],O.prototype,"watch_vis",null),O=Object(u["a"])([Object(d["a"])({components:{Edit:z,LineEchart:F["a"]}})],O);var w=O,j=w,x=(a("1234"),Object(y["a"])(j,n,i,!1,null,"2f7fc4c1",null));e["default"]=x.exports}}]);