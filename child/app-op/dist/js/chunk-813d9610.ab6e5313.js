(window["webpackJsonp_AppOp"]=window["webpackJsonp_AppOp"]||[]).push([["chunk-813d9610"],{"15fc":function(e,t,a){},"1d27":function(e,t,a){"use strict";a("6729")},"470b":function(e,t,a){"use strict";a("15fc")},6729:function(e,t,a){},b486:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("action-block",{attrs:{search_option:e.searchDom},on:{"fn-search":e.search,"fn-filter":e.FnFilter}}),a("div",{staticClass:"text-right m-bottom10"},[a("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[a("el-button",{attrs:{type:"text"},on:{click:e.exportList}},[a("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1)],1),a("el-table",{attrs:{data:e.list,border:""},on:{"sort-change":e.handleSort}},[a("el-table-column",{attrs:{prop:"region_name",label:"所属地域"}}),a("el-table-column",{attrs:{prop:"az_name",label:"可用区名称"}}),a("el-table-column",{attrs:{prop:"host_product_name",label:"物理机产品名称"}}),a("el-table-column",{attrs:{prop:"spec_family_name",label:"实例规格族"}}),a("el-table-column",{attrs:{prop:"cpu",label:"vcpu (核)",sortable:"custom"}}),a("el-table-column",{attrs:{prop:"ram",label:"内存(GB)",sortable:"custom"}}),a("el-table-column",{attrs:{prop:"gpu",label:"GPU",sortable:"custom"}}),a("el-table-column",{attrs:{prop:"instance_sell_num",label:"已售实例数量",sortable:"custom"}}),a("el-table-column",{attrs:{prop:"customer_sell_num",label:"已售客户数量",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.detail(t.row)}}},[e._v(e._s(t.row.customer_sell_num))])]}}])}),a("el-table-column",{attrs:{prop:"available_num",label:"剩余可售数量",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{placement:"top",effect:"light"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("el-table",{attrs:{data:t.row.availableNumList}},[a("el-table-column",{attrs:{prop:"name",label:"主机归属"}}),a("el-table-column",{attrs:{prop:"num",label:"剩余可售量"}})],1)],1),a("span",[e._v(e._s(t.row.available_num))])])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pageInfo.page_index,"page-sizes":[20,50,100],"page-size":e.pageInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.visible?[a("Customer",{attrs:{visible:e.visible,info:e.operateInfo},on:{"update:visible":function(t){e.visible=t}}})]:e._e()],2)},s=[],i=a("ade3"),r=a("5530"),o=a("2909"),c=a("1da1"),l=a("d4ec"),u=a("bee2"),p=a("262e"),_=a("2caf"),h=(a("96cf"),a("4e82"),a("b0c0"),a("99af"),a("ac1f"),a("841c"),a("d81d"),a("a15b"),a("fb6a"),a("9ab4")),d=a("1b40"),f=a("5124"),b=a("9074"),g=a("e527"),m=a("c811"),v=a("8ce4"),O=a("3673"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"客户详情",visible:e.visibleSync,width:"700px","close-on-click-modal":!1,"destroy-on-close":!0},on:{"update:visible":function(t){e.visibleSync=t}}},[a("el-table",{attrs:{data:e.list}},[a("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),a("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),a("el-table-column",{attrs:{prop:"num",label:"购买数量"}})],1),a("el-pagination",{attrs:{"current-page":e.pageInfo.page_index,"page-sizes":[20,50,100],"page-size":e.pageInfo.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.visibleSync=!1}}},[e._v("确 定")])],1)],1)},j=[],k=a("c1df"),z=a.n(k),x=function(e){Object(p["a"])(a,e);var t=Object(_["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.list=[],e.moment=z.a,e.pageInfo={page_index:1,page_size:20,total:0},e}return Object(u["a"])(a,[{key:"created",value:function(){this.getCustomerList()}},{key:"getCustomerList",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a,n,s,i,r,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.info,a=t.spec_family_id,n=t.host_product_id,s=t.az_id,i=t.cpu,r=t.ram,o=t.gpu,e.next=3,f["a"].get_customer_sell_info({spec_family_id:a,host_product_id:n,az_id:s,cpu:i,ram:r,gpu:o,page_index:this.pageInfo.page_index,page_size:this.pageInfo.page_size});case 3:c=e.sent,"Success"===c.code&&(this.list=c.data.customer_buy_list,this.pageInfo.total=c.data.page_info.count);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCurrentChange",value:function(e){this.pageInfo.page_index=e,this.getCustomerList()}},{key:"handleSizeChange",value:function(e){this.pageInfo.page_size=e,this.getCustomerList()}},{key:"create",value:function(){}}]),a}(d["e"]);Object(h["a"])([Object(d["d"])("visible")],x.prototype,"visibleSync",void 0),Object(h["a"])([Object(d["c"])({default:function(){}})],x.prototype,"info",void 0),Object(h["a"])([Object(d["b"])("fn-create")],x.prototype,"create",null),x=Object(h["a"])([Object(d["a"])({components:{}})],x);var w=x,S=w,I=(a("470b"),a("2877")),L=Object(I["a"])(S,y,j,!1,null,"fd37af4a",null),P=L.exports,C=function(e){Object(p["a"])(a,e);var t=Object(_["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.list=[],e.sort=void 0,e.sortLable="",e.authList=[],e.visible=!1,e.operateInfo={},e.pageInfo={page_index:1,page_size:20,total:0},e.searchDom={region_id:{placeholder:"请选择地域",list:[],default_value:"",close_clearable:!1},az_id:{placeholder:"请选择可用区",list:[]},host_product_name:{placeholder:"请选择物理机产品名称",list:[],multiple:!0,filter:!0},spec_family_id:{placeholder:"请选择实例规格族",list:[]}},e.search_info={},e}return Object(u["a"])(a,[{key:"created",value:function(){this.authList=this.$store.state.auth_info[this.$route.name],this.getRegion(),this.getHostProductName(),this.getFamilyList(),this.getProductInventoryList()}},{key:"getRegion",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.searchDom.region_id.list=[],e.next=3,b["a"].get_region_az_list({employee_no:this.$store.state.employee_no,user_name:this.$store.state.login_name});case 3:if(t=e.sent,"Success"===t.code){for(a in t.data)for(n in this.searchDom.region_id.list=[].concat(Object(o["a"])(this.searchDom.region_id.list),Object(o["a"])(Object(v["c"])(t.data[a].region_list,"region_name","region_id","label","type"))),t.data[a].region_list)this.searchDom.az_id.list=[].concat(Object(o["a"])(this.searchDom.az_id.list),Object(o["a"])(Object(v["c"])(t.data[a].region_list[n].az_list,"az_name","az_id","label","type")));"0"==this.$store.state.is_special_user&&(this.searchDom.region_id.close_clearable=!0,this.searchDom.region_id.default_value=this.searchDom.region_id.list[0].type,this.search_info=this.searchDom.region_id.list[0].type,this.search(this.search_info))}case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getHostProductName",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a,n,s=this,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:"",a=!(i.length>1&&void 0!==i[1])||i[1],a||this.$store.commit("SET_LOADING",!1),e.next=5,f["a"].get_product_host_name({page_index:1,page_size:20,name:t});case 5:n=e.sent,"Success"===n.code&&(this.searchDom.host_product_name.list=[],n.data.host_product_list.map((function(e){s.searchDom.host_product_name.list.push({type:e.name,label:e.name})})),this.pageInfo.total=n.data.page_info.count);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getFamilyList",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_family_data();case 2:t=e.sent,"Success"===t.code&&(a=["spec_family_id","name"],n=["type","label"],this.searchDom.spec_family_id.list=Object(v["b"])(t.data.spec_family_list,n,a));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnFilter",value:function(e){this.getHostProductName(e,!1)}},{key:"search",value:function(e){this.search_info=Object(r["a"])({},e),this.getProductInventoryList()}},{key:"getProductInventoryList",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].get_product_inventory_list((t={region_id:this.search_info.region_id,az_id:this.search_info.az_id,host_product_name:this.search_info.host_product_name?this.search_info.host_product_name.join(","):void 0,spec_family_id:this.search_info.spec_family_id},Object(i["a"])(t,this.sortLable?"sort_".concat(this.sortLable):"",this.sortLable?this.sort:void 0),Object(i["a"])(t,"page_index",this.pageInfo.page_index),Object(i["a"])(t,"page_size",this.pageInfo.page_size),t));case 2:a=e.sent,"Success"===a.code&&(this.list=a.data.spec_stock_list,this.pageInfo.total=a.data.page_info.count,this.list.map((function(e){return e.availableNumList=[{name:"云主机",num:e.cloud_vm_sale_num},{name:"云桌面",num:e.cloud_desktop_sale_num},{name:"文件存储",num:e.nas_host_sale_num}],e})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCurrentChange",value:function(e){this.pageInfo.page_index=e,this.getProductInventoryList()}},{key:"handleSizeChange",value:function(e){this.pageInfo.page_size=e,this.getProductInventoryList()}},{key:"handleSort",value:function(e){this.sortLable=e.prop,this.sort="descending"===e.order?"1":"ascending"===e.order?"0":void 0,this.getProductInventoryList()}},{key:"exportList",value:function(){var e="";for(var t in this.search_info)this.search_info[t]&&(e+="".concat(t,"=").concat(Array.isArray(this.search_info[t])?this.search_info[t].join(","):this.search_info[t],"&"));var a=""===e?"":"?".concat(e.slice(0,e.length-1));window.location.href="/ecs_business/v1/stock/spec_stock_download/".concat(a)}},{key:"detail",value:function(e){this.visible=!0,this.operateInfo=e}}]),a}(d["e"]);C=Object(h["a"])([Object(d["a"])({components:{ActionBlock:m["a"],svgIcon:O["a"],Customer:P}})],C);var T=C,D=T,R=(a("1d27"),Object(I["a"])(D,n,s,!1,null,"6d65dd64",null));t["default"]=R.exports},e527:function(e,t,a){"use strict";var n=a("81a9"),s=a("bff7"),i=a("4328"),r=a.n(i);t["a"]={get_instance_list:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/ecs_list/",e))},operate_instance:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/operate/",e))},delete_instance:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/delete/",e))},recover_instance:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/recover/",e))},destroy_instance:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/destroy/",e))},get_status_list:function(){return Object(n["a"])(Object(s["a"])("GET","/ecs/ecs_status_list/"))},get_family_data:function(){return Object(n["a"])(Object(s["a"])("GET","/ecs/get_family_data/"))},reset_password:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/ecs_reset_password/",e))},update_spec:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/ecs_change_configure/",e))},update_system:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/ecs_change_system/",e))},get_usage_ip:function(e){return Object(n["a"])(Object(s["a"])("GET","/ecs/get_deleted_ecs_ip/",e))},get_vnc_url:function(e){return Object(n["a"])(Object(s["a"])("GET","/ecs/vnc_info/",e))},start_charge:function(e){return Object(n["a"])(Object(s["a"])("POST","/resource/start_charge/",e))},change_config_price:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/change_config_price/",e))},change_system_price:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/change_system_price/",e))},each_resource_price:function(e){return Object(n["a"])(Object(s["a"])("POST","/ecs/each_resource_price/",e))},export_list:function(e){return Object(n["a"])({method:"GET",url:"/ecs_business/v1/ecs/ecs_list_download/",params:e,paramsSerializer:function(e){return r.a.stringify(e)},responseType:"blob"})},get_list_field:function(){return Object(n["a"])(Object(s["a"])("POST","/ecs/get_ecs_list_field/"))}}}}]);