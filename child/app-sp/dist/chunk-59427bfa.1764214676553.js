(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-59427bfa"],{1296:function(e,t,a){"use strict";var i=a("81a9"),s=a("bff7");t["a"]={get_event_list(e){return Object(i["a"])(Object(s["b"])("POST","/event/get_event_list/",e))},get_filter_list(e){return Object(i["a"])(Object(s["b"])("POST","/event/get_filter_item/",e))},get_filter_item(e){return Object(i["a"])(Object(s["b"])("POST","/event/get_filter_item/",e))},retry_task(e){return Object(i["a"])(Object(s["b"])("POST","/event/retry_task/",e))},get_error_task_list(e){return Object(i["a"])(Object(s["b"])("POST","/event/get_error_task_list/",e))},ignore(e){return Object(i["a"])(Object(s["b"])("POST","/event/task_status/",e))},get_repair_event_list(e){return Object(i["a"])(Object(s["b"])("POST","/event/get_error_task_list/",e))},getUnderlyingTasks(e){return Object(i["a"])(Object(s["b"])("GET","/event/get_maintask_detail/",e))},getTasksStatus(e){return Object(i["a"])(Object(s["b"])("GET","/event/check_task_resource/",e))},setTasksStatus(e){return Object(i["a"])(Object(s["b"])("POST","/event/repair_task_resource/",e))},setReTasks(e){return Object(i["a"])(Object(s["b"])("POST","/event/repair_task/",e))},getResourceStatus(){return Object(i["a"])(Object(s["b"])("GET","/event/resource_status/"))},task_flow_check(e){return Object(i["a"])(Object(s["b"])("GET","/event/task_flow_check/",e))}}},"1f82":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"time-box"},[t("el-radio-group",{staticClass:"m-right20",on:{change:e.FnChangeTime},model:{value:e.default_time,callback:function(t){e.default_time=t},expression:"default_time"}},e._l(e.time_list,(function(a,i){return t("el-radio-button",{key:i,attrs:{label:i}},[e._v(" "+e._s(a.label)+" ")])})),1),t("span",{staticClass:"m-left20 m-right10"},[e._v("选择时间范围:")]),t("date-picker",{attrs:{time_option:e.time_option},on:{"fn-emit":e.FnChangeDateTimer}})],1)},s=[],l=a("9ab4"),r=a("1b40"),n=a("9a8d");let c=class extends r["e"]{constructor(){super(...arguments),this.time_option={placeholder:["开始时间","结束时间"],type:"datetimerange",width:"360",clearable:!1,dis_day:this.dis_day,min_date:this.start_time,defaultTime:[]},this.time_list=Object.keys(this.timeList).length>0?this.timeList:{hour:{label:"1小时",time:36e5},"6_hour":{label:"6小时",time:216e5},"12_hour":{label:"12小时",time:432e5},day:{label:"1天",time:864e5},"3_day":{label:"3天",time:2592e5},week:{label:"7天",time:6048e5},"14_day":{label:"14天",time:12096e5}},this.default_time=""}FnChangeTime(){let e=this.time_list[this.default_time].time,t=(new Date).getTime(),a=new Date(t-e);this.start_time&&new Date(this.start_time)>a&&(a=new Date(this.start_time)),this.time_option.defaultTime=[a,new Date(t)],this.FnEmit(this.time_option.defaultTime)}FnChangeDateTimer(e){if(this.default_time="",0===e.length)return;let t=e[1].getTime()-e[0].getTime();for(let a in this.time_list)this.time_list[a].time===t&&(this.default_time=a);this.FnEmit(e)}FnEmit(e){}created(){this.default_time=this.default_timer?this.default_timer:Object.keys(this.time_list)[0],this.FnChangeTime()}};Object(l["a"])([Object(r["c"])({default:""})],c.prototype,"start_time",void 0),Object(l["a"])([Object(r["c"])({default:()=>({})})],c.prototype,"timeList",void 0),Object(l["a"])([Object(r["c"])({default:31})],c.prototype,"dis_day",void 0),Object(l["a"])([Object(r["c"])({default:""})],c.prototype,"default_timer",void 0),Object(l["a"])([Object(r["b"])("fn-emit")],c.prototype,"FnEmit",null),c=Object(l["a"])([Object(r["a"])({components:{DatePicker:n["a"]}})],c);var o=c,_=o,u=(a("2daa"),a("3d78"),a("2877")),h=Object(u["a"])(_,i,s,!1,null,"07769091",null);t["a"]=h.exports},"26f3":function(e,t,a){"use strict";a("4f3f")},"2daa":function(e,t,a){"use strict";a("5d62")},"3d78":function(e,t,a){"use strict";a("ed85")},4414:function(e,t,a){"use strict";var i=a("81a9"),s=a("bff7");t["a"]={get_cluster_outline(e){return Object(i["a"])(Object(s["b"])("GET","/pod/get_cluster_outline/",e))},get_resource_list(e){return Object(i["a"])(Object(s["b"])("GET","/cluster/get_resource_available_count_list/",e))},get_cluster_task_list(e){return Object(i["a"])(Object(s["b"])("POST","/event/get_cluster_task_list/",e))}}},4774:function(e,t,a){"use strict";a("835c")},"4f3f":function(e,t,a){},"5d62":function(e,t,a){},"835c":function(e,t,a){},"9a8d":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-date-picker",{attrs:{type:e.time_option.type,editable:!1,"range-separator":"至","picker-options":{disabledDate:e.dis_date,onPick:e.onPicker},clearable:e.time_option.clearable,"start-placeholder":e.time_option.placeholder[0],"end-placeholder":e.time_option.placeholder[1]},on:{change:e.FnEmit},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})},s=[],l=a("9ab4"),r=a("1b40");let n=class extends r["e"]{constructor(){super(...arguments),this.time=[],this.min_date="",this.day=0}dis_date(e){const{day:t}=this;if(0===t)return;let a=864e5,i=(new Date).getTime(),s=(new Date).getTime(),l=(new Date).getTime();return this.time_option.min_date?(s=new Date(this.time_option.min_date).getTime(),e.getTime()>l||e.getTime()<s-a):e.getTime()>l||e.getTime()>(this.min_date||i)+a*t||this.min_date&&e.getTime()<this.min_date-a*t}onPicker({maxDate:e,minDate:t}){this.min_date=t.getTime()}created(){this.day=this.time_option.dis_day-1||0,this.FnChangeDefaultTime(this.time_option.defaultTime)}FnClear(){this.FnChangeDefaultTime(this.time_option.defaultTime)}FnChangeDefaultTime(e){console.log("clear",e),e.length,this.time=e,this.FnEmit()}FnEmit(){return this.min_date="",this.time}};Object(l["a"])([Object(r["c"])({default:()=>({placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!1,dis_day:31,min_date:"",defaultTime:[new Date,new Date]})})],n.prototype,"time_option",void 0),Object(l["a"])([Object(r["c"])({default:!1})],n.prototype,"clear",void 0),Object(l["a"])([Object(r["f"])("time_option.defaultTime")],n.prototype,"FnChangeDefaultTime",null),Object(l["a"])([Object(r["b"])("fn-emit")],n.prototype,"FnEmit",null),n=Object(l["a"])([r["a"]],n);var c=n,o=c,_=a("2877"),u=Object(_["a"])(o,i,s,!1,null,null,null);t["a"]=u.exports},c811:function(e,t,a){"use strict";a("e9f5"),a("910d");var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"action-box",style:e.isShowBg?{}:{background:"#fff",padding:0,margin:0,border:"none"}},[t("div",{ref:"search",staticClass:"search-box",class:{fold:!e.isOpen}},[e._l(e.search_option,(function(a,i){return t("div",{key:i,staticClass:"search-input",style:a.width?{width:a.width+"px"}:{}},[a.list&&!a.type?t("el-select",{attrs:{placeholder:a.placeholder,multiple:a.multiple,filterable:a.filter,clearable:""},model:{value:e.search_value[i],callback:function(t){e.$set(e.search_value,i,t)},expression:"search_value[key]"}},e._l(a.list,(function(e,i){return t("el-option",{key:Array.isArray(a.list)?e.type:i,attrs:{label:Array.isArray(a.list)?e.label:e,value:Array.isArray(a.list)?e.type:i}})})),1):e._e(),(a.list||a.type||a.multi)&&"composite"!==a.type?e._e():t("el-input",{staticClass:"composite",style:a.width?{width:a.width+"px"}:{},attrs:{placeholder:a.placeholder,clearable:""},model:{value:e.search_value[i],callback:function(t){e.$set(e.search_value,i,t)},expression:"search_value[key]"}},["composite"===a.type?t("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.search_value[i+"sub"],callback:function(t){e.$set(e.search_value,i+"sub",t)},expression:"search_value[key + 'sub']"}},e._l(a.list,(function(e){return t("el-option",{key:e.type,attrs:{label:e.label,value:e.type}})})),1):e._e()],1),a.multi?t("el-popover",{attrs:{placement:"bottom",width:"250",trigger:"click"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:a.placeholder+"（使用回车或英文逗号隔开）"},model:{value:e.search_value[i],callback:function(t){e.$set(e.search_value,i,t)},expression:"search_value[key]"}}),!a.list&&!a.type||a.multi?t("el-input",{staticClass:"multi_input",style:a.width?{width:a.width+"px"}:{},attrs:{slot:"reference",placeholder:a.placeholder,clearable:""},slot:"reference",model:{value:e.search_value[i],callback:function(t){e.$set(e.search_value,i,t)},expression:"search_value[key]"}}):e._e()],1):e._e(),"datetimerange"===a.type||"daterange"===a.type?[t("date-picker",{ref:"datepicker",refInFor:!0,attrs:{time_option:e.search_option[i]},on:{"fn-emit":function(t){return e.FnGetTime(t,i)}}})]:e._e()],2)})),e.type?e._e():t("div",{staticClass:"m-bottom20"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("查 询")]),t("el-button",{attrs:{type:"default"},on:{click:e.FnClear}},[e._v("清 空")])],1)],2),e.type?t("div",{staticClass:"m-bottom5"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("查 询")]),"physical"===e.type?t("el-button",{attrs:{type:"primary"},on:{click:e.FnMultiSearch}},[e._v("批量查询")]):e._e(),t("el-button",{attrs:{type:"default"},on:{click:e.FnClear}},[e._v("清 空")]),t("el-button",{staticClass:"m-bottom10",attrs:{type:"text"},on:{click:e.operate}},[e._v(e._s(e.isOpen?"折叠":"展开"))])],1):e._e(),e._t("default",(function(){return[e.create_btn?t("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.FnShowCreate}},[e._v(e._s(e.create_btn))]):e._e()]})),t("el-dialog",{attrs:{title:"批量查询",visible:e.syncVisible,width:"400px","destroy-on-close":!0,"close-on-click-modal":!1}},[t("el-input",{attrs:{type:"textarea",rows:13,placeholder:"请输入主机ID/名称,格式如下：\nPOD01-CLU01-H001\nPOD01-CLU01-H002\nPOD01-CLU01-H003\n..."},model:{value:e.search_value["host_info"],callback:function(t){e.$set(e.search_value,"host_info",t)},expression:"search_value['host_info']"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("确认")]),t("el-button",{on:{click:function(t){e.syncVisible=!1}}},[e._v("取消")])],1)],1)],2)},s=[],l=a("9ab4"),r=a("1b40"),n=a("9a8d");let c=class extends r["e"]{constructor(){super(...arguments),this.search_value={},this.time=null,this.date_key="",this.syncVisible=!1,this.isOpen=!0}FnGetTime(e,t){this.time=e,this.date_key=t}FnSearch(){return this.syncVisible=!1,this.search_value[this.date_key]=this.time,this.search_value}watch_search_option(){this.type&&this.$nextTick(()=>{let e=this.$refs.search,t=window.getComputedStyle(e).height.replace("px","");parseInt(t)>52&&this.isOpen&&(this.isOpen=!1),this.FnOperate()})}FnMultiSearch(){this.syncVisible=!0}operate(){this.isOpen=!this.isOpen,this.FnOperate()}FnOperate(){}FnShowCreate(){}watch_search_value(e,t){}FnClear(){for(let e in this.search_option)["datetimerange","daterange"].includes(this.search_option[e].type)?this.$refs.datepicker[0].FnClear():this.search_value={};this.FnSearch()}mounted(){let e=0;for(let t in this.search_option)this.search_option[t].default_value&&(this.$set(this.search_value,t,this.search_option[t].default_value),e++),"composite"===this.search_option[t].type&&this.$set(this.search_value,t+"sub",this.search_option[t].list[0].type);(e>0||"physical"===this.type)&&setTimeout(()=>{this.FnSearch()},500)}};Object(l["a"])([Object(r["c"])({default:{}})],c.prototype,"search_option",void 0),Object(l["a"])([Object(r["c"])({default:""})],c.prototype,"create_btn",void 0),Object(l["a"])([Object(r["c"])({default:!0})],c.prototype,"disabled",void 0),Object(l["a"])([Object(r["c"])({default:!1})],c.prototype,"type",void 0),Object(l["a"])([Object(r["c"])({default:!0})],c.prototype,"isShowBg",void 0),Object(l["a"])([Object(r["b"])("fn-search")],c.prototype,"FnSearch",null),Object(l["a"])([Object(r["f"])("search_option",{immediate:!0,deep:!0})],c.prototype,"watch_search_option",null),Object(l["a"])([Object(r["b"])("fn-operate")],c.prototype,"FnOperate",null),Object(l["a"])([Object(r["b"])("fn-create")],c.prototype,"FnShowCreate",null),Object(l["a"])([Object(r["f"])("search_value",{immediate:!0,deep:!0})],c.prototype,"watch_search_value",null),c=Object(l["a"])([Object(r["a"])({components:{DatePicker:n["a"]}})],c);var o=c,_=o,u=(a("4774"),a("26f3"),a("2877")),h=Object(u["a"])(_,i,s,!1,null,"20a86f62",null);t["a"]=h.exports},e6e0:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"app-container"},[t("action-block",{staticClass:"m-bottom10",attrs:{search_option:e.search_option},on:{"fn-search":e.fn_search}},[t("time-group",{attrs:{start_time:e.start_time,timeList:e.timeList,default_timer:"30_day"},on:{"fn-emit":e.FnGetTimer}})],1),t("div",{staticClass:"main-2"},[t("el-table",{ref:"table",attrs:{data:e.data_list,height:"100%"},on:{"filter-change":e.filterAttribute}},[t("el-table-column",{attrs:{prop:"task_type",label:"任务名称"}}),t("el-table-column",{attrs:{prop:"cloud_id",label:"对象"}}),t("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),t("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",filters:e.status_list,"filter-multiple":!1,"column-key":"status",width:"80px"}}),t("el-table-column",{attrs:{prop:"event_content",label:"详细信息"},scopedSlots:e._u([{key:"default",fn:function(a){return[Object.keys(a.row.event_content).length>0?t("div",e._l(a.row.event_content,(function(a,i){return t("div",{key:i},[e._v(" "+e._s(i)+": "+e._s(a)+" ")])})),0):t("div",[e._v("-")])]}}])}),t("el-table-column",{attrs:{prop:"create_time",label:"开始时间"}}),t("el-table-column",{attrs:{prop:"end_time",label:"完成时间"}})],1)],1),t("el-pagination",{attrs:{"current-page":e.page_info.current,"page-sizes":[20,50,100],"page-size":e.page_info.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},s=[],l=(a("14d9"),a("9ab4")),r=a("1b40"),n=a("c811"),c=a("1f82"),o=a("1296"),_=a("4414"),u=a("c1df"),h=a.n(u);let p=class extends r["e"]{constructor(){super(...arguments),this.default_date_timer=[],this.data_list=[],this.status_list=[],this.search_data={},this.filter_obj=null,this.type_list=[{type:"crash_cold_migrate",label:"宕机迁移"},{type:"gpu_recover",label:"GPU恢复"},{type:"gpu_ff",label:"GPU掉卡"}],this.search_option={event_concre:{placeholder:"请输入事件内容"},event_type:{placeholder:"请选择事件类型",list:this.type_list},customer_id:{placeholder:"请输入客户ID"},cloud_id:{placeholder:"请输入对象ID"}},this.start_time=new Date((new Date).setDate((new Date).getDate()-90)).toISOString().replace("Z","+08:00"),this.timeList={"6_hour":{label:"6小时",time:216e5},"12_hour":{label:"12小时",time:432e5},day:{label:"1天",time:864e5},"3_day":{label:"3天",time:2592e5},week:{label:"7天",time:6048e5},"14_day":{label:"14天",time:12096e5},"30_day":{label:"30天",time:2592e6}},this.page_info={current:1,size:20,total:0}}created(){this.getFilterList()}async getFilterList(){let e=await o["a"].get_filter_list({filed_names:["event_status"]});if("Success"===e.code)for(let t in e.data.event_status)this.status_list.push({text:e.data.event_status[t],value:t})}fn_search(e={}){this.search_data={...e,...this.filter_obj},this.FnGetList()}async FnGetList(){const{search_data:e}=this;let t={cluster_id:this.$route.params.id,page_index:this.page_info.current,page_size:this.page_info.size,status:e.status?e.status[0]:void 0,customer_id:e.customer_id||"",task_type:e.event_type||"",cloud_id:e.cloud_id||"",event_content:e.event_concre||"",start_time:h()(this.default_date_timer[0]).format("YYYY-MM-DD HH:mm:ss"),end_time:h()(this.default_date_timer[1]).format("YYYY-MM-DD HH:mm:ss")},a=await _["a"].get_cluster_task_list(t);"Success"===a.code&&(this.data_list=a.data.event_list,this.page_info.total=a.data.page_info.count)}FnGetTimer(e){this.default_date_timer=e,this.fn_search(this.search_data)}handleSizeChange(e){this.page_info.size=e,this.fn_search(this.search_data)}handleCurrentChange(e){this.page_info.current=e,this.fn_search(this.search_data)}filterAttribute(e){this.filter_obj={...this.filter_obj,...e},this.fn_search(this.search_data)}};p=Object(l["a"])([Object(r["a"])({components:{TimeGroup:c["a"],ActionBlock:n["a"]}})],p);var d=p,m=d,b=a("2877"),f=Object(b["a"])(m,i,s,!1,null,"48470450",null);t["default"]=f.exports},ed85:function(e,t,a){}}]);
//# sourceMappingURL=chunk-59427bfa.1764214676553.js.map