(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-3fd641a8"],{"138e":function(t,e,a){},aabf:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"报警联系人",name:"0"}},["0"===t.activeName?[a("List")]:t._e()],2),a("el-tab-pane",{attrs:{label:"报警联系组",name:"1"}},["1"===t.activeName?[a("GroupList")]:t._e()],2)],1)},i=[],s=a("d4ec"),r=a("bee2"),c=a("262e"),o=a("2caf"),l=a("9ab4"),u=a("1b40"),p=a("c811"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("action-block",{attrs:{search_option:t.search},on:{"fn-search":t.fn_search},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-button",{attrs:{type:"primary",disabled:!t.auth_list.includes("add_contact")},on:{click:t.add}},[t._v("新建联系人")]),a("el-button",{attrs:{type:"primary",disabled:!t.auth_list.includes("delete_contact")},on:{click:function(e){return t.del({})}}},[t._v("删除联系人")]),a("el-button",{attrs:{type:"primary",disabled:!t.auth_list.includes("add_to_group")},on:{click:t.addToWarnGroup}},[t._v("添加至报警联系组")])]},proxy:!0}])}),a("el-table",{ref:"contact_list",staticClass:"event-table",attrs:{data:t.list,border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"phone",label:"电话号码"}}),a("el-table-column",{attrs:{prop:"groupName",label:"所属报警组"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",disabled:!t.auth_list.includes("edit_contact")},on:{click:function(a){return t.edit(e.row.id)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text",disabled:!t.auth_list.includes("delete_contact")},on:{click:function(a){return t.del(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":t.current,"page-sizes":[2,20,50,100],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t.user_visible?[a("AddContact",{attrs:{title:t.user_title,id:t.user_id,visible:t.user_visible},on:{close:t.close}})]:t._e(),t.group_visible?[a("AddToGroup",{attrs:{visible:t.group_visible,contact_rows:t.contact_rows},on:{close:t.close}})]:t._e(),t.del_visible?[a("common-dialog",{attrs:{visible:t.del_visible,title:"删除联系人",contact_rows:t.contact_rows},on:{"update:visible":function(e){t.del_visible=e},close:t.close}})]:t._e()],2)},d=[],_=a("ade3"),b=a("1da1"),g=(a("96cf"),a("ac1f"),a("841c"),a("b0c0"),a("d81d"),a("a15b"),a("b64b"),a("da87")),f=a("dfe3"),v=a("2966"),m=a("d085"),y=function(t){Object(c["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.type_list=[{type:"name",label:"姓名"},{type:"email",label:"邮箱"},{type:"phone",label:"电话号码"}],t.search={type:{placeholder:"请输入后查询",list:t.type_list,type:"composite",width:340}},t.list=[],t.current=1,t.size=20,t.total=0,t.user_visible=!1,t.user_id="",t.user_title="新建联系人",t.group_visible=!1,t.del_visible=!1,t.contact_rows=[],t.search_data={},t.auth_list=[],t}return Object(r["a"])(a,[{key:"created",value:function(){this.fn_search(),this.auth_list=this.$store.state.auth_info[this.$route.name]}},{key:"fn_search",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.current=1,this.search_data=t,this.getContactList()}},{key:"getContactList",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].get_contact_list(Object(_["a"])({page:this.current,pageSize:this.size},this.search_data.typesub?this.search_data.typesub:"name",this.search_data.type));case 2:e=t.sent,"Success"===e.code&&(this.list=e.data.datas,this.list.map((function(t){var e=t.groups.map((function(t){return t.name}));return t.groupName=e.join(","),t})),this.total=e.data.total||0);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSizeChange",value:function(t){this.size=t,this.getContactList()}},{key:"handleCurrentChange",value:function(t){this.current=t,this.getContactList()}},{key:"handleSelectionChange",value:function(t){this.contact_rows=t}},{key:"add",value:function(){this.user_title="新建联系人",this.user_visible=!0}},{key:"edit",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.user_id=e,this.user_title="编辑联系人",this.user_visible=!0;case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"del",value:function(t){Object.keys(t).length>0&&(this.contact_rows=[t]),0!==this.contact_rows.length?this.del_visible=!0:this.$message.warning("请勾选联系人！")}},{key:"close",value:function(t){this.user_visible=!1,this.group_visible=!1,this.del_visible=!1,this.contact_rows=[],this.user_id="","1"===t&&this.getContactList();var e=this.$refs.contact_list;e.clearSelection()}},{key:"addToWarnGroup",value:function(){0!==this.contact_rows.length?this.group_visible=!0:this.$message.warning("请先勾选联系人！")}}]),a}(u["e"]);y=Object(l["a"])([Object(u["a"])({components:{ActionBlock:p["a"],AddContact:g["a"],AddToGroup:f["a"],CommonDialog:m["a"]}})],y);var k=y,w=k,C=a("2877"),j=Object(C["a"])(w,h,d,!1,null,null,null),x=j.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contact-group"},[a("action-block",{attrs:{search_option:t.search},on:{"fn-search":t.fn_search},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-button",{attrs:{type:"primary",disabled:!t.auth_list.includes("add_contact_group")},on:{click:t.add}},[t._v("新建联系人组")]),a("el-button",{attrs:{type:"primary",disabled:!t.auth_list.includes("delete_contact_group")},on:{click:t.del}},[t._v("删除联系人组")])]},proxy:!0}])}),a("el-collapse",{attrs:{accordion:""}},t._l(t.group_list,(function(e){return a("el-collapse-item",{key:e.id},[a("template",{slot:"title"},[a("el-checkbox",{on:{change:function(a){return t.sel_users(e.id,a)}},model:{value:e.check,callback:function(a){t.$set(e,"check",a)},expression:"item.check"}},[t._v(t._s(e.name))]),a("el-button",{staticClass:"edit",attrs:{type:"text",disabled:!t.auth_list.includes("edit_contact_group")},on:{click:function(a){return a.stopPropagation(),t.edit(e.id)}}},[t._v("编辑")])],1),a("div",{staticClass:"table-box"},[a("el-table",{staticClass:"event-table",attrs:{data:e.members,border:"","max-height":"396"}},[a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"phone",label:"电话号码"}}),a("el-table-column",{attrs:{prop:"groups",label:"所属报警组"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.groups,(function(n,i){return a("span",{key:n.id},[t._v(t._s(i===e.row.groups.length-1?""+n.name:n.name+","))])}))}}],null,!0)}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(n){return[a("el-button",{attrs:{type:"text",disabled:!t.auth_list.includes("remove_contact")},on:{click:function(a){return t.remove(n.row.id,e.id,e.name)}}},[t._v("移除")])]}}],null,!0)})],1)],1)],2)})),1),a("el-pagination",{attrs:{"current-page":t.current,"page-sizes":[2,20,50,100],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t.group_visible?[a("AddGroup",{attrs:{title:t.group_title,id:t.group_id,visible:t.group_visible},on:{"update:visible":function(e){t.group_visible=e},close:t.close_group}})]:t._e()],2)},z=[],S=(a("4de4"),a("d3b7"),a("6aac")),$=a("7afc"),G=function(t){Object(c["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.search={name:{placeholder:"请输入组名后查询"}},t.search_data={},t.list=[],t.current=1,t.size=20,t.total=0,t.group_list=[],t.group_title="新建联系人组",t.group_visible=!1,t.del_visible=!1,t.group_id="",t.group_rows=[],t.auth_list=[],t}return Object(r["a"])(a,[{key:"created",value:function(){this.fn_search(),this.auth_list=this.$store.state.auth_info[this.$route.name]}},{key:"fn_search",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.search_data=t,this.current=1,this.getContactGroupList()}},{key:"getContactGroupList",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].get_contact_group_list({name:this.search_data.name,page:this.current,pageSize:this.size});case 2:e=t.sent,"Success"===e.code&&(this.group_list=e.data.datas.map((function(t){return t=Object.assign({},t,{check:!1}),t})),this.total=e.data.total||0);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSizeChange",value:function(t){this.size=t,this.getContactGroupList()}},{key:"handleCurrentChange",value:function(t){this.current=t,this.getContactGroupList()}},{key:"handleSelectionChange",value:function(t){this.group_rows=t}},{key:"remove",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(e,a,n){var i,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=this.group_list.filter((function(t){return t.id===a}))[0].members,this.$confirm("确定将此用户从".concat(n,"中移去吗， 是否继续?"),"联系人移除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(b["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].update_contact_group({id:a,name:n,contactIDs:i.map((function(t){if(t.id!==e)return t.id}))});case 2:r=t.sent,"Success"===r.code&&(s.$message.success("移除联系人任务下发成功！"),s.getContactGroupList());case 4:case"end":return t.stop()}}),t)})))).catch((function(){s.$message({type:"info",message:"已取消移除"})}));case 2:case"end":return t.stop()}}),t,this)})));function e(e,a,n){return t.apply(this,arguments)}return e}()},{key:"close_group",value:function(t){this.group_visible=!1,this.del_visible=!1,this.group_rows=[],this.group_id="","1"===t&&this.getContactGroupList()}},{key:"add",value:function(){this.group_title="新建联系人组",this.group_visible=!0}},{key:"edit",value:function(t){this.group_id=t,this.group_title="编辑联系人组",this.group_visible=!0}},{key:"sel_users",value:function(){}},{key:"del",value:function(){var t=this;if(this.group_rows=this.group_list.filter((function(t){return t.check})),0!==this.group_rows.length){var e=this.group_rows.map((function(t){return t.name})),a=this.group_rows.map((function(t){return t.id})),n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"确定删除 "),n("i",{style:"color: #455cc6"},"".concat(e.join(","))),n("span",null,"  吗, 是否继续?")]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",iconClass:"el-icon-warning",customClass:"message-box"}).then(Object(b["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v["a"].delete_contact_group({ids:a});case 2:n=e.sent,"Success"===n.code&&(t.$message.success("删除联系人组任务下发成功！"),t.getContactGroupList());case 4:case"end":return e.stop()}}),e)})))).catch((function(){t.$message({type:"info",message:"已取消删除"}),t.getContactGroupList()}))}else this.$message.warning("请先勾选联系人组!")}},{key:"addToWarnGroup",value:function(){}}]),a}(u["e"]);G=Object(l["a"])([Object(u["a"])({components:{ActionBlock:p["a"],AddGroup:S["a"],CommonDel:$["a"]}})],G);var L=G,A=L,R=(a("ad7b"),a("db4d"),Object(C["a"])(A,O,z,!1,null,"5a18b642",null)),T=R.exports,B=function(t){Object(c["a"])(a,t);var e=Object(o["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.activeName="0",t}return Object(r["a"])(a,[{key:"handleClick",value:function(){}}]),a}(u["e"]);B=Object(l["a"])([Object(u["a"])({components:{ActionBlock:p["a"],List:x,GroupList:T}})],B);var N=B,E=N,D=Object(C["a"])(E,n,i,!1,null,null,null);e["default"]=D.exports},ad7b:function(t,e,a){"use strict";a("c534")},c534:function(t,e,a){},d81d:function(t,e,a){"use strict";var n=a("23e7"),i=a("b727").map,s=a("1dde"),r=s("map");n({target:"Array",proto:!0,forced:!r},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},db4d:function(t,e,a){"use strict";a("138e")}}]);
//# sourceMappingURL=chunk-3fd641a8.1747715207673.js.map