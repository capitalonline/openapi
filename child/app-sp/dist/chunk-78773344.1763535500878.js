(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-78773344"],{"0cec":function(t,e,a){},"1c03":function(t,e,a){},"26f3":function(t,e,a){"use strict";a("4f3f")},"29cb":function(t,e,a){"use strict";a("c85b")},"2b31":function(t,e,a){},"2f4f":function(t,e,a){"use strict";a("2b31")},3673:function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{staticClass:"svg-icon",attrs:{id:"svgIcon",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[e("defs",{attrs:{xmlns:"http://www.w3.org/2000/svg"}},[e("linearGradient",{attrs:{x1:"50%",y1:"18.3303197%",x2:"50%",y2:"100%",id:"linearGradient-1"}},[e("stop",{attrs:{"stop-color":"#8C8D94","stop-opacity":"0",offset:"0%"}}),e("stop",{attrs:{"stop-color":"#8C8D94",offset:"100%"}})],1),e("linearGradient",{attrs:{x1:"50%",y1:"21.3748651%",x2:"50%",y2:"100%",id:"linearGradient-2"}},[e("stop",{attrs:{"stop-color":"#8C8D94","stop-opacity":"0",offset:"0%"}}),e("stop",{attrs:{"stop-color":"#8C8D94",offset:"100%"}})],1),e("linearGradient",{attrs:{x1:"50%",y1:"0%",x2:"50%",y2:"100%",id:"linearGradient-3"}},[e("stop",{attrs:{"stop-color":"#8C8D94","stop-opacity":"0",offset:"0%"}}),e("stop",{attrs:{"stop-color":"#8C8D94",offset:"100%"}})],1),e("linearGradient",{attrs:{x1:"50%",y1:"0%",x2:"50%",y2:"100%",id:"linearGradient-4"}},[e("stop",{attrs:{"stop-color":"#8C8D94","stop-opacity":"0",offset:"0%"}}),e("stop",{attrs:{"stop-color":"#8C8D94",offset:"100%"}})],1)],1),t._v(" "),"search"===t.icon?e("g",[e("path",{attrs:{d:"M5.66666667,10.8333333 C2.81319546,10.8333333 0.5,8.52013787 0.5,5.66666667 C0.5,2.81319546 2.81319546,0.5 5.66666667,0.5 C8.52013787,\n    0.5 10.8333333,2.81319546 10.8333333,5.66666667 C10.8333333,8.52013787 8.52013787,10.8333333 5.66666667,10.8333333 Z M5.66666667,9.83333333 C7.96785312,\n    9.83333333 9.83333333,7.96785312 9.83333333,5.66666667 C9.83333333,3.36548021 7.96785312,1.5 5.66666667,1.5 C3.36548021,1.5 1.5,3.36548021 1.5,\n    5.66666667 C1.5,7.96785312 3.36548021,9.83333333 5.66666667,9.83333333 Z"}}),e("path",{attrs:{d:"M8.24644661,9.75355339 L11.4464466,12.9535534 C11.6417088,13.1488155 11.9582912,13.1488155 12.1535534,12.9535534 C12.3488155,12.7582912 12.3488155,\n    12.4417088 12.1535534,12.2464466 L8.95355339,9.04644661 C8.75829124,8.85118446 8.44170876,8.85118446 8.24644661,9.04644661 C8.05118446,9.24170876 8.05118446,\n    9.55829124 8.24644661,9.75355339 Z"}})]):t._e(),"refresh"===t.icon?e("g",[e("g",{attrs:{transform:"translate(-160.000000, -212.000000)"}},[e("path",{attrs:{d:"M173.918376,216.305631 L172.182224,217.058009 C172.182224,217.058009 170.986665,213.932711 167.628085,213.903723 C164.269505,\n    213.8749 163.244856,216.305631 163.244856,216.305631 L164.497115,216.913397 L160.540755,219.980882 L160,215.003465 L161.423168,\n    215.611231 C161.423168,215.611231 163.017085,212.543745 166.005657,212.10958 C168.99423,211.67558 170.759056,212.601557 171.982964,\n    213.643323 C173.206873,214.685089 173.918376,216.305631 173.918376,216.305631 Z M161.081624,221.694369 L162.817938,220.941991 C162.817938,\n    220.941991 164.013335,224.067289 167.371915,224.096277 C170.730657,224.1251 171.755144,221.694369 171.755144,221.694369 L170.502885,\n    221.086603 L174.459245,218.019283 L175,222.996535 L173.576832,222.388934 C173.576832,222.388934 171.982915,225.456255 168.994343,\n    225.89042 C166.00577,226.32442 164.240944,225.398443 163.017036,224.356677 C161.793289,223.314911 161.081624,221.694369 161.081624,221.694369 Z"}})])]):t._e(),"export"===t.icon?e("g",[e("rect",{attrs:{x:"6",y:"4",width:"4",height:"6"}}),e("polygon",{attrs:{transform:"translate(8.000000, 2.500000) rotate(-180.000000) translate(-8.000000, -2.500000) ",points:"3 0 13 0 8 5"}}),e("path",{attrs:{d:"M3.5,16.4734508 L4.5,16.4734508 L4.5,18.5 L6.9,18.5 C9.44050985,18.5 11.5,16.4405098 11.5,13.9 L11.5,9.1 C11.5,6.55949015 9.44050985,\n    4.5 6.9,4.5 L4.5,4.5 L4.5,6.52654919 L3.5,6.52654919 L3.5,4.5 C3.5,3.94771525 3.94771525,3.5 4.5,3.5 L6.9,3.5 C9.9927946,3.5 12.5,6.0072054 12.5,\n    9.1 L12.5,13.9 C12.5,16.9927946 9.9927946,19.5 6.9,19.5 L6.27777778,19.5 L4.5,19.5 C3.94771525,19.5 3.5,19.0522847 3.5,18.5 L3.5,16.4734508 Z M3.5,\n    16.4734508 L4.5,16.4734508 L4.5,18.5 L6.27777778,18.5 L6.9,18.5 C9.44050985,18.5 11.5,16.4405098 11.5,13.9 L11.5,9.1 C11.5,6.55949015 9.44050985,\n    4.5 6.9,4.5 L4.5,4.5 L4.5,6.52654919 L3.5,6.52654919 L3.5,4.5 C3.5,3.94771525 3.94771525,3.5 4.5,3.5 L6.9,3.5 C9.9927946,3.5 12.5,6.0072054 12.5,\n    9.1 L12.5,13.9 C12.5,16.9927946 9.9927946,19.5 6.9,19.5 L4.5,19.5 C3.94771525,19.5 3.5,19.0522847 3.5,18.5 L3.5,16.4734508 Z",transform:"translate(8.000000, 11.500000) rotate(-270.000000) translate(-8.000000, -11.500000) "}})]):t._e(),"detail"===t.icon?e("g",[e("path",{attrs:{d:"M0,5.9 L1.5,5.9 L1.5,10.1 C1.5,11.9777681 3.02223185,13.5 4.9,13.5 L9.1,13.5 C10.9777681,13.5 12.5,11.9777681 12.5,10.1 L12.5,5.9 C12.5,\n    4.02223185 10.9777681,2.5 9.1,2.5 L4.9,2.5 L4.9,1 L9.1,1 C11.8061953,1 14,3.19380473 14,5.9 L14,10.1 C14,12.8061953 11.8061953,15 9.1,15 L4.9,\n    15 C2.19380473,15 3.31413338e-16,12.8061953 0,10.1 L0,5.9 Z M0,5.9 L1.5,5.9 L1.5,10.1 C1.5,11.9777681 3.02223185,13.5 4.9,13.5 L9.1,13.5 C10.9777681,\n    13.5 12.5,11.9777681 12.5,10.1 L12.5,5.9 C12.5,4.02223185 10.9777681,2.5 9.1,2.5 L4.9,2.5 L4.9,1 L9.1,1 C11.8061953,1 14,3.19380473 14,5.9 L14,\n    10.1 C14,12.8061953 11.8061953,15 9.1,15 L4.9,15 C2.19380473,15 3.31413338e-16,12.8061953 0,10.1 L0,5.9 Z",transform:"translate(7.000000, 8.000000) rotate(-270.000000) translate(-7.000000, -8.000000) "}}),e("path",{attrs:{d:"M13.0304984,0.969669914 L10.0304984,3.96966991 C9.73760516,4.26256313 9.73760516,4.73743687 10.0304984,5.03033009 C10.3233916,5.3232233 10.7982653,\n    5.3232233 11.0911586,5.03033009 L14.0911586,2.03033009 C14.3840518,1.73743687 14.3840518,1.26256313 14.0911586,0.969669914 C13.7982653,0.676776695 13.3233916,\n    0.676776695 13.0304984,0.969669914 Z"}}),t._v(" "),e("path",{attrs:{d:"M4,7.75 L7,7.75 C7.41421356,7.75 7.75,7.41421356 7.75,7 C7.75,6.58578644 7.41421356,6.25 7,6.25 L4,\n    6.25 C3.58578644,6.25 3.25,6.58578644 3.25,7 C3.25,7.41421356 3.58578644,7.75 4,7.75 Z"}}),t._v(" "),e("path",{attrs:{d:"M4,10.75 L9,10.75 C9.41421356,10.75 9.75,\n    10.4142136 9.75,10 C9.75,9.58578644 9.41421356,9.25 9,9.25 L4,9.25 C3.58578644,9.25 3.25,9.58578644 3.25,10 C3.25,10.4142136 3.58578644,10.75 4,10.75 Z"}})]):t._e(),"more"===t.icon?e("g",[e("g",{attrs:{transform:"translate(2, 7)"}},[e("circle",{attrs:{cx:"1.5",cy:"1.5",r:"1.5"}}),t._v(" "),e("circle",{attrs:{cx:"6.5",cy:"1.5",r:"1.5"}}),e("circle",{attrs:{cx:"11.5",cy:"1.5",r:"1.5"}})])]):t._e(),"copy"===t.icon?e("g",[e("g",{attrs:{transform:"translate(-30.000000, -141.000000)","fill-rule":"nonzero",fill:"#8078D6"}},[e("g",{attrs:{transform:"translate(30.000000, 141.000000)"}},[e("path",{attrs:{d:"M6.18949336e-15,5.74573472 C0.603568923,4.70213211 1.73168467,4 3.02375885,4 L8.50923955,4 C10.4371333,4 12,5.56318412 12,7.49146945 L12,\n    12.975627 C12,14.2679636 11.2980105,15.3963085 10.2546198,16 L10.2546198,13.942267 C10.41349,13.6559043 10.5039598,13.326333 10.5039598,\n    12.975627 L10.5039598,7.49146945 C10.5039598,6.38959212 9.61089313,5.49634405 8.50923955,5.49634405 L3.02375885,5.49634405 C2.67312412,\n    5.49634405 2.34361974,5.58683223 2.0573151,5.74573472 L6.10622664e-15,5.74573472 Z",id:"Combined-Shape",transform:"translate(6.000000, 10.000000) rotate(-180.000000) translate(-6.000000, -10.000000) "}}),e("path",{attrs:{d:"M14.5,6.87867966 L14.5,3.9 C14.5,2.5745166 13.4254834,1.5 12.1,1.5 L6.9,1.5 C5.5745166,1.5 4.5,\n    2.5745166 4.5,3.9 L4.5,9.1 C4.5,10.4254834 5.5745166,11.5 6.9,11.5 L9.87867966,11.5 L14.5,6.87867966 Z M10.5,\n    13 L6.9,13 C4.74608948,13 3,11.2539105 3,9.1 L3,3.9 C3,1.74608948 4.74608948,0 6.9,0 L12.1,4.4408921e-16 C14.2539105,\n    4.4408921e-16 16,1.74608948 16,3.9 L16,7.5 L10.5,13 Z",id:"Rectangle-99",transform:"translate(9.500000, 6.500000) rotate(-90.000000) translate(-9.500000, -6.500000) "}}),t._v(" "),e("path",{attrs:{d:"M15,0.5 L11,0.5 C10.1715729,0.5 9.5,1.17157288 9.5,2 L9.5,6 L10.5,6 L10.5,2 C10.5,1.72385763 10.7238576,\n    1.5 11,1.5 L15,1.5 L15,0.5 Z",id:"Path-52",transform:"translate(12.250000, 3.250000) rotate(-90.000000) translate(-12.250000, -3.250000) "}})])])]):t._e(),"info"===t.icon?e("g",[e("path",{attrs:{d:"M8.51248164,17.1097561 C4.08294846,17.1097561 0.5,13.3873542 0.5,8.80487805 C0.5,4.22240188 4.08294846,0.5 8.51248164,0.5 C12.9420148,\n    0.5 16.5249633,4.22240188 16.5249633,8.80487805 C16.5249633,13.3873542 12.9420148,17.1097561 8.51248164,17.1097561 Z M8.51248164,16.1097561 C12.3810065,16.1097561 15.5249633,\n    12.8434321 15.5249633,8.80487805 C15.5249633,4.76632398 12.3810065,1.5 8.51248164,1.5 C4.64395674,1.5 1.5,4.76632398 1.5,8.80487805 C1.5,12.8434321 4.64395674,\n    16.1097561 8.51248164,16.1097561 Z",id:"Oval-3","fill-rule":"nonzero",fill:"#455cc6"}}),e("ellipse",{attrs:{id:"Oval-4",cx:"8.51248164",cy:"4.90243902",rx:"1",ry:"1"}}),e("rect",{attrs:{id:"Rectangle-10",x:"7.57342144",y:"6.85365854",width:"1.87812041",height:"6.82926829",rx:"0.939060206"}})]):t._e()])},i=[],o=a("9ab4"),r=a("1b40");let n=class extends r["e"]{};Object(o["a"])([Object(r["c"])({default:""})],n.prototype,"icon",void 0),n=Object(o["a"])([r["a"]],n);var l=n,c=l,p=(a("29cb"),a("2877")),d=Object(p["a"])(c,s,i,!1,null,"7bbf8d24",null);e["a"]=d.exports},"41aa":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"gpuBox"},[e("el-tabs",{attrs:{type:"border-card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"GPU管理",name:"first"}}),e("el-tab-pane",{attrs:{label:"GPU故障记录",name:"second"}})],1),e("div",["first"===t.activeName?[e("gpu_list")]:[e("gpu_fault-record")]],2)],1)},i=[],o=a("9ab4"),r=a("1b40"),n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"instance-list"},[e("action-block",{attrs:{search_option:t.search_con,type:!0},on:{"fn-search":t.FnSearch}}),e("el-table",{ref:"table",attrs:{data:t.gpu_list,"row-class-name":t.rowStyle,border:""},on:{"filter-change":t.handleFilterChange,"selection-change":t.handleSelectionChange,"row-click":t.FnOperRow,"row-contextmenu":t.FnRightClick}},[e("el-table-column",{attrs:{type:"selection"}}),e("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),e("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),e("el-table-column",{attrs:{prop:"host_name",label:"主机名"}}),e("el-table-column",{attrs:{prop:"host_id",label:"物理机ID",width:"200px"}}),e("el-table-column",{attrs:{prop:"host_ip",label:"管理网IP"}}),e("el-table-column",{attrs:{prop:"card_name",label:"GPU"}}),e("el-table-column",{attrs:{label:"Slot号",prop:"slot"}}),e("el-table-column",{attrs:{label:"PCIe号",prop:"pci_address"}}),e("el-table-column",{attrs:{label:"SN号",prop:"sn"}}),e("el-table-column",{attrs:{label:"状态",prop:"status","column-key":"status",filters:t.status_list,"filter-multiple":!1},scopedSlots:t._u([{key:"default",fn:function(a){return["禁售"===a.row.status?e("span",[e("el-tooltip",{attrs:{content:a.row.message,"popper-class":"tooltip-width",placement:"bottom",effect:"light"}},[e("span",{staticClass:"id-cell"},[t._v(t._s(a.row.status))])])],1):e("span",{class:["FF"===a.row.status?"err":"normal"]},[t._v(t._s(a.row.status))])]}}])}),e("el-table-column",{attrs:{label:"监控"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.FnGoToMonitor(a.row)}}},[t._v("查看监控")])]}}])}),e("el-table-column",{attrs:{label:"所属云主机",prop:"vm_id"}}),e("el-table-column",{attrs:{label:"创建时间",prop:"create_time"}}),e("el-table-column",{attrs:{label:"更新时间",prop:"update_time"}})],1),e("el-pagination",{attrs:{"current-page":t.page_info.page_index,"page-sizes":t.page_info.page_sizes,"page-size":t.page_info.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.page_info.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.page_info,"page_index",e)},"update:current-page":function(e){return t.$set(t.page_info,"page_index",e)},"update:pageSize":function(e){return t.$set(t.page_info,"page_size",e)},"update:page-size":function(e){return t.$set(t.page_info,"page_size",e)}}}),e("gpu-edit",{attrs:{visible:t.visible,oper_info:t.oper_info},on:{"update:visible":function(e){t.visible=e}}}),e("sale",{attrs:{oper_info:t.oper_info,visible:t.visible_sale,type:t.hand_type},on:{"update:visible":function(e){t.visible_sale=e}}}),1===t.multi_rows.length?e("right-click",{attrs:{multi_rows:t.multi_rows,menus:t.menus,name:t.multi_rows.length>0?t.multi_rows[0].host_name:""},on:{"fn-click":t.infoClick}}):t._e()],1)},l=[],c=(a("14d9"),a("e9f5"),a("d866"),a("ab43"),a("a732"),a("c811")),p=a("c1df"),d=a.n(p),u=a("8693"),_=a("d220"),h=a("bd4d"),f=a("e8c0"),m=a("cf88"),b=a("6285"),g=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("el-dialog",{attrs:{title:"forbid"===t.type?"禁售":"取消禁售",visible:t.visible_sync,width:"800px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible_sync=e},close:function(e){t.visible_sync=!1}}},[e("el-alert",{attrs:{title:`是否确定要对以下实例执行 ${"forbid"===t.type?"禁售":"取消禁售"} 操作`,type:"warning",closable:!1,center:""}}),e("el-table",{attrs:{data:t.oper_info,border:""}},[e("el-table-column",{attrs:{prop:"card_name",label:"GPU"}}),e("el-table-column",{attrs:{prop:"host_id",label:"物理机ID"}}),e("el-table-column",{attrs:{prop:"host_name",label:"主机名"}}),e("el-table-column",{attrs:{prop:"pci_address",label:"PCIe号"}}),"forbid"===t.type?e("el-table-column",{attrs:{prop:"lock",label:"禁售原因"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{type:"textarea",placeholder:"请输入禁售原因",maxlength:"50","show-word-limit":""},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.reason,expression:"!reason"}],staticClass:"error_message"},[t._v("请输入禁售原因")])]}}],null,!1,3678557658)}):t._e()],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确认")]),e("el-button",{on:{click:function(e){t.visible_sync=!1}}},[t._v("取消")])],1)],1)],1)},y=[];let v=class extends r["e"]{constructor(){super(...arguments),this.reason=""}watch_visible(t){t||(this.reason="")}async confirm(){if("forbid"===this.type&&""===this.reason)return;let t=Object(b["b"])(this.$route.params.id),e={pod_id:t,op_type:this.type,host_id:this.oper_info[0].host_id,pci_address:this.oper_info[0].pci_address};"forbid"===this.type&&(e["message"]=this.reason);let a=await u["a"].handle_gpu_sale(e);"Success"===a.code&&(this.$message.success(a.message),this.visible_sync=!1)}};Object(o["a"])([Object(r["d"])("visible")],v.prototype,"visible_sync",void 0),Object(o["a"])([Object(r["c"])({default:()=>{}})],v.prototype,"oper_info",void 0),Object(o["a"])([Object(r["c"])({default:""})],v.prototype,"type",void 0),Object(o["a"])([Object(r["f"])("visible_sync")],v.prototype,"watch_visible",null),v=Object(o["a"])([Object(r["a"])({})],v);var C=v,w=C,O=a("2877"),x=Object(O["a"])(w,g,y,!1,null,"5ce99dfe",null),L=x.exports;let j=class extends r["e"]{constructor(){super(...arguments),this.gpu_list=[],this.search_reqData={},this.visible=!1,this.oper_info={},this.err="err",this.normal="normal",this.operate_auth=[],this.search_status=[],this.multi_rows=[],this.hand_type="",this.visible_sale=!1,this.status_list=[{text:"正常",value:"READY"},{text:"FF",value:"DISCONNECTED"}],this.menus=[{label:"编辑",value:"edit",single:!0,disabled:!1},{label:"禁售",value:"forbid",single:!0,disabled:!1},{label:"取消禁售",value:"cancel_forbid",single:!0,disabled:!1},{label:"同步",value:"sync",single:!0,disabled:!1}],this.page_info={page_sizes:[20,50,100],page_size:20,page_index:1,total:0},this.search_con={vm_id:{placeholder:"请输入云服务器ID"},card_name:{placeholder:"请输入显卡名称"},host_ip:{placeholder:"请输入管理网IP"},customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},sn:{placeholder:"请输入sn号"},create_time:{placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!0,dis_day:1,defaultTime:[]}},this.menuConditions={cancel_forbid:()=>!this.hasStatus("禁售"),forbid:()=>this.hasStatus("禁售")}}watch_visible(t){t||(this.oper_info={},this.FnGetList())}watch_pod(t){t&&this.FnGetList()}watch_multi(){this.handleMenus()}hasStatus(t){return this.multi_rows.every(e=>e.status===t)}handleMenus(){for(const t of this.menus)t.disabled=!!this.menuConditions[t.value]&&this.menuConditions[t.value]()}infoClick(t){if(t.disabled)return;const{label:e,value:a}=t;"edit"===a?this.FnEdit(this.multi_rows[0]):"forbid"===a?this.FnHandleGpuSale(this.multi_rows[0],"forbid"):"cancel_forbid"===a?this.FnHandleGpuSale(this.multi_rows[0],"cancel_forbid"):"sync"===a&&this.FnSync(this.multi_rows[0]),Object(m["a"])()}async FnSync(t){let e=Object(b["b"])(this.$route.params.id),a=await u["a"].update_host_gpu_status({pod_id:e,host_id:t.host_id,pci_address:t.pci_address});"Success"===a.code&&this.$message.success(a.message)}async FnHandleGpuSale(t,e){this.visible_sale=!0,this.oper_info=[t],this.hand_type=e}handleFilterChange(t){this.search_status=t.status,console.log("this.search_status",this.search_status),this.FnGetList()}handleSelectionChange(t){this.multi_rows=t}FnOperRow(t){this.$refs.table.toggleRowSelection(t)}rowStyle({row:t}){const e=this.multi_rows.some(e=>e.index===t.index);if(e)return"rowStyle"}FnRightClick(t,e,a){console.log(a);const s=this.multi_rows.some(e=>e.index===t.index);s||this.$refs.table.toggleRowSelection(t),Object(f["a"])(t,e,a)}created(){this.FnGetList(),this.operate_auth=this.$store.state.auth_info[this.$route.name]}async FnEdit(t){this.visible=!0,this.oper_info=t}FnGoToMonitor(t){this.$router.push({name:"host_monitor",params:{id:t.host_id,gpuTab:"gpu"}})}FnSearch(t={}){this.search_reqData={vm_id:t.vm_id,card_name:t.card_name,customer_id:t.customer_id,customer_name:t.customer_name,host_ip:t.host_ip,host_name:t.host_name,sn:t.sn,create_time_start:t.create_time&&t.create_time[0]?d()(t.create_time[0]).local().format("YYYY-MM-DDTHH:mm:ss[Z]"):void 0,create_time_end:t.create_time&&t.create_time[0]?d()(t.create_time[1]).local().format("YYYY-MM-DDTHH:mm:ss[Z]"):void 0},this.FnGetList()}async FnGetList(){let t="";t="waiting_hosts"===this.$route.name?this.$route.params.id.slice(0,this.$route.params.id.length-1):this.$route.params.id;let e=Object(b["b"])(t);const a=await u["a"].get_gpu_list({pod_id:e,page_index:this.page_info.page_index,page_size:this.page_info.page_size,status:this.search_status.length>0?this.search_status.join(","):this.search_status.map(t=>t.value).join(","),host_id:this.$route.params.id,...this.search_reqData});"Success"===a.code&&(this.gpu_list=a.data.page_info_list,this.page_info.total=a.data.page_info.count)}handleSizeChange(t){this.page_info.page_size=t,this.page_info.page_index=1,this.FnGetList()}handleCurrentChange(t){this.page_info.page_index=t,this.FnGetList()}};Object(o["a"])([Object(r["f"])("visible")],j.prototype,"watch_visible",null),Object(o["a"])([Object(r["f"])("$store.state.pod_id")],j.prototype,"watch_pod",null),Object(o["a"])([Object(r["f"])("multi_rows",{immediate:!0,deep:!0})],j.prototype,"watch_multi",null),j=Object(o["a"])([Object(r["a"])({components:{Sale:L,RightClick:h["a"],GpuEdit:_["a"],ActionBlock:c["a"]}})],j);var k=j,F=k,S=(a("2f4f"),Object(O["a"])(F,n,l,!1,null,"9accdb9c",null)),D=S.exports,T=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"instance-list"},[e("action-block",{attrs:{search_option:t.search_con,type:!1},on:{"fn-search":t.FnSearch}}),e("div",{staticClass:"icon m-bottom10"},[e("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[e("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"text"},on:{click:t.down}},[e("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1)],1),e("el-table",{attrs:{data:t.history_list,border:""}},[e("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),e("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),e("el-table-column",{attrs:{prop:"host_name",label:"主机名"}}),e("el-table-column",{attrs:{prop:"host_id",label:"物理机ID"}}),e("el-table-column",{attrs:{prop:"host_ip",label:"管理网IP"}}),e("el-table-column",{attrs:{prop:"card_name",label:"GPU"}}),e("el-table-column",{attrs:{label:"所属云主机",prop:"vm_id"}}),e("el-table-column",{attrs:{label:"Slot号",prop:"slot"}}),e("el-table-column",{attrs:{label:"PCIe号",prop:"pci_address"}}),e("el-table-column",{attrs:{label:"SN号",prop:"sn"}}),e("el-table-column",{attrs:{label:"更新内容",prop:"content"}}),e("el-table-column",{attrs:{label:"创建时间",prop:"create_time"}})],1),e("el-pagination",{attrs:{"current-page":t.page_info.page_index,"page-sizes":t.page_info.page_sizes,"page-size":t.page_info.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.page_info.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.page_info,"page_index",e)},"update:current-page":function(e){return t.$set(t.page_info,"page_index",e)},"update:pageSize":function(e){return t.$set(t.page_info,"page_size",e)},"update:page-size":function(e){return t.$set(t.page_info,"page_size",e)}}})],1)},G=[],$=(a("88a7"),a("271a"),a("5494"),a("3673"));let P=class extends r["e"]{constructor(){super(...arguments),this.history_list=[],this.search_reqData={},this.loading=!1,this.page_info={page_sizes:[20,50,100],page_size:20,page_index:1,total:0},this.search_con={pci_address:{placeholder:"请输入PCIe号"},host_ip:{placeholder:"请输入管理网IP"},customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},create_time:{placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!0,dis_day:1,defaultTime:[]}}}watch_pod(t){t&&this.FnGetList()}FnSearch(t={}){this.search_reqData={pci_address:t.pci_address,customer_id:t.customer_id,customer_name:t.customer_name,host_ip:t.host_ip,host_name:t.host_name,create_time_start:t.create_time&&t.create_time[0]?d()(t.create_time[0]).local().format("YYYY-MM-DDTHH:mm:ss[Z]"):void 0,create_time_end:t.create_time&&t.create_time[0]?d()(t.create_time[1]).local().format("YYYY-MM-DDTHH:mm:ss[Z]"):void 0},this.FnGetList()}created(){this.FnGetList()}async FnGetList(){let t=Object(b["b"])(this.$route.params.id);const e=await u["a"].get_gpu_record({pod_id:t,page_index:this.page_info.page_index,page_size:this.page_info.page_size,host_id:this.$route.params.id,...this.search_reqData});"Success"===e.code&&(this.history_list=e.data.gpu_record_list,this.page_info.total=e.data.page_info.count)}handleSizeChange(t){this.page_info.page_size=t,this.page_info.page_index=1,this.FnGetList()}handleCurrentChange(t){this.page_info.page_index=t,this.FnGetList()}async down(){this.loading=!0;const t=await u["a"].gpu_record_download({...this.search_reqData});if(t){this.loading=!1;let e=new Blob([t],{type:"application/octet-stream"}),a=new FileReader,s="GPU故障记录--"+d()(new Date).format("YYYYMMDD");a.readAsText(e,"utf-8"),a.onload=()=>{let t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download=s+".xlsx",t.click(),window.URL.revokeObjectURL(t.href)}}}};Object(o["a"])([Object(r["f"])("$store.state.pod_id")],P.prototype,"watch_pod",null),P=Object(o["a"])([Object(r["a"])({components:{ActionBlock:c["a"],SvgIcon:$["a"]}})],P);var z=P,M=z,I=(a("9b20"),Object(O["a"])(M,T,G,!1,null,"415d0e30",null)),E=I.exports;let R=class extends r["e"]{constructor(){super(...arguments),this.activeName="first"}};R=Object(o["a"])([Object(r["a"])({components:{Gpu_faultRecord:E,Gpu_list:D}})],R);var Y=R,Z=Y,H=(a("7852"),Object(O["a"])(Z,s,i,!1,null,"3b3d1647",null));e["default"]=H.exports},4774:function(t,e,a){"use strict";a("835c")},"4f3f":function(t,e,a){},6285:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return o}));var s=a("0613");function i(t){for(let e of s["a"].state.tree_list)for(let a of e.children)if(a.cluster_id===t)return e.pod_id;return null}function o(t){for(let e of s["a"].state.tree_list)for(let a of e.children||[])for(let s of a.children||[])if(s.host_id===t)return e.pod_id;return null}},7852:function(t,e,a){"use strict";a("0cec")},"835c":function(t,e,a){},8693:function(t,e,a){"use strict";var s=a("81a9"),i=a("bff7");e["a"]={get_gpu_list(t){return Object(s["a"])(Object(i["b"])("GET","/host/gpu_list/",t))},post_edit_gpu(t){return Object(s["a"])(Object(i["b"])("POST","/host/edit_gpu/",t))},get_gpu_record(t){return Object(s["a"])(Object(i["b"])("GET","/host/get_gpu_record/",t))},gpu_record_download(t){return Object(s["a"])(Object(i["e"])("GET","/host/gpu_record_download/",t,"blob"))},handle_gpu_sale(t){return Object(s["a"])(Object(i["b"])("POST","/host/handle_gpu_sale/",t))},update_host_gpu_status(t){return Object(s["a"])(Object(i["b"])("POST","/host/update_host_gpu_status/",t))}}},"9a8d":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-date-picker",{attrs:{type:t.time_option.type,editable:!1,"range-separator":"至","picker-options":{disabledDate:t.dis_date,onPick:t.onPicker},clearable:t.time_option.clearable,"start-placeholder":t.time_option.placeholder[0],"end-placeholder":t.time_option.placeholder[1]},on:{change:t.FnEmit},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})},i=[],o=a("9ab4"),r=a("1b40");let n=class extends r["e"]{constructor(){super(...arguments),this.time=[],this.min_date="",this.day=0}dis_date(t){const{day:e}=this;if(0===e)return;let a=864e5,s=(new Date).getTime(),i=(new Date).getTime(),o=(new Date).getTime();return this.time_option.min_date?(i=new Date(this.time_option.min_date).getTime(),t.getTime()>o||t.getTime()<i-a):t.getTime()>o||t.getTime()>(this.min_date||s)+a*e||this.min_date&&t.getTime()<this.min_date-a*e}onPicker({maxDate:t,minDate:e}){this.min_date=e.getTime()}created(){this.day=this.time_option.dis_day-1||0,this.FnChangeDefaultTime(this.time_option.defaultTime)}FnClear(){this.FnChangeDefaultTime(this.time_option.defaultTime)}FnChangeDefaultTime(t){console.log("clear",t),t.length,this.time=t,this.FnEmit()}FnEmit(){return this.min_date="",this.time}};Object(o["a"])([Object(r["c"])({default:()=>({placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!1,dis_day:31,min_date:"",defaultTime:[new Date,new Date]})})],n.prototype,"time_option",void 0),Object(o["a"])([Object(r["c"])({default:!1})],n.prototype,"clear",void 0),Object(o["a"])([Object(r["f"])("time_option.defaultTime")],n.prototype,"FnChangeDefaultTime",null),Object(o["a"])([Object(r["b"])("fn-emit")],n.prototype,"FnEmit",null),n=Object(o["a"])([r["a"]],n);var l=n,c=l,p=a("2877"),d=Object(p["a"])(c,s,i,!1,null,null,null);e["a"]=d.exports},"9b20":function(t,e,a){"use strict";a("1c03")},a732:function(t,e,a){"use strict";var s=a("23e7"),i=a("c65b"),o=a("2266"),r=a("59ed"),n=a("825a"),l=a("46c4"),c=a("2a62"),p=a("f99f"),d=p("some",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:d},{some:function(t){n(this);try{r(t)}catch(s){c(this,"throw",s)}if(d)return i(d,this,t);var e=l(this),a=0;return o(e,(function(e,s){if(t(e,a++))return s()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},c811:function(t,e,a){"use strict";a("e9f5"),a("910d");var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"action-box",style:t.isShowBg?{}:{background:"#fff",padding:0,margin:0,border:"none"}},[e("div",{ref:"search",staticClass:"search-box",class:{fold:!t.isOpen}},[t._l(t.search_option,(function(a,s){return e("div",{key:s,staticClass:"search-input",style:a.width?{width:a.width+"px"}:{}},[a.list&&!a.type?e("el-select",{attrs:{placeholder:a.placeholder,multiple:a.multiple,filterable:a.filter,clearable:""},model:{value:t.search_value[s],callback:function(e){t.$set(t.search_value,s,e)},expression:"search_value[key]"}},t._l(a.list,(function(t,s){return e("el-option",{key:Array.isArray(a.list)?t.type:s,attrs:{label:Array.isArray(a.list)?t.label:t,value:Array.isArray(a.list)?t.type:s}})})),1):t._e(),(a.list||a.type||a.multi)&&"composite"!==a.type?t._e():e("el-input",{staticClass:"composite",style:a.width?{width:a.width+"px"}:{},attrs:{placeholder:a.placeholder,clearable:""},model:{value:t.search_value[s],callback:function(e){t.$set(t.search_value,s,e)},expression:"search_value[key]"}},["composite"===a.type?e("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.search_value[s+"sub"],callback:function(e){t.$set(t.search_value,s+"sub",e)},expression:"search_value[key + 'sub']"}},t._l(a.list,(function(t){return e("el-option",{key:t.type,attrs:{label:t.label,value:t.type}})})),1):t._e()],1),a.multi?e("el-popover",{attrs:{placement:"bottom",width:"250",trigger:"click"}},[e("el-input",{attrs:{type:"textarea",rows:4,placeholder:a.placeholder+"（使用回车或英文逗号隔开）"},model:{value:t.search_value[s],callback:function(e){t.$set(t.search_value,s,e)},expression:"search_value[key]"}}),!a.list&&!a.type||a.multi?e("el-input",{staticClass:"multi_input",style:a.width?{width:a.width+"px"}:{},attrs:{slot:"reference",placeholder:a.placeholder,clearable:""},slot:"reference",model:{value:t.search_value[s],callback:function(e){t.$set(t.search_value,s,e)},expression:"search_value[key]"}}):t._e()],1):t._e(),"datetimerange"===a.type||"daterange"===a.type?[e("date-picker",{ref:"datepicker",refInFor:!0,attrs:{time_option:t.search_option[s]},on:{"fn-emit":function(e){return t.FnGetTime(e,s)}}})]:t._e()],2)})),t.type?t._e():e("div",{staticClass:"m-bottom20"},[e("el-button",{attrs:{type:"primary"},on:{click:t.FnSearch}},[t._v("查 询")]),e("el-button",{attrs:{type:"default"},on:{click:t.FnClear}},[t._v("清 空")])],1)],2),t.type?e("div",{staticClass:"m-bottom5"},[e("el-button",{attrs:{type:"primary"},on:{click:t.FnSearch}},[t._v("查 询")]),"physical"===t.type?e("el-button",{attrs:{type:"primary"},on:{click:t.FnMultiSearch}},[t._v("批量查询")]):t._e(),e("el-button",{attrs:{type:"default"},on:{click:t.FnClear}},[t._v("清 空")]),e("el-button",{staticClass:"m-bottom10",attrs:{type:"text"},on:{click:t.operate}},[t._v(t._s(t.isOpen?"折叠":"展开"))])],1):t._e(),t._t("default",(function(){return[t.create_btn?e("el-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.FnShowCreate}},[t._v(t._s(t.create_btn))]):t._e()]})),e("el-dialog",{attrs:{title:"批量查询",visible:t.syncVisible,width:"400px","destroy-on-close":!0,"close-on-click-modal":!1}},[e("el-input",{attrs:{type:"textarea",rows:13,placeholder:"请输入主机ID/名称,格式如下：\nPOD01-CLU01-H001\nPOD01-CLU01-H002\nPOD01-CLU01-H003\n..."},model:{value:t.search_value["host_info"],callback:function(e){t.$set(t.search_value,"host_info",e)},expression:"search_value['host_info']"}}),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.FnSearch}},[t._v("确认")]),e("el-button",{on:{click:function(e){t.syncVisible=!1}}},[t._v("取消")])],1)],1)],2)},i=[],o=a("9ab4"),r=a("1b40"),n=a("9a8d");let l=class extends r["e"]{constructor(){super(...arguments),this.search_value={},this.time=null,this.date_key="",this.syncVisible=!1,this.isOpen=!0}FnGetTime(t,e){this.time=t,this.date_key=e}FnSearch(){return this.syncVisible=!1,this.search_value[this.date_key]=this.time,this.search_value}watch_search_option(){this.type&&this.$nextTick(()=>{let t=this.$refs.search,e=window.getComputedStyle(t).height.replace("px","");parseInt(e)>52&&this.isOpen&&(this.isOpen=!1),this.FnOperate()})}FnMultiSearch(){this.syncVisible=!0}operate(){this.isOpen=!this.isOpen,this.FnOperate()}FnOperate(){}FnShowCreate(){}watch_search_value(t,e){}FnClear(){for(let t in this.search_option)["datetimerange","daterange"].includes(this.search_option[t].type)?this.$refs.datepicker[0].FnClear():this.search_value={};this.FnSearch()}mounted(){let t=0;for(let e in this.search_option)this.search_option[e].default_value&&(this.$set(this.search_value,e,this.search_option[e].default_value),t++),"composite"===this.search_option[e].type&&this.$set(this.search_value,e+"sub",this.search_option[e].list[0].type);(t>0||"physical"===this.type)&&setTimeout(()=>{this.FnSearch()},500)}};Object(o["a"])([Object(r["c"])({default:{}})],l.prototype,"search_option",void 0),Object(o["a"])([Object(r["c"])({default:""})],l.prototype,"create_btn",void 0),Object(o["a"])([Object(r["c"])({default:!0})],l.prototype,"disabled",void 0),Object(o["a"])([Object(r["c"])({default:!1})],l.prototype,"type",void 0),Object(o["a"])([Object(r["c"])({default:!0})],l.prototype,"isShowBg",void 0),Object(o["a"])([Object(r["b"])("fn-search")],l.prototype,"FnSearch",null),Object(o["a"])([Object(r["f"])("search_option",{immediate:!0,deep:!0})],l.prototype,"watch_search_option",null),Object(o["a"])([Object(r["b"])("fn-operate")],l.prototype,"FnOperate",null),Object(o["a"])([Object(r["b"])("fn-create")],l.prototype,"FnShowCreate",null),Object(o["a"])([Object(r["f"])("search_value",{immediate:!0,deep:!0})],l.prototype,"watch_search_value",null),l=Object(o["a"])([Object(r["a"])({components:{DatePicker:n["a"]}})],l);var c=l,p=c,d=(a("4774"),a("26f3"),a("2877")),u=Object(d["a"])(p,s,i,!1,null,"20a86f62",null);e["a"]=u.exports},c85b:function(t,e,a){},d220:function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-dialog",{attrs:{title:"编辑GPU",visible:t.visible_sync,width:"800px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible_sync=e},close:t.cancel}},[e("el-form",{ref:"gpu_form",staticClass:"demo-ruleForm",attrs:{model:t.form_data,"label-width":"170px","label-position":"left","label-suffix":":"}},[e("el-form-item",{attrs:{label:"物理机ID",prop:"card_name"}},[e("span",[t._v(t._s(t.oper_info.host_id))])]),e("el-form-item",{attrs:{label:"GPU",prop:"card_name"}},[e("span",[t._v(t._s(t.oper_info.card_name))])]),e("el-form-item",{attrs:{label:"PCIe号",prop:"pci_address"}},[e("span",[t._v(t._s(t.oper_info.pci_address))])]),e("el-form-item",{attrs:{label:"Slot",prop:"slot"}},[e("span",[t._v(t._s(t.oper_info.slot))])]),e("el-form-item",{attrs:{label:"SN号",prop:"sn",rules:[{required:!0,message:"请输入SN号",trigger:"blur"}]}},[e("el-input",{attrs:{type:"textarea",autosize:"",resize:"none"},model:{value:t.form_data.sn,callback:function(e){t.$set(t.form_data,"sn",e)},expression:"form_data.sn"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")]),e("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)},i=[],o=a("9ab4"),r=a("1b40"),n=a("8693");let l=class extends r["e"]{constructor(){super(...arguments),this.form_data={sn:this.oper_info.sn?this.oper_info.sn:""}}watch_info(t){this.form_data.sn=t.sn?t.sn:""}async confirm(){const t=this.$refs.gpu_form;t.validate(async t=>{if(t){const t=await n["a"].post_edit_gpu({host_id:this.oper_info.host_id,pci_address:this.oper_info.pci_address,slot:this.oper_info.slot,sn:this.form_data.sn});"Success"===t.code&&(this.$message.success(t.message),this.visible_sync=!1)}})}cancel(){const t=this.$refs.gpu_form;t.resetFields(),this.visible_sync=!1}};Object(o["a"])([Object(r["d"])("visible")],l.prototype,"visible_sync",void 0),Object(o["a"])([Object(r["c"])({default:()=>{}})],l.prototype,"oper_info",void 0),Object(o["a"])([Object(r["f"])("oper_info",{immediate:!0})],l.prototype,"watch_info",null),l=Object(o["a"])([Object(r["a"])({})],l);var c=l,p=c,d=a("2877"),u=Object(d["a"])(p,s,i,!1,null,"76315fb2",null);e["a"]=u.exports},d866:function(t,e,a){"use strict";var s=a("23e7"),i=a("c65b"),o=a("2266"),r=a("59ed"),n=a("825a"),l=a("46c4"),c=a("2a62"),p=a("f99f"),d=p("every",TypeError);s({target:"Iterator",proto:!0,real:!0,forced:d},{every:function(t){n(this);try{r(t)}catch(s){c(this,"throw",s)}if(d)return i(d,this,t);var e=l(this),a=0;return!o(e,(function(e,s){if(!t(e,a++))return s()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},e8c0:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("cf88");function i(t,e,a){a.preventDefault(),document.addEventListener("contextmenu",t=>{const e=t.target;if(e.closest(".el-table")){let e=document.querySelector("#menu");if(e){e.style.display="block";let a=e.offsetHeight,i=e.offsetWidth;console.log("menuHeight",a);let o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=t.clientX,l=t.clientY,c=n,p=l;r<n+i&&(c=n-i),o<l+a&&(p=o-a),e.style.left=c-250+"px",e.style.top=p-50+"px",e.style.display="block",e.style.zIndex="1000",document.addEventListener("click",s["a"])}}}),document.addEventListener("contextmenu",s["a"])}}}]);
//# sourceMappingURL=chunk-78773344.1763535500878.js.map