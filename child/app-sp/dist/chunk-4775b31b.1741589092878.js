(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-4775b31b"],{"0692":function(e,t,i){},"1b7c":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-tooltip",{attrs:{content:e.content,placement:e.placement,effect:e.effect,"popper-class":"tooltip-class"},scopedSlots:e._u([{key:"content",fn:function(){return[e._t("content")]},proxy:!0}],null,!0)},[i("el-button",{attrs:{type:"text"}},[i("svg-icon",{attrs:{icon:"info",viewBox:"0 0 18 18"}})],1)],1)},s=[],n=i("bee2"),_=i("d4ec"),r=i("262e"),c=i("2caf"),o=i("9ab4"),d=i("1b40"),l=i("3673"),u=function(e){Object(r["a"])(i,e);var t=Object(c["a"])(i);function i(){return Object(_["a"])(this,i),t.apply(this,arguments)}return Object(n["a"])(i)}(d["e"]);Object(o["a"])([Object(d["c"])({default:""})],u.prototype,"content",void 0),Object(o["a"])([Object(d["c"])({default:"right"})],u.prototype,"placement",void 0),Object(o["a"])([Object(d["c"])({default:"light"})],u.prototype,"effect",void 0),u=Object(o["a"])([Object(d["a"])({components:{svgIcon:l["a"]}})],u);var f=u,m=f,p=(i("b4f2"),i("2877")),b=Object(p["a"])(m,a,s,!1,null,null,null);t["a"]=b.exports},"4d0a":function(e,t,i){"use strict";i("4d78")},"4d78":function(e,t,i){},6848:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"root"},[i("back-header",{attrs:{title:"创建云盘",back_url:"/disk"}}),i("div",{staticClass:"main_box"},[i("div",{staticClass:"form_box"},[i("el-form",{ref:"form",staticClass:"demo-dynamic",attrs:{model:e.form_data,"label-width":"120px"}},[i("el-card",[i("el-form-item",{attrs:{prop:"customer_id",label:"客户ID",rules:[{required:!0,trigger:"blur",validator:e.validate_customer}]}},[i("el-input",{model:{value:e.form_data.customer_id,callback:function(t){e.$set(e.form_data,"customer_id",t)},expression:"form_data.customer_id"}})],1),i("el-form-item",{attrs:{prop:"customer_name",label:"客户名称"}},[i("div",[e._v(e._s(e.form_data.customer_name))])]),i("el-form-item",{attrs:{prop:"is_bill",label:"是否计费"}},[i("el-switch",{staticClass:"m-right10",attrs:{disabled:!e.form_data.customer_name,"active-value":"1","inactive-value":"0"},on:{change:e.changeBillMode},model:{value:e.form_data.is_bill,callback:function(t){e.$set(e.form_data,"is_bill",t)},expression:"form_data.is_bill"}}),i("mark-tip",{attrs:{content:"未计费的云盘无法挂载至计费的实例上"}})],1)],1),i("el-card",[i("el-form-item",{attrs:{prop:"isMounted",label:"是否挂载"}},[[i("el-button",{attrs:{type:"1"===e.form_data.isMounted?"primary":"default",disabled:!e.form_data.customer_name},on:{click:function(t){return e.mount("1")}}},[e._v("挂载到实例")]),i("el-button",{attrs:{type:"1"===e.form_data.isMounted?"default":"primary",disabled:!e.form_data.customer_name},on:{click:function(t){return e.mount("0")}}},[e._v("暂不挂载")])]],2)],1),i("el-card",[i("div",{staticClass:"card_inline"},[i("el-form-item",{attrs:{prop:"area",label:"1"===e.form_data.isMounted?"ECS实例":"地域及可用区"}},[i("Area",{attrs:{list:e.area_list,area:e.form_data.area},on:{get_area_id:e.get_area_id}})],1),i("el-form-item",{attrs:{prop:"az",label:""}},[i("el-select",{attrs:{placeholder:"请选择可用区"},model:{value:e.form_data.az,callback:function(t){e.$set(e.form_data,"az",t)},expression:"form_data.az"}},e._l(e.az_list,(function(e){return i("el-option",{key:e.az_id,attrs:{label:e.az_name,value:e.az_id}})})),1)],1),"1"===e.form_data.isMounted?i("el-form-item",{attrs:{prop:"ecs_id",label:""}},[i("el-select",{attrs:{placeholder:"请选择或输入实例名称（实例ID)",filterable:"","filter-method":e.get_instance_list},on:{"visible-change":e.change_ecs},model:{value:e.form_data.ecs_id,callback:function(t){e.$set(e.form_data,"ecs_id",t)},expression:"form_data.ecs_id"}},e._l(e.ECS_instance_list,(function(e){return i("el-option",{key:e.ecs_id,attrs:{label:e.ecs_id+" / "+e.ecs_name,value:e.ecs_id}})})),1),e.form_data.ecs_id||"1"!==e.form_data.isMounted?e._e():i("div",{staticClass:"ecs-error"},[e._v("请选择或输入实例")])],1):e._e()],1),e.form_data.ecs_id&&"1"===e.form_data.isMounted?[i("el-form-item",{attrs:{prop:"instance_detail",label:"实例详情"}},[[i("div",{staticClass:"area"},[e._v("地域及可用区："+e._s(e.config_info.regionAz.value.split("-")[1]+" "+e.config_info.regionAz.value.split("-")[2]))]),i("div",{staticClass:"area"},[e._v("实例规格: "+e._s(e.ecs_specifications))])],i("div",{staticClass:"prompt_message"},[e._v("提示：云盘挂载到实例后，您需要登录实例对挂载的云盘进行“分区格式化和挂载新分区”的操作后即可正式使用云盘")])],2)]:e._e()],2),"1"===e.form_data.isMounted?[i("el-card",[i("el-form-item",{attrs:{prop:"del_set",label:"删除设置"}},[i("el-checkbox",{model:{value:e.form_data.del_set,callback:function(t){e.$set(e.form_data,"del_set",t)},expression:"form_data.del_set"}},[e._v("云盘随实例删除")])],1)],1)]:e._e(),e._l(e.form_data.disk_list,(function(t,a){return i("el-card",{key:a},[i("el-form-item",{attrs:{prop:"disk_name",label:"云盘名称"}},[i("div",{staticClass:"disk-name"},[i("el-input",{attrs:{minlength:"2",maxlength:"40","show-word-limit":""},model:{value:t.disk_name,callback:function(i){e.$set(t,"disk_name",i)},expression:"inn.disk_name"}}),1===t.disk_name.trim().length?i("span",{staticClass:"name-error"},[e._v("云盘名称长度不能为1")]):t.disk_name.trim().length>1&&!/^[A-Za-z][\u4e00-\u9fa5_a-zA-Z0-9-_:()\u002E]{1,39}$/.test(t.disk_name)?i("span",{staticClass:"name-error"},[e._v("云盘名称不符合规范")]):e._e()],1),i("div",{staticClass:"remark"},[e._v("2-40个字符，可包含大小写字母、中文、数字、点号(.)、下划线(_)、半角冒号(:)、连字符(-)、英文括号(英文输入法下的括号)字符，以大小写字母开头")])]),i("div",{staticClass:"card_inline"},[i("el-form-item",{attrs:{prop:"ecs_goods_id",label:"类型/容量"}},[i("el-select",{on:{change:function(t){return e.change_type(t,a)}},model:{value:t.ecs_goods_id,callback:function(i){e.$set(t,"ecs_goods_id",i)},expression:"inn.ecs_goods_id"}},e._l(e.disk_type_list,(function(e){return i("el-option",{key:e.ecs_goods_id,attrs:{label:e.disk_value,value:e.ecs_goods_id}})})),1),i("div",{staticClass:"prompt_message"},[e._v("当前区域已购买 "),i("span",{staticClass:"num_message"},[e._v(e._s(e.data_disk_info&&e.data_disk_info[t.ecs_goods_id]?e.data_disk_info[t.ecs_goods_id].disk_feature:""))]),i("span",{staticClass:"num_message"},[e._v(" "+e._s(t?t.disk_size*t.amount:0))]),e._v(" "+e._s(e.data_disk_info&&e.data_disk_info[t.ecs_goods_id]?e.data_disk_info[t.ecs_goods_id].disk_unit:"GB")+"，还可以购买的容量额度为： "),i("span",{staticClass:"num_message"},[e._v(e._s(t?e.getResetInfo(t.ecs_goods_id,t.disk_size,t.amount).capacity:0))]),e._v(" "+e._s(e.data_disk_info&&e.data_disk_info[t.ecs_goods_id]?e.data_disk_info[t.ecs_goods_id].disk_unit:"GB")+" ")])],1),i("el-form-item",{attrs:{prop:"disk_size",label:""}},[i("input-number",{attrs:{disable:!e.form_data.customer_name,info:e.data_disk_info?e.size_info:null},on:{func:e.change_capacity}}),e._v("  "+e._s(e.data_disk_info&&e.data_disk_info[t.ecs_goods_id]?e.data_disk_info[t.ecs_goods_id].disk_unit:"GB")+" ")],1)],1),i("el-form-item",{attrs:{prop:"amount",label:"数量"}},[i("el-input-number",{attrs:{step:1,min:1,disabled:!e.form_data.customer_name,max:e.getEveryMaxNum(t)},on:{blur:function(i){return e.changeNum(a,t.amount)},change:function(i){return e.changeNum(a,t.amount)}},model:{value:t.amount,callback:function(i){e.$set(t,"amount",i)},expression:"inn.amount"}}),e._v(" 块 "),"1"===e.form_data.isMounted?i("div",{staticClass:"prompt_message"},[e._v("还可以挂载  "),i("span",{staticClass:"num_message"},[e._v(e._s(t?e.getEveryMaxNum(t)-t.amount:0))]),e._v("  块盘， 已挂载 "),i("span",{staticClass:"num_message"},[e._v(e._s(e.mounted_disk))]),e._v(" 块盘")]):e._e()],1)],1)})),"1"===e.form_data.is_bill?i("el-card",{staticClass:"m-bottom10"},[i("el-form-item",{attrs:{prop:"fee",label:"计费方式"}},[[i("el-button",{attrs:{type:"primary"}},[e._v("按需计费")])]],2)],1):e._e()],2)],1),i("div",{staticClass:"detail_box fixed-top"},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("当前配置信息")])]),e._l(e.config_info,(function(t,a){return i("div",{key:a,staticClass:"config-info"},[i("div",[e._v(e._s(t.label))]),"ecs_name"===a?i("div",{class:["--"===t.value?"":"clickble"],on:{click:function(i){return e.goToDetail(t.value)}}},[e._v(e._s(t.value))]):i("div",[e._v(e._s(t.value))])])}))],2)],1),i("div",{staticClass:"button_box"},[i("el-card",{staticClass:"box-card"},["1"===e.form_data.is_bill?i("div",{staticClass:"flex-between m-bottom20"},[i("div",[e._v("总价：")]),i("div",{staticClass:"num_message price"},[e._v(e._s(e.total_price))])]):e._e(),i("el-button",{attrs:{type:"primary",disabled:!e.form_data.customer_name||e.curTotal>e.showResetVolume[e.form_data.disk_list[0].disk_feature]},on:{click:e.create}},[e._v("创建")])],1)],1)]),e.detail_visible?[i("Detail",{attrs:{visible:e.detail_visible,detail_id:e.form_data.ecs_id},on:{"close-detail":e.closeDetail}})]:e._e(),e.visible?[i("confirm-box",{attrs:{visible:e.visible},on:{"update:visible":function(t){e.visible=t},"fn-create":e.createConfirm}})]:e._e()],2)},s=[],n=i("ade3"),_=i("5530"),r=i("1da1"),c=i("d4ec"),o=i("bee2"),d=i("262e"),l=i("2caf"),u=(i("96cf"),i("d9e2"),i("ac1f"),i("1276"),i("4de4"),i("d3b7"),i("a15b"),i("a9e3"),i("b64b"),i("99af"),i("b680"),i("caad"),i("d81d"),i("b0c0"),i("159b"),i("498a"),i("00b4"),i("9ab4")),f=i("1b40"),m=i("ed46"),p=i("38a7"),b=i("9074"),h=i("e527"),v=i("1c98"),k=i("d772"),g=i("76ff"),O=i("3673"),y=i("8bcb"),j=i("8ce4"),w=i("1b7c"),x=i("c550"),C=i("4875"),z=function(e){Object(d["a"])(i,e);var t=Object(l["a"])(i);function i(){var e;return Object(c["a"])(this,i),e=t.apply(this,arguments),e.form_data={customer_id:"",customer_name:"",isMounted:"1",is_bill:"1",area:"",az:"",ecs_id:"",del_set:!0,disk_list:[{disk_name:"",ecs_goods_id:"",disk_size:0,amount:1,iops:2824,throughput:96,disk_feature:"",disk_max:1}]},e.data_disk_info=null,e.ecs_specifications="",e.az_list=[],e.ECS_instance_list=[],e.area_list=[],e.disk_type_list=[],e.detail_visible=!1,e.customerID="",e.billing_info={},e.visible=!1,e.total_price="￥0.00/天",e.price_unit="￥",e.showResetVolume={},e.ecs_mounted_disk=0,e.mounted_disk=0,e.size_info={},e.config_info={regionAz:{label:"地域及可用区：",value:"--"},ecs_name:{label:"挂载实例名称：",value:"--"},disk:{label:"云盘规格：",value:"--"},amount:{label:"购买数量：",value:"1"},fee:{label:"计费方式",value:"按需计费"}},e.validate_customer=function(e,t,i){return t?t.length>0&&t.length<=6?i(new Error("请输入正确的客户ID")):i():i(new Error("请输入客户ID"))},e}return Object(o["a"])(i,[{key:"mounted",value:function(){var e=this.$refs.form;e.validate((function(e){}))}},{key:"watch_customer_id",value:function(e){var t=this,i=this.$refs.form;i.validate((function(e){e&&t.get_customer_name()}))}},{key:"watch_ecs_id",value:function(e){e&&this.get_mounted_num()}},{key:"watch_az",value:function(e){var t=this.config_info.regionAz.value.split("-"),i=this.az_list.filter((function(t){return t.az_id===e}));t[2]=i[0].az_name,this.config_info.regionAz.value=t.join("-"),this.get_instance_list(),this.get_disk_info()}},{key:"curTotal",get:function(){return"1"===this.form_data.is_bill&&this.getDiskFee(),this.form_data.disk_list[0].disk_size*this.form_data.disk_list[0].amount}},{key:"get_customer_name",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].get_customer_name({customer_id:this.form_data.customer_id});case 2:t=e.sent,"Success"==t.code&&(this.form_data=Object(_["a"])(Object(_["a"])({},this.form_data),{},{customer_name:t.data.customer_name}),this.mount(this.form_data.isMounted),this.customerID=t.data.customer_id,this.get_area_list(),this.price_unit=t.data.area_id,this.total_price="$"===this.price_unit?"$0.00/day":"￥0.00/天");case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_area_list",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].get_region_az_list({customer_id:this.form_data.customer_id});case 2:t=e.sent,"Success"==t.code&&(this.area_list=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"change_ecs",value:function(e){!e&&this.form_data.customer_id&&this.get_instance_list()}},{key:"changeBillMode",value:function(e){this.form_data.is_bill=e,this.form_data.ecs_id="",this.get_instance_list(),this.config_info.ecs_name.value="",0===Number(e)?(this.total_price="$"===this.price_unit?"$0.00/day":"￥0.00/天",this.config_info.fee.value="不计费"):(this.getDiskFee(),this.config_info.fee.value="按需计费")}},{key:"getDiskFee",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,a,s,n,_,r,c,o,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.form_data.disk_list[0],0!==Object.keys(this.billing_info).length&&t.disk_feature){e.next=3;break}return e.abrupt("return");case 3:return i=["ebs_goods_id","storage_space","iops","ebs_number","handling_capacity","disk_feature"],a=["ecs_goods_id","disk_size","iops","amount","throughput","disk_feature"],s=Object(j["b"])(this.form_data.disk_list,i,a),n=Object(j["a"])(this.billing_info),e.next=9,v["a"].get_price({az_id:this.form_data.az,customer_id:this.form_data.customer_id,number:1,is_gpu:0,billing_method:"0",disk_info:{billing_info:n,data_disk:s}});case 9:_=e.sent,"Success"===_.code&&(r=_.data,c=r.price_symbol,o=r.price_unit,d=r.total_price,this.total_price="".concat(c).concat(Number(d).toFixed(2),"/").concat(o));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_instance_list",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,a=this,s=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:"",e.next=3,h["a"].get_instance_list({page_index:1,page_size:20,keyword:t,customer_id:this.form_data.customer_id,az_id:this.form_data.az,billing_method:"all"});case 3:i=e.sent,"Success"==i.code&&(this.ECS_instance_list=i.data.ecs_list.filter((function(e){return["running","shutdown"].includes(e.status)&&!e.is_gpu&&e.is_charge===Number(a.form_data.is_bill)&&!e.no_charge_for_shutdown})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_disk_info",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v["a"].get_disk_type({customer_id:this.form_data.customer_id,az_id:this.form_data.az,billing_method:"0"});case 2:t=e.sent,"Success"==t.code&&(this.billing_info=t.data.billing_info,this.disk_type_list=t.data.data_disk,i=[],this.disk_type_list.map((function(e){i.push(e.disk_feature),a.data_disk_info=Object.assign({},a.data_disk_info,Object(n["a"])({},e.ecs_goods_id,e))})),this.get_disk_limit(i));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_disk_limit",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var i,a,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v["a"].get_disk_limit({customer_id:this.form_data.customer_id,az_id:this.form_data.az,feature:t});case 2:if(i=e.sent,"Success"===i.code){for(a in this.showResetVolume={},i.data)this.showResetVolume[a]=i.data[a].rest_volume;this.$nextTick((function(){var e=s.disk_type_list.filter((function(e){return"SSD"===e.disk_feature}));0===e.length&&(e=[s.disk_type_list[0]]),s.form_data=Object(_["a"])(Object(_["a"])({},s.form_data),{},{disk_list:s.form_data.disk_list.map((function(t,i){return t.ecs_goods_id=e[0].ecs_goods_id,t.disk_feature=e[0].disk_feature,t.amount=1,s.change_type(t.ecs_goods_id,i),s.getEveryMaxNum(t),s.config_info.amount.value=s.form_data.disk_list[0].amount,t}))})}))}case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getEveryMaxNum",value:function(e){if(!this.form_data.customer_id)return 16;var t=e.disk_size*e.amount,i=Math.floor(Math.max(this.showResetVolume[e.disk_feature]-t,0)/e.disk_size),a=i+e.amount>16-this.mounted_disk?16-this.mounted_disk:i+e.amount;return"1"===this.form_data.isMounted?a:i+e.amount}},{key:"getResetInfo",value:function(e,t,i){var a=0;if(this.data_disk_info&&this.data_disk_info[e]&&this.showResetVolume[this.data_disk_info[e].disk_feature]>0){var s=this.showResetVolume[this.data_disk_info[e].disk_feature]?this.showResetVolume[this.data_disk_info[e].disk_feature]-t*i:0;a=s,this.config_info.disk.value="".concat(this.data_disk_info[e].disk_feature," | ").concat(t*i,"GB")}return{capacity:a}}},{key:"clearEcs",value:function(){this.form_data.ecs_id="",this.mounted_disk=0,this.config_info.ecs_name.value="--",this.ecs_specifications="",this.get_instance_list()}},{key:"get_mounted_num",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,a,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k["a"].get_detail({ecs_id:this.form_data.ecs_id});case 2:t=e.sent,"Success"==t.code&&(i=t.data,a=i.disk,s=i.ecs_rule,n=i.ecs_name,this.mounted_disk=a.data_disk_conf?a.data_disk_conf.length:0,this.config_info.ecs_name.value=n,this.ecs_specifications=s.name+"  "+s.cpu_num+s.cpu_unit+s.ram+s.ram_unit,16===this.mounted_disk&&(this.$message.warning("该实例云盘已挂满！"),this.clearEcs()),this.resetDiskMounted());case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"resetDiskMounted",value:function(){this.form_data=Object(_["a"])(Object(_["a"])({},this.form_data),{},{disk_list:this.form_data.disk_list.map((function(e){return e.amount=1,e}))}),this.config_info.amount.value=this.form_data.disk_list[0].amount}},{key:"mount",value:function(e){this.resetDiskMounted(),this.clearEcs(),this.form_data=Object(_["a"])(Object(_["a"])({},this.form_data),{},{isMounted:e})}},{key:"get_area_id",value:function(e){var t,i,a=this,s=this.area_list;s.forEach((function(s){s.region_list&&s.region_list.forEach((function(n){n.region_id===e&&(i=n.region_name,t=s.region_group_name,a.az_list=n.az_list)}))})),this.form_data=Object(_["a"])(Object(_["a"])({},this.form_data),{},{area:e,az:this.az_list[0].az_id}),this.config_info.regionAz.value=t+"-"+i+"-"+this.az_list[0].az_name,this.clearEcs()}},{key:"changeNum",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,i){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$nextTick((function(){i||a.$set(a.form_data.disk_list[t],"amount",1)}));case 2:this.config_info.amount.value=this.form_data.disk_list[0].amount,this.getDiskFee();case 4:case"end":return e.stop()}}),e,this)})));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"goToDetail",value:function(e){"--"!==e&&(this.detail_visible=!0)}},{key:"closeDetail",value:function(){this.detail_visible=!1}},{key:"get_step_max",value:function(e){return this.data_disk_info?{step:this.data_disk_info[e].disk_step,max:this.form_data.disk_list[0].disk_max,min:this.data_disk_info[e].disk_min}:{step:1,max:1,min:1}}},{key:"change_type",value:function(e,t){this.form_data.disk_list[t].disk_feature=this.data_disk_info[e].disk_feature;var i=this.form_data.disk_list[t].disk_feature;this.form_data.disk_list[t].iops=Object(y["a"])(this.data_disk_info[e]).iops,this.form_data.disk_list[t].throughput=Object(y["a"])(this.data_disk_info[e]).throughput,this.form_data.disk_list[t].disk_size=this.data_disk_info[e].disk_min,this.form_data.disk_list[t].disk_max=this.showResetVolume[i]?Math.min(this.showResetVolume[i],this.data_disk_info[e].disk_max):this.data_disk_info[e].disk_max,this.get_step_max(this.form_data.disk_list[t].ecs_goods_id),this.size_info=Object(_["a"])(Object(_["a"])({},this.data_disk_info[e]),{},{disk_max:this.get_step_max(e).max,size:this.data_disk_info[e].disk_min}),this.getDiskFee()}},{key:"change_capacity",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.form_data.disk_list.map((function(e){return e.ecs_goods_id===t.ecs_goods_id&&(e.disk_size=t.size,e.iops=Object(y["a"])(t,t.size).iops,e.throughput=Object(y["a"])(t,t.size).throughput,e.disk_size*e.amount>i.showResetVolume[e.disk_feature]&&(e.amount=1),i.config_info.amount.value=i.form_data.disk_list[0].amount),e})),"1"===this.form_data.is_bill&&this.getDiskFee();case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createConfirm",value:function(){var e=this,t=this.$refs.form,i=["ebs_goods_id","disk_size","storage_space","disk_iops","iops","amount","band_mbps","handling_capacity","disk_feature","disk_name"],a=["ecs_goods_id","disk_size","disk_size","iops","iops","amount","throughput","throughput","disk_feature","disk_name"],s=Object(j["b"])(this.form_data.disk_list,i,a),n=Object(j["a"])(this.billing_info,!0);t.validate(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(i){var a,_,r,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!i){t.next=9;break}return a=e.form_data,_=a.ecs_id,r=a.del_set,c=a.az,t.next=4,v["a"].create({customer_id:e.customerID,ecs_id:_,is_follow_delete:r?"1":"0",az_id:c,disk_list:s,billing_info:"1"===e.form_data.is_bill?n:{}});case 4:o=t.sent,"Success"===o.code&&e.$message.success("云盘创建任务下发成功"),e.$router.push("/disk"),t.next=10;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"create",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.form_data.ecs_id||"1"!==this.form_data.isMounted){e.next=2;break}return e.abrupt("return");case 2:if(t=/^[A-Za-z][\u4e00-\u9fa5_a-zA-Z0-9-_:()\u002E]{1,39}$/,!this.form_data.disk_list.some((function(e){return 1===e.disk_name.trim().length||e.disk_name.trim().length>1&&!t.test(e.disk_name)}))){e.next=5;break}return e.abrupt("return");case 5:this.form_data.disk_list.map((function(e){return e.disk_name=0===e.disk_name.trim().length?"":e.disk_name,e})),this.visible=!0;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),i}(f["e"]);Object(u["a"])([Object(f["f"])("form_data.customer_id")],z.prototype,"watch_customer_id",null),Object(u["a"])([Object(f["f"])("form_data.ecs_id")],z.prototype,"watch_ecs_id",null),Object(u["a"])([Object(f["f"])("form_data.az")],z.prototype,"watch_az",null),z=Object(u["a"])([Object(f["a"])({components:{backHeader:m["a"],Area:p["a"],Detail:g["a"],svgIcon:O["a"],MarkTip:w["a"],ConfirmBox:x["a"],InputNumber:C["a"]}})],z);var S=z,R=S,T=(i("4d0a"),i("e38e"),i("2877")),E=Object(T["a"])(R,a,s,!1,null,"65be626a",null);t["default"]=E.exports},"76ff":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"配置详情",visible:e.visible,width:"60%","destroy-on-close":!0},on:{"update:visible":function(t){e.visible=t},close:e.back}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:10}},[i("span",{staticClass:"label"},[e._v("云服务器ID:")]),i("span",[e._v(e._s(e.detail&&e.detail.ecs_id))])]),i("el-col",{attrs:{span:10}},[i("span",{staticClass:"label"},[e._v("地域:")]),i("span",[e._v(e._s(e.detail&&e.detail.region_name))])])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{staticClass:"name-row",attrs:{span:10}},[i("span",{staticClass:"label"},[e._v("云服务器名称:")]),i("span",[i("pre",[e._v(e._s(e.detail&&e.detail.ecs_name))])])]),i("el-col",{attrs:{span:10}},[i("span",{staticClass:"label"},[e._v("可用区:")]),i("span",[e._v(e._s(e.detail&&e.detail.az_name))])])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:10}},[i("span",{staticClass:"label"},[e._v("状态:")]),i("span",[e._v(e._s(e.detail&&e.detail.status_display))])])],1),i("div",{staticClass:"title"},[e._v("计算规格")]),i("el-row",{attrs:{gutter:20}},[e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name?i("el-col",{attrs:{span:20}},[i("span",{staticClass:"label"},[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name)+":")]),i("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.name))]),e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num?i("span",[e._v("   "+e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num)+"vCPU "),i("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.ram)+"GiB")]),e.detail&&e.detail.is_gpu?i("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.gpu)+"*"+e._s(e.detail&&e.detail.card_name))]):e._e()]):e._e()]):e._e()],1),i("div",{staticClass:"title"},[e._v("操作系统")]),i("div",{staticClass:"content"},[e._v(e._s(e.detail&&e.detail.os_info&&e.detail.os_info.name))]),i("div",{staticClass:"title"},[e._v("存储")]),i("div",{staticClass:"content"},[i("span",{staticClass:"label"},[e._v("系统盘：")]),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf?i("span",{staticClass:"data-disk"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.disk_name))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size?i("span",{staticClass:"data-disk-unit"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size)+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.unit))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id?i("span",{staticClass:"id_name"},[e._v("("+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id)+" / "+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.name)+")")]):e._e()]),i("div",{staticClass:"content data_disk"},[i("span",{staticClass:"label"},[e._v("数据盘：")]),e.detail&&e.detail.disk&&e.detail.disk.data_disk_conf?i("div",{staticClass:"disk_content"},e._l(e.detail.disk.data_disk_conf,(function(t){return i("div",{key:t.id},[i("span",{staticClass:"data-disk"},[e._v(e._s(t.disk_name))]),i("span",{staticClass:"data-disk-unit"},[e._v(e._s(t.size)+e._s(t.unit))]),i("span",{staticClass:"id_name"},[e._v("("+e._s(t.id)+" / "+e._s(t.name)+")")]),i("span",[e._v(e._s(t.is_follow_delete?"随实例删除":"不随实例删除"))])])})),0):e._e()]),i("div",{staticClass:"title"},[e._v("网络")]),i("div",{staticClass:"content"},[i("span",{staticClass:"label"},[e._v("VPC:")]),e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id?i("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_name))]):e._e()]),i("div",{staticClass:"content"},[i("span",{staticClass:"label"},[e._v("子网:")]),e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id?i("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_name))]):e._e()]),i("div",{staticClass:"content display-flex"},[i("span",{staticClass:"label"},[e._v("私网IP：")]),e.detail&&e.detail.pipe?i("span",[e.detail.pipe.private_net?[e._v(e._s(e.detail.pipe.private_net)+" （主）")]:e._e(),i("br"),e.detail.pipe.pub_net?[e._v(" "+e._s(e.detail.pipe.pub_net)+" "),e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） ")]:e._e(),i("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(t){return i("span",{key:t},[e._v(" "+e._s(t)+" "),e.detail.pipe.eip_info[t]&&e.detail.pipe.eip_info[t].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[t].conf_name)+"） ")]:e._e(),i("br")],2)}))],2):e._e()]),i("div",{staticClass:"content display-flex"},[i("span",{staticClass:"label"},[e._v("公网IP：")]),e.detail&&e.detail.pipe?i("span",[e.detail.pipe.pub_net&&e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip?[e._v(" "+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip)+" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） "),i("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(t){return i("span",{key:t},[e.detail.pipe.eip_info[t]&&e.detail.pipe.eip_info[t].conf_name?[e._v(" "+e._s(t.eip_ip)+" （"+e._s(e.detail.pipe.eip_info[t].conf_name)+"） ")]:e._e(),i("br")],2)}))],2):e._e()]),i("div",{staticClass:"divider"}),i("div",{staticClass:"content"},[i("span",{staticClass:"label"},[e._v("所属机房:")]),i("span",[e._v(e._s(e.detail&&e.detail.engine_room))])]),i("div",{staticClass:"content"},[i("span",{staticClass:"label"},[e._v("所属节点:")]),i("span",[e._v(e._s(e.detail&&e.detail.host_name))])]),i("div",{staticClass:"content"},[i("span",{staticClass:"label"},[e._v("所属物理机:")]),e.detail&&e.detail.host_id?i("span",[e._v(e._s(e.detail&&e.detail.host_id)+"   "),e.detail&&e.detail.host_status?i("span",[e._v("( "+e._s(e.detail&&e.detail.host_status)+" )")]):e._e()]):e._e()]),i("div",{staticClass:"content"},[i("span",{staticClass:"label"},[e._v("处理器型号:")]),i("span",[e._v(e._s(e.detail&&e.detail.cpu_type))])]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},s=[],n=i("1da1"),_=i("d4ec"),r=i("bee2"),c=i("262e"),o=i("2caf"),d=(i("96cf"),i("9ab4")),l=i("1b40"),u=i("d772"),f=function(e){Object(c["a"])(i,e);var t=Object(o["a"])(i);function i(){var e;return Object(_["a"])(this,i),e=t.apply(this,arguments),e.detail=null,e.loading=!1,e}return Object(r["a"])(i,[{key:"getDetail",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["a"].get_detail({ecs_id:this.detail_id});case 2:t=e.sent,"Success"===t.code?(this.loading=!1,this.detail=t.data):this.loading=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(){}},{key:"created",value:function(){this.getDetail()}}]),i}(l["e"]);Object(d["a"])([Object(l["c"])(Boolean)],f.prototype,"visible",void 0),Object(d["a"])([Object(l["c"])(String)],f.prototype,"detail_id",void 0),Object(d["a"])([Object(l["b"])("close-detail")],f.prototype,"back",null),f=Object(d["a"])([l["a"]],f);var m=f,p=m,b=(i("d8a7"),i("2877")),h=Object(b["a"])(p,a,s,!1,null,"33b12e64",null);t["a"]=h.exports},a15b:function(e,t,i){"use strict";var a=i("23e7"),s=i("e330"),n=i("44ad"),_=i("fc6a"),r=i("a640"),c=s([].join),o=n!=Object,d=r("join",",");a({target:"Array",proto:!0,forced:o||!d},{join:function(e){return c(_(this),void 0===e?",":e)}})},b4f2:function(e,t,i){"use strict";i("0692")},d772:function(e,t,i){"use strict";var a=i("81a9"),s=i("bff7");t["a"]={get_operate_record_list:function(e){return Object(a["a"])(Object(s["b"])("GET","/ecs/history_record/",e))},get_detail:function(e){return Object(a["a"])(Object(s["b"])("GET","/ecs/get_ecs_detail/",e))}}},d8a7:function(e,t,i){"use strict";i("fceb")},e38e:function(e,t,i){"use strict";i("faed")},e527:function(e,t,i){"use strict";var a=i("81a9"),s=i("bff7"),n=i("4328"),_=i.n(n);t["a"]={get_instance_list:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/ecs_list/",e))},operate_instance:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/operate/",e))},delete_instance:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/delete/",e))},recover_instance:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/recover/",e))},destroy_instance:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/destroy/",e))},get_status_list:function(){return Object(a["a"])(Object(s["b"])("GET","/ecs/ecs_status_list/"))},get_family_data:function(){return Object(a["a"])(Object(s["b"])("GET","/ecs/get_family_data/"))},reset_password:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/ecs_reset_password/",e))},update_spec:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/ecs_change_configure/",e))},update_system:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/ecs_change_system/",e))},get_usage_ip:function(e){return Object(a["a"])(Object(s["b"])("GET","/ecs/get_deleted_ecs_ip/",e))},get_vnc_url:function(e){return Object(a["a"])(Object(s["b"])("GET","/ecs/vnc_info/",e))},start_charge:function(e){return Object(a["a"])(Object(s["b"])("POST","/resource/start_charge/",e))},change_config_price:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/change_config_price/",e))},change_system_price:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/change_system_price/",e))},each_resource_price:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/each_resource_price/",e))},add_common_mirror:function(e){return Object(a["a"])(Object(s["b"])("POST","/img/create_pub_image_by_ecs/",e))},set_net:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/ecs_set_base_nic/",e))},get_default_dns:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/az_default_dns/",e))},mount_gpu_card:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/instance_gpu_card/",e))},update_gpu_status:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/update_gpu_status/",e))},export_list:function(e){return Object(a["a"])({method:"GET",url:"/ecs_business/v1/ecs/ecs_list_download/",params:e,paramsSerializer:function(e){return _.a.stringify(e)},responseType:"blob"})},get_tag_list:function(){return Object(a["a"])(Object(s["b"])("GET","/ecs/get_tag_list/"))},get_rescue_image_list:function(e){return Object(a["a"])(Object(s["b"])("GET","/ecs/get_rescue_image_list/",e))},enter_rescue:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/enter_rescue/",e))},exit_rescue:function(e){return Object(a["a"])(Object(s["b"])("POST","/ecs/exit_rescue/",e))}}},faed:function(e,t,i){},fceb:function(e,t,i){}}]);
//# sourceMappingURL=chunk-4775b31b.1741589092878.js.map