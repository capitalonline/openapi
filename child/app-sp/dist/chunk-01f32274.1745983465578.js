(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-01f32274"],{"0a845":function(t,e,s){"use strict";s("f67f")},1148:function(t,e,s){"use strict";var a=s("da84"),r=s("5926"),i=s("577e"),n=s("1d80"),o=a.RangeError;t.exports=function(t){var e=i(n(this)),s="",a=r(t);if(a<0||a==1/0)throw o("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(s+=e);return s}},"29f3":function(t,e,s){},"408a":function(t,e,s){var a=s("e330");t.exports=a(1..valueOf)},"4dba":function(t,e,s){},"8eb9":function(t,e,s){"use strict";s("4dba")},9064:function(t,e,s){"use strict";var a=s("81a9"),r=s("bff7");e["a"]={get_task_list:function(t){return Object(a["a"])(Object(r["b"])("POST","/event/get_task_list/",t))},reTry:function(t){return Object(a["a"])(Object(r["b"])("POST","/task/task_retry/",t))},get_customer_list:function(t){return Object(a["a"])(Object(r["b"])("GET","/event/get_customer_list/",t))}}},aaea:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("back-header",{attrs:{title:t.event_name,back_url:"/event"}}),s("div",{staticClass:"content m-top20"},[s("div",{staticClass:"event-content"},[s("div",{staticClass:"event-search"},[s("el-input",{attrs:{placeholder:"请输入资源ID或资源名称查询",clearable:""},model:{value:t.cloud_id,callback:function(e){t.cloud_id=e},expression:"cloud_id"}}),s("el-button",{attrs:{type:"primary"},on:{click:t.getTaskList}},[t._v("搜索")])],1),s("div",{staticClass:"event-detail"},[s("div",[t._v("任务总数:"+t._s(t.task_num))]),s("div",{staticClass:"destroy"},[t._v("已完成任务数:"+t._s(t.finish_num))]),s("div",[t._v("完成率："+t._s(t.finished_percent))]),s("div",[t._v("成功任务数:"+t._s(t.success_num))]),s("div",{staticClass:"error"},[t._v("失败任务数:"+t._s(t.fail_num))]),s("div",{staticClass:"nonExecution"},[t._v("不执行:"+t._s(t.none_exec_num))])])]),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"event-table",attrs:{data:t.task_list,border:""},on:{"sort-change":t.FnSortChange,"filter-change":t.filterAttribute}},[s("el-table-column",{attrs:{prop:"task_id",label:"任务ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.task_id?e.row.task_id:"-"))])]}}])}),s("el-table-column",{attrs:{prop:"customer_id",lable:"客户ID","filter-multiple":!1,"column-key":"customer_id",filters:t.customer_id_list}}),s("el-table-column",{attrs:{prop:"customer_name",label:"客户名称","filter-multiple":!1,"column-key":"customer_name",filters:t.customer_name_list},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.customer_name?e.row.customer_name:"-"))])]}}])}),s("el-table-column",{attrs:{prop:"resource_name",label:"资源名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.resource_name?s("el-button",{attrs:{type:"text"},on:{click:t.toPhysical}},[t._v(t._s(e.row.resource_name))]):s("span",[t._v("-")])]}}])}),s("el-table-column",{attrs:{prop:"cloud_id",label:"资源ID"}}),s("el-table-column",{attrs:{prop:"",label:"资源配置"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.resource_name.length>0?s("div",{staticClass:"resource_name"},[s("el-popover",{attrs:{title:"",placement:"top-start",width:"200",trigger:"hover",content:t.getResourceConfig(e.row)}},[s("span",{staticClass:"isButton",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.spec_family_name))])])],1):s("div",[t._v(" - ")])]}}])}),s("el-table-column",{attrs:{prop:"task_type",label:"任务名称"}}),s("el-table-column",{attrs:{prop:"task_state",label:"任务状态","filter-multiple":!1,"column-key":"status",filters:t.status_list},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"taskStatus"},["init"===e.row.status?s("div",{staticClass:"tip-icon status-init"}):"doing"===e.row.status?s("div",{staticClass:"tip-icon status-doing"}):"success"===e.row.status?s("div",{staticClass:"tip-icon status-success"}):(e.row.status,s("div",{staticClass:"tip-icon status-failed"})),s("span",[t._v(t._s(e.row.task_state))])])]}}])}),s("el-table-column",{attrs:{prop:"detail",label:"执行结果"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.detail?s("span",[t._v(t._s(e.row.detail))]):s("span",[t._v("--")])]}}])}),s("el-table-column",{attrs:{prop:"error_type",label:"失败类型","filter-multiple":!1,"column-key":"error_type",filters:t.fail_type_list},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.error_type?e.row.error_type:"-"))])]}}])}),s("el-table-column",{attrs:{prop:"create_time",label:"创建时间",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.create_time?t.moment(e.row.create_time).format("YYYY-MM-DD HH:mm:ss"):"--"))])]}}])}),s("el-table-column",{attrs:{prop:"update_time",label:"更新时间",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.update_time?t.moment(e.row.update_time).format("YYYY-MM-DD HH:mm:ss"):"--"))])]}}])}),s("el-table-column",{attrs:{prop:"end_time",label:"完成时间",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.end_time?t.moment(e.row.end_time).format("YYYY-MM-DD HH:mm:ss"):"--"))])]}}])})],1),s("el-pagination",{attrs:{"current-page":t.current,"page-sizes":[20,50,100],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),s("div",{staticClass:"err-record"},[s("el-dialog",{attrs:{title:"错误记录",visible:t.visible,width:"40%"},on:{"update:visible":function(e){t.visible=e}}},[s("div",{staticClass:"err_record"},[t._v(t._s(t.err_record))])])],1)],1)},r=[],i=s("ade3"),n=s("1da1"),o=s("5530"),u=s("d4ec"),c=s("bee2"),l=s("262e"),_=s("2caf"),d=(s("96cf"),s("ac1f"),s("841c"),s("b0c0"),s("b680"),s("9ab4")),p=s("1b40"),f=s("c811"),m=s("9064"),v=s("1296"),h=s("ed46"),b=s("c1df"),k=s.n(b),g=function(t){Object(l["a"])(s,t);var e=Object(_["a"])(s);function s(){var t;return Object(u["a"])(this,s),t=e.apply(this,arguments),t.stateList=[{type:"",label:"全部"},{type:"doing",label:"执行中"},{type:"success",label:"成功"},{type:"failed",label:"失败"}],t.search={},t.task_num=0,t.finish_num=0,t.finished_percent="0.00%",t.fail_num=0,t.success_num=0,t.none_exec_num=0,t.err="err",t.loading=!1,t.visible=!1,t.err_record="",t.moment=k.a,t.event_name="",t.task_list=[],t.current=1,t.size=20,t.total=0,t.search_data={},t.status_list=[],t.fail_type_list=[],t.sort_prop_name="",t.sort_value="",t.filter_obj={},t.cloud_id="",t.customer_id_list=[],t.customer_name_list=[],t}return Object(c["a"])(s,[{key:"created",value:function(){this.getFilterList(),this.getTaskList(),this.getCurCustomer()}},{key:"mounted",value:function(){this.event_name=this.$route.query.name}},{key:"watch_pod",value:function(t){t&&(this.current=1,this.getTaskList())}},{key:"fn_search",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.current=1,this.search_data=Object(o["a"])(Object(o["a"])({},t),this.filter_obj),this.getTaskList()}},{key:"getFilterList",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].get_filter_list({filed_names:["status","error_type"]});case 2:if(e=t.sent,"Success"===e.code){for(s in e.data.status)this.status_list.push({text:e.data.status[s],value:s});for(a in e.data.error_type)this.fail_type_list.push({text:e.data.error_type[a],value:a})}case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getTaskList",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,s,a,r,n,o,u,c,l,_,d,p,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=this.filter_obj,a=this.$route.params.id,e={pod_id:this.$store.state.pod_id,status:s.status&&s.status.length>0?s.status[0]:"",event_id:a,page_index:this.current,page_size:this.size},Object(i["a"])(e,this.sort_prop_name,this.sort_value),Object(i["a"])(e,"error_type",s.error_type?s.error_type[0]:void 0),Object(i["a"])(e,"cloud_id",this.cloud_id?this.cloud_id:""),r=e,console.log("params",r),t.next=6,m["a"].get_task_list(r);case 6:n=t.sent,"Success"===n.code?(this.task_list=null===(o=n.data)||void 0===o?void 0:o.event_list,this.total=(null===(u=n.data)||void 0===u||null===(c=u.page_info)||void 0===c?void 0:c.count)||0,this.task_num=null===(l=n.data)||void 0===l?void 0:l.task_num,this.finish_num=null===(_=n.data)||void 0===_?void 0:_.finish_num,this.fail_num=null===(d=n.data)||void 0===d?void 0:d.fail_num,this.success_num=null===(p=n.data)||void 0===p?void 0:p.success_num,this.finished_percent=this.task_num?(this.finish_num/this.task_num*100).toFixed(2)+"%":"0.00%",this.none_exec_num=null===(f=n.data)||void 0===f?void 0:f.none_exec_num):this.$message.error(n.msg);case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"handleSizeChange",value:function(t){this.size=t,this.getTaskList()}},{key:"handleCurrentChange",value:function(t){this.current=t,this.getTaskList()}},{key:"FnSortChange",value:function(t){this.sort_prop_name="sort_".concat(t.prop),this.sort_value="descending"===t.order?"0":"ascending"===t.order?"1":void 0,this.getTaskList()}},{key:"filterAttribute",value:function(t){this.filter_obj=Object(o["a"])(Object(o["a"])({},this.filter_obj),t),this.fn_search(this.search_data)}},{key:"view",value:function(t){this.err_record=t,this.visible=!0}},{key:"reTry",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].reTry({task_id:e});case 2:s=t.sent,"Success"===s.code?(this.$message.success(s.msg),this.getTaskList()):this.$message.error(s.msg||"操作错误");case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"back",value:function(){this.$router.go(-1)}},{key:"getCurCustomer",value:function(){var t=this,e={event_id:this.$route.params.id};m["a"].get_customer_list(e).then((function(e){if("Success"===e.code&&e.data.customer_list.length>0)for(var s in e.data.customer_list)t.customer_id_list.push({text:e.data.customer_list[s].id,value:s}),t.customer_name_list.push({text:e.data.customer_list[s].name,value:s})}))}},{key:"getResourceConfig",value:function(t){var e="";return e=t.gpu_type.length>0?t.cpu_size+"C | "+t.ram_size+"G | "+t.gpu_type+" | "+t.system_disk_size+"G "+t.system_disk_type:t.cpu_size+"C | "+t.ram_size+"G | -- | "+t.system_disk_size+"G "+t.system_disk_type,e}},{key:"toPhysical",value:function(){this.$router.push({path:"/physical"})}}]),s}(p["e"]);Object(d["a"])([Object(p["f"])("$store.state.pod_id")],g.prototype,"watch_pod",null),g=Object(d["a"])([Object(p["a"])({components:{ActionBlock:f["a"],backHeader:h["a"]}})],g);var y=g,w=y,j=(s("8eb9"),s("0a845"),s("2877")),O=Object(j["a"])(w,a,r,!1,null,"bfdd4ac4",null);e["default"]=O.exports},b680:function(t,e,s){"use strict";var a=s("23e7"),r=s("da84"),i=s("e330"),n=s("5926"),o=s("408a"),u=s("1148"),c=s("d039"),l=r.RangeError,_=r.String,d=Math.floor,p=i(u),f=i("".slice),m=i(1..toFixed),v=function(t,e,s){return 0===e?s:e%2===1?v(t,e-1,s*t):v(t*t,e/2,s)},h=function(t){var e=0,s=t;while(s>=4096)e+=12,s/=4096;while(s>=2)e+=1,s/=2;return e},b=function(t,e,s){var a=-1,r=s;while(++a<6)r+=e*t[a],t[a]=r%1e7,r=d(r/1e7)},k=function(t,e){var s=6,a=0;while(--s>=0)a+=t[s],t[s]=d(a/e),a=a%e*1e7},g=function(t){var e=6,s="";while(--e>=0)if(""!==s||0===e||0!==t[e]){var a=_(t[e]);s=""===s?a:s+p("0",7-a.length)+a}return s},y=c((function(){return"0.000"!==m(8e-5,3)||"1"!==m(.9,0)||"1.25"!==m(1.255,2)||"1000000000000000128"!==m(0xde0b6b3a7640080,0)}))||!c((function(){m({})}));a({target:"Number",proto:!0,forced:y},{toFixed:function(t){var e,s,a,r,i=o(this),u=n(t),c=[0,0,0,0,0,0],d="",m="0";if(u<0||u>20)throw l("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return _(i);if(i<0&&(d="-",i=-i),i>1e-21)if(e=h(i*v(2,69,1))-69,s=e<0?i*v(2,-e,1):i/v(2,e,1),s*=4503599627370496,e=52-e,e>0){b(c,0,s),a=u;while(a>=7)b(c,1e7,0),a-=7;b(c,v(10,a,1),0),a=e-1;while(a>=23)k(c,1<<23),a-=23;k(c,1<<a),b(c,1,1),k(c,2),m=g(c)}else b(c,0,s),b(c,1<<-e,0),m=g(c)+p("0",u);return u>0?(r=m.length,m=d+(r<=u?"0."+p("0",u-r)+m:f(m,0,r-u)+"."+f(m,r-u))):m=d+m,m}})},bd09:function(t,e,s){"use strict";s("29f3")},ed46:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"box"},[s("div",[s("span",[t._v(t._s(t.title))]),t._t("left")],2),s("div",[t._t("default"),t.no_back?t._e():s("el-button",{attrs:{type:"primary",plain:""},on:{click:t.FnBack}},[t._v("返回")])],2)]),s("div",{staticClass:"perch"})])},r=[],i=s("d4ec"),n=s("bee2"),o=s("262e"),u=s("2caf"),c=s("9ab4"),l=s("1b40"),_=function(t){Object(o["a"])(s,t);var e=Object(u["a"])(s);function s(){return Object(i["a"])(this,s),e.apply(this,arguments)}return Object(n["a"])(s,[{key:"FnBack",value:function(){this.back_url?this.$router.push(this.back_url):this.$router.go(-1)}}]),s}(l["e"]);Object(c["a"])([Object(l["c"])({default:""})],_.prototype,"title",void 0),Object(c["a"])([Object(l["c"])({default:""})],_.prototype,"back_url",void 0),Object(c["a"])([Object(l["c"])({default:!1})],_.prototype,"no_back",void 0),_=Object(c["a"])([l["a"]],_);var d=_,p=d,f=(s("bd09"),s("2877")),m=Object(f["a"])(p,a,r,!1,null,"bdf5ebe2",null);e["a"]=m.exports},f67f:function(t,e,s){}}]);
//# sourceMappingURL=chunk-01f32274.1745983465578.js.map