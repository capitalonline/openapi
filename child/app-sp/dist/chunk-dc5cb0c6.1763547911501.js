(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-dc5cb0c6"],{"039b":function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_snapshot_list(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_list/",e))},get_snapshot_chains_list(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_list/",e))},chains_detail(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_detail/",e))},record(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/history_record/",e))},get_monitor_id(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_disk_ids/",e))},get_snapshot_info(e){return Object(i["a"])(Object(a["i"])("POST","/snapshot/snapshot_use_monitor",e))}}},1477:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_host_list(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_list/",e))},get_room_list(e){return Object(i["a"])(Object(a["d"])("GET","/host/machine_room_list/",e))},get_status_list(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_status_list/",e))},external_management(e){return Object(i["a"])(Object(a["d"])("GET","/host/external_management/",e))},migrate(e){return Object(i["a"])(Object(a["d"])("POST","/host/migration_operation/",e))},disperse(e){return Object(i["a"])(Object(a["d"])("POST","/host/disperse_operation/",e))},record(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_operation_record/",e))},recommended_host(e){return Object(i["a"])(Object(a["d"])("POST","/host/recommended_host/",e))},host_maintenance(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",e))},finish_maintenance(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_finish_maintenance/",e))},shelves(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_off_shelves/",e))},get_detail_overview(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_main_details/",e))},get_detail_storage(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_disk/",e))},down(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_list_download/",e))},host_operate(e){return Object(i["a"])(Object(a["d"])("POST","/host/operate/",e))},host_import(e){return Object(i["a"])(Object(a["d"])("POST","/host/import/",e))},get_host_attribution(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_attribution/",e))},set_host_attribution(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_attribution/",e))},get_host_type(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_config/",e))},update_attribute(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_config/",e))},getCustomerList(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_customer_list/",e))},getFamilyList(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_family_list/",e))},finish_validate(e){return Object(i["a"])(Object(a["d"])("POST","/host/verification_finish/",e))},get_host_recycle_department(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_recycle_department/",e))},get_host_list_field(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_list_field/",e))},get_task_list(e){return Object(i["a"])(Object(a["d"])("GET","/host/business_test_task/",e))},create_test_task(e){return Object(i["a"])(Object(a["d"])("POST","/host/create_test_task/",e))},get_host_filter_item(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_filter_item/",e))},set_remark(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_remark/",e))},set_flag(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_tag/",e))},update_ecs_info(e){return Object(i["a"])(Object(a["d"])("POST","/ecs/update_ecs_info/",e))},crash_clear(e){return Object(i["a"])(Object(a["b"])("POST","/host/crash_clear/",e))},crash_recover(e){return Object(i["a"])(Object(a["b"])("POST","/host/crash_recover/",e))},set_lock(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_lock/",e))},set_unlock(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_unlock/",e))},set_maintenance(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",e))},get_maintenance_record(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_maintenance_record/",e))},get_lock_record(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_lock_record/",e))},recover_storage_error(e){return Object(i["a"])(Object(a["d"])("POST","/host/recover_storage_error/",e))},agent_update(e){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_update/",e))},agent_rollback(e){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_rollback/",e))},set_prepare_host(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_prepare_host/",e))},get_ovs_version(e){return Object(i["a"])(Object(a["d"])("GET","/host/ovs_version_list/",e))},update_host_power_status(e){return Object(i["a"])(Object(a["d"])("POST","/host/update_host_power_status/",e))},update_ecs_status(e){return Object(i["a"])(Object(a["d"])("POST","/host/update_host_ecs_status/",e))}}},"268f":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("el-dialog",{attrs:{title:"操作记录",visible:e.visible,width:"60%","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("div",[t("el-dialog",{attrs:{title:"响应信息",visible:e.res_visible,width:"60%","destroy-on-close":!0,"append-to-body":"","custom-class":"response-data"},on:{"update:visible":function(t){e.res_visible=t},close:e.clost_res}},[t("div",[e._v(e._s(e.response))])])],1),t("div",[t("action-block",{attrs:{search_option:["physical","message"].includes(e.type)?{...e.search}:e.search},on:{"fn-search":e.fn_search}}),["physical","message"].includes(e.type)?t("div",{staticClass:"icon m-bottom10"},[t("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[t("el-button",{attrs:{type:"text"},on:{click:e.getOperateRecordList}},[t("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1)],1):e._e(),t("el-table",{staticClass:"record-table",attrs:{data:e.record_list,border:""}},[t("el-table-column",{attrs:{prop:"oper_time",label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.oper_time?e.moment(s.row.oper_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),t("el-table-column",{attrs:{prop:"oper_type_display",label:"操作内容"}}),t("el-table-column",{attrs:{prop:"status_display",label:"状态"}}),["message","physical"].includes(e.type)?t("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.response?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.view(s.row.response)}}},[e._v("查看")]):t("span",[e._v("-")])]}}])}):t("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.result?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.view(s.row.result)}}},[e._v("查看")]):t("span",[e._v("-")])]}}],null,!1,79404134)}),t("el-table-column",{attrs:{prop:"finish_time",label:"完成时间"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.finish_time?e.moment(s.row.finish_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),t("el-table-column",{attrs:{prop:"oper_user",label:"nas"===e.type?"操作用户":"用户名"}}),["physical","message"].includes(e.type)?e._e():t("el-table-column",{attrs:{prop:"flag_display",label:"操作标识"}})],1),t("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},a=[],r=s("9ab4"),o=s("1b40"),n=s("c811"),c=s("d772"),l=s("1477"),_=s("e4d0"),u=s("039b"),d=s("fc43"),b=s("c1df"),h=s.n(b),p=s("8ce4"),m=s("3673");let g=class extends o["e"]{constructor(){super(...arguments),this.state_list=[{type:"",label:"全部"},{type:"doing",label:"执行中"},{type:"success",label:"成功"},{type:"failed",label:"失败"}],this.search={state:{list:this.state_list,placeholder:"请选择状态"},content:{placeholder:"请输入操作内容"}},this.record_list=[],this.current=1,this.size=20,this.total=0,this.search_data={},this.moment=h.a,this.response="",this.res_visible=!1}created(){this.fn_search()}fn_search(e={}){this.current=1,this.search_data=e,this.getOperateRecordList()}async getOperateRecordList(){let e;const{search_data:t}=this;let s="physical"!==this.type?{task_type:t.content,cloud_id:this.record_id}:{content:t.content,cloud_id:this.record_id,cloud_type:"host"},i={status:t.state||"",page_size:this.size,page_index:this.current,...s};if(e="physical"===this.type?await l["a"].record({...i}):"message"===this.type?await _["a"].get_pub_operate_record({os_id:this.record_id,status:t.state||"",content_type:t.content,page_size:this.size,page_index:this.current}):"snapshot"===this.type?await u["a"].record({cloud_id:this.record_id,cloud_type:"snapshot",status:t.state||"",task_type:t.content,page_size:this.size,page_index:this.current}):"nas"===this.type?await d["a"].get_nas_record({...i}):await c["a"].get_operate_record_list({cloud_type:this.type?this.type:"ecs",...i}),"Success"===e.code){var a,r;if(["physical","message"].includes(this.type)){let t=["create_time","content","status_name","response","update_time","op_user"],s=["oper_time","oper_type_display","status_display","response","finish_time","oper_user"];this.record_list=Object(p["b"])(e.data.operation_list,s,t)}else{var o;this.record_list=(null===(o=e.data)||void 0===o?void 0:o.history_record)||[]}this.total=(null===(a=e.data)||void 0===a||null===(r=a.page_info)||void 0===r?void 0:r.count)||0}}handleSizeChange(e){this.size=e,this.getOperateRecordList()}handleCurrentChange(e){this.current=e,this.getOperateRecordList()}view(e){this.response=e,this.res_visible=!0}clost_res(){this.res_visible=!1,this.response=""}back(){}};Object(r["a"])([Object(o["c"])(Boolean)],g.prototype,"visible",void 0),Object(r["a"])([Object(o["c"])(String)],g.prototype,"record_id",void 0),Object(r["a"])([Object(o["c"])(String)],g.prototype,"type",void 0),Object(r["a"])([Object(o["b"])("close")],g.prototype,"back",null),g=Object(r["a"])([Object(o["a"])({components:{ActionBlock:n["a"],SvgIcon:m["a"]}})],g);var f=g,O=f,j=(s("f813"),s("2877")),v=Object(j["a"])(O,i,a,!1,null,null,null);t["a"]=v.exports},2829:function(e,t,s){},"3f8d":function(e,t,s){"use strict";s.d(t,"b",(function(){return o})),s.d(t,"c",(function(){return n}));const i={building:"创建中",running:"运行中",restarting:"重启中",shutting_down:"关机中",shutdown:"已关机",starting_up:"开机中",deleting:"删除中",deleted:"已删除",destroying:"销毁中",destroy:"已销毁",updating:"更新中",error:"错误",recovering:"恢复中",failed:"创建失败"},a={start_up_ecs:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"开 机"},shutdown_ecs:{auth:["running"],msg:"已选实例需为运行中！",label:"关 机"},restart_ecs:{auth:["running"],msg:"已选实例状态需为运行中！",label:"重 启"},delete_ecs:{auth:["running","shutdown","error"],msg:"已选实例状态需为已关机或运行中或错误！",label:"逻辑删除"},recover_ecs:{auth:["deleted"],msg:"已选实例状态需为已删除！",label:"恢 复"},destroy_ecs:{auth:["deleted","failed"],msg:"已选实例状态需为已删除或创建失败！",label:"销 毁"},update_spec:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换实例规格"},update_system:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换操作系统"},reset_pwd:{auth:["running"],msg:"已选实例状态需为运行中！",label:"更换密码"},open_bill:{auth:["running","shutdown"],msg:"已选实例状态需为运行中或已关机！",label:"开启计费"},net_set:{auth:["running"],msg:"已选实例状态需为运行中！",label:"网络设置"}},r={start_up_host:{power:["shutdown"],host:["offline","online","exception","maintenance"],msg:"已选主机需为在线、离线、异常或维护状态",label:"开机"},shutdown_host:{power:["running"],host:["maintenance"],vm:1,msg:"已选主机需为维护状态",msg2:"操作关机前，请确保物理机上无云主机运行",label:"关机"},restart_host:{power:["running"],host:["offline","online","maintenance"],msg:"已选主机需为在线、离线或维护状态",label:"重启"},online_maintenance:{power:[],host:["online","exception"],msg:"已选主机需为在线状态",label:"在线维护"},maintenance:{power:[],host:[],msg:"",label:"设置维护"},offline_maintenance:{power:[],host:["offline","online","exception"],vm:1,msg:"已选主机需为在线或离线状态且已选主机上不能有虚拟机运行",label:"离线维护"},finish:{power:[],host:["maintenance","online_maintenance","offline_maintenance"],msg:"已选主机需为维护中状态",label:"完成维护"},shelves:{power:[],host:[],vm:1,msg:"已选主机上不能有虚拟机运行",label:"下架"},disperse:{power:["running"],host:["online"],msg:"已选主机需为在线状态",label:"驱散"},out_of_band:{power:[],host:["offline","online"],msg:"已选主机需为在线或离线状态",label:"进入带外管理"},migrate:{power:["running"],host:["online","storage_error","crash"],msg:"已选主机需为在线、存储异常或宕机状态",label:"迁移"},lock:{power:[],host:[],msg:"",label:"锁定"},unlock:{power:[],host:["lock"],msg:"已选主机需为锁定状态",label:"解锁"},unstore_exception:{power:[],host:["storage_error"],msg:"已选主机需为存储异常状态",label:"解除存储异常"},service:{power:[],host:[],msg:"",label:"服务更新"},rollback:{power:[],host:[],label:"回滚"},physical_detail:{power:[],host:[],msg:"",label:"详情"},data_clear:{power:[],host:["crash_clear"],msg:"",label:"数据清理同步"},down_recover:{power:[],host:["crash_recover"],msg:"",label:"宕机恢复"},sign:{power:[],host:[],msg:"",label:"设备标记"},upload:{power:[],host:[],msg:"",label:"导入"},under_sync:{power:[],host:[],msg:"",label:"底层同步"},cheat:{power:[],host:[],msg:"",label:"欺骗器管理"},business_test:{power:[],host:[],msg:"",label:"业务测试"},record:{power:[],host:[],msg:"",label:"操作记录"},resource:{power:[],host:[],msg:"",label:"分配资源"},remark:{power:[],host:[],msg:"",label:"编辑备注"},add_cluster:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"加入集群"},change_cluster:{power:[],host:[],msg:"",label:"更换集群"},remove_cluster:{power:[],host:["maintenance"],mag:"",label:"移出集群"},set_label:{power:[],host:[],msg:"",label:"添加标签"},set_prepar_host:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"设为备机"},set_resource_pools:{power:[],host:["online"],msg:"",label:"设为资源池"}};t["a"]={getInsOperateAuth(e){return a[e]}};const o=e=>i[e],n=e=>r[e]},"495e":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{title:"卸载云盘",visible:e.visible,width:"600px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("el-alert",{attrs:{title:"是否确定要对以下云盘执行 卸载 操作",type:"warning",center:"",closable:!1}}),t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.mount_id,"max-height":"161",border:""}},[t("el-table-column",{attrs:{prop:"disk_id",label:"待卸载云盘ID"}}),t("el-table-column",{attrs:{prop:"ecs_id",label:"源实例ID"}}),t("el-table-column",{attrs:{prop:"az_name",label:"地域及可用区"}})],1),t("div",{staticClass:"remark"},[t("div",[e._v("1.执行卸载操作前,请停止云盘数据的读写。")]),t("div",[e._v("2.执行卸载操作前,请确认预设的文件索引已被删除,避免影响实例重启。")])])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定卸载")]),t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)},a=[],r=(s("14d9"),s("e9f5"),s("7d54"),s("9ab4")),o=s("1b40"),n=s("f33c");let c=class extends o["e"]{async confirm(){const e=[];this.mount_id.forEach(t=>{e.push(t.disk_id)});let t=await n["a"].unmount({customer_id:this.mount_id[0].customer_id,disk_ids:e});"Success"===t.code?(this.$message.success("云盘卸载任务下发成功！"),this.back("1")):this.back("0")}cancel(){this.back("0")}back(e){}};Object(r["a"])([Object(o["c"])(Boolean)],c.prototype,"visible",void 0),Object(r["a"])([Object(o["c"])({default:()=>[]})],c.prototype,"mount_id",void 0),Object(r["a"])([Object(o["b"])("close")],c.prototype,"back",null),c=Object(r["a"])([Object(o["a"])({})],c);var l=c,_=l,u=(s("ee63"),s("2877")),d=Object(u["a"])(_,i,a,!1,null,"66337734",null);t["a"]=d.exports},"4a26":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{title:"挂载云盘",visible:e.visible,width:"600px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("div",{staticClass:"mount"},[t("el-alert",{attrs:{title:"是否确定要对以下云盘执行 挂载 操作",type:"warning",center:"",closable:!1}}),t("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:e.form_data,"label-width":"100px"}},[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.mount_id,"max-height":"161",border:""}},[t("el-table-column",{attrs:{prop:"disk_id",label:"待挂载云盘ID"}}),t("el-table-column",{attrs:{prop:"az_name",label:"地域及可用区"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.region_name)+"  "+e._s(s.row.az_name))])]}}])})],1)],1),t("el-form-item",{attrs:{label:"目标实例",prop:"instance_id",rules:[{required:!0,message:"请选择目标实例",trigger:"blur"}]}},[t("el-select",{attrs:{filterable:"","filter-method":e.get_instance_list,placeholder:"请选择目标实例"},on:{"visible-change":e.change_ecs},model:{value:e.form_data.instance_id,callback:function(t){e.$set(e.form_data,"instance_id",t)},expression:"form_data.instance_id"}},e._l(e.instance_list,(function(e){return t("el-option",{key:e.ecs_id,attrs:{label:`${e.ecs_id} / ${e.ecs_name}`,value:e.ecs_id}})})),1),""===e.form_data.instance_id&&e.judge_ecs?t("div",{staticClass:"ecs-error"},[e._v("请选择或输入实例")]):e._e()],1),t("el-form-item",{attrs:{prop:"del_set",label:"删除设置"}},[t("el-checkbox",{model:{value:e.form_data.del_set,callback:function(t){e.$set(e.form_data,"del_set",t)},expression:"form_data.del_set"}},[e._v("云盘随实例删除")])],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定挂载")]),t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)])},a=[],r=(s("14d9"),s("e9f5"),s("910d"),s("7d54"),s("9ab4")),o=s("1b40"),n=s("f33c"),c=s("e527"),l=s("d772"),_=s("3f8d");let u=class extends o["e"]{constructor(){super(...arguments),this.form_data={instance_id:"",del_set:!0},this.judge_ecs=!1,this.instance_list=[]}created(){this.get_instance_list("")}watch_instance_id(e){""!==e&&e&&(this.judge_ecs=!1,this.get_mounted_num(e))}change_ecs(e){e||this.get_instance_list("")}async get_instance_list(e){const t=await c["a"].get_instance_list({page_index:1,page_size:20,keyword:e,customer_id:this.mount_id[0].customer_id,az_id:this.mount_id[0].az_id});"Success"==t.code&&(this.instance_list=t.data.ecs_list.filter(e=>["running","shutdown"].includes(e.status)&&!e.is_gpu&&e.is_charge===this.mount_id[0].is_charge&&!e.no_charge_for_shutdown)||[])}async get_mounted_num(e){const t=await l["a"].get_detail({ecs_id:e});if("Success"==t.code){const{data:{disk:e}}=t;16-e.data_disk_conf.length<this.mount_id.length&&(this.$message.warning("该实例可挂载云盘数量不足!"),this.form_data.instance_id="",this.get_instance_list(this.form_data.instance_id))}}transEcsStatus(e){return`状态${Object(_["b"])(e)}不可挂载`}confirm(){const e=this.$refs.form;""!==this.form_data.instance_id?e.validate(async e=>{if(e){const e=[];this.mount_id.forEach(t=>{e.push(t.disk_id)});let t=await n["a"].mount({customer_id:this.mount_id[0].customer_id,disk_ids:e,ecs_id:this.form_data.instance_id,is_follow_delete:this.form_data.del_set?"1":"0"});"Success"===t.code?(this.$message.success("云盘挂载任务下发成功！"),this.back("1")):this.back("0")}}):this.judge_ecs=!0}cancel(){this.back("0")}back(e){const t=this.$refs.form;t.resetFields()}};Object(r["a"])([Object(o["c"])(Boolean)],u.prototype,"visible",void 0),Object(r["a"])([Object(o["c"])({default:()=>[]})],u.prototype,"mount_id",void 0),Object(r["a"])([Object(o["f"])("form_data.instance_id")],u.prototype,"watch_instance_id",null),Object(r["a"])([Object(o["b"])("close")],u.prototype,"back",null),u=Object(r["a"])([Object(o["a"])({})],u);var d=u,b=d,h=(s("cc29"),s("2877")),p=Object(h["a"])(b,i,a,!1,null,"376085a2",null);t["a"]=p.exports},"4a55":function(e,t,s){},"603d":function(e,t,s){},"754a":function(e,t,s){},"78e5":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{title:"修改云盘名称",visible:e.visible,width:"700px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("el-alert",{attrs:{title:"是否确定要对以下云盘执行 修改名称 操作",type:"warning",center:"",closable:!1}}),t("div",{staticClass:"content"},[t("div",{staticClass:"label"},[e._v("云盘名称:")]),t("el-input",{attrs:{placeholder:"请输入新的名称",minlength:"2",maxlength:"40","show-word-limit":""},model:{value:e.new_name,callback:function(t){e.new_name=t},expression:"new_name"}}),e.new_name.trim().length<2?t("span",{staticClass:"name-error"},[e._v("云盘名称长度最少为2")]):/^[A-Za-z][\u4e00-\u9fa5_a-zA-Z0-9-_:()\u002E]{1,39}$/.test(e.new_name)?e._e():t("span",{staticClass:"name-error"},[e._v("云盘名称格式不正确")])],1),t("div",{staticClass:"remark"},[e._v("2-40个字符，可包含大小写字母、中文、数字、点号(.)、下划线(_)、半角冒号(:)、连字符(-)、英文括号(英文输入法下的括号)字符，以大小写字母开头")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)},a=[],r=s("9ab4"),o=s("1b40"),n=s("f33c");let c=class extends o["e"]{constructor(){super(...arguments),this.new_name=this.name.disk_name}async confirm(){let e=/^[A-Za-z][\u4e00-\u9fa5_a-zA-Z0-9-_:()\u002E]{1,39}$/;if(!e.test(this.new_name))return;let t=await n["a"].edit_disk_name({customer_id:this.name.customer_id,disk_id:this.name.disk_id,disk_name:""===this.new_name?this.name.disk_name:this.new_name});"Success"===t.code?(this.$message.success("修改云盘名称任务下发成功！"),this.back("1")):this.back("0")}cancel(){this.back("0")}back(e){}};Object(r["a"])([Object(o["c"])(Boolean)],c.prototype,"visible",void 0),Object(r["a"])([Object(o["c"])({default:()=>{}})],c.prototype,"name",void 0),Object(r["a"])([Object(o["b"])("close")],c.prototype,"back",null),c=Object(r["a"])([Object(o["a"])({})],c);var l=c,_=l,u=(s("b336"),s("2877")),d=Object(u["a"])(_,i,a,!1,null,"65fdec5e",null);t["a"]=d.exports},"86d7":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{title:"修改云盘属性",visible:e.visible,width:"600px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("el-alert",{attrs:{title:"是否确定要对以下云盘执行 修改属性 操作",type:"warning",center:"",closable:!1}}),t("div",{staticClass:"content"},[t("div",{staticClass:"label"},[e._v("云盘ID/名称:")]),t("div",[t("pre",[e._v(e._s(e.attr.disk_id)+" / "+e._s(e.attr.disk_name))])])]),t("div",{staticClass:"content"},[t("div",{staticClass:"label"},[e._v("云盘种类:")]),t("div",[e._v(e._s(e.attr.feature))])]),t("div",{staticClass:"content"},[t("div",{staticClass:"label"},[e._v("删除设置:")]),t("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("云盘随实例删除")])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)},a=[],r=s("9ab4"),o=s("1b40"),n=s("f33c");let c=class extends o["e"]{constructor(){super(...arguments),this.checked=this.attr.is_follow_delete}created(){}async confirm(){let e=await n["a"].edit_disk_attr({disk_id:this.attr.disk_id,is_follow_delete:this.checked?"1":"0"});"Success"===e.code?(this.$message.success("修改云盘属性任务下发成功！"),this.back("1")):this.back("0")}cancel(){this.back("0")}back(e){}};Object(r["a"])([Object(o["c"])(Boolean)],c.prototype,"visible",void 0),Object(r["a"])([Object(o["c"])({default:()=>{}})],c.prototype,"attr",void 0),Object(r["a"])([Object(o["b"])("close")],c.prototype,"back",null),c=Object(r["a"])([Object(o["a"])({})],c);var l=c,_=l,u=(s("b5d3"),s("2877")),d=Object(u["a"])(_,i,a,!1,null,"396fe902",null);t["a"]=d.exports},"8ce4":function(e,t,s){"use strict";s.d(t,"e",(function(){return i})),s.d(t,"b",(function(){return a})),s.d(t,"a",(function(){return r})),s.d(t,"c",(function(){return o})),s.d(t,"d",(function(){return n}));s("14d9"),s("e9f5"),s("ab43");function i(e,t,s,i,a){let r=[];return e.map(e=>{r.push({[i]:e[t],[a]:e[s]})}),r}function a(e,t,s,i={}){let a=[];return e.map(e=>{let r={};t.map((t,i)=>{r[t]=e[s[i]]}),a.push({...r,...i})}),a}function r(e,t=!1){let s={};for(let i in e){const{billing_scheme_id:a,billing_cycle_id:r,billing_items:o,gic_goods_id:n}=e[i];let c={};for(let e in o){let s={attr_id:o[e].attr_id,name:o[e].name},i={id:o[e].id,key:e};c[e]=t?{...s,...i}:i}s[i]={billing_scheme_id:a,billing_cycle_id:r,billing_items:c,gic_goods_id:t?n:void 0}}return s}function o(e,t){return e.map(e=>e[t])}function n(e){let t="";for(let s in e)e[s]&&(t+=`${s}=${e[s]}&`);return""===t?"":"?"+t.slice(0,t.length-1)}},9409:function(e,t,s){},"95a2":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("action-block",{attrs:{search_option:e.search_dom,type:!0},on:{"fn-search":e.search}}),t("el-table",{ref:"disk_table",attrs:{data:e.disk_list,border:"","row-class-name":e.rowStyle},on:{"selection-change":e.handleSelectionChange,"filter-change":e.filterAttribute,"row-click":e.FnOperRow,"row-contextmenu":e.FnRightClick}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),t("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),t("el-table-column",{attrs:{prop:"disk_id",label:"云盘ID","min-width":"150px","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"disk_name",label:"云盘名称","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("pre",[e._v(e._s(s.row.disk_name))])]}}])}),t("el-table-column",{attrs:{prop:"status",label:"云盘状态","filter-multiple":!1,filters:e.disk_state,"column-key":"status"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",{class:s.row.status},[e._v(e._s(s.row.status_name))])]}}])}),t("el-table-column",{attrs:{prop:"type",label:"类型容量","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[e._v("类型："+e._s(s.row.feature?""+s.row.feature:""))]),t("div",[e._v("容量："+e._s(s.row.size?s.row.size+"GB":""))]),t("div",[e._v("IOPS："+e._s(s.row.disk_iops?`${s.row.disk_iops}${s.row.iops_unit}`:""))])]}}])}),t("el-table-column",{attrs:{prop:"az_name",label:"地域及可用区","min-width":"130px"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.region_name)+"  "+e._s(s.row.az_name))])]}}])}),t("el-table-column",{attrs:{prop:"disk_type",label:"属性","filter-multiple":!1,filters:e.diskAttribute,"column-key":"disk_property"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s("data"===s.row.disk_type?"数据盘":"系统盘"))])]}}])}),t("el-table-column",{attrs:{prop:"ecs_id",label:"实例ID","min-width":"140px","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(s){return[t("pre",[e._v(e._s(s.row.ecs_id?s.row.ecs_id:""))])]}}])}),t("el-table-column",{attrs:{prop:"is_follow_delete",label:"删除设置"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(""===s.row.ecs_id?"-":s.row.is_follow_delete?"随实例删除":"不随实例删除"))])]}}])}),t("el-table-column",{attrs:{prop:"create_time",label:"创建时间"}}),t("el-table-column",{attrs:{prop:"fee_way",label:"计费方式","filter-multiple":!1,filters:e.fee_way_fil,"column-key":"fee_way"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.billing_method_display?s.row.billing_method_display:"不计费"))])]}}])}),t("el-table-column",{attrs:{prop:"op_source",label:"创建来源","filter-multiple":!1,filters:e.op_source_fil,"column-key":"op_source"},scopedSlots:e._u([{key:"default",fn:function(s){return["gic"===s.row.op_source?t("span",[e._v("GIC")]):"internal_api"===s.row.op_source?t("span",[e._v("内部API")]):t("span",[e._v("运维后台")])]}}])}),t("el-table-column",{attrs:{prop:"product_source",label:"产品来源","filter-multiple":!0,filters:e.product_source_list,"column-key":"product_source"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(e.product_source_list,(function(i){return t("span",[i.value===s.row.product_source?t("span",[e._v(" "+e._s(i.text)+" ")]):e._e()])}))}}])}),t("el-table-column",{attrs:{prop:"product_server_id",width:"120px",label:"内部服务账号ID"}}),t("el-table-column",{attrs:{prop:"product_server_name",width:"120px",label:"内部服务账号名称"}})],1),t("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.visible&&"record"===e.operate_type?[t("Record",{attrs:{visible:e.visible,record_id:e.mount_id[0].disk_id,type:"ebs"},on:{close:e.close_disk}})]:e._e(),e.visible&&"mount"===e.operate_type?[t("mount-disk",{attrs:{visible:e.visible,mount_id:e.mount_id},on:{close:e.close_disk}})]:e._e(),e.visible&&"unInstall"===e.operate_type?[t("UnInstall",{attrs:{visible:e.visible,mount_id:e.mount_id},on:{close:e.close_disk}})]:e._e(),e.visible&&"edit_attr"===e.operate_type?[t("edit-attr",{attrs:{visible:e.visible,attr:e.mount_id[0]},on:{close:e.close_disk}})]:e._e(),e.visible&&"edit_name"===e.operate_type?[t("edit-name",{attrs:{visible:e.visible,name:e.mount_id[0]},on:{close:e.close_disk}})]:e._e(),!e.visible||"delete"!==e.operate_type&&"restore"!==e.operate_type&&"destroy"!==e.operate_type&&"open_bill"!==e.operate_type?e._e():[t("Common",{attrs:{visible:e.visible,mount_id:e.mount_id,title:e.common_operate[e.operate_type]},on:{close:e.close_disk}})],1===e.mount_id.length?t("span",[t("right-click",{attrs:{multi_rows:e.mount_id,menus:e.menus,name:e.mount_id.length>0?e.mount_id[0].disk_name:"",error_msg:e.error_msg},on:{"fn-click":e.infoClick}})],1):e._e()],2)},a=[],r=(s("14d9"),s("e9f5"),s("d866"),s("910d"),s("7d54"),s("ab43"),s("a732"),s("9ab4")),o=s("1b40"),n=s("c811"),c=s("c550"),l=s("268f"),_=s("4a26"),u=s("495e"),d=s("86d7"),b=s("78e5"),h=s("9c6f"),p=s("f33c"),m=s("8ce4"),g=s("e8c0"),f=s("cf88"),O=s("bd4d");let j=class extends o["e"]{constructor(){super(...arguments),this.disk_list=[],this.current=1,this.size=20,this.total=0,this.disk_state=[],this.auth_list=[],this.search_dom={disk_id:{placeholder:"请输入云盘ID"},ecs_id:{placeholder:"请输入实例ID"},customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},product_server_id:{placeholder:"请输入内部服务账号ID"},product_server_name:{placeholder:"请输入内部服务账号名称"}},this.visible=!1,this.operate_type="",this.mount_id=[],this.filter_obj=null,this.clear=null,this.product_source_list=[],this.common_operate={delete:"逻辑删除",restore:"恢复",destroy:"销毁",open_bill:"开启计费"},this.operateBtns=[{label:"创建云盘",value:"disk_create"},{label:"挂载",value:"mount"},{label:"卸载",value:"unInstall"},{label:"逻辑删除",value:"delete"},{label:"恢复",value:"restore"},{label:"销毁",value:"destroy"},{label:"扩容",value:"disk_capacity"},{label:"开启计费",value:"open_bill"}],this.req_data={},this.diskAttribute=[{text:"数据盘",value:"data"},{text:"系统盘",value:"system"}],this.op_source_fil=[{text:"运维后台",value:"cloud_op"},{text:"GIC",value:"gic"},{text:"内部API",value:"internal_api"}],this.fee_way_fil=[{text:"按量计费",value:"0"},{text:"不计费",value:"no"}],this.menus=[{label:"操作记录",value:"record",single:!0,disabled:!1}],this.error_msg={},this.selectedRow=null}created(){this.get_disk_state(),this.get_product_source(),this.search(),this.auth_list=this.$store.state.auth_info[this.$route.name],document.addEventListener("click",f["a"])}beforeDestroy(){this.FnClearTimer()}watch_pod(e){e&&this.search(this.req_data)}async get_product_source(){this.product_source_list=[];let e=await p["a"].get_product_source({});"Success"===e.code&&e.data.map((e,t)=>(this.product_source_list.push({text:Object.values(e)[0],value:Object.keys(e)[0]}),e))}async get_disk_state(){let e=await p["a"].get_disk_state({});"Success"===e.code&&(this.disk_state=Object(m["e"])(e.data,"status_name","status","text","value"))}FnRightClick(e,t,s){this.$refs.disk_table.clearSelection();const i=this.mount_id.some(t=>t.disk_id===e.disk_id);i||this.$refs.disk_table.toggleRowSelection(e),Object(g["a"])(e,t,s)}FnOperRow(e){const t=this.$refs.disk_table;this.selectedRow!==e?(this.selectedRow&&t.clearSelection(),t.toggleRowSelection(e,!0),this.selectedRow=e):(t.toggleRowSelection(e,!1),this.selectedRow=null)}rowStyle({row:e}){const t=this.mount_id.some(t=>t.disk_id===e.disk_id);if(t)return"rowStyle"}infoClick(e){this.operateRecord(this.mount_id),Object(f["a"])()}async getDiskList(e=!0){let t=[];e||(this.$store.commit("SET_LOADING",!1),t=this.mount_id.map(e=>e.disk_id));const{req_data:s}=this;let i=await p["a"].get_disk_list({az_id:this.$store.state.az_id,disk_id:s.disk_id||"",ecs_id:s.ecs_id||"",status:s.status?s.status[0]:"",product_source:s.product_source?s.product_source:[],customer_id:s.customer_id||"",customer_name:s.customer_name||"",product_server_id:s.product_server_id||"",product_server_name:s.product_server_name||"",disk_property:s.disk_property?s.disk_property[0]:"",op_source:s.op_source?s.op_source[0]:"",billing_method:s.fee_way?s.fee_way[0]:"all",page_index:this.current,page_size:this.size});if("Success"===i.code){this.disk_list=i.data.result||[],this.total=i.data.page_info.count||0;let e=i.data.result.filter(e=>t.includes(e.disk_id));e.length>0&&this.$nextTick(()=>{e.forEach(e=>{let t=this.$refs.disk_table;t&&t.toggleRowSelection(e)})})}this.FnSetTimer()}FnSetTimer(){this.clear&&this.FnClearTimer(),this.clear=setTimeout(()=>{this.getDiskList(!1)},5e3)}FnClearTimer(){this.clear&&clearTimeout(this.clear)}search(e={}){this.FnClearTimer(),this.current=1,this.req_data={...e,...this.filter_obj},this.getDiskList()}handleSizeChange(e){this.size=e,this.getDiskList()}handleCurrentChange(e){this.current=e,this.getDiskList()}handleBtn(e){if("disk_create"===e)this[e]();else{if(0===this.mount_id.length)return void this.$message.warning("请选择要操作的云盘！");if(!this.judge_disk("customer_id",this.mount_id[0].customer_id))return void this.$message.warning("只允许对同一客户的云盘进行批量操作！");"restore"===e||"destroy"===e?this.restore(e):this[e]()}}handleOperate(e){this.FnClearTimer(),this.mount_id=[e.value],this.operate_type=e.label,"restore"===e.label||"destroy"===e.label?this.restore(e.label):"edit_attr"===e.label||"edit_name"===e.label?this.visible=!0:this[e.label]()}disk_create(){this.$router.push("/disk/create")}detail(){this.$router.push({path:"/disk/detail",query:{disk_id:this.mount_id[0].disk_id,count:1}})}operateRecord(e){this.FnClearTimer(),this.mount_id=e,this.visible=!0,this.operate_type="record"}mount(){this.judge_disk("status","waiting")?this.judge_disk("az_name",this.mount_id[0].az_name)?this.judge_disk("is_charge",this.mount_id[0].is_charge)?(this.FnClearTimer(),this.operate_type="mount",this.visible=!0):this.$message.warning("只允许对同一计费状态的云盘进行批量操作！"):this.$message.warning("只允许对同一可用区的云盘进行批量操作！"):this.$message.warning("只允许对待挂载的云盘进行批量操作！")}unInstall(){this.judge_disk("status","running")?this.judge_disk("disk_type","data")?this.$confirm("文件索引是否已被删除，建议最好删除后再进行卸载。是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.FnClearTimer(),this.operate_type="unInstall",this.visible=!0}).catch(()=>{this.close_disk()}):this.$message.warning("只允许对数据盘进行批量操作！"):this.$message.warning("只允许对使用中的云盘进行批量操作！")}delete(){const e=this.mount_id.filter(e=>"running"===e.status);if(e.length>0)return void this.$message.warning("只允许对待挂载的云盘进行批量操作,请先卸载使用中的云盘，再手动删除！");const t=this.mount_id.every((e,t,s)=>"waiting"===e.status||"error"===e.status);t?this.judge_disk("disk_type","data")?(this.FnClearTimer(),this.operate_type="delete",this.visible=!0):this.$message.warning("只允许对数据盘进行批量操作！"):this.$message.warning("只允许对待挂载或错误的云盘进行批量操作！")}restore(e){const t=this.mount_id.every((e,t,s)=>"deleted"===e.status&&!e.ecs_id),s=this.mount_id.every((e,t,s)=>"deleted"===e.status&&!e.ecs_id||"build_fail"===e.status);if("restore"===e){if(!t)return void this.$message.warning("只允许对已删除且不随实例删除的云盘进行批量操作！")}else if(!s)return void this.$message.warning("只允许对已删除且不随实例删除或创建失败的云盘进行批量操作！");this.FnClearTimer(),this.operate_type=e,this.visible=!0}disk_capacity(){if(!this.judge_disk("az_name",this.mount_id[0].az_name))return void this.$message.warning("只允许对同一可用区的云盘进行批量操作！");const e=this.mount_id.every((e,t,s)=>"running"===e.ecs_status&&"running"===e.status||"running"===e.disk_status&&"shutdown"===e.ecs_status&&e.no_charge_shutdown_ecs||"waiting"===e.status);e?this.$router.push({path:"/disk/capacity",query:{list:JSON.stringify(this.mount_id)}}):this.$message.warning("仅支持对实例状态为运行中且云盘状态为使用中，或云盘状态为待挂载的云盘进行批量操作！")}open_bill(){1!==this.mount_id.length||"running"!==this.mount_id[0].status?this.judge_disk("status","waiting")?(this.FnClearTimer(),this.operate_type="open_bill",this.visible=!0):this.$message.warning("只允许对待挂载的云盘进行批量操作！"):this.$message.warning("使用中的云盘不支持单独开启计费，请前往云服务器列表页进行操作")}judge_disk(e,t){return this.mount_id.every((s,i,a)=>s[e]===t)}limit_disk_operate(e,t){return"mount"===e?"waiting"===t.status&&this.auth_list.includes(e):"unInstall"===e?"running"===t.status&&"data"===t.disk_type&&this.auth_list.includes(e):"delete"===e?("waiting"===t.status||"error"===t.status&&!1===t.is_follow_delete)&&"data"===t.disk_type&&this.auth_list.includes(e):"restore"===e?"deleted"===t.status&&!t.ecs_id&&this.auth_list.includes(e):"destroy"===e?("deleted"===t.status&&!t.ecs_id||"build_fail"===t.status)&&this.auth_list.includes(e):"disk_capacity"===e?"running"===t.status&&"running"===t.ecs_status||"waiting"===t.status&&this.auth_list.includes("disk_capacity"):"edit_attr"===e?"running"===t.status&&"data"===t.disk_type&&this.auth_list.includes(e):"edit_name"===e?("running"===t.status||"waiting"===t.status||"deleted"===t.status)&&this.auth_list.includes(e):"open_bill"===e?"waiting"===t.status&&0===t.is_charge&&this.auth_list.includes(e):void 0}close_disk(e="1"){this.visible=!1,this.mount_id=[],this.operate_type="",this.toggleSelection(),"1"===e&&(this.current=1),this.getDiskList()}handleSelectionChange(e){this.mount_id=e}toggleSelection(){const e=this.$refs.disk_table;e.clearSelection()}filterAttribute(e){this.filter_obj={...this.filter_obj,...e},this.search(this.req_data)}};Object(r["a"])([Object(o["f"])("$store.state.az_id")],j.prototype,"watch_pod",null),j=Object(r["a"])([Object(o["a"])({components:{ActionBlock:n["a"],Record:l["a"],MountDisk:_["a"],UnInstall:u["a"],EditAttr:d["a"],EditName:b["a"],Common:h["a"],ConfirmBox:c["a"],RightClick:O["a"]}})],j);var v=j,y=v,k=(s("bbda"),s("2877")),w=Object(k["a"])(y,i,a,!1,null,"8cf2fb48",null);t["default"]=w.exports},"9c6f":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"960px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("div",{staticClass:"mount"},[t("el-alert",{attrs:{title:e.alert_title,type:"warning",center:"",closable:!1}}),t("el-table",{attrs:{data:e.mount_id,"max-height":"220",border:""}},[t("el-table-column",{attrs:{prop:"customer_id",label:"客户ID1"}}),t("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),t("el-table-column",{attrs:{prop:"disk_id",label:"云盘ID"}}),t("el-table-column",{attrs:{prop:"disk_name",label:"云盘名称"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("pre",[e._v(e._s(s.row.disk_name))])]}}])}),t("el-table-column",{attrs:{prop:"status_name",label:"状态"}}),"开启计费"===e.title?t("el-table-column",{attrs:{prop:"fee",label:"费用"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",{staticClass:"num_message"},[e._v(e._s(s.row.fee))])]}}],null,!1,1094748420)}):e._e()],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)])},a=[],r=(s("14d9"),s("e9f5"),s("7d54"),s("ab43"),s("9ab4")),o=s("1b40"),n=s("f33c");let c=class extends o["e"]{constructor(){super(...arguments),this.alert_title=`是否确定要对以下云盘执行 ${this.title} 操作`}created(){"开启计费"===this.title&&this.getFee()}async getFee(){let e=this.mount_id.map(e=>e.disk_id),t=await n["a"].get_fee({customer_id:this.mount_id[0].customer_id,az_id:this.mount_id[0].az_id,resource_ids:e,billing_method:"0",resource_type:"ebs"});"Success"===t.code&&await this.$nextTick(()=>{this.mount_id.map(e=>{let s=Object.keys(t.data.total_price).length>0?`${t.data.price_symbol}${t.data.total_price[e.disk_id].toFixed(2)}/${t.data.price_unit}`:"￥0.00/天";return this.$set(e,"fee",s),e})})}async confirm(){let e;const t=[];this.mount_id.forEach(e=>{t.push(e.disk_id)});const s={customer_id:this.mount_id[0].customer_id,disk_ids:t};if("逻辑删除"===this.title)e=await n["a"].del_disk({...s});else if("恢复"===this.title)e=await n["a"].recover({...s});else if("销毁"===this.title)e=await n["a"].destroy({...s});else{if("开启计费"!==this.title)return;{let t=this.mount_id.map(e=>e.disk_id);e=await n["a"].open_bill({customer_id:this.mount_id[0].customer_id,resource_ids:t,billing_method:"0",resource_type:"ebs"})}}"Success"===e.code?(this.$message.success(`云盘${this.title}任务下发成功！`),this.back("1")):this.back("0")}cancel(){this.back("0")}back(e){}};Object(r["a"])([Object(o["c"])(Boolean)],c.prototype,"visible",void 0),Object(r["a"])([Object(o["c"])({default:()=>[]})],c.prototype,"mount_id",void 0),Object(r["a"])([Object(o["c"])(String)],c.prototype,"title",void 0),Object(r["a"])([Object(o["b"])("close")],c.prototype,"back",null),c=Object(r["a"])([Object(o["a"])({})],c);var l=c,_=l,u=(s("cffb"),s("2877")),d=Object(u["a"])(_,i,a,!1,null,"1cce8aaa",null);t["a"]=d.exports},a732:function(e,t,s){"use strict";var i=s("23e7"),a=s("c65b"),r=s("2266"),o=s("59ed"),n=s("825a"),c=s("46c4"),l=s("2a62"),_=s("f99f"),u=_("some",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(e){n(this);try{o(e)}catch(i){l(this,"throw",i)}if(u)return a(u,this,e);var t=c(this),s=0;return r(t,(function(t,i){if(e(t,s++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},ac03:function(e,t,s){},b336:function(e,t,s){"use strict";s("ac03")},b5d3:function(e,t,s){"use strict";s("f509")},bbda:function(e,t,s){"use strict";s("4a55")},c550:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"confirm-box"},[t("el-dialog",{attrs:{title:"提示",visible:e.visible_sync,"show-close":!1,width:"400px"},on:{"update:visible":function(t){e.visible_sync=t}}},[t("i",{staticClass:"el-icon-success"}),t("span",{staticClass:"m-left10"},[e._v("请确认订单并开始执行创建任务")]),t("div",{staticClass:"text-right m-top10"},[t("el-button",{on:{click:function(t){e.visible_sync=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)])],1)},a=[],r=s("9ab4"),o=s("1b40");let n=class extends o["e"]{confirm(){this.visible_sync=!1,this.create()}create(){}};Object(r["a"])([Object(o["d"])("visible")],n.prototype,"visible_sync",void 0),Object(r["a"])([Object(o["b"])("fn-create")],n.prototype,"create",null),n=Object(r["a"])([o["a"]],n);var c=n,l=c,_=(s("e0fd"),s("2877")),u=Object(_["a"])(l,i,a,!1,null,null,null);t["a"]=u.exports},cc29:function(e,t,s){"use strict";s("d461")},cffb:function(e,t,s){"use strict";s("603d")},d461:function(e,t,s){},d772:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_operate_record_list(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/history_record/",e))},get_detail(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_ecs_detail/",e))}}},d866:function(e,t,s){"use strict";var i=s("23e7"),a=s("c65b"),r=s("2266"),o=s("59ed"),n=s("825a"),c=s("46c4"),l=s("2a62"),_=s("f99f"),u=_("every",TypeError);i({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(e){n(this);try{o(e)}catch(i){l(this,"throw",i)}if(u)return a(u,this,e);var t=c(this),s=0;return!r(t,(function(t,i){if(!e(t,s++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},e0fd:function(e,t,s){"use strict";s("2829")},e4d0:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_pub_mirror_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_pub_image_list/",e))},check_name(e){return Object(i["a"])(Object(a["b"])("POST","/img/name_check/",e))},get_mirror_type(e){return Object(i["a"])(Object(a["b"])("GET","/img/image_type/",e))},get_model_image_type(e){return Object(i["a"])(Object(a["b"])("GET","/img/model_image_type/",e))},add_pub_mirror(e){return Object(i["a"])(Object(a["b"])("GET","/img/create_pub_image/",e))},edit_pub_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/edit_image/",e))},change_status(e){return Object(i["a"])(Object(a["b"])("POST","/img/alter_image/",e))},del_pub_mirror_az(e){return Object(i["a"])(Object(a["b"])("POST","/img/delete_pub_image/",e))},del_pub_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/batch_delete_pub_image/",e))},get_pub_operate_record(e){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_operation_list/",e))},get_pub_sync_detail(e){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_info/",e))},sync_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/sync_pub_image/",e))},get_private_mirror_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_private_image_list/",e))},get_status_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_image_status_list/",e))},get_available_az(e){return Object(i["a"])(Object(a["b"])("POST","/img/get_available_az/",e))},get_disk_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/backend_type/",e))},get_product_source(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_product_source/"))}}},e527:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7"),r=s("4328"),o=s.n(r);t["a"]={get_instance_list(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_list/",e))},operate_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/operate/",e))},delete_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/delete/",e))},recover_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/recover/",e))},destroy_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/destroy/",e))},get_status_list(){return Object(i["a"])(Object(a["b"])("GET","/ecs/ecs_status_list/"))},get_family_data(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_family_data/"))},reset_password(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_reset_password/",e))},update_spec(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_configure/",e))},update_system(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_system/",e))},get_usage_ip(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_deleted_ecs_ip/",e))},get_vnc_url(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/vnc_info/",e))},start_charge(e){return Object(i["a"])(Object(a["b"])("POST","/resource/start_charge/",e))},change_config_price(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_config_price/",e))},change_system_price(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_system_price/",e))},each_resource_price(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/each_resource_price/",e))},add_common_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/create_pub_image_by_ecs/",e))},set_net(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_set_base_nic/",e))},get_default_dns(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/az_default_dns/",e))},mount_gpu_card(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/instance_gpu_card/",e))},update_gpu_status(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/update_gpu_status/",e))},export_list(e){return Object(i["a"])({method:"GET",url:"/ecs_business/v1/ecs/ecs_list_download/",params:e,paramsSerializer:e=>o.a.stringify(e),responseType:"blob"})},get_tag_list(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_tag_list/"))},get_rescue_image_list(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_rescue_image_list/",e))},enter_rescue(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/enter_rescue/",e))},exit_rescue(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/exit_rescue/",e))}}},e8c0:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s("cf88");function a(e,t,s){s.preventDefault(),document.addEventListener("contextmenu",e=>{const t=e.target;if(t.closest(".el-table")){let t=document.querySelector("#menu");if(t){t.style.display="block";let s=t.offsetHeight,a=t.offsetWidth;console.log("menuHeight",s);let r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=e.clientX,c=e.clientY,l=n,_=c;o<n+a&&(l=n-a),r<c+s&&(_=r-s),t.style.left=l-250+"px",t.style.top=_-50+"px",t.style.display="block",t.style.zIndex="1000",document.addEventListener("click",i["a"])}}}),document.addEventListener("contextmenu",i["a"])}},ee63:function(e,t,s){"use strict";s("754a")},f33c:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_disk_list(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/get_disk_list/",e))},get_disk_state(e){return Object(i["a"])(Object(a["b"])("GET","/ebs/disk_status/",e))},edit_disk_name(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/disk_name_update/",e))},edit_disk_attr(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/disk_property_update/ ",e))},mount(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/mount/",e))},unmount(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/unmount/",e))},del_disk(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/delete/",e))},recover(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/recover/",e))},destroy(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/destroy_disk/",e))},expansion(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/expansion/",e))},get_fee(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/each_resource_price/",e))},open_bill(e){return Object(i["a"])(Object(a["b"])("POST","/resource/start_charge/",e))},get_product_source(e){return Object(i["a"])(Object(a["b"])("GET","/ebs/disk_product_source/",e))},change_iops_mbps(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/change_iops_mbps/",e))},iops_mbps_record(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/iops_mbps_record/",e))},get_iops_mbps_limit(){return Object(i["a"])(Object(a["b"])("GET","/ebs/get_iops_mbps_limit/"))}}},f509:function(e,t,s){},f813:function(e,t,s){"use strict";s("9409")}}]);