(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-36f67780"],{"8af8":function(e,t,a){"use strict";a("b61d")},b61d:function(e,t,a){},d81d:function(e,t,a){"use strict";var n=a("23e7"),s=a("b727").map,i=a("1dde"),r=i("map");n({target:"Array",proto:!0,forced:!r},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},e6d8:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"instance-list"},[a("action-block",{attrs:{search_option:e.search_con,type:!1},on:{"fn-search":e.FnSearch}}),a("el-table",{attrs:{data:e.gpu_list,border:""},on:{"filter-change":e.handleFilterChange}},[a("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),a("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),a("el-table-column",{attrs:{prop:"host_name",label:"主机名"}}),a("el-table-column",{attrs:{prop:"host_id",label:"物理机ID",width:"200px"}}),a("el-table-column",{attrs:{prop:"host_ip",label:"管理网IP"}}),a("el-table-column",{attrs:{prop:"card_name",label:"GPU"}}),a("el-table-column",{attrs:{label:"Slot号",prop:"slot"}}),a("el-table-column",{attrs:{label:"PCIe号",prop:"pci_address"}}),a("el-table-column",{attrs:{label:"SN号",prop:"sn"}}),a("el-table-column",{attrs:{label:"状态",prop:"status","column-key":"status",filters:e.status_list,"filter-multiple":!1},scopedSlots:e._u([{key:"default",fn:function(t){return["禁售"===t.row.status?a("span",[a("el-tooltip",{attrs:{content:t.row.message,"popper-class":"tooltip-width",placement:"bottom",effect:"light"}},[a("span",{staticClass:"id-cell"},[e._v(e._s(t.row.status))])])],1):a("span",{class:["FF"===t.row.status?"err":"normal"]},[e._v(e._s(t.row.status))])]}}])}),a("el-table-column",{attrs:{label:"监控"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.FnGoToMonitor(t.row)}}},[e._v("查看监控")])]}}])}),a("el-table-column",{attrs:{label:"所属云主机",prop:"vm_id"}}),a("el-table-column",{attrs:{label:"创建时间",prop:"create_time"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"update_time"}}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",disabled:!e.operate_auth.includes("update")},on:{click:function(a){return e.FnEdit(t.row)}}},[e._v("编辑")]),"禁售"===t.row.status?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.FnHandleGpuSale(t.row,"cancel_forbid")}}},[e._v("取消禁售")]):a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.FnHandleGpuSale(t.row,"forbid")}}},[e._v("禁售")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.FnSync(t.row)}}},[e._v("同步")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.page_info.page_index,"page-sizes":e.page_info.page_sizes,"page-size":e.page_info.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.page_info,"page_index",t)},"update:current-page":function(t){return e.$set(e.page_info,"page_index",t)},"update:pageSize":function(t){return e.$set(e.page_info,"page_size",t)},"update:page-size":function(t){return e.$set(e.page_info,"page_size",t)}}}),a("gpu-edit",{attrs:{visible:e.visible,oper_info:e.oper_info},on:{"update:visible":function(t){e.visible=t}}}),a("Sale",{attrs:{oper_info:e.oper_info,visible:e.visible_sale,type:e.hand_type},on:{"update:visible":function(t){e.visible_sale=t}}})],1)},s=[],i=a("5530"),r=a("1da1"),o=a("d4ec"),l=a("bee2"),c=a("262e"),u=a("2caf"),p=(a("96cf"),a("b0c0"),a("a15b"),a("d81d"),a("9ab4")),_=a("1b40"),d=a("c811"),h=a("c1df"),b=a.n(h),f=a("8693"),m=a("d220"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"forbid"===e.type?"禁售":"取消禁售",visible:e.visible_sync,width:"800px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:function(t){e.visible_sync=!1}}},[a("el-alert",{attrs:{title:"是否确定要对以下实例执行 "+("forbid"===e.type?"禁售":"取消禁售")+" 操作",type:"warning",closable:!1,center:""}}),a("el-table",{attrs:{data:e.oper_info,border:""}},[a("el-table-column",{attrs:{prop:"card_name",label:"GPU"}}),a("el-table-column",{attrs:{prop:"host_id",label:"物理机ID"}}),a("el-table-column",{attrs:{prop:"host_name",label:"主机名"}}),a("el-table-column",{attrs:{prop:"pci_address",label:"PCIe号"}}),"forbid"===e.type?a("el-table-column",{attrs:{prop:"lock",label:"禁售原因"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",placeholder:"请输入禁售原因",maxlength:"50","show-word-limit":""},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.reason,expression:"!reason"}],staticClass:"error_message"},[e._v("请输入禁售原因")])]}}],null,!1,3678557658)}):e._e()],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),a("el-button",{on:{click:function(t){e.visible_sync=!1}}},[e._v("取消")])],1)],1)],1)},g=[],y=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.reason="",e}return Object(l["a"])(a,[{key:"watch_visible",value:function(e){e||(this.reason="")}},{key:"confirm",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("forbid"!==this.type||""!==this.reason){e.next=2;break}return e.abrupt("return");case 2:return t={pod_id:this.$store.state.pod_id,op_type:this.type,host_id:this.oper_info[0].host_id,pci_address:this.oper_info[0].pci_address},"forbid"===this.type&&(t["message"]=this.reason),e.next=6,f["a"].handle_gpu_sale(t);case 6:a=e.sent,"Success"===a.code&&(this.$message.success(a.message),this.visible_sync=!1);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(_["e"]);Object(p["a"])([Object(_["d"])("visible")],y.prototype,"visible_sync",void 0),Object(p["a"])([Object(_["c"])({default:function(){}})],y.prototype,"oper_info",void 0),Object(p["a"])([Object(_["c"])({default:""})],y.prototype,"type",void 0),Object(p["a"])([Object(_["f"])("visible_sync")],y.prototype,"watch_visible",null),y=Object(p["a"])([Object(_["a"])({})],y);var w=y,k=w,j=a("2877"),O=Object(j["a"])(k,v,g,!1,null,"f0da9afa",null),x=O.exports,F=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.gpu_list=[],e.search_reqData={},e.visible=!1,e.oper_info={},e.err="err",e.normal="normal",e.operate_auth=[],e.search_status=[],e.hand_type="",e.visible_sale=!1,e.status_list=[{text:"正常",value:"READY"},{text:"FF",value:"DISCONNECTED"},{text:"禁售",value:"DISABLE"}],e.page_info={page_sizes:[20,50,100],page_size:20,page_index:1,total:0},e.search_con={host_id:{placeholder:"请输入物理机ID"},vm_id:{placeholder:"请输入云服务器ID"},card_name:{placeholder:"请输入显卡名称"},host_ip:{placeholder:"请输入管理网IP"},host_name:{placeholder:"请输入主机名称"},customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},sn:{placeholder:"请输入sn号"},create_time:{placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!0,dis_day:1,defaultTime:[]}},e}return Object(l["a"])(a,[{key:"watch_visible",value:function(e){e||(this.oper_info={},this.FnGetList())}},{key:"watch_visible_sale",value:function(e){e||this.FnGetList()}},{key:"watch_pod",value:function(e){e&&this.FnGetList()}},{key:"handleFilterChange",value:function(e){this.search_status=e.status,console.log("this.search_status",this.search_status),this.FnGetList()}},{key:"created",value:function(){this.FnGetList(),this.operate_auth=this.$store.state.auth_info[this.$route.name]}},{key:"FnEdit",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.visible=!0,this.oper_info=t;case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnHandleGpuSale",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.visible_sale=!0,this.oper_info=[t],this.hand_type=a;case 3:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"FnSync",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].update_host_gpu_status({pod_id:this.$store.state.pod_id,host_id:t.host_id,pci_address:t.pci_address});case 2:a=e.sent,"Success"===a.code&&this.$message.success(a.message);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnGoToMonitor",value:function(e){this.$router.push({name:"physical_detail",query:{id:e.host_id,name:e.host_name},params:{active:"1",default_tab:"gpu"}})}},{key:"FnSearch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.search_reqData={host_id:e.host_id,vm_id:e.vm_id,card_name:e.card_name,customer_id:e.customer_id,customer_name:e.customer_name,host_ip:e.host_ip,host_name:e.host_name,sn:e.sn,create_time_start:e.create_time&&e.create_time[0]?b()(e.create_time[0]).local().format("YYYY-MM-DDTHH:mm:ss[Z]"):void 0,create_time_end:e.create_time&&e.create_time[0]?b()(e.create_time[1]).local().format("YYYY-MM-DDTHH:mm:ss[Z]"):void 0},this.FnGetList()}},{key:"FnGetList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].get_gpu_list(Object(i["a"])({pod_id:this.$store.state.pod_id,page_index:this.page_info.page_index,page_size:this.page_info.page_size,status:this.search_status.length>0?this.search_status.join(","):this.search_status.map((function(e){return e.value})).join(",")},this.search_reqData));case 2:t=e.sent,"Success"===t.code&&(this.gpu_list=t.data.page_info_list,this.page_info.total=t.data.page_info.count);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.page_info.page_size=e,this.page_info.page_index=1,this.FnGetList()}},{key:"handleCurrentChange",value:function(e){this.page_info.page_index=e,this.FnGetList()}}]),a}(_["e"]);Object(p["a"])([Object(_["f"])("visible")],F.prototype,"watch_visible",null),Object(p["a"])([Object(_["f"])("visible_sale")],F.prototype,"watch_visible_sale",null),Object(p["a"])([Object(_["f"])("$store.state.pod_id")],F.prototype,"watch_pod",null),F=Object(p["a"])([Object(_["a"])({components:{GpuEdit:m["a"],ActionBlock:d["a"],Sale:x}})],F);var S=F,z=S,D=(a("8af8"),Object(j["a"])(z,n,s,!1,null,"c39d2c62",null));t["default"]=D.exports}}]);
//# sourceMappingURL=chunk-36f67780.1745983465578.js.map