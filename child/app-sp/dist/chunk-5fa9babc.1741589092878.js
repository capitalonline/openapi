(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-5fa9babc"],{b721:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("action-block",{attrs:{search_option:e.search_dom},on:{"fn-search":e.search},scopedSlots:e._u([{key:"default",fn:function(){return e._l(e.operate_btns,(function(t){return a("el-button",{key:t.value,attrs:{type:"primary",disabled:!e.auth_list.includes(t.value)},on:{click:function(a){return e.handleBtn(t.label,t.value)}}},[e._v(e._s(t.label))])}))},proxy:!0}])}),a("el-table",{ref:"disk_table",attrs:{data:e.disk_list,border:""},on:{"selection-change":e.handleSelectionChange,"filter-change":e.filterAttribute}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),a("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),a("el-table-column",{attrs:{prop:"disk_id",label:"云盘ID"}}),a("el-table-column",{attrs:{prop:"disk_name",label:"云盘名称"}}),a("el-table-column",{attrs:{prop:"customer_id",label:"云盘状态","filter-multiple":!1,filters:e.disk_state,"column-key":"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:t.row.status},[e._v(e._s(t.row.status_name))])]}}])}),a("el-table-column",{attrs:{prop:"customer_id",label:"IOPS及吞吐","min-width":"110px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("IOPS："+e._s(t.row.disk_iops?""+t.row.disk_iops+t.row.iops_unit:""))]),a("div",[e._v("吞吐量："+e._s(t.row.band_mbps?""+t.row.band_mbps+t.row.mbps_unit:""))])]}}])}),a("el-table-column",{attrs:{prop:"customer_id",label:"地域-可用区","min-width":"110ox"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.region_name)+"  "+e._s(t.row.az_name))])]}}])}),a("el-table-column",{attrs:{prop:"customer_id",label:"属性"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s("data"===t.row.disk_type?"数据盘":"系统盘"))])]}}])}),a("el-table-column",{attrs:{prop:"customer_id",label:"实例ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.ecs_id?t.row.ecs_id:""))])]}}])}),a("el-table-column",{attrs:{prop:"dev_id",label:"dev_id"}}),a("el-table-column",{attrs:{prop:"dev_name",label:"dev_name"}}),a("el-table-column",{attrs:{prop:"cluster_name",label:"集群名称","min-width":"95px"}}),a("el-table-column",{attrs:{prop:"pool_name",label:"存储池名称"}})],1),a("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.visible?[a("Iops",{attrs:{visible:e.visible,title:e.oper_label,oper_type:e.oper_type,mount_id:e.mount_id},on:{close:e.close_disk}})]:e._e()],2)},i=[],n=a("1da1"),r=a("5530"),l=a("d4ec"),o=a("bee2"),u=a("262e"),c=a("2caf"),d=(a("96cf"),a("b0c0"),a("ac1f"),a("841c"),a("d3b7"),a("9ab4")),_=a("1b40"),p=a("c811"),h=a("a03d"),b=a("f33c"),m=a("8ce4"),f=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(l["a"])(this,a),e=t.apply(this,arguments),e.disk_list=[],e.current=1,e.size=20,e.total=0,e.filter_obj=null,e.visible=!1,e.oper_type="",e.oper_label="",e.disk_state=[],e.mount_id=[],e.req_data={},e.auth_list=[],e.search_dom={customer_id:{placeholder:"请输入客户ID"},disk_id:{placeholder:"请输入云盘ID"},ecs_id:{placeholder:"请输入实例ID"}},e.operate_btns=[{label:"设置IOPS",value:"iops"},{label:"设置吞吐量",value:"mbps"}],e}return Object(o["a"])(a,[{key:"search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.current=1,this.req_data=Object(r["a"])(Object(r["a"])({},e),this.filter_obj),this.getDataList()}},{key:"created",value:function(){this.auth_list=this.$store.state.auth_info[this.$route.name],this.get_disk_state(),this.search()}},{key:"get_disk_state",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].get_disk_state({});case 2:t=e.sent,"Success"===t.code&&(this.disk_state=Object(m["e"])(t.data,"status_name","status","text","value"));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleBtn",value:function(e,t){if(0!==this.mount_id.length)if(this.judge_disk("customer_id",this.mount_id[0].customer_id))if(this.judge_disk("az_name",this.mount_id[0].az_name)){var a=this.mount_id.every((function(e,t,a){return"running"===e.ecs_status&&"running"===e.status||"running"===e.disk_status&&"shutdown"===e.ecs_status&&e.no_charge_shutdown_ecs||"waiting"===e.status}));if(a){var s="iops"===t?"IOPS":"吞吐量";this.operate(t,s,this.mount_id)}else this.$message.warning("仅支持对实例状态为运行中且云盘状态为使用中，或云盘状态为待挂载的云盘进行批量操作！")}else this.$message.warning("只允许对同一可用区的云盘进行批量操作！");else this.$message.warning("只允许对同一客户的云盘进行批量操作！");else this.$message.warning("请先勾选云盘!")}},{key:"judge_disk",value:function(e,t){return this.mount_id.every((function(a,s,i){return a[e]===t}))}},{key:"operate",value:function(e,t,a){this.mount_id=a,this.oper_type=e,this.oper_label=t,this.visible=!0}},{key:"close_disk",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";this.visible=!1,this.mount_id=[],this.oper_type="",this.toggleSelection(),"1"===e&&(this.current=1),this.getDataList()}},{key:"toggleSelection",value:function(){var e=this.$refs.disk_table;e.clearSelection()}},{key:"handleSelectionChange",value:function(e){this.mount_id=e}},{key:"filterAttribute",value:function(e){this.filter_obj=Object(r["a"])(Object(r["a"])({},this.filter_obj),e),this.search(this.req_data)}},{key:"handleSizeChange",value:function(e){this.size=e,this.getDataList()}},{key:"handleCurrentChange",value:function(e){this.current=e,this.getDataList()}},{key:"getDataList",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.req_data,e.next=3,b["a"].get_disk_list({pod_id:this.$store.state.pod_id,disk_id:t.disk_id||"",ecs_id:t.ecs_id||"",status:t.status?t.status[0]:"",customer_id:t.customer_id||"",page_index:this.current,page_size:this.size});case 3:a=e.sent,"Success"===a.code&&(this.disk_list=a.data.result||[],this.total=a.data.page_info.count||0);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(_["e"]);f=Object(d["a"])([Object(_["a"])({components:{ActionBlock:p["a"],Iops:h["a"]}})],f);var v=f,g=v,k=a("2877"),y=Object(k["a"])(g,s,i,!1,null,"e3a26a96",null);t["default"]=y.exports},d81d:function(e,t,a){"use strict";var s=a("23e7"),i=a("b727").map,n=a("1dde"),r=n("map");s({target:"Array",proto:!0,forced:!r},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-5fa9babc.1741589092878.js.map