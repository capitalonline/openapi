(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-44c2710f"],{"039b":function(t,e,s){"use strict";var i=s("81a9"),a=s("bff7");e["a"]={get_snapshot_list(t){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_list/",t))},get_snapshot_chains_list(t){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_list/",t))},chains_detail(t){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_detail/",t))},record(t){return Object(i["a"])(Object(a["b"])("GET","/snapshot/history_record/",t))},get_monitor_id(t){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_disk_ids/",t))},get_snapshot_info(t){return Object(i["a"])(Object(a["i"])("POST","/snapshot/snapshot_use_monitor",t))}}},"07a7":function(t,e,s){"use strict";s("c4e3")},1477:function(t,e,s){"use strict";var i=s("81a9"),a=s("bff7");e["a"]={get_host_list(t){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_list/",t))},get_room_list(t){return Object(i["a"])(Object(a["d"])("GET","/host/machine_room_list/",t))},get_status_list(t){return Object(i["a"])(Object(a["d"])("GET","/host/host_status_list/",t))},external_management(t){return Object(i["a"])(Object(a["d"])("GET","/host/external_management/",t))},migrate(t){return Object(i["a"])(Object(a["d"])("POST","/host/migration_operation/",t))},disperse(t){return Object(i["a"])(Object(a["d"])("POST","/host/disperse_operation/",t))},record(t){return Object(i["a"])(Object(a["d"])("POST","/host/host_operation_record/",t))},recommended_host(t){return Object(i["a"])(Object(a["d"])("POST","/host/recommended_host/",t))},host_maintenance(t){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",t))},finish_maintenance(t){return Object(i["a"])(Object(a["d"])("POST","/host/host_finish_maintenance/",t))},shelves(t){return Object(i["a"])(Object(a["d"])("POST","/host/host_off_shelves/",t))},get_detail_overview(t){return Object(i["a"])(Object(a["d"])("GET","/host/host_main_details/",t))},get_detail_storage(t){return Object(i["a"])(Object(a["d"])("GET","/host/host_disk/",t))},down(t){return Object(i["a"])(Object(a["d"])("GET","/host/host_list_download/",t))},host_operate(t){return Object(i["a"])(Object(a["d"])("POST","/host/operate/",t))},host_import(t){return Object(i["a"])(Object(a["d"])("POST","/host/import/",t))},get_host_attribution(t){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_attribution/",t))},set_host_attribution(t){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_attribution/",t))},get_host_type(t){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_config/",t))},update_attribute(t){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_config/",t))},getCustomerList(t){return Object(i["a"])(Object(a["d"])("POST","/host/get_customer_list/",t))},getFamilyList(t){return Object(i["a"])(Object(a["d"])("POST","/host/get_family_list/",t))},finish_validate(t){return Object(i["a"])(Object(a["d"])("POST","/host/verification_finish/",t))},get_host_recycle_department(t){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_recycle_department/",t))},get_host_list_field(t){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_list_field/",t))},get_task_list(t){return Object(i["a"])(Object(a["d"])("GET","/host/business_test_task/",t))},create_test_task(t){return Object(i["a"])(Object(a["d"])("POST","/host/create_test_task/",t))},get_host_filter_item(t){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_filter_item/",t))},set_remark(t){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_remark/",t))},set_flag(t){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_tag/",t))},update_ecs_info(t){return Object(i["a"])(Object(a["d"])("POST","/ecs/update_ecs_info/",t))},crash_clear(t){return Object(i["a"])(Object(a["b"])("POST","/host/crash_clear/",t))},crash_recover(t){return Object(i["a"])(Object(a["b"])("POST","/host/crash_recover/",t))},set_lock(t){return Object(i["a"])(Object(a["d"])("POST","/host/host_lock/",t))},set_unlock(t){return Object(i["a"])(Object(a["d"])("POST","/host/host_unlock/",t))},set_maintenance(t){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",t))},get_maintenance_record(t){return Object(i["a"])(Object(a["d"])("GET","/host/host_maintenance_record/",t))},get_lock_record(t){return Object(i["a"])(Object(a["d"])("GET","/host/host_lock_record/",t))},recover_storage_error(t){return Object(i["a"])(Object(a["d"])("POST","/host/recover_storage_error/",t))},agent_update(t){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_update/",t))},agent_rollback(t){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_rollback/",t))},set_prepare_host(t){return Object(i["a"])(Object(a["d"])("POST","/host/set_prepare_host/",t))},get_ovs_version(t){return Object(i["a"])(Object(a["d"])("GET","/host/ovs_version_list/",t))}}},"1e42":function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"复制",placement:"bottom"}},[e("el-button",{attrs:{type:"text"},on:{click:t.copyText}},[e("svg-icon",{attrs:{icon:"copy"}})],1)],1)},a=[],o=s("9ab4"),n=s("1b40"),r=s("3673");let c=class extends n["e"]{copyText(){this.$copyText(this.content).then(()=>{this.$message.success({message:"复制成功"})}).catch(()=>{this.$message.error({message:"复制失败"})})}};Object(o["a"])([Object(n["c"])({default:""})],c.prototype,"content",void 0),c=Object(o["a"])([Object(n["a"])({components:{SvgIcon:r["a"]}})],c);var l=c,_=l,u=(s("22c9"),s("2877")),h=Object(u["a"])(_,i,a,!1,null,"23bfc843",null);e["a"]=h.exports},"22c9":function(t,e,s){"use strict";s("79c1")},"268f":function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("el-dialog",{attrs:{title:"操作记录",visible:t.visible,width:"60%","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e},close:t.back}},[e("div",[e("el-dialog",{attrs:{title:"响应信息",visible:t.res_visible,width:"60%","destroy-on-close":!0,"append-to-body":"","custom-class":"response-data"},on:{"update:visible":function(e){t.res_visible=e},close:t.clost_res}},[e("div",[t._v(t._s(t.response))])])],1),e("div",[e("action-block",{attrs:{search_option:["physical","message"].includes(t.type)?{...t.search}:t.search},on:{"fn-search":t.fn_search}}),["physical","message"].includes(t.type)?e("div",{staticClass:"icon m-bottom10"},[e("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[e("el-button",{attrs:{type:"text"},on:{click:t.getOperateRecordList}},[e("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1)],1):t._e(),e("el-table",{staticClass:"record-table",attrs:{data:t.record_list,border:""}},[e("el-table-column",{attrs:{prop:"oper_time",label:"操作时间"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.oper_time?t.moment(s.row.oper_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),e("el-table-column",{attrs:{prop:"oper_type_display",label:"操作内容"}}),e("el-table-column",{attrs:{prop:"status_display",label:"状态"}}),["message","physical"].includes(t.type)?e("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.response?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.view(s.row.response)}}},[t._v("查看")]):e("span",[t._v("-")])]}}])}):e("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:t._u([{key:"default",fn:function(s){return[s.row.result?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.view(s.row.result)}}},[t._v("查看")]):e("span",[t._v("-")])]}}],null,!1,79404134)}),e("el-table-column",{attrs:{prop:"finish_time",label:"完成时间"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.finish_time?t.moment(s.row.finish_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),e("el-table-column",{attrs:{prop:"oper_user",label:"nas"===t.type?"操作用户":"用户名"}}),["physical","message"].includes(t.type)?t._e():e("el-table-column",{attrs:{prop:"flag_display",label:"操作标识"}})],1),e("el-pagination",{attrs:{"current-page":t.current,"page-sizes":[20,50,100],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.back}},[t._v("返回")])],1)],1)])],1)},a=[],o=s("9ab4"),n=s("1b40"),r=s("c811"),c=s("d772"),l=s("1477"),_=s("e4d0"),u=s("039b"),h=s("fc43"),d=s("c1df"),p=s.n(d),b=s("8ce4"),m=s("3673");let f=class extends n["e"]{constructor(){super(...arguments),this.state_list=[{type:"",label:"全部"},{type:"doing",label:"执行中"},{type:"success",label:"成功"},{type:"failed",label:"失败"}],this.search={state:{list:this.state_list,placeholder:"请选择状态"},content:{placeholder:"请输入操作内容"}},this.record_list=[],this.current=1,this.size=20,this.total=0,this.search_data={},this.moment=p.a,this.response="",this.res_visible=!1}created(){this.fn_search()}fn_search(t={}){this.current=1,this.search_data=t,this.getOperateRecordList()}async getOperateRecordList(){let t;const{search_data:e}=this;let s="physical"!==this.type?{task_type:e.content,cloud_id:this.record_id}:{content:e.content,cloud_id:this.record_id,cloud_type:"host"},i={status:e.state||"",page_size:this.size,page_index:this.current,...s};if(t="physical"===this.type?await l["a"].record({...i}):"message"===this.type?await _["a"].get_pub_operate_record({os_id:this.record_id,status:e.state||"",content_type:e.content,page_size:this.size,page_index:this.current}):"snapshot"===this.type?await u["a"].record({cloud_id:this.record_id,cloud_type:"snapshot",status:e.state||"",task_type:e.content,page_size:this.size,page_index:this.current}):"nas"===this.type?await h["a"].get_nas_record({...i}):await c["a"].get_operate_record_list({cloud_type:this.type?this.type:"ecs",...i}),"Success"===t.code){var a,o;if(["physical","message"].includes(this.type)){let e=["create_time","content","status_name","response","update_time","op_user"],s=["oper_time","oper_type_display","status_display","response","finish_time","oper_user"];this.record_list=Object(b["b"])(t.data.operation_list,s,e)}else{var n;this.record_list=(null===(n=t.data)||void 0===n?void 0:n.history_record)||[]}this.total=(null===(a=t.data)||void 0===a||null===(o=a.page_info)||void 0===o?void 0:o.count)||0}}handleSizeChange(t){this.size=t,this.getOperateRecordList()}handleCurrentChange(t){this.current=t,this.getOperateRecordList()}view(t){this.response=t,this.res_visible=!0}clost_res(){this.res_visible=!1,this.response=""}back(){}};Object(o["a"])([Object(n["c"])(Boolean)],f.prototype,"visible",void 0),Object(o["a"])([Object(n["c"])(String)],f.prototype,"record_id",void 0),Object(o["a"])([Object(n["c"])(String)],f.prototype,"type",void 0),Object(o["a"])([Object(n["b"])("close")],f.prototype,"back",null),f=Object(o["a"])([Object(n["a"])({components:{ActionBlock:r["a"],SvgIcon:m["a"]}})],f);var g=f,O=g,v=(s("f813"),s("2877")),j=Object(v["a"])(O,i,a,!1,null,null,null);e["a"]=j.exports},"4e32":function(t,e,s){},"77dc":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("action-block",{attrs:{search_option:t.search_option},on:{"fn-search":t.search}}),e("div",{staticClass:"icon m-bottom10"},[e("el-tooltip",{attrs:{content:"自定义列表项",placement:"bottom",effect:"light"}},[e("el-button",{attrs:{type:"text"},on:{click:t.FnCustom}},[e("i",{staticClass:"el-icon-s-tools"})])],1),e("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[e("el-button",{attrs:{type:"text",disabled:t.auth_list.includes("export")},on:{click:t.down}},[e("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1),e("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[e("el-button",{attrs:{type:"text"},on:{click:t.refresh}},[e("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1)],1),e("el-table",{attrs:{data:t.list,border:""}},[t._l(t.custom_host,(function(s){return e("el-table-column",{key:s.prop,attrs:{"filter-multiple":!s.column_key&&null,prop:s.prop,"column-key":s.column_key?s.column_key:null,filters:s.column_key?s.list:null,sortable:s.sortable?s.sortable:null,width:s.width?s.width:null,label:s.label,type:s.type},scopedSlots:t._u(["nas_id_name"===s.prop?{key:"default",fn:function(s){return[e("div",[e("el-tooltip",{attrs:{content:s.row.nas_id,placement:"bottom",effect:"light"}},[["building","build_fail"].includes(s.row.status)?e("span",{staticClass:"not-clickable"},[t._v(t._s(s.row.nas_id))]):e("span",{staticClass:"id-cell clickble",on:{click:function(e){return t.detail(s.row.nas_id)}}},[t._v(t._s(s.row.nas_id))])]),s.row.nas_id?e("Clipboard",{attrs:{content:s.row.nas_id}}):t._e()],1),e("div",[t._v(t._s(s.row.nas_name))])]}}:"region_az_name"===s.prop?{key:"default",fn:function(s){return[e("span",[t._v(t._s(`${s.row.region_name}-${s.row.az_name}`))])]}}:"vpc"===s.prop?{key:"default",fn:function(s){return[e("div",{staticClass:"not-clickable"},[t._v(t._s(s.row.vpc_id))]),e("div",[t._v(t._s(s.row.vpc_name))])]}}:"subnet"===s.prop?{key:"default",fn:function(s){return[e("div",{staticClass:"not-clickable"},[t._v(t._s(s.row.subnet_id))]),e("div",[t._v(t._s(s.row.subnet_name))])]}}:"mount_path"===s.prop?{key:"default",fn:function(s){return[e("el-tooltip",{attrs:{content:s.row.mount_path[0],placement:"bottom",effect:"light"}},[e("span",{staticClass:"id-cell"},[t._v(t._s(s.row.mount_path[0]))])]),s.row.mount_path?e("Clipboard",{attrs:{content:s.row.mount_path[0]}}):t._e()]}}:"transfer_vpc_storage_ip"===s.prop?{key:"default",fn:function(s){return[e("div",[t._v("VPC:"+t._s(s.row.transfer_vm_vpc_ip))]),e("div",[t._v("存储网:"+t._s(s.row.transfer_vm_storage_ip))])]}}:"billing_method"===s.prop?{key:"default",fn:function(s){return[e("span",[t._v(t._s(t.feeInfo[s.row.billing_method]))])]}}:"status_ch"===s.prop?{key:"default",fn:function(s){return[e("span",{class:s.row.status},[t._v(t._s(s.row.status_ch))])]}}:"create_time"===s.prop?{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.create_time?t.moment(s.row.create_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}:null],null,!0)})})),e("el-table-column",{attrs:{prop:"operate",label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(s){return["running"===s.row.status&&t.auth_list.includes("file_capacity")?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.capacity(s.row)}}},[t._v("扩容")]):e("el-tooltip",{attrs:{placement:"right",effect:"light",content:"只有运行中的文件系统才可以扩容"}},[e("span",{staticClass:"not-clickable m-right10",attrs:{type:"text"}},[t._v("扩容")])]),e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.record(s.row)}}},[t._v("操作记录")])]}}])})],2),e("el-pagination",{attrs:{"current-page":t.current,"page-sizes":[20,50,100],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t.visible?[e("capacity",{attrs:{visible:t.visible,info:t.operateInfo},on:{"update:visible":function(e){t.visible=e}}})]:t._e(),t.recordVisible?[e("record",{attrs:{visible:t.recordVisible,record_id:t.operateInfo.nas_id,type:"nas"},on:{close:t.closeRecord}})]:t._e(),e("custom-list-item",{attrs:{visible:t.show_custom,all_item:t.all_item,all_column_item:t.all_column_item,type:"nas"},on:{"update:visible":function(e){t.show_custom=e},"fn-custom":t.get_custom_columns}})],2)},a=[],o=(s("14d9"),s("e9f5"),s("910d"),s("ab43"),s("9ab4")),n=s("1b40"),r=s("c811"),c=s("3673"),l=s("fc43"),_=s("c1df"),u=s.n(_),h=s("1e42"),d=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-dialog",{attrs:{title:"扩容",visible:t.visibleSync,width:"700px","close-on-click-modal":!1},on:{"update:visible":function(e){t.visibleSync=e}}},[t._l(t.configInfo,(function(s,i){return e("div",{key:i,staticClass:"m-bottom10"},[e("span",{staticClass:"label"},[t._v(t._s(s.label))]),e("span",{staticClass:"label"},[t._v(t._s(s.value))])])})),e("div",[e("span",{staticClass:"label"},[t._v("扩容后容量:")]),e("span",[e("el-input",{staticClass:"size",on:{keyup:function(e){t.value=t.value.replace(/^(0+)|[^\d]+/g,"")}},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}}),e("el-select",{model:{value:t.unit,callback:function(e){t.unit=e},expression:"unit"}},t._l(t.unitList,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t.text.test(Number(t.size))?t.getIsMin()?("TB"===t.unit?Number(t.size)>64:Number(t.size)>65536)?e("div",{staticClass:"error_message m-l-73"},[t._v("扩容后容量不能大于64TB")]):t._e():e("div",{staticClass:"error_message m-l-73"},[t._v("扩容后容量不能小于或者等于当前容量")]):e("div",{staticClass:"error_message m-l-73"},[t._v("请输入正整数")]),e("div",{staticClass:"prompt_message m-top10"},[t._v("说明：扩容后容量不能小于或者等于当前容量")])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",disabled:Math.ceil(t.max)>=64},on:{click:t.confirm}},[t._v("确 定")]),e("el-button",{on:{click:function(e){t.visibleSync=!1}}},[t._v("取 消")])],1)],2)},p=[];let b=class extends n["e"]{constructor(){super(...arguments),this.configInfo={customer_id:{label:"客户ID:",value:""},customer_name:{label:"客户名称:",value:""},nas_id:{label:"文件系统ID:",value:""},nas_name:{label:"文件系统名称:",value:""},total:{label:"当前容量:",value:""},used:{label:"当前使用量:",value:""}},this.size=0,this.unit="",this.unitList=["GB","TB"],this.units=["B","KB","MB","GB","TB","PB","EB","ZB"],this.clear=null,this.max=0,this.min=0,this.text=new RegExp("^[0-9]*[1-9][0-9]*$")}created(){for(let t in this.configInfo)this.configInfo[t].value=this.info[t];this.getFileUse()}beforeDestroy(){this.FnClearTimer()}FnSetTimer(){this.clear&&this.FnClearTimer(),this.clear=setTimeout(()=>{this.getFileUse(!1)},6e4)}FnClearTimer(){this.clear&&clearTimeout(this.clear)}async getFileUse(t=!0){t||this.$store.commit("SET_LOADING",!1);let e=await l["a"].get_file_use({region_id:this.info.region_id,volume_ids:[this.info.nas_id]});if("Success"===e.code){let t=this.info.nas_id;this.configInfo.used.value=this.computeUnit(e.data[t]&&e.data[t].used?e.data[t].used:0),this.configInfo.total.value=this.computeUnit(e.data[t]&&e.data[t].total?e.data[t].total:0);let s=this.configInfo.total.value.slice(-2);this.size=Math.ceil(Number(this.configInfo.total.value.slice(0,-2))),this.max=e.data[t].total?Number(e.data[t].total)/1024/1024/1024/1024:0,this.min=e.data[t].total?Number(e.data[t].total)/1024/1024/1024:0,["GB","TB"].includes(s)?this.unit=s:this.unit="GB"}this.FnSetTimer()}getIsMin(){let t=!0;return t="TB"===this.unit&&this.configInfo.total.value.indexOf("TB")>-1?this.size>Number(this.max.toFixed(2)):"TB"===this.unit&&this.configInfo.total.value.indexOf("GB")>-1?this.size>0:"GB"===this.unit&&this.configInfo.total.value.indexOf("TB")>-1?this.size>1024*Number(this.max.toFixed(2)):this.size>Number(this.min.toFixed(2)),t}computeUnit(t,e=0){return t>=1024?this.computeUnit(t/1024,++e):t.toFixed(2)+this.units[e]}async confirm(){if(!this.unit)return;if(!this.text.test(this.size))return;if("TB"===this.unit&&Number(this.size)>64||Number(this.size)>65536||!this.getIsMin())return;const{region_id:t,az_id:e,nas_id:s,customer_id:i}=this.info;let a=await l["a"].capacity({region_id:t,az_id:e,nas_id:s,size:this.size,unit:this.unit,customer_id:i});"Success"===a.code&&(this.$message.success(a.message),this.visibleSync=!1)}create(){}};Object(o["a"])([Object(n["d"])("visible")],b.prototype,"visibleSync",void 0),Object(o["a"])([Object(n["c"])({default:()=>{}})],b.prototype,"info",void 0),Object(o["a"])([Object(n["b"])("fn-create")],b.prototype,"create",null),b=Object(o["a"])([Object(n["a"])({components:{}})],b);var m=b,f=m,g=(s("d634"),s("2877")),O=Object(g["a"])(f,d,p,!1,null,"92b0f840",null),v=O.exports,j=s("8ce4"),y=s("af7d"),T=s("268f");let w=class extends n["e"]{constructor(){super(...arguments),this.moment=u.a,this.units=["B","KB","MB","GB","TB","PB","EB","ZB"],this.search_option={customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},nas_id:{placeholder:"请输入文件系统ID"},nas_name:{placeholder:"请输入文件系统名称"},transfer_vm_id:{placeholder:"请输入中转虚拟机ID"},transfer_vm_ip:{placeholder:"请输入中转虚拟机IP"}},this.list=[],this.current=1,this.size=20,this.total=0,this.search_data={},this.auth_list=[],this.operateInfo={},this.clear=null,this.visible=!1,this.recordVisible=!1,this.show_custom=!1,this.all_item=[],this.all_column_item=[],this.custom_host=[],this.feeInfo={0:"按需计费",1:"包年包月",2:"按次计费"}}created(){this.get_field(),this.auth_list=this.$store.state.auth_info[this.$route.name],this.search()}watch_visible(t){t||this.getNasList()}watch_pod(){this.search(this.search_data)}async get_field(){let t=await l["a"].get_field({});if("Success"===t.code){let e=["field_name","show_name"],s=["prop","label"],i=[];t.data.map(t=>(i=[...i,...t.filed],t)),this.all_item=t.data,this.all_column_item=Object(j["b"])(i,s,e),this.get_custom_columns(this.$store.state.nas_host)}}get_custom_columns(t){0!==t.length&&(this.custom_host=this.all_column_item.filter(e=>t.includes(e.label)),this.custom_host.map(t=>("nas_id_name"===t.prop&&(t=Object.assign(t,{},{width:"120px"})),"mount_path"===t.prop&&(t=Object.assign(t,{},{width:"180px"})),"create_time"===t.prop&&(t=Object.assign(t,{},{width:"90px"})),t)))}down(){let t={pod_id:this.$store.state.pod_id,field_names:JSON.stringify(this.custom_host.map(t=>t.prop))},e="";for(let i in t)t[i]&&(e+=`${i}=${t[i]}&`);let s=""===e?"":"?"+e.slice(0,e.length-1);window.location.href="/nas_union_business/v1/nas/nas_list_download/"+s}async getNasList(t=!0){t||this.$store.commit("SET_LOADING",!1);let e=await l["a"].get_nas_list({...this.search_data,pod_id:this.$store.state.pod_id,page_index:this.current,page_size:this.size});"Success"===e.code&&(this.list=e.data.nas_list,this.total=e.data.page.count,this.getFileUse(!1)),this.FnSetTimer()}FnSetTimer(){this.clear&&this.FnClearTimer(),this.clear=setTimeout(()=>{this.getNasList(!1)},6e4)}FnClearTimer(){this.clear&&clearTimeout(this.clear)}FnCustom(){this.show_custom=!0}async getFileUse(t=!0){if(t||this.$store.commit("SET_LOADING",!1),0===this.list.length)return;let e=await l["a"].get_file_use({region_id:this.list[0].region_id,volume_ids:this.list.map(t=>t.nas_id)});"Success"===e.code&&this.list.map(t=>{let s=this.computeUnit(e.data[t.nas_id]&&e.data[t.nas_id].used?e.data[t.nas_id].used:0),i=this.computeUnit(e.data[t.nas_id]&&e.data[t.nas_id].total?e.data[t.nas_id].total:0),a=e.data[t.nas_id]&&e.data[t.nas_id].used&&e.data[t.nas_id].total?(100*Number(e.data[t.nas_id].used/e.data[t.nas_id].total)).toFixed(2):"0.00";this.$set(t,"use_percent",a+"%"),this.$set(t,"use_size",`${s} / ${i}`)})}search(t={}){this.FnClearTimer(),this.current=1,this.search_data={...t},this.getNasList()}refresh(){this.FnClearTimer(),this.getNasList()}handleSizeChange(t){this.FnClearTimer(),this.size=t,this.getNasList()}handleCurrentChange(t){this.FnClearTimer(),this.current=t,this.getNasList()}detail(t){this.FnClearTimer(),this.$router.push({path:"fielsystem/detail",query:{id:t}})}capacity(t){this.FnClearTimer(),this.visible=!0,this.operateInfo=t}computeUnit(t,e=0){return t>=1024?this.computeUnit(t/1024,++e):t.toFixed(2)+this.units[e]}record(t){this.FnClearTimer(),this.recordVisible=!0,this.operateInfo=t}closeRecord(){this.recordVisible=!1}beforeDestroy(){this.FnClearTimer()}};Object(o["a"])([Object(n["f"])("visible")],w.prototype,"watch_visible",null),Object(o["a"])([Object(n["f"])("$store.state.pod_id")],w.prototype,"watch_pod",null),w=Object(o["a"])([Object(n["a"])({components:{ActionBlock:r["a"],SvgIcon:c["a"],Clipboard:h["a"],Capacity:v,CustomListItem:y["a"],Record:T["a"]}})],w);var S=w,k=S,x=(s("88ed"),s("07a7"),Object(g["a"])(k,i,a,!1,null,"18f2246b",null));e["default"]=x.exports},"79c1":function(t,e,s){},"88ed":function(t,e,s){"use strict";s("edc9")},"8ce4":function(t,e,s){"use strict";s.d(e,"e",(function(){return i})),s.d(e,"b",(function(){return a})),s.d(e,"a",(function(){return o})),s.d(e,"c",(function(){return n})),s.d(e,"d",(function(){return r}));s("14d9"),s("e9f5"),s("ab43");function i(t,e,s,i,a){let o=[];return t.map(t=>{o.push({[i]:t[e],[a]:t[s]})}),o}function a(t,e,s,i={}){let a=[];return t.map(t=>{let o={};e.map((e,i)=>{o[e]=t[s[i]]}),a.push({...o,...i})}),a}function o(t,e=!1){let s={};for(let i in t){const{billing_scheme_id:a,billing_cycle_id:o,billing_items:n,gic_goods_id:r}=t[i];let c={};for(let t in n){let s={attr_id:n[t].attr_id,name:n[t].name},i={id:n[t].id,key:t};c[t]=e?{...s,...i}:i}s[i]={billing_scheme_id:a,billing_cycle_id:o,billing_items:c,gic_goods_id:e?r:void 0}}return s}function n(t,e){return t.map(t=>t[e])}function r(t){let e="";for(let s in t)t[s]&&(e+=`${s}=${t[s]}&`);return""===e?"":"?"+e.slice(0,e.length-1)}},9409:function(t,e,s){},ab43:function(t,e,s){"use strict";var i=s("23e7"),a=s("c65b"),o=s("59ed"),n=s("825a"),r=s("46c4"),c=s("c5cc"),l=s("9bdd"),_=s("2a62"),u=s("2baa"),h=s("f99f"),d=s("c430"),p=!d&&!u("map",(function(){})),b=!d&&!p&&h("map",TypeError),m=d||p||b,f=c((function(){var t=this.iterator,e=n(a(this.next,t)),s=this.done=!!e.done;if(!s)return l(t,this.mapper,[e.value,this.counter++],!0)}));i({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(t){n(this);try{o(t)}catch(e){_(this,"throw",e)}return b?a(b,this,t):new f(r(this),{mapper:t})}})},af7d:function(t,e,s){"use strict";var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-dialog",{attrs:{visible:t.visible,title:"自定义列表项","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"m-bottom10"},[t._v("清除缓存或者更换浏览器，自定义列表失效"),e("span",{staticClass:"warning_message m-left10"},[t._v("(最少选择5项，最多选择25项)")])]),e("div",{staticClass:"item"},[t._l(t.all_item,(function(s){return[e("div",{staticClass:"label"},[t._v(t._s(s.name))]),e("div",{class:[t.newView?"checkbox-box2":"checkbox-box"]},[e("el-checkbox-group",{model:{value:t.select_item,callback:function(e){t.select_item=e},expression:"select_item"}},t._l(s.filed,(function(t){return e("el-checkbox",{key:t.show_name,attrs:{label:t.show_name,disabled:"主机名"===t.show_name}})})),1)],1)]}))],2),e("span",[t._v("已选择："),e("span",{staticClass:"num_message"},[t._v(t._s(t.select_item.length))])]),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.FnConfirm}},[t._v("确 定")]),e("el-button",{on:{click:t.FnClose}},[t._v("取 消")])],1)])},a=[],o=(s("e9f5"),s("ab43"),s("9ab4")),n=s("1b40");let r=class extends n["e"]{constructor(){super(...arguments),this.select_item=[],this.typeObj={host:{func:"SET_CUSTOM_HOST",value:"custom_host"},nas:{func:"SET_NAS_HOST",value:"nas_host"},cluster:{func:"SET_CLUSTER_HOST",value:"pod"},pod_host:{func:"SET_HOST_LIST",value:"pod"},pod_vm:{func:"SET_VM_HOST",value:"pod"}}}created(){"cluster"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].cluster_host):"pod_host"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].host_list):"pod_vm"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].vm_host):this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value])}FnHandleSelectItem(t){t.length>0?this.select_item=[...t]:this.select_item=this.all_column_item.slice(0,25).map(t=>t.label),this.FnEmit()}FnConfirm(){this.select_item.length<5||this.select_item.length>25?this.$message.warning("自定义列表项最少为5项，最多为25项"):(this.$store.commit(this.typeObj[this.type].func,this.select_item),this.FnEmit(),this.FnClose())}FnClose(){this.$emit("update:visible",!1)}FnEmit(){return this.select_item}};Object(o["a"])([Object(n["c"])({default:!1})],r.prototype,"visible",void 0),Object(o["a"])([Object(n["c"])({default:"host"})],r.prototype,"type",void 0),Object(o["a"])([Object(n["c"])({default:()=>[]})],r.prototype,"all_column_item",void 0),Object(o["a"])([Object(n["c"])({default:()=>[]})],r.prototype,"all_item",void 0),Object(o["a"])([Object(n["c"])({default:!1})],r.prototype,"newView",void 0),Object(o["a"])([Object(n["b"])("fn-custom")],r.prototype,"FnEmit",null),r=Object(o["a"])([n["a"]],r);var c=r,l=c,_=(s("ea55"),s("2877")),u=Object(_["a"])(l,i,a,!1,null,"b2dbf330",null);e["a"]=u.exports},c4e3:function(t,e,s){},d634:function(t,e,s){"use strict";s("4e32")},d772:function(t,e,s){"use strict";var i=s("81a9"),a=s("bff7");e["a"]={get_operate_record_list(t){return Object(i["a"])(Object(a["b"])("GET","/ecs/history_record/",t))},get_detail(t){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_ecs_detail/",t))}}},e4d0:function(t,e,s){"use strict";var i=s("81a9"),a=s("bff7");e["a"]={get_pub_mirror_list(t){return Object(i["a"])(Object(a["b"])("GET","/img/get_pub_image_list/",t))},check_name(t){return Object(i["a"])(Object(a["b"])("POST","/img/name_check/",t))},get_mirror_type(t){return Object(i["a"])(Object(a["b"])("GET","/img/image_type/",t))},get_model_image_type(t){return Object(i["a"])(Object(a["b"])("GET","/img/model_image_type/",t))},add_pub_mirror(t){return Object(i["a"])(Object(a["b"])("GET","/img/create_pub_image/",t))},edit_pub_mirror(t){return Object(i["a"])(Object(a["b"])("POST","/img/edit_image/",t))},change_status(t){return Object(i["a"])(Object(a["b"])("POST","/img/alter_image/",t))},del_pub_mirror_az(t){return Object(i["a"])(Object(a["b"])("POST","/img/delete_pub_image/",t))},del_pub_mirror(t){return Object(i["a"])(Object(a["b"])("POST","/img/batch_delete_pub_image/",t))},get_pub_operate_record(t){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_operation_list/",t))},get_pub_sync_detail(t){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_info/",t))},sync_mirror(t){return Object(i["a"])(Object(a["b"])("POST","/img/sync_pub_image/",t))},get_private_mirror_list(t){return Object(i["a"])(Object(a["b"])("GET","/img/get_private_image_list/",t))},get_status_list(t){return Object(i["a"])(Object(a["b"])("GET","/img/get_image_status_list/",t))},get_available_az(t){return Object(i["a"])(Object(a["b"])("POST","/img/get_available_az/",t))},get_disk_list(t){return Object(i["a"])(Object(a["b"])("GET","/img/backend_type/",t))},get_product_source(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_product_source/"))}}},e867:function(t,e,s){},ea55:function(t,e,s){"use strict";s("e867")},edc9:function(t,e,s){},f813:function(t,e,s){"use strict";s("9409")}}]);
//# sourceMappingURL=chunk-44c2710f.1764224471686.js.map