(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-f8bc7d7e"],{"0d26":function(t,e,r){"use strict";var o=r("e330"),s=Error,a=o("".replace),i=function(t){return String(new s(t).stack)}("zxcasd"),n=/\n\s*at [^:]*:[^\n]*/,c=n.test(i);t.exports=function(t,e){if(c&&"string"==typeof t&&!s.prepareStackTrace)while(e--)t=a(t,n,"");return t}},1750:function(t,e,r){"use strict";r("db08")},1787:function(t,e,r){"use strict";var o=r("861d");t.exports=function(t){return o(t)||null===t}},"2ba4":function(t,e,r){"use strict";var o=r("40d5"),s=Function.prototype,a=s.apply,i=s.call;t.exports="object"==typeof Reflect&&Reflect.apply||(o?i.bind(a):function(){return i.apply(a,arguments)})},"2f6f":function(t,e,r){},"3bbe":function(t,e,r){"use strict";var o=r("1787"),s=String,a=TypeError;t.exports=function(t){if(o(t))return t;throw new a("Can't set "+s(t)+" as a prototype")}},"3fa7":function(t,e,r){"use strict";var o=r("2b0e");e["a"]=new o["default"]},"58d1":function(t,e,r){"use strict";var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("el-dialog",{staticClass:"clusterBox",attrs:{title:t.isCreate?"新建集群":"编辑集群",visible:t.visible_sync,"destroy-on-close":!0,"close-on-click-modal":!1,width:"800px","append-to-body":""},on:{"update:visible":function(e){t.visible_sync=e},close:t.cancel}},[e("el-form",{ref:"createForm",staticClass:"demo-ruleForm",attrs:{model:t.form_data,rules:t.rules,"label-width":"170px","label-position":"left","label-suffix":":"}},[e("el-form-item",{attrs:{label:"集群名称",prop:"cluster_name"}},[e("el-input",{attrs:{type:"textarea",autosize:"",resize:"none",maxlength:100,"show-word-limit":""},model:{value:t.form_data.cluster_name,callback:function(e){t.$set(t.form_data,"cluster_name",e)},expression:"form_data.cluster_name"}})],1),e("el-form-item",{attrs:{label:"所属POD"}},[e("el-select",{attrs:{filterable:"",disabled:!t.isCreate&&t.oper_info&&t.oper_info.length>0&&0!==t.oper_info[0].host_count},model:{value:t.form_data.father_pod,callback:function(e){t.$set(t.form_data,"father_pod",e)},expression:"form_data.father_pod"}},t._l(t.pod_list,(function(t){return e("el-option",{key:t.pod_id,attrs:{label:t.pod_name,value:t.pod_id}})})),1)],1),e("el-form-item",{attrs:{label:"CPU品牌"}},[e("el-select",{attrs:{disabled:!t.isCreate&&t.oper_info&&t.oper_info.length>0&&0!==t.oper_info[0].host_count},on:{change:t.changeCpuBrand},model:{value:t.form_data.cpu_brand,callback:function(e){t.$set(t.form_data,"cpu_brand",e)},expression:"form_data.cpu_brand"}},t._l(t.cpu_brand_list,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),e("el-form-item",{attrs:{label:"CPU型号",prop:"cpu_model"}},[e("el-select",{staticClass:"noInput",attrs:{filterable:"",multiple:""},model:{value:t.form_data.cpu_model,callback:function(e){t.$set(t.form_data,"cpu_model",e)},expression:"form_data.cpu_model"}},t._l(t.cpu_model_list,(function(r){return e("el-option",{key:r.id,attrs:{label:r.real_name,value:r.id,disabled:t.FnSelectedCpus(r)}})})),1)],1),e("el-form-item",{attrs:{label:"GPU型号"}},[e("el-select",{attrs:{filterable:"",disabled:!t.isCreate&&t.oper_info&&t.oper_info.length>0&&0!==t.oper_info[0].host_count,clearable:""},model:{value:t.form_data.gpu_model,callback:function(e){t.$set(t.form_data,"gpu_model",e)},expression:"form_data.gpu_model"}},t._l(t.gpu_model_list,(function(t,r){return e("el-option",{key:r,attrs:{label:t.real_name,value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:"虚拟机存储类型"}},[e("el-select",{attrs:{disabled:!t.isCreate&&t.oper_info&&t.oper_info.length>0&&0!==t.oper_info[0].host_count},model:{value:t.form_data.storage_type,callback:function(e){t.$set(t.form_data,"storage_type",e)},expression:"form_data.storage_type"}},t._l(t.storage_type_list,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),"block"===t.form_data.storage_type?e("el-form-item",{attrs:{label:"块存储集群",prop:"block_storage_cluster"}},[e("el-select",{attrs:{"value-key":"id",disabled:!t.isCreate&&t.oper_info&&t.oper_info.length>0&&0!==t.oper_info[0].host_count,clearable:""},model:{value:t.form_data.block_storage_cluster,callback:function(e){t.$set(t.form_data,"block_storage_cluster",e)},expression:"form_data.block_storage_cluster"}},t._l(t.storage_cluster_list,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t}})})),1)],1):t._e(),e("el-form-item",{attrs:{label:"最大物理机数",prop:"max_host_number"}},[e("el-input-number",{attrs:{"controls-position":"right",min:!t.isCreate&&t.oper_info&&t.oper_info.length>0?t.oper_info[0].host_count:1,max:100},model:{value:t.form_data.max_host_number,callback:function(e){t.$set(t.form_data,"max_host_number",e)},expression:"form_data.max_host_number"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")]),e("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)},s=[],a=(r("d9e2"),r("9ab4")),i=r("1b40"),n=r("da8b"),c=r("3fa7");let l=class extends i["e"]{constructor(){super(...arguments),this.pod_list=[],this.cpu_brand_list=["Intel","AMD"],this.cpu_model_list=[],this.gpu_model_list=[],this.storage_cluster_list=[],this.storage_type_list=[{id:"local",name:"本地盘"},{id:"block",name:"云盘"}],this.form_data={cluster_name:"",father_pod:"",cpu_brand:this.cpu_brand_list[0],cpu_model:"",gpu_model:"",block_storage_cluster:{id:"",name:""},max_host_number:"50",storage_type:"block"},this.rules={cluster_name:[{required:!0,message:"请输入集群名称",trigger:"change"}],cpu_model:[{required:!0,message:"请选择CPU品牌",trigger:"change"}],max_host_number:[{required:!0,message:"请输入最大物理机数",trigger:"change"}],block_storage_cluster:[{required:!0,validator:this.validate_name,trigger:"blur"}]}}validate_name(t,e,r){if(!e&&"block"===this.form_data.storage_type)return r(new Error("请选择块存储集群"));r()}FnGetInfo(t){const e={cluster_name:"",father_pod:"",cpu_brand:this.cpu_brand_list[0],cpu_model:"",gpu_model:"",block_storage_cluster:{id:"",name:""},max_host_number:"50",storage_type:"block"};t&&!this.isCreate&&(this.form_data={...e,cluster_name:this.oper_info[0].cluster_name,block_storage_cluster:{id:this.oper_info[0].storage_cluster_id,name:this.oper_info[0].storage_cluster_name},max_host_number:this.oper_info[0].max_host_count,cpu_brand:this.oper_info[0].cpu_brand,storage_type:this.oper_info[0].backend_type}),t?(this.get_pod_list(),this.get_storage_cluster_info(),this.getModelInfoList("cpu",!1),this.getModelInfoList("gpu",!1)):this.form_data={...e}}FnSelectedCpus(t){let e=!1;if(this.oper_info&&this.oper_info[0]){const r=this.oper_info[0].cpu_type_id;e=Array.isArray(r)&&r.includes(String(t.id))}const r=this.oper_info&&this.oper_info.length>0&&0!==this.oper_info[0].host_count;return!(!e||!r)}async get_pod_list(){let t=await n["a"].get_pod_list({az_name:this.$store.state.az_list.az_name});"Success"===t.code&&(this.pod_list=t.data.pod_list,this.form_data.father_pod=this.isCreate&&this.pod_list[0]?this.pod_list[0].pod_id:this.oper_info[0].pod_id)}async get_storage_cluster_info(){let t=await n["a"].get_storage_cluster_info({az_id:this.$store.state.az_id,az_code:this.$store.state.az_list.az_code});"Success"===t.code&&(this.storage_cluster_list=t.data.clusters,this.isCreate?this.form_data.block_storage_cluster="":(this.form_data.block_storage_cluster.name=this.oper_info[0].storage_cluster_name,this.form_data.block_storage_cluster.id=this.oper_info[0].storage_cluster_id))}async getModelInfoList(t,e){let r=await n["a"].get_model_info_list({handle_type:t,cpu_brand:this.form_data.cpu_brand});"Success"===r.code&&("cpu"===t?(this.cpu_model_list=r.data.model_info_list,this.isCreate||e?this.cpu_model_list.length>0?this.form_data.cpu_model=[this.cpu_model_list[0].id]:this.form_data.cpu_model="":this.form_data.cpu_model=this.oper_info[0].cpu_type_id):"gpu"===t&&(this.gpu_model_list=r.data.model_info_list,this.form_data.gpu_model=(this.isCreate,this.oper_info[0].gpu_type_id)))}changeCpuBrand(){this.getModelInfoList("cpu",!0)}async confirm(){const t=this.$refs.createForm;t.validate(async t=>{if(console.log("===="),t){let t=await(this.isCreate?n["a"].create_cluster:n["a"].update_cluster)({az_id:this.$store.state.az_id,cluster_id:this.oper_info[0]?this.oper_info[0].cluster_id:void 0,cluster_name:this.form_data.cluster_name,father_pod_id:this.form_data.father_pod,cpu_brand:this.form_data.cpu_brand,cpu_type_id:this.form_data.cpu_model,gpu_type_id:this.form_data.gpu_model,storage_cluster_id:"block"===this.form_data.storage_type?this.form_data.block_storage_cluster.id:void 0,storage_cluster_name:"block"===this.form_data.storage_type?this.form_data.block_storage_cluster.name:void 0,max_host_count:this.form_data.max_host_number,backend_type:this.form_data.storage_type});"Success"===t.code&&(this.$message.success(t.message),this.cancel(),c["a"].$emit("getTreeData",!1))}})}cancel(){this.visible_sync=!1}};Object(a["a"])([Object(i["d"])("visible")],l.prototype,"visible_sync",void 0),Object(a["a"])([Object(i["c"])({default:()=>[]})],l.prototype,"oper_info",void 0),Object(a["a"])([Object(i["c"])({default:!1})],l.prototype,"isCreate",void 0),Object(a["a"])([Object(i["f"])("visible")],l.prototype,"FnGetInfo",null),l=Object(a["a"])([Object(i["a"])({})],l);var _=l,u=_,d=(r("6431"),r("2877")),p=Object(d["a"])(u,o,s,!1,null,null,null);e["a"]=p.exports},6431:function(t,e,r){"use strict";r("2f6f")},"6f19":function(t,e,r){"use strict";var o=r("9112"),s=r("0d26"),a=r("b980"),i=Error.captureStackTrace;t.exports=function(t,e,r,n){a&&(i?i(t,e):o(t,"stack",s(r,n)))}},7156:function(t,e,r){"use strict";var o=r("1626"),s=r("861d"),a=r("d2bb");t.exports=function(t,e,r){var i,n;return a&&o(i=e.constructor)&&i!==r&&s(n=i.prototype)&&n!==r.prototype&&a(t,n),t}},7282:function(t,e,r){"use strict";var o=r("e330"),s=r("59ed");t.exports=function(t,e,r){try{return o(s(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(a){}}},ab36:function(t,e,r){"use strict";var o=r("861d"),s=r("9112");t.exports=function(t,e){o(e)&&"cause"in e&&s(t,"cause",e.cause)}},ab43:function(t,e,r){"use strict";var o=r("23e7"),s=r("c65b"),a=r("59ed"),i=r("825a"),n=r("46c4"),c=r("c5cc"),l=r("9bdd"),_=r("2a62"),u=r("2baa"),d=r("f99f"),p=r("c430"),f=!p&&!u("map",(function(){})),b=!p&&!f&&d("map",TypeError),m=p||f||b,h=c((function(){var t=this.iterator,e=i(s(this.next,t)),r=this.done=!!e.done;if(!r)return l(t,this.mapper,[e.value,this.counter++],!0)}));o({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(t){i(this);try{a(t)}catch(e){_(this,"throw",e)}return b?s(b,this,t):new h(n(this),{mapper:t})}})},aeb0:function(t,e,r){"use strict";var o=r("9bf2").f;t.exports=function(t,e,r){r in t||o(t,r,{configurable:!0,get:function(){return e[r]},set:function(t){e[r]=t}})}},b980:function(t,e,r){"use strict";var o=r("d039"),s=r("5c6c");t.exports=!o((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",s(1,7)),7!==t.stack)}))},bd4d:function(t,e,r){"use strict";var o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"menu"}},[e("ul",[e("div",{staticClass:"tip"},[t._v(" 操作-"+t._s(t.tipText))]),t._l(t.filteredMenus,(function(r,o){return t.multi_rows.length>1&&!r.single||1===t.multi_rows.length?e("li",{key:o,on:{click:function(e){return e.stopPropagation(),t.FnClick(r)}}},[r.disabled?e("el-tooltip",{attrs:{effect:"light",placement:"left",content:t.disabledTooltipContent(r)}},[e("span",{staticClass:"disabled"},[t._v(" "+t._s(r.label)+" ")])]):e("span",[t._v(" "+t._s(r.label)+" ")]),r.list?e("span",[e("i",{staticClass:"el-icon-arrow-right",staticStyle:{float:"right","margin-top":"7px","font-size":"15px"}}),e("ul",t._l(r.list,(function(r){return e("li",{key:r.value,on:{click:function(e){return e.stopPropagation(),t.FnClick(r)}}},[r.disabled?e("el-tooltip",{attrs:{effect:"light",placement:"left",content:t.disabledTooltipContent(r)}},[e("span",{staticClass:"disabled"},[t._v(" "+t._s(r.label)+" ")])]):e("span",[t._v(" "+t._s(r.label)+" ")])],1)})),0)]):t._e()],1):t._e()}))],2)])},s=[],a=(r("e9f5"),r("910d"),r("9ab4")),i=r("1b40"),n=r("58d1");let c=class extends i["e"]{constructor(){super(...arguments),this.operate_auth=[],this.msg={},this.visibleSubMenus={}}watch_error_msg(t){this.msg=t}get tipText(){return this.multi_rows.length>1?this.multi_rows.length+"个对象":this.name}get filteredMenus(){return 0===this.multi_rows.length?[]:this.menus.filter(t=>this.multi_rows.length>1&&!t.single||1===this.multi_rows.length)}created(){this.msg=this.error_msg}disabledTooltipContent(t){return this.msg&&this.msg[t.value]?this.msg[t.value]:"此状态无法操作或无操作权限"}FnClick(t){return t}};Object(a["a"])([Object(i["c"])({default:()=>[]})],c.prototype,"multi_rows",void 0),Object(a["a"])([Object(i["c"])({default:()=>[]})],c.prototype,"menus",void 0),Object(a["a"])([Object(i["c"])({default:()=>{}})],c.prototype,"error_msg",void 0),Object(a["a"])([Object(i["c"])({default:""})],c.prototype,"name",void 0),Object(a["a"])([Object(i["f"])("error_msg")],c.prototype,"watch_error_msg",null),Object(a["a"])([Object(i["b"])("fn-click")],c.prototype,"FnClick",null),c=Object(a["a"])([Object(i["a"])({components:{CreateCluster:n["a"]}})],c);var l=c,_=l,u=(r("1750"),r("2877")),d=Object(u["a"])(_,o,s,!1,null,"4f5ac217",null);e["a"]=d.exports},cf88:function(t,e,r){"use strict";function o(){console.log("----######");let t=document.querySelector("#menu");t&&(t.style.display="none",document.removeEventListener("click",o))}r.d(e,"a",(function(){return o}))},d2bb:function(t,e,r){"use strict";var o=r("7282"),s=r("861d"),a=r("1d80"),i=r("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{t=o(Object.prototype,"__proto__","set"),t(r,[]),e=r instanceof Array}catch(n){}return function(r,o){return a(r),i(o),s(r)?(e?t(r,o):r.__proto__=o,r):r}}():void 0)},d9e2:function(t,e,r){"use strict";var o=r("23e7"),s=r("cfe9"),a=r("2ba4"),i=r("e5cb"),n="WebAssembly",c=s[n],l=7!==new Error("e",{cause:7}).cause,_=function(t,e){var r={};r[t]=i(t,e,l),o({global:!0,constructor:!0,arity:1,forced:l},r)},u=function(t,e){if(c&&c[t]){var r={};r[t]=i(n+"."+t,e,l),o({target:n,stat:!0,constructor:!0,arity:1,forced:l},r)}};_("Error",(function(t){return function(e){return a(t,this,arguments)}})),_("EvalError",(function(t){return function(e){return a(t,this,arguments)}})),_("RangeError",(function(t){return function(e){return a(t,this,arguments)}})),_("ReferenceError",(function(t){return function(e){return a(t,this,arguments)}})),_("SyntaxError",(function(t){return function(e){return a(t,this,arguments)}})),_("TypeError",(function(t){return function(e){return a(t,this,arguments)}})),_("URIError",(function(t){return function(e){return a(t,this,arguments)}})),u("CompileError",(function(t){return function(e){return a(t,this,arguments)}})),u("LinkError",(function(t){return function(e){return a(t,this,arguments)}})),u("RuntimeError",(function(t){return function(e){return a(t,this,arguments)}}))},da8b:function(t,e,r){"use strict";var o=r("81a9"),s=r("bff7");e["a"]={get_pod_outline(t){return Object(o["a"])(Object(s["b"])("GET","/pod/get_pod_outline/",t))},get_pod_cluster_list(t){return Object(o["a"])(Object(s["b"])("GET","/pod/get_pod_cluster_list/",t))},get_cluster_field(){return Object(o["a"])(Object(s["b"])("GET","/pod/get_cluster_field/"))},get_pod_host_field(){return Object(o["a"])(Object(s["b"])("GET","/pod/get_pod_host_field/"))},get_pod_host_list(t){return Object(o["a"])(Object(s["b"])("POST","/pod/get_pod_host_list/",t))},create_cluster(t){return Object(o["a"])(Object(s["b"])("POST","/cluster/create_cluster/",t))},update_cluster(t){return Object(o["a"])(Object(s["b"])("POST","/cluster/update_cluster/",t))},delete_cluster(t){return Object(o["a"])(Object(s["b"])("POST","/cluster/delete_cluster/",t))},get_pod_list(t){return Object(o["a"])(Object(s["b"])("GET","/pod/get_pod_list/",t))},get_model_info_list(t){return Object(o["a"])(Object(s["b"])("GET","/cluster/get_model_info_list/",t))},get_storage_cluster_info(t){return Object(o["a"])(Object(s["b"])("GET","/cluster/get_storage_cluster_info/",t))},get_status_list(t){return Object(o["a"])(Object(s["d"])("GET","/host/host_status_list/",t))},recommend_cluster(t){return Object(o["a"])(Object(s["d"])("POST","/host/recommend_cluster/",t))},add_cluster(t){return Object(o["a"])(Object(s["d"])("POST","/host/host_add_cluster/",t))},set_cluster_prepare_host(t){return Object(o["a"])(Object(s["d"])("POST","/cluster/set_cluster_prepare_host_count/",t))},add_host_label(t){return Object(o["a"])(Object(s["d"])("POST","/host/add_host_label/",t))},get_label_list(t){return Object(o["a"])(Object(s["d"])("GET","/host/get_label_list/",t))},get_all_host_label(t){return Object(o["a"])(Object(s["d"])("GET","/host/get_all_host_label/",t))}}},db08:function(t,e,r){},e391:function(t,e,r){"use strict";var o=r("577e");t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:o(t)}},e5cb:function(t,e,r){"use strict";var o=r("d066"),s=r("1a2d"),a=r("9112"),i=r("3a9b"),n=r("d2bb"),c=r("e893"),l=r("aeb0"),_=r("7156"),u=r("e391"),d=r("ab36"),p=r("6f19"),f=r("83ab"),b=r("c430");t.exports=function(t,e,r,m){var h="stackTraceLimit",g=m?2:1,v=t.split("."),y=v[v.length-1],O=o.apply(null,v);if(O){var j=O.prototype;if(!b&&s(j,"cause")&&delete j.cause,!r)return O;var k=o("Error"),x=e((function(t,e){var r=u(m?e:t,void 0),o=m?new O(t):new O;return void 0!==r&&a(o,"message",r),p(o,x,o.stack,2),this&&i(j,this)&&_(o,this,x),arguments.length>g&&d(o,arguments[g]),o}));if(x.prototype=j,"Error"!==y?n?n(x,k):c(x,k,{name:!0}):f&&h in O&&(l(x,O,h),l(x,O,"prepareStackTrace")),c(x,O),!b)try{j.name!==y&&a(j,"name",y),j.constructor=x}catch(C){}return x}}}}]);
//# sourceMappingURL=chunk-f8bc7d7e.1764156034953.js.map