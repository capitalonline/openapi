(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-0eacb813"],{"0ac9":function(e,t,a){},2483:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"box"},[t("Monitor"),e._l(e.overview_info,(function(a){return t("el-card",{key:a.name,staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"title"},[e._v(e._s(a.name))]),t("span",{staticClass:"all"},[t("span",{staticClass:"num_message"},[e._v(e._s(a.all))]),e._v(" 台")])]),t("div",{staticClass:"content"},e._l(a.info,(function(a,s){return t("div",{key:s},[t("p",{staticClass:"m-bottom10",class:s},[e._v(e._s(a.value))]),t("p",[e._v(e._s(a.label))])])})),0)])}))],2)},i=[],l=a("9ab4"),o=a("1b40"),r=a("81a9"),c=a("bff7"),n={get_host_overview(e){return Object(r["a"])(Object(c["b"])("POST","/host/get_host_overview/",e))},get_ecs_overview(e){return Object(r["a"])(Object(c["b"])("POST","/ecs/get_ecs_overview/",e))},get_host_type(e){return Object(r["a"])(Object(c["b"])("GET","/host/host_product_list/",e))},get_cpu_percent(e){return Object(r["a"])(Object(c["f"])("GET","/cpu_group_info",e))},get_ram_percent(e){return Object(r["a"])(Object(c["f"])("GET","/memory_group_info",e))},get_gpu_percent(e){return Object(r["a"])(Object(c["f"])("GET","/gpu_group_info",e))}},_=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"m-bottom20"},[t("div",{staticClass:"monitor"},[t("el-select",{attrs:{placeholder:"请选择物理机产品类型名称",multiple:!0},on:{change:e.changeProductType},model:{value:e.productList,callback:function(t){e.productList=t},expression:"productList"}},e._l(e.hostTypes,(function(e){return t("el-option",{key:e.host_product_id,attrs:{value:e.host_product_id,label:e.name}})})),1),t("span",{staticClass:"m-left10 m-right10"},[e._v("物理机总台数:"),t("span",{staticClass:"num_message"},[e._v(" "+e._s(Object.keys(e.physicalInfo).length)+" ")]),e._v("台")]),t("time-group",{attrs:{dis_day:366,timeList:e.timeList},on:{"fn-emit":e.FnGetTimer}})],1),t("div",{staticClass:"chart-box"},[t("line-echart",{staticClass:"item",attrs:{chart_id:"cpu_chart",data:e.cpu_used}}),t("line-echart",{staticClass:"item",attrs:{chart_id:"ram_chart",data:e.memory_used}})],1),t("div",{staticClass:"chart-box"},[t("line-echart",{staticClass:"item",attrs:{chart_id:"graphics_card",data:e.graphics_card_used}}),t("line-echart",{staticClass:"item",attrs:{chart_id:"graphics_ram",data:e.graphics_ram_used}})],1)])},u=[],p=(a("14d9"),a("e9f5"),a("910d"),a("7d54"),a("ab43"),a("1f82")),d=a("ff48"),h=a("c1df"),m=a.n(h);let f=class extends o["e"]{constructor(){super(...arguments),this.hostTypes=[],this.default_date_timer=[],this.productList=[],this.physicalInfo=[],this.timeList={day:{label:"最近1天",time:864e5},week:{label:"最近7天",time:6048e5},"30_day":{label:"最近30天",time:2592e6},"90_day":{label:"最近90天",time:7776e6}},this.cpu_used={title:"CPU使用率",unit:"",xTime:[],yValue:[],resize:0},this.memory_used={title:"内存使用率",unit:"",xTime:[],yValue:[],resize:0},this.graphics_card_used={title:"显卡使用率",unit:"",xTime:[],yValue:[],resize:0},this.graphics_ram_used={title:"显存使用率",unit:"",xTime:[],yValue:[],resize:0}}created(){this.getHostTypes()}watch_pod(e){e&&this.getHostTypes()}async getHostTypes(){let e=await n.get_host_type({pod_id:this.$store.state.pod_id});"Success"===e.code&&(this.hostTypes=e.data.host_product_list)}FnGetTimer(e){this.default_date_timer=e,this.init()}changeProductType(){this.physicalInfo={};let e=this.hostTypes.filter(e=>this.productList.includes(e.host_product_id));e.map(e=>{e.host_infos.map(e=>{this.physicalInfo[e.host_name]={hostIp:e.host_ip,region:e.region_id,az:e.az_id}})}),this.init()}init(){if(0===Object.keys(this.physicalInfo).length)return;let e=Object.values(this.physicalInfo),t={hostIds:Object.keys(this.physicalInfo).join("|"),hostIps:e.map(e=>e.hostIp).join("|"),region:e[0].region,replica:e[0].az,start:m.a.utc(this.default_date_timer[0]).format("YYYY-MM-DD HH:mm:ss"),end:m.a.utc(this.default_date_timer[1]).format("YYYY-MM-DD HH:mm:ss")};Promise.all([n.get_cpu_percent({...t}),n.get_ram_percent({...t}),n.get_gpu_percent({...t,queryType:"memory"}),n.get_gpu_percent({...t,queryType:"gpu"})]).then(e=>{let t={0:"cpu_used",1:"memory_used",2:"graphics_ram_used",3:"graphics_card_used"},a={sale:"已售量",saleRate:"售卖率",use:"实际使用量",usage:"实际使用率"};e.map((e,s)=>{let i=[],l=[];for(let t in e.data)"xTime"!==t&&(l.push(a[t]),i.push({code:e.code,yValues:[e.data[t]],xTime:e.data.xTime}));i.map(e=>e.metricInfo=l),this.FnHandleDubleData(t[s],i)})})}FnHandleDubleData(e,t){let a=0;this[e].yValue=[],t.forEach(t=>{"Success"===t.code&&(t.metricInfo=t.metricInfo,0===a&&(this[e].xTime=t.xTime,this[e].legend=t.metricInfo),t.yValues&&this[e].yValue.push(...t.yValues)),a++}),this[e].resize++}};Object(l["a"])([Object(o["f"])("$store.state.pod_id")],f.prototype,"watch_pod",null),f=Object(l["a"])([Object(o["a"])({components:{TimeGroup:p["a"],LineEchart:d["a"]}})],f);var b=f,v=b,g=(a("ae90"),a("2877")),y=Object(g["a"])(v,_,u,!1,null,"345f7cd0",null),T=y.exports;let w=class extends o["e"]{constructor(){super(...arguments),this.header_info={CPU:{name:"CPU",total_label:"逻辑总核数:",total:2700,remain_label:"可用",remain:"80%",use:"20%",count:"100%",alloted:"2600核",allot_percent:"96%"},memory:{name:"内存",total_label:"总容量:",total:"1.25TB",remain_label:"可用",remain:"8.44TB",use:"1.25TB",count:"9.69TB",alloted:"4.56TB",allot_percent:"60%"},GPU:{name:"GPU",total_label:"总块数:",total:800,remain_label:"可分配",remain:"22块",use:"",count:"",alloted:"22块",allot_percent:"16%"},storage:{name:"GPU",total_label:"总容量:",total:"4.22TB",remain_label:"可用",remain:"2.22TB",use:"2TB",count:"4.22TB",alloted:"2.6TB",allot_percent:"96%"}},this.overview_info=[{name:"宿主机",all:233,info:{init:{label:"初始化待验证",value:50},init_error:{label:"验证失败",value:50},offline:{label:"离线",value:50},exception:{label:"异常",value:50},online_maintenance:{label:"在线维护中",value:50},offline_maintenance:{label:"离线维护中",value:50},online:{label:"在线",value:50}}},{name:"云主机",all:233,info:{failed:{label:"创建失败",value:50},error:{label:"错误",value:50},shutdown:{label:"已关机",value:50},running:{label:"运行中",value:50}}}]}created(){this.get_overview(0),this.get_overview(1)}watch_pod(e){e&&(this.get_overview(0),this.get_overview(1))}async get_overview(e){if(!this.$store.state.pod_id)return;let t=0===e?"get_host_overview":"get_ecs_overview",a=await n[t]({pod_id:this.$store.state.pod_id});if("Success"===a.code){this.overview_info[e].all=a.data.all;for(let t in a.data)this.overview_info[e].info[t]&&(this.overview_info[e].info[t].value=a.data[t])}}};Object(l["a"])([Object(o["f"])("$store.state.pod_id")],w.prototype,"watch_pod",null),w=Object(l["a"])([Object(o["a"])({components:{Monitor:T}})],w);var j=w,O=j,x=(a("a4a5"),Object(g["a"])(O,s,i,!1,null,"0bac8a98",null));t["default"]=x.exports},8168:function(e,t,a){},a4a5:function(e,t,a){"use strict";a("8168")},ae90:function(e,t,a){"use strict";a("0ac9")}}]);