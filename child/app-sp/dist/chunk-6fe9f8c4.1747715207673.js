(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-6fe9f8c4"],{"13f1":function(e,t,a){"use strict";var i=a("81a9"),n=a("bff7");function s(e){var t=n["f"];return"gpu"===e&&(t=n["c"]),t}t["a"]={get_cpu:function(e,t){return Object(i["a"])(s(e)("GET","/cpu_info",t))},get_disk:function(e,t){return Object(i["a"])(s(e)("GET","/disk_info",t))},get_load:function(e,t){return Object(i["a"])(s(e)("GET","/load_info",t))},get_memory:function(e,t){return Object(i["a"])(s(e)("GET","/memory_info",t))},get_network:function(e,t){return Object(i["a"])(s(e)("GET","/network_info",t))},get_gpu:function(e,t){return Object(i["a"])(s(e)("GET","/gpu_info",t))},get_disk_info:function(e,t){return Object(i["a"])(s(e)("GET","/disk_info",t))},get_eip_info:function(e){return Object(i["a"])(Object(n["b"])("POST","/ecs/eip_monitor_info/",e))}}},"29f3":function(e,t,a){},"7b78":function(e,t,a){"use strict";a("7ced")},"7ced":function(e,t,a){},8661:function(e,t,a){},"8b07":function(e,t,a){"use strict";a("8661")},"99af":function(e,t,a){"use strict";var i=a("23e7"),n=a("da84"),s=a("d039"),r=a("e8b5"),u=a("861d"),o=a("7b0b"),c=a("07fa"),_=a("8418"),l=a("65f0"),d=a("1dde"),f=a("b622"),p=a("2d00"),m=f("isConcatSpreadable"),h=9007199254740991,b="Maximum allowed index exceeded",y=n.TypeError,g=p>=51||!s((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),v=d("concat"),k=function(e){if(!u(e))return!1;var t=e[m];return void 0!==t?!!t:r(e)},O=!g||!v;i({target:"Array",proto:!0,forced:O},{concat:function(e){var t,a,i,n,s,r=o(this),u=l(r,0),d=0;for(t=-1,i=arguments.length;t<i;t++)if(s=-1===t?r:arguments[t],k(s)){if(n=c(s),d+n>h)throw y(b);for(a=0;a<n;a++,d++)a in s&&_(u,d,s[a])}else{if(d>=h)throw y(b);_(u,d++,s)}return u.length=d,u}})},b85c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("d9e2");var i=a("06c5");function n(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=Object(i["a"])(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,u=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return u=e.done,e},e:function(e){o=!0,r=e},f:function(){try{u||null==a["return"]||a["return"]()}finally{if(o)throw r}}}}},bd09:function(e,t,a){"use strict";a("29f3")},cae8:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"monitor"},["monitor"===e.source_name?a("div",[e.$route.path.includes("vm_monitor")?e._e():a("back-header",{attrs:{title:"云服务器监控",back_url:"/instance"}}),a("el-card",{staticClass:"m-bottom20 m-top20",scopedSlots:e._u([{key:"header",fn:function(){return[a("span",[e._v("云服务器详情")])]},proxy:!0}],null,!1,1403309807)},[a("div",{staticClass:"detail-box"},e._l(e.detail_info,(function(t,i){return a("div",{key:i,staticClass:"row"},[a("span",{staticClass:"left-title"},[e._v(e._s(t.label)+":")]),a("span",{domProps:{innerHTML:e._s(t.value)}})])})),0)])],1):e._e(),a("el-card",{staticClass:"tab-card"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.default_tab,callback:function(t){e.default_tab=t},expression:"default_tab"}},e._l(e.tab_list,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:t,name:i,disabled:"eip"===i&&!e.detail_info.public_net.value}})})),1),e.ecs_info.create_finish_time||e.session.getItem("vm_monitor")?a("time-group",{key:"eip"!==e.default_tab?e.ecs_info.create_finish_time:e.start_time,attrs:{start_time:"eip"!==e.default_tab?e.ecs_info.create_finish_time:e.start_time},on:{"fn-emit":e.FnGetTimer}}):e._e(),"instance"===e.default_tab?a("div",{staticClass:"chart-box"},[a("line-echart",{staticClass:"item",attrs:{chart_id:"cpu_chart",data:e.cpu_used}}),a("line-echart",{staticClass:"item",attrs:{chart_id:"ram_chart",data:e.memory_used}}),"windows"!==e.ecs_info.os_system.toLocaleLowerCase()?a("line-echart",{staticClass:"item",attrs:{chart_id:"system_chart",data:e.system_load}}):e._e()],1):e._e(),"net"===e.default_tab?a("div",{staticClass:"chart-box"},[a("line-echart",{staticClass:"item",attrs:{chart_id:"net_rate_chart",data:e.net_rate}})],1):e._e(),"disk"===e.default_tab?a("div",{staticClass:"chart-box"},[a("line-echart",{staticClass:"item",attrs:{chart_id:"disk_chart",data:e.disk_used}}),a("line-echart",{staticClass:"item",attrs:{chart_id:"disk_through_chart",data:e.disk_bytes}}),a("line-echart",{staticClass:"item",attrs:{chart_id:"disk_iops_chart",data:e.disk_iops}})],1):e._e(),"gpu"===e.default_tab?a("div",{staticClass:"chart-box"},[a("line-echart",{staticClass:"item",attrs:{chart_id:"gpu_chart",data:e.gpu_used}}),a("line-echart",{staticClass:"item",attrs:{chart_id:"gpu_memory_chart",data:e.gpu_memory_used}}),a("line-echart",{staticClass:"item",attrs:{chart_id:"gpu_temperature",data:e.gpu_temperature}}),a("line-echart",{staticClass:"item",attrs:{chart_id:"gpu_frequency",data:e.gpu_frequency}})],1):e._e(),"eip"===e.default_tab?a("div",{staticClass:"chart-box"},[a("line-echart",{staticClass:"item",attrs:{chart_id:"eip_chart",data:e.net_throughput}})],1):e._e()],1)],1)},n=[],s=a("2909"),r=a("b85c"),u=a("1da1"),o=a("d4ec"),c=a("bee2"),_=a("262e"),l=a("2caf"),d=(a("96cf"),a("b64b"),a("99af"),a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("159b"),a("d81d"),a("9ab4")),f=a("1b40"),p=a("ed46"),m=a("1f82"),h=a("ff48"),b=a("d772"),y=a("13f1"),g=a("c1df"),v=a.n(g),k=function(e){Object(_["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.session=sessionStorage,e.source_name="",e.ecs_info={region_id:"",az_id:"",private_net:"",create_finish_time:"",os_system:""},e.detail_info={ecs_name:{label:"实例名称",value:""},ecs_id:{label:"实例ID",value:""},ecs_rule:{label:"云服务器规格",value:""},az_name:{label:"地域及可用区",value:""},system_disk_conf:{label:"系统盘",value:""},os_info:{label:"镜像",value:""},public_net:{label:"公网IP",value:""},private_net:{label:"私网IP",value:""},status:{label:"运行状态",value:""}},e.cpu_used={title:"CPU使用率",unit:"",xTime:[],yValue:[],resize:0},e.memory_used={title:"内存使用率",unit:"",xTime:[],yValue:[],resize:0},e.system_load={title:"系统平均负载",unit:"",xTime:[],yValue:[],resize:0,legend:["1m","5m","15m"]},e.net_in_out={title:"网络流量",unit:"",xTime:[],yValue:[],resize:0,legend:[],line_name:["出网流量","入网流量"],type:"double_line"},e.net_rate={title:"网络吞吐量",unit:"",xTime:[],yValue:[],resize:0,legend:[],line_name:["出网流量速率","入网流量速率"],type:"double_line"},e.disk_used={title:"磁盘使用率",unit:"",xTime:[],yValue:[],resize:0,legend:[]},e.disk_iops={title:"磁盘IOPS",unit:"",xTime:[],yValue:[],resize:0,legend:[],line_name:["读","写"],type:"double_line"},e.disk_bytes={title:"磁盘吞吐量",unit:"",xTime:[],yValue:[],resize:0,legend:[],line_name:["读","写"],type:"double_line"},e.default_tab="",e.tab_list={instance:"主机",net:"网络",disk:"磁盘",gpu:"GPU",eip:"EIP"},e.gpu_used={title:"GPU使用率",unit:"",xTime:[],yValue:[],resize:0},e.gpu_memory_used={title:"显存使用率",unit:"",xTime:[],yValue:[],resize:0},e.gpu_temperature={title:"GPU温度",unit:"",xTime:[],yValue:[],resize:0},e.gpu_frequency={title:"GPU主频",unit:"",xTime:[],yValue:[],resize:0,line_name:["GPU核心频率","显存频率"],type:"double_line"},e.net_throughput={title:"网络吞吐量",unit:"",xTime:[],yValue:[],resize:0,legend:["入网流量速率","出网流量速率"],is_special:!0,qos:""},e.default_date_timer=[],e.eip="",e.start_time=new Date((new Date).setDate((new Date).getDate()-60)).toISOString(),e}return Object(c["a"])(a,[{key:"FnGetTimer",value:function(e){this.default_date_timer=e,this.FnGetChartData()}},{key:"FnGetChartData",value:function(){var e="",t="",a="",i="",n="",s="kvm";if("monitor"===this.source_name)e=sessionStorage.getItem("vm_monitor")?JSON.parse(sessionStorage.getItem("vm_monitor")).id:this.detail_info.ecs_id.value,t=this.ecs_info.region_id,a=this.ecs_info.az_id,i=this.ecs_info.private_net,n="vm";else{var r=this.$route.query;e=r.id,t=r.region,a=r.az,i=r.ip,n=r.type,s="gpu"}if(e){var u=sessionStorage.getItem("vm_monitor")?JSON.parse(sessionStorage.getItem("vm_monitor")):"",o={hostId:Object.keys(u).length>0?u.hostId:e,region:Object.keys(u).length>0?u.region_id:t,replica:Object.keys(u).length>0?u.replica:a,ip:Object.keys(u).length>0?u.ip:i,instanceType:Object.keys(u).length>0?u.instanceType:n,os:Object.keys(u).length>0?u.os:this.ecs_info.os_system.toLocaleLowerCase(),start:v.a.utc(this.default_date_timer[0]).format("YYYY-MM-DD HH:mm:ss"),end:v.a.utc(this.default_date_timer[1]).format("YYYY-MM-DD HH:mm:ss")},c={eip:this.eip,ecs_id:this.$route.params.id,start_time:v()(this.default_date_timer[0]).format("YYYY-MM-DD HH:mm:ss"),end_time:v()(this.default_date_timer[1]).format("YYYY-MM-DD HH:mm:ss")};"instance"===this.default_tab?(this.FnGetCpu(s,o),this.FnGetMemory(s,o),"windows"!==this.ecs_info.os_system.toLocaleLowerCase()&&this.FnGetLoad(s,o)):"disk"===this.default_tab?this.FnGetDiskInfo(s,o):"net"===this.default_tab?this.FnGetNetInfo(s,o):"gpu"===this.default_tab?this.FnGetGpuInfo(s,o):"eip"===this.default_tab&&this.FnGetEipInfo(c)}}},{key:"FnGetDetail",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,a,i,n,s,u,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].get_detail({ecs_id:this.$route.params.id});case 2:if(t=e.sent,"Success"===t.code){a=t.data,this.ecs_info={region_id:a.region_id,az_id:a.az_id,private_net:a.pipe.private_net,os_system:a.os_info.system,create_finish_time:v()(new Date(a.create_finish_time)).format()},this.detail_info.ecs_name.value=a.ecs_name,this.detail_info.ecs_id.value=a.ecs_id,this.detail_info.ecs_rule.value="".concat(a.ecs_rule.name," ").concat(a.ecs_rule.cpu_num,"vCPU ").concat(a.ecs_rule.ram,"GiB")+(a.is_gpu?"".concat(a.ecs_rule.gpu,"*").concat(a.card_name):""),this.detail_info.az_name.value=a.az_name,this.detail_info.system_disk_conf.value="".concat(a.disk.system_disk_conf.disk_name," ").concat(a.disk.system_disk_conf.size).concat(a.disk.system_disk_conf.unit),this.detail_info.os_info.value="".concat(a.os_info.system," ").concat(a.os_info.version," ").concat(a.os_info.bite).concat(a.os_info.unit),i=a.pipe,this.detail_info.private_net.value="".concat(i.private_net,"（主）<br> "),this.detail_info.public_net.value="",i.pub_net&&(n=i.eip_info[i.pub_net],this.detail_info.private_net.value+=i.pub_net+(n.conf_name?"（"+n.conf_name+"）":" ")+"默认出网网卡<br>",n.eip_ip&&(this.detail_info.public_net.value="".concat(n.eip_ip,"（").concat(n.conf_name,"）<br>"),this.eip=n.eip_ip)),s=Object(r["a"])(i.virtual_net);try{for(s.s();!(u=s.n()).done;)o=u.value,c=i.eip_info[o],this.detail_info.private_net.value+=o+(c.conf_name?"（"+c.conf_name+"）":"")+"<br>",c.eip_ip&&(this.detail_info.public_net.value+="".concat(c.eip_ip,"（").concat(c.conf_name,"）<br>")),this.eip=c.eip_ip}catch(_){s.e(_)}finally{s.f()}this.detail_info.status.value=a.status_display,a.is_gpu||f["e"].delete(this.tab_list,"gpu")}case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnGetCpu",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,a){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].get_cpu(t,Object.assign({queryType:"use_total"},a));case 2:i=e.sent,this.FnHandleSingleData("cpu_used",i);case 4:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"FnGetMemory",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,a){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].get_memory(t,Object.assign({queryType:"used"},a));case 2:i=e.sent,this.FnHandleSingleData("memory_used",i);case 4:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"FnHandleSingleData",value:function(e,t){"Success"===t.code&&(this[e].xTime=t.data.xTime,this[e].yValue=t.data.yValues,this[e].unit=t.data.unit),this[e].resize++}},{key:"FnGetLoad",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,a){var i,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.system_load.yValue=[],i=this.system_load.legend,Promise.all([y["a"].get_load(t,Object.assign({queryType:i[0]},a)),y["a"].get_load(t,Object.assign({queryType:i[1]},a)),y["a"].get_load(t,Object.assign({queryType:i[2]},a))]).then((function(e){n.FnHandleMoreData("system_load",e)}));case 3:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"FnHandleMoreData",value:function(e,t){var a=this,i=0;t.forEach((function(t){"Success"===t.code&&(0===i&&(a[e].xTime=t.data.xTime,a[e].unit=t.data.unit),a[e].yValue.push(t.data.yValues)),i++})),this[e].resize++}},{key:"FnGetDiskInfo",value:function(e,t){var a=this;y["a"].get_disk(e,Object.assign({queryType:"use"},t)).then((function(e){"Success"===e.code&&(a.disk_used.xTime=e.data.xTime,a.disk_used.yValue=e.data.yValues,a.disk_used.legend=e.data.metricInfo,a.disk_used.unit=e.data.unit);a.disk_used.resize++})),this.disk_bytes.yValue=[],Promise.all([y["a"].get_disk(e,Object.assign({queryType:"readbytes"},t)),y["a"].get_disk(e,Object.assign({queryType:"writebytes"},t))]).then((function(e){a.FnHandleDubleData("disk_bytes",e)})),this.disk_iops.yValue=[],Promise.all([y["a"].get_disk(e,Object.assign({queryType:"readiops"},t)),y["a"].get_disk(e,Object.assign({queryType:"writeiops"},t))]).then((function(e){a.FnHandleDubleData("disk_iops",e)}))}},{key:"FnHandleDubleData",value:function(e,t){var a=this,i=0;t.forEach((function(t){var n;"Success"===t.code&&(t.data.metricInfo=t.data.metricInfo||t.data.device||t.data.gpuName,0===i?(a[e].xTime=t.data.xTime,a[e].legend=t.data.metricInfo,a[e].unit=t.data.unit):t.data.metricInfo&&t.data.metricInfo.forEach((function(t){a[e].legend.push(t+a.disk_iops.type)})),t.data.yValues&&(console.log("1",a[e].yValue),(n=a[e].yValue).push.apply(n,Object(s["a"])(t.data.yValues)),console.log("2",a[e].yValue)));i++})),this[e].resize++,console.log("####",this[e])}},{key:"FnGetNetInfo",value:function(e,t){var a=this;this.net_in_out.yValue=[],this.net_rate.yValue=[],Promise.all([y["a"].get_network(e,Object.assign({queryType:"networkout_rate"},t)),y["a"].get_network(e,Object.assign({queryType:"networkin_rate"},t))]).then((function(e){a.FnHandleDubleData("net_rate",e)}))}},{key:"FnGetGpuInfo",value:function(e,t){var a=this;this.gpu_used.yValue=[],y["a"].get_gpu(e,Object.assign({queryType:"gpu_usage"},t)).then((function(e){a.FnHandleDubleData("gpu_used",[e])})),this.gpu_memory_used.yValue=[],y["a"].get_gpu(e,Object.assign({queryType:"memory_usage"},t)).then((function(e){a.FnHandleDubleData("gpu_memory_used",[e])})),this.gpu_temperature.yValue=[],y["a"].get_gpu(e,Object.assign({queryType:"temperature"},t)).then((function(e){a.FnHandleDubleData("gpu_temperature",[e])})),this.gpu_frequency.yValue=[],Promise.all([y["a"].get_gpu(e,Object.assign({queryType:"gpu_clocks_graphics"},t)),y["a"].get_gpu(e,Object.assign({queryType:"gpu_clocks_memory"},t))]).then((function(e){a.FnHandleDubleData("gpu_frequency",e)})),this.gpu_frequency.yValue=[],Promise.all([y["a"].get_gpu(e,Object.assign({queryType:"gpu_clocks_graphics"},t)),y["a"].get_gpu(e,Object.assign({queryType:"gpu_clocks_memory"},t))]).then((function(e){console.log("resData",e),e.map((function(e){return e.data.yValues&&e.data.yValues.length>0&&(e.data.yValues=[e.data.yValues]),e})),a.FnHandleDubleData("gpu_frequency",e)}))}},{key:"FnGetEipInfo",value:function(e){var t=this;this.net_throughput.yValue=[],y["a"].get_eip_info(e).then((function(e){t.net_throughput.unit=e.data.unit,t.net_throughput.xTime=e.data.time,t.net_throughput.yValue=[e.data.in_bps,e.data.out_bps],t.net_throughput.qos=e.data.qos,t.net_throughput.resize++}))}},{key:"created",value:function(){if(this.default_tab=Object.keys(this.tab_list)[0],this.source_name=this.$route.name,sessionStorage.getItem("vm_monitor")){f["e"].delete(this.tab_list,"gpu");var e=JSON.parse(sessionStorage.getItem("vm_monitor"));this.detail_info.ecs_name.value=e.transfer_vm_name,this.detail_info.ecs_id.value=e.transfer_vm_id,this.detail_info.az_name.value=e.region_name+"-"+e.az_name,this.detail_info.system_disk_conf.value=e.transfer_vm_conf_system_disk_type?"".concat(e.transfer_vm_conf_system_disk_type,"  ").concat(e.transfer_vm_conf_system_disk_size).concat(e.transfer_vm_conf_system_disk_unit):"",this.detail_info.os_info.value=e.transfer_vm_image,this.detail_info.private_net.value="".concat(e.transfer_vm_vpc_ip,"（vpc ip）<br> ").concat(e.transfer_vm_storage_ip,"（存储网 ip）"),this.detail_info.status.value=e.status_cn}"monitor"!==this.source_name||sessionStorage.getItem("vm_monitor")||this.FnGetDetail()}},{key:"destroyed",value:function(){sessionStorage.removeItem("vm_monitor")}},{key:"FnChangeTab",value:function(e,t){t&&this.FnGetChartData()}}]),a}(f["e"]);Object(d["a"])([Object(f["f"])("default_tab")],k.prototype,"FnChangeTab",null),k=Object(d["a"])([Object(f["a"])({components:{BackHeader:p["a"],TimeGroup:m["a"],LineEchart:h["a"]}})],k);var O=k,j=O,T=(a("8b07"),a("7b78"),a("2877")),D=Object(T["a"])(j,i,n,!1,null,"c92f689c",null);t["default"]=D.exports},d772:function(e,t,a){"use strict";var i=a("81a9"),n=a("bff7");t["a"]={get_operate_record_list:function(e){return Object(i["a"])(Object(n["b"])("GET","/ecs/history_record/",e))},get_detail:function(e){return Object(i["a"])(Object(n["b"])("GET","/ecs/get_ecs_detail/",e))}}},ed46:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"box"},[a("div",[a("span",[e._v(e._s(e.title))]),e._t("left")],2),a("div",[e._t("default"),e.no_back?e._e():a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.FnBack}},[e._v("返回")])],2)]),a("div",{staticClass:"perch"})])},n=[],s=a("d4ec"),r=a("bee2"),u=a("262e"),o=a("2caf"),c=a("9ab4"),_=a("1b40"),l=function(e){Object(u["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(r["a"])(a,[{key:"FnBack",value:function(){this.back_url?this.$router.push(this.back_url):this.$router.go(-1)}}]),a}(_["e"]);Object(c["a"])([Object(_["c"])({default:""})],l.prototype,"title",void 0),Object(c["a"])([Object(_["c"])({default:""})],l.prototype,"back_url",void 0),Object(c["a"])([Object(_["c"])({default:!1})],l.prototype,"no_back",void 0),l=Object(c["a"])([_["a"]],l);var d=l,f=d,p=(a("bd09"),a("2877")),m=Object(p["a"])(f,i,n,!1,null,"bdf5ebe2",null);t["a"]=m.exports}}]);
//# sourceMappingURL=chunk-6fe9f8c4.1747715207673.js.map