(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-e84dbbbc","chunk-30f3228e","chunk-a1badcb8","chunk-740bba1a"],{"0003":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-alert",{attrs:{type:"warning",closable:!1},scopedSlots:e._u([{key:"title",fn:function(){return[s("p",[e._v("支持自定义填写恢复后新IP，若原IP未被占用则可以使用原IP；")]),s("p",[e._v("若未自定义填写恢复后新IP，则默认随机生成新可用IP；")]),s("p",[e._v("为避免自定义IP成功可用率较低，建议使用随机生成的新IP。")])]},proxy:!0}])}),s("el-table",{attrs:{data:e.multiple_selection,border:""}},[s("el-table-column",{attrs:{prop:"ecs_id",label:"云服务器ID"}}),s("el-table-column",{attrs:{prop:"ecs_name",label:"云服务器名称"}}),s("el-table-column",{attrs:{label:"原IP（最近使用）"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.ip_usage[t.row.ecs_id]?s("div",[e._v(" "+e._s(e.ip_usage[t.row.ecs_id].ip_address)+" "),e.ip_usage[t.row.ecs_id].is_used?s("span",{staticClass:"destroy"},[e._v("（已占用）")]):e._e()]):e._e()]}}])}),s("el-table-column",{attrs:{label:"恢复后新IP"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{placeholder:"请输入自定义IP"},model:{value:e.new_ip_address[t.row.ecs_id],callback:function(s){e.$set(e.new_ip_address,t.row.ecs_id,s)},expression:"new_ip_address[scope.row.ecs_id]"}})]}}])})],1)],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("96cf"),s("d81d"),s("d3b7"),s("159b"),s("07ac"),s("ddb0"),s("9ab4")),_=s("1b40"),d=s("e527"),p=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.ip_usage={},e.ip_available_list={},e.new_ip_address={},e}return Object(o["a"])(s,[{key:"FnGetIpUsage",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={customer_id:this.customer_id,ecs_ids:this.multiple_selection.map((function(e){return e.ecs_id}))},this.ip_usage={},e.next=4,d["a"].get_usage_ip(t);case 4:s=e.sent,"Success"===s.code&&(s.data.forEach((function(e){i.ip_usage[e.ecs_id]={ip_address:e.ip_address,is_used:e.is_used}})),this.$set(this.ip_usage));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnRecover",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,n,r,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Object.values(this.new_ip_address),s=[],e.t0=regeneratorRuntime.keys(this.new_ip_address);case 3:if((e.t1=e.t0()).done){e.next=12;break}if(i=e.t1.value,a=this.new_ip_address[i],!this.ip_usage[i].is_used||this.ip_usage[i].ip_address!==a){e.next=9;break}return this.$message.warning("恢复后新IP已被占用！"),e.abrupt("return");case 9:(s.indexOf(a)<0||!a)&&s.push(a),e.next=3;break;case 12:if(!(t.length>s.length)){e.next=15;break}return this.$message.warning("恢复后新IP重复！"),e.abrupt("return");case 15:return n={customer_id:this.customer_id,is_gpu:this.is_gpu,ecs_list:this.multiple_selection.map((function(e){return{ecs_id:e.ecs_id,ip_address:o.new_ip_address[e.ecs_id]}}))},e.next=18,d["a"].recover_instance(n);case 18:r=e.sent,"Success"==r.code&&(this.$message.success(r.msg||"成功下发 恢 复 任务！"),this.Fnclose());case 20:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"Fnclose",value:function(){}},{key:"created",value:function(){this.FnGetIpUsage()}}]),s}(_["e"]);Object(u["a"])([Object(_["c"])({default:""})],p.prototype,"customer_id",void 0),Object(u["a"])([Object(_["c"])({default:[]})],p.prototype,"multiple_selection",void 0),Object(u["a"])([Object(_["c"])({default:0})],p.prototype,"is_gpu",void 0),Object(u["a"])([Object(_["b"])("fn-close")],p.prototype,"Fnclose",null),p=Object(u["a"])([_["a"]],p);var h=p,f=h,m=s("2877"),b=Object(m["a"])(f,i,a,!1,null,null,null);t["a"]=b.exports},"008d":function(e,t,s){"use strict";s("f999")},"00b4":function(e,t,s){"use strict";s("ac1f");var i=s("23e7"),a=s("da84"),n=s("c65b"),r=s("e330"),o=s("1626"),c=s("861d"),l=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),u=a.Error,_=r(/./.test);i({target:"RegExp",proto:!0,forced:!l},{test:function(e){var t=this.exec;if(!o(t))return _(this,e);var s=n(t,this,e);if(null!==s&&!c(s))throw new u("RegExp exec method returned something other than an Object or null");return!!s}})},"00b7":function(e,t,s){},"018b":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("div",[s("action-block",{attrs:{search_option:e.search_option,type:"physical"},on:{"fn-search":e.fn_search}}),s("div",{staticClass:"icon m-bottom10"},[s("el-dropdown",{staticClass:"aliFont",on:{command:e.infoClick}},[s("el-button",{attrs:{type:"text"}},[s("svg-icon-font",{attrs:{iconName:"icon-gengduo"}})],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.rows_operate_btns,(function(t){return s("el-dropdown-item",{key:t.value,attrs:{command:t}},[e._v(e._s(t.label))])})),1)],1),s("el-tooltip",{attrs:{content:"自定义列表项",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.FnCustom}},[s("i",{staticClass:"el-icon-s-tools"})])],1),s("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.refresh}},[s("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1),s("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.down}},[s("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1)],1)],1),s("el-table",{ref:"table",attrs:{data:e.list,border:"",height:"100%","row-class-name":e.rowStyle},on:{"selection-change":e.handleSelectionChange,"sort-change":e.FnSortChange,"filter-change":e.filterAttribute,"row-click":e.FnOperRow,"row-contextmenu":e.FnRightClick}},[s("el-table-column",{attrs:{type:"selection"}}),e._l(e.custom_host,(function(t){return s("el-table-column",{key:t.prop,attrs:{"filter-multiple":!t.column_key&&null,prop:t.prop,"column-key":t.column_key?t.column_key:null,filters:t.column_key?t.list:null,sortable:t.sortable?t.sortable:null,width:t.width?t.width:null,type:t.type,label:t.label,"show-overflow-tooltip":t.overflow,"min-width":t.minWidth},scopedSlots:e._u(["cpu_rate"===t.prop?{key:"default",fn:function(e){return[s("el-progress",{attrs:{"stroke-width":14,color:"#455cc6",percentage:Math.round(e.row.cpu_rate)}})]}}:"ram_rate"===t.prop?{key:"default",fn:function(e){return[s("el-progress",{attrs:{"stroke-width":14,color:"#455cc6",percentage:Math.round(e.row.ram_rate)}})]}}:"gpu_rage"===t.prop?{key:"default",fn:function(e){return[s("el-progress",{attrs:{"stroke-width":14,color:"#455cc6",percentage:Math.round(e.row.gpu_rate)}})]}}:"host_name"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.host_name))]),s("br"),e._l(t.row.label,(function(t,i){return s("el-tag",{key:i,staticClass:"m-right5",attrs:{size:"mini"}},[e._v(e._s(t))])}))]}}:"is_prepare_host"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.is_prepare_host?"是":"否"))])]}}:null],null,!0)})}))],2),s("el-pagination",{attrs:{"current-page":e.page_info.current,"page-sizes":[20,50,100],"page-size":e.page_info.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.visible&&!["physical_detail","upload","migrate","record","resource","update_attribute","business_test","remark","set_label","service","rollback"].includes(e.oper_type)?[s("Operate",{attrs:{title:e.oper_label,rows:e.multi_rows,oper_type:e.oper_type,visible:e.visible},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"upload"===e.oper_type?[s("upload-file",{attrs:{visible:e.visible},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"migrate"===e.oper_type?[s("Migrate",{attrs:{visible:e.visible,rows:e.multi_rows},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"record"===e.oper_type?[s("Record",{attrs:{visible:e.visible,type:"physical",record_id:e.multi_rows[0].host_id},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&["resource","service","rollback"].includes(e.oper_type)?[s("Resource",{attrs:{visible:e.visible,rows:e.multi_rows,title:e.oper_label,oper_type:e.oper_type},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"business_test"===e.oper_type?[s("business-test",{attrs:{visible:e.visible,az_info:e.az_info},on:{"update:visible":function(t){e.visible=t}}})]:e._e(),e.visible&&"remark"===e.oper_type?[s("remark",{attrs:{visible:e.visible,rows:e.multi_rows[0]},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"set_label"===e.oper_type?[s("set_label",{attrs:{visible:e.visible,rows:e.multi_rows[0]},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),s("custom-list-item",{attrs:{visible:e.show_custom,all_item:e.all_item,all_column_item:e.all_column_item,type:"pod_host",newView:!0},on:{"update:visible":function(t){e.show_custom=t},"fn-custom":e.get_custom_columns}}),s("right-click",{attrs:{multi_rows:e.multi_rows,menus:e.menus,name:e.multi_rows.length>0?e.multi_rows[0].host_name:"",error_msg:e.error_msg},on:{"fn-click":e.infoClick}})],2)},a=[],n=s("ade3"),r=s("2909"),o=s("b85c"),c=s("5530"),l=s("1da1"),u=s("d4ec"),_=s("bee2"),d=s("262e"),p=s("2caf"),h=(s("96cf"),s("d3b7"),s("159b"),s("caad"),s("4de4"),s("2532"),s("d81d"),s("99af"),s("e9c4"),s("b0c0"),s("fb6a"),s("9ab4")),f=s("1b40"),m=s("c811"),b=s("3673"),v=s("bfc6"),g=s("af7d"),y=s("8ce4"),k=s("bd4d"),O=s("da8b"),j=s("e8c0"),w=s("cf88"),x=s("3f8d"),C=s("14a9"),S=s("343a"),z=s("74b1"),F=s("786f"),R=s("a881"),T=s("cf80"),$=s("edc2"),E=s("c1df"),I=s.n(E),P=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"标签设置",visible:e.visibleSync,width:"800px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visibleSync=t}}},[s("div",{staticClass:"text-align: center;"},[s("div",{staticStyle:{"text-align":"center"}},[s("div",{staticClass:"el-transfer",staticStyle:{"text-align":"left",display:"inline-block"}},[s("div",{staticClass:"el-transfer-panel"},[s("p",{staticClass:"el-transfer-panel__header"},[s("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.checkall},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("标签 "),s("span",[e._v(" "+e._s(e.num(e.source_data))+"/"+e._s(e.source_data.length)+" ")])])],1),s("div",{staticClass:"el-transfer-panel__body is-with-footer"},[s("div",[s("el-input",{attrs:{placeholder:"请输入标签内容",maxlength:"4"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addLabel()}},model:{value:e.inputLabel,callback:function(t){e.inputLabel=t},expression:"inputLabel"}})],1),s("div",{staticClass:"el-transfer-panel__list check-box"},[e._l(e.source_data,(function(t,i){return s("div",{key:i},[s("el-checkbox",{staticClass:"el-checkbox el-transfer-panel__item",attrs:{value:"item.check"},on:{change:function(t){return e.curcheck()}},model:{value:t.check,callback:function(s){e.$set(t,"check",s)},expression:"item.check"}},[s("span",[e._v(e._s(t.label_name))])])],1)})),0===e.source_data.length?s("div",{staticStyle:{"text-align":"center"}},[e._v("暂无数据")]):e._e()],2)]),s("p",{staticClass:"el-transfer-panel__footer"},[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",plain:""},on:{click:e.deleteLabel}},[e._v("删除")])],1)])]),s("div",{staticClass:"el-transfer__buttons"},[s("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left",disabled:0===e.num(e.target_data)},on:{click:e.toleft}}),s("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-right",disabled:0===e.num(e.source_data)},on:{click:e.toright}})],1),s("div",{staticClass:"el-transfer",staticStyle:{"text-align":"left",display:"inline-block"}},[s("div",{staticClass:"el-transfer-panel"},[s("p",{staticClass:"el-transfer-panel__header"},[s("el-checkbox",{attrs:{indeterminate:e.target_isIndeterminate},on:{change:e.checkall1},model:{value:e.checkAll1,callback:function(t){e.checkAll1=t},expression:"checkAll1"}},[e._v("已选择 "),s("span",[e._v(" "+e._s(e.num(e.target_data))+"/"+e._s(e.target_data.length)+" ")])])],1),s("div",{staticClass:"el-transfer-panel__body"},[s("div",{staticClass:"el-transfer-panel__list check-box"},[e._l(e.target_data,(function(t,i){return s("div",{key:i},[s("el-checkbox",{staticClass:"el-checkbox el-transfer-panel__item",attrs:{value:"item.check"},on:{change:function(t){return e.curcheck1()}},model:{value:t.check,callback:function(s){e.$set(t,"check",s)},expression:"item.check"}},[s("span",[e._v(e._s(t.label_name))])])],1)})),0===e.target_data.length?s("div",{staticStyle:{"text-align":"center"}},[e._v("暂无数据")]):e._e()],2)])])])])]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){e.visibleSync=!1}}},[e._v("取消")])],1)])],1)},D=[],G=(s("498a"),function(e){Object(d["a"])(s,e);var t=Object(p["a"])(s);function s(){var e;return Object(u["a"])(this,s),e=t.apply(this,arguments),e.target_data=[],e.source_data=[],e.inputLabel="",e.checkAll=!1,e.checkAll1=!1,e.isIndeterminate=!1,e.target_isIndeterminate=!1,e}return Object(_["a"])(s,[{key:"addLabel",value:function(){if(!(this.source_data.length>=30)){var e=this.inputLabel.trim();if(e){var t=[].concat(Object(r["a"])(this.source_data),Object(r["a"])(this.target_data));if(t.some((function(t){return t.label_name===e})))return void this.$message.warning("标签已存在");this.source_data.unshift({label_name:e,check:!1}),this.inputLabel=""}}}},{key:"checkall",value:function(){var e=this;this.source_data.forEach((function(t){return t.check=e.checkAll})),this.isIndeterminate=!1}},{key:"checkall1",value:function(){var e=this;this.target_data.forEach((function(t){return t.check=e.checkAll1})),this.target_isIndeterminate=!1}},{key:"num",get:function(){return function(e){return e.filter((function(e){return e.check})).length}}},{key:"curcheck",value:function(){var e=this.num(this.source_data);this.checkAll=this.source_data.every((function(e){return e.check})),this.isIndeterminate=e>0&&e<this.source_data.length}},{key:"curcheck1",value:function(){var e=this.num(this.target_data);this.checkAll1=this.target_data.every((function(e){return e.check})),this.target_isIndeterminate=e>0&&e<this.target_data.length}},{key:"deleteLabel",value:function(){this.source_data=this.source_data.filter((function(e){return!e.check}))}},{key:"toright",value:function(){if(3===this.target_data.length||this.num(this.source_data)+this.target_data.length>3)this.$message.warning("最多只能选择3个标签");else{var e=this.source_data.filter((function(e){return 1==e.check}));this.target_data=[].concat(Object(r["a"])(this.target_data),Object(r["a"])(e.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{check:!1})})))),this.source_data=this.source_data.filter((function(e){return!e.check}))}}},{key:"toleft",value:function(){var e=this.target_data.filter((function(e){return 1==e.check}));this.source_data=[].concat(Object(r["a"])(this.source_data),Object(r["a"])(e.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{check:!1})})))),this.target_data=this.target_data.filter((function(e){return!e.check}))}},{key:"created",value:function(){this.get_host_label(),this.rows.label.length>0&&(this.target_data=this.rows.label.map((function(e){return{label_name:e,check:!1}})))}},{key:"get_host_label",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].get_label_list({host_id:this.rows.host_id});case 2:t=e.sent,"Success"===t.code&&(this.source_data=t.data.label_list.map((function(e){return{label_name:e.label_name,check:!1}})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"confirm",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[].concat(Object(r["a"])(this.source_data),Object(r["a"])(this.target_data)).map((function(e){return e.label_name})),e.next=3,O["a"].add_host_label({host_id:this.rows.host_id,host_label_list:this.target_data.map((function(e){return e.label_name})),all_label_list:t});case 3:s=e.sent,"Success"===s.code?(this.$message.success(s.message),this.back("1")):this.back("0");case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visibleSync=!1}},{key:"watchcheck",value:function(e){0===this.num(e)?(this.checkAll=!1,this.isIndeterminate=!1):this.num(e)===e.length?(this.checkAll=!0,this.isIndeterminate=!1):(this.checkAll=!1,this.isIndeterminate=this.num(e)>0&&this.num(e)<e.length)}},{key:"watchcheck1",value:function(e){0===this.num(e)?(this.checkAll1=!1,this.target_isIndeterminate=!1):this.num(e)===e.length?(this.checkAll1=!0,this.target_isIndeterminate=!1):(this.checkAll1=!1,this.target_isIndeterminate=this.num(e)>0&&this.num(e)<e.length)}}]),s}(f["e"]));Object(h["a"])([Object(f["d"])("visible")],G.prototype,"visibleSync",void 0),Object(h["a"])([Object(f["c"])({default:function(){return{}}})],G.prototype,"rows",void 0),Object(h["a"])([Object(f["b"])("close")],G.prototype,"back",null),Object(h["a"])([Object(f["f"])("source_data")],G.prototype,"watchcheck",null),Object(h["a"])([Object(f["f"])("target_data")],G.prototype,"watchcheck1",null),G=Object(h["a"])([Object(f["a"])({})],G);var L=G,A=L,N=(s("be60"),s("2877")),M=Object(N["a"])(A,P,D,!1,null,"5f57a928",null),U=M.exports,B=s("1477"),Y=function(e){Object(d["a"])(s,e);var t=Object(p["a"])(s);function s(){var e;return Object(u["a"])(this,s),e=t.apply(this,arguments),e.list=[],e.all_column_item=[],e.multi_rows=[],e.search_data={},e.az_info={},e.visible=!1,e.oper_type="",e.oper_label="",e.power_list=[],e.filter_data={},e.machine_list=[],e.power_status="",e.machine_status="",e.filter_info={},e.sort_prop_name="",e.sort_order=void 0,e.page_info={current:1,size:20,total:0},e.all_item=[],e.custom_host=[],e.show_custom=!1,e.rows_operate_btns=[{label:"导入",value:"upload"},{label:"服务更新",value:"service"},{label:"回滚",value:"rollback"}],e.is_pare_host=[{text:"是",value:"1"},{text:"否",value:"0"}],e.search_option={out_band_address:{placeholder:"请输入带外IP"},host_ip:{placeholder:"请输入管理网IP"},host_name:{placeholder:"请输入主机名称"},host_id:{placeholder:"请输入主机ID"},vm_id:{placeholder:"请输入虚拟机ID"},cpu:{placeholder:"请输入CPU型号"},gpu_model:{placeholder:"请输入显卡型号"},nic:{placeholder:"请输入网卡型号"},room:{placeholder:"请选择机房",list:[]},host_rack:{placeholder:"请输入机柜编号"},bare_metal_id:{placeholder:"请输入物理机产品ID"},bare_metal_name:{placeholder:"请输入物理机产品名称"},label:{placeholder:"请选择标签",list:[]},create_time:{placeholder:["开始时间","结束时间"],type:"datetimerange",width:"360",clearable:!0,dis_day:31,defaultTime:[]}},e.switch_power=[{label:"开机",value:"start_up_host",disabled:!1},{label:"关机",value:"shutdown_host",disabled:!1},{label:"重启",value:"restart_host",disabled:!1}],e.lock_machine=[{label:"锁定机器",value:"lock",disabled:!1},{label:"解锁机器",value:"unlock",disabled:!1}],e.crash_list=[{label:"数据清理同步",value:"data_clear",disabled:!1},{label:"宕机恢复",value:"down_recover",disabled:!1}],e.maintenance_host=[{label:"设置维护",value:"maintenance",disabled:!1},{label:"完成维护",value:"finish",disabled:!1}],e.sign_host=[{label:"调度标记",value:"schedule",disabled:!1},{label:"迁移标记",value:"migrate_flag",disabled:!1}],e.error_msg={start_up_host:"已选主机需为在线或离线状态",shutdown_host:"已选主机需为在线或离线状态且无虚拟机运行",restart_host:"已选主机需为在线或离线状态",finish:"已选主机需为在线维护中或离线维护中",shelves:"已选主机上不能有虚拟机运行",disperse:"已选主机需为在线状态",migrate:"已选主机需为在线状态",unlock:"已选主机需为锁定状态",data_clear:"机器状态需为待清理状态",down_recover:"机器状态需为待恢复状态!",remove_cluster:"已选主机需为维护中状态",unstore_exception:"已选主机需为存储异常状态",set_prepar_host:"已选主机需为在线状态且为资源池",set_resource_pools:"已选主机需为在线状态且为备机"},e}return Object(_["a"])(s,[{key:"menus",get:function(){var e=[{label:"迁移",value:"migrate",single:!0,disabled:!1},{label:"操作记录",value:"record",single:!0,disabled:!1},{label:"分配资源",value:"resource",single:!0,disabled:!1},{label:"编辑备注",value:"remark",single:!0,disabled:!1},{label:"开关机",value:"start_or_shutdown",list:this.switch_power,disabled:!1},{label:"机器锁定",value:"lock_machine",disabled:!1,list:this.lock_machine},{label:"更换集群",value:"change_cluster",disabled:!1},{label:"移出集群",value:"remove_cluster",disabled:!1},{label:"机器维护",value:"maintenance",disabled:!1,list:this.maintenance_host},{label:"宕机处理",value:"crash",disabled:!1,list:this.crash_list},{label:"设备标记",value:"sign",disabled:!1,list:this.sign_host},{label:"底层同步",value:"under_sync",disabled:!1},{label:"驱散",value:"disperse",disabled:!1},{label:"欺骗器管理",value:"cheat",disabled:!1},{label:"业务测试",value:"business_test",disabled:!1},{label:"完成验证",value:"finish_validate",disabled:!1},{label:"解除存储异常",value:"unstore_exception",disabled:!1},{label:"服务更新",value:"service",disabled:!1},{label:"回滚",value:"rollback",disabled:!1},{label:"标签设置",value:"set_label",single:!0}];return this.multi_rows.length>0&&(this.multi_rows[0].is_prepare_host?e.push({label:"设为资源池",value:"set_resource_pools",disabled:!1}):e.push({label:"设为备机",value:"set_prepar_host",disabled:!1})),e}},{key:"watch_multi",value:function(){this.handleMenus()}},{key:"created",value:function(){this.get_room_list(),this.get_field(),this.get_pod_host_list(),this.get_status_list(),this.get_label_list()}},{key:"get_label_list",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.search_option.label.list=[],e.next=3,O["a"].get_all_host_label({});case 3:t=e.sent,"Success"===t.code&&t.data.all_host_label_list.forEach((function(e){s.search_option.label.list.push({label:e.label_name,type:e.label_name})}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_room_list",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,B["a"].get_room_list({});case 2:t=e.sent,"Success"===t.code&&t.data.machine_room.forEach((function(e){s.search_option.room.list.push({label:e,type:e})}));case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fn_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.search_data=Object(c["a"])({},e),this.page_info.current=1,this.judgeColumns(),this.get_pod_host_list()}},{key:"close",value:function(e){"set_label"===this.oper_type&&this.get_label_list(),"1"===e&&this.get_pod_host_list(),this.visible=!1,this.oper_type="",this.oper_label="",this.multi_rows=[];var t=this.$refs.table;t.clearSelection()}},{key:"handleMenus",value:function(){var e,t=Object(o["a"])(this.menus);try{for(t.s();!(e=t.n()).done;){var s=e.value;if(s.list){var i,a=Object(o["a"])(s.list);try{for(a.s();!(i=a.n()).done;){var n=i.value;n.disabled=this.handle(n.label,n.value)}}catch(r){a.e(r)}finally{a.f()}}else s.disabled=this.handle(s.label,s.value)}}catch(r){t.e(r)}finally{t.f()}}},{key:"handle",value:function(e,t){if("finish_validate"===t)return!this.multi_rows.every((function(e){return["init_error","init","offline"].includes(e.machine_status)}))&&(this.error_msg["finish_validate"]="物理机需为初始化状态或验证失败状态",!0);if("remove_cluster"===t&&this.multi_rows.every((function(e){return"0-0"===e.cluster_id})))return!0;if(["upload","resource","update_attribute","business_test","schedule","migrate_flag","cheat","under_sync"].includes(t))return"business_test"===t&&0===this.list.length&&(this.error_msg["business_test"]="当前无宿主机可进行业务测试!",!0);if("set_prepar_host"===t||"set_resource_pools"===t){var s=this.multi_rows.some((function(e){return e.is_prepare_host})),i=this.multi_rows.some((function(e){return!e.is_prepare_host}));return s&&i}if(!this.judge(t))return!0;if("disperse"===t){var a=this.multi_rows.filter((function(e){return"GPU"===e.host_purpose})),n=a.every((function(e){return e.ecs_list.every((function(e){return e.is_gpu&&"已关机"===e.status||!e.is_gpu}))}));if(!n)return this.error_msg["disperse"]="GPU物理机中的GPU云主机需为关机状态!",!1}}},{key:"judge",value:function(e){var t=Object(x["c"])(e),s=this.multi_rows.every((function(e){var s=0===t.power.length||t.power.includes(e.power_status),i=0===t.host.length||t.host.includes(e.machine_status),a=!t.vm||t.vm===e.ecs_count+1;return s&&i&&a}));return s}},{key:"infoClick",value:function(e){var t=e.label,s=e.value;e.list||e.disabled||("business_test"===s&&(this.az_info={az_id:this.$store.state.az_id,az_name:this.$store.state.az_list.az_name}),this.oper_type=s,this.oper_label=t,this.visible=!0,Object(w["a"])())}},{key:"watch_az",value:function(e){e&&this.refresh()}},{key:"refresh",value:function(){this.get_pod_host_list()}},{key:"FnOperRow",value:function(e){this.$refs.table.toggleRowSelection(e)}},{key:"rowStyle",value:function(e){var t=e.row,s=this.multi_rows.some((function(e){return e.host_id===t.host_id}));if(s)return"rowStyle"}},{key:"FnRightClick",value:function(e,t,s){var i=this.multi_rows.some((function(t){return t.host_id===e.host_id}));i||this.$refs.table.toggleRowSelection(e),Object(j["a"])(e,t,s)}},{key:"get_field",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].get_pod_host_field();case 2:t=e.sent,"Success"===t.code&&(s=["field_name","show_name"],i=["prop","label"],a=[],this.all_item=t.data.map((function(e){return a=[].concat(Object(r["a"])(a),Object(r["a"])(e.filed)),e})),this.all_column_item=Object(y["b"])(a,i,s),this.get_custom_columns(this.$store.state.pod.host_list),this.FnDoLayout());case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_custom_columns",value:function(e){var t=this;0!==e.length&&(this.custom_host=this.all_column_item.filter((function(t){return e.includes(t.label)})),this.custom_host.map((function(e){return["cpu_model","gpu_model","bare_metal_name","power_status_name","machine_status_name","is_prepare_host"].includes(e.prop)||(e=Object.assign(e,{},{sortable:"custom"})),["host_id","bare_metal_name","cpu_model"].includes(e.prop)&&(e=Object.assign(e,{},{width:"240px",overflow:!0})),["host_name","gpu_model"].includes(e.prop)&&(e=Object.assign(e,{},{width:"150px",overflow:!0})),["host_ip","out_band_address","gpu_count","ecs_count","cpu_rate","ram_rate","gpu_rage","machine_status_name","power_status_name"].includes(e.prop)&&(e=Object.assign(e,{},{minWidth:"120px"})),"power_status_name"===e.prop&&(e=Object.assign(e,{},{column_key:"power_status",list:t.power_list})),"machine_status_name"===e.prop&&(e=Object.assign(e,{},{column_key:"machine_status",list:t.machine_list})),"is_prepare_host"===e.prop&&(e=Object.assign(e,{},{column_key:"is_prepare_host",list:t.is_pare_host})),e})),this.FnDoLayout())}},{key:"FnDoLayout",value:function(){var e=this;this.$nextTick((function(){e.$refs.table.doLayout()}))}},{key:"get_status_list",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O["a"].get_status_list({});case 2:if(t=e.sent,"Success"===t.code){for(s in t.data.power_status)this.power_list.push({text:t.data.power_status[s],value:s});for(i in t.data.machine_status)this.machine_list.push({text:t.data.machine_status[i],value:i})}case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnCustom",value:function(){this.show_custom=!0}},{key:"down",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,n,r,o,l,u,_,d,p,h,f,m,b,v,g,y,k;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(y in t=this.search_data,s=t.room,i=t.host_name,a=t.vm_id,n=t.out_band_address,r=t.host_ip,o=t.host_id,l=t.gpu_model,u=t.host_rack,_=t.sort_host_ip,d=t.create_time,p=t.cpu,h=t.nic,f=t.bare_metal_name,m=t.bare_metal_id,b=t.label,v=Object(c["a"])(Object(c["a"])({machine_room_name:s,host_name:i,vm_id:a,out_band_address:n,host_ip:r,host_id:o,gpu_model:l,host_rack:u,sort_host_ip:_,cpu:p,nic:h,bare_metal_name:f,bare_metal_id:m,label:b,start_time:d&&d[0]?I()(d[0]).format("YYYY-MM-DD HH:mm:ss"):void 0,end_time:d&&d[1]?I()(d[1]).format("YYYY-MM-DD HH:mm:ss"):void 0},this.filter_info),{},{field_names:JSON.stringify(this.custom_host.map((function(e){return e.prop})))}),"pod_host"===this.$route.name&&(v["pod_id"]=this.$route.params.id),"cluster_host"===this.$route.name&&(v["cluster_id"]=this.$route.params.id),g="",v)v[y]&&(g+="".concat(y,"=").concat(v[y],"&"));k=""===g?"":"?".concat(g.slice(0,g.length-1)),window.location.href="/ecs_business/v1/host/host_list_download/".concat(k);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_pod_host_list",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,r,o,l,u,_,d,p,h,f,m,b,v,g,y,k;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$store.state.az_id){e.next=2;break}return e.abrupt("return");case 2:return t=this.search_data,s=t.room,i=t.host_name,a=t.vm_id,r=t.out_band_address,o=t.host_ip,l=t.host_id,u=t.gpu_model,_=t.host_rack,d=t.create_time,p=t.cpu,h=t.nic,f=t.bare_metal_name,m=t.bare_metal_id,b=t.vgpu_segment_type,v=t.host_info,g=t.label,y=Object(c["a"])(Object(n["a"])({host_name:i,vm_id:a,out_band_address:r,host_ip:o,host_id:l,gpu_model:u,host_rack:_,cpu:p,nic:h,bare_metal_name:f,bare_metal_id:m,host_info:v,label:g,machine_room_name:s,vgpu_segment_type:b?b[0]:void 0,start_time:d&&d[0]?I()(d[0]).format("YYYY-MM-DD HH:mm:ss"):void 0,end_time:d&&d[1]?I()(d[1]).format("YYYY-MM-DD HH:mm:ss"):void 0,page_index:this.page_info.current,page_size:this.page_info.size,az_id:this.$store.state.az_id},this.sort_prop_name,this.sort_order),this.filter_info),"pod_host"===this.$route.name&&(y["pod_id"]=this.$route.params.id),"cluster_host"===this.$route.name&&(y["cluster_id"]=this.$route.params.id),e.next=8,O["a"].get_pod_host_list(y);case 8:k=e.sent,"Success"===k.code&&(this.list=k.data.result,this.page_info.total=k.data.page_info.count);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"judgeColumns",value:function(){for(var e in this.filter_info={},this.filter_data)this.filter_info[e]=this.filter_data[e][0]}},{key:"filterAttribute",value:function(e){this.filter_data=Object(c["a"])(Object(c["a"])({},this.filter_data),e),this.judgeColumns(),this.get_pod_host_list()}},{key:"handleSelectionChange",value:function(e){this.multi_rows=e}},{key:"FnSortChange",value:function(e){var t={};this.all_item.forEach((function(e){e.filed.forEach((function(e){t[e.field_name]="sort_".concat(e.field_name)}))})),this.sort_prop_name=t[e.prop],this.sort_order="ascending"===e.order?"0":"descending"===e.order?"1":void 0,this.get_pod_host_list()}},{key:"handleSizeChange",value:function(e){this.page_info.size=e,this.get_pod_host_list()}},{key:"handleCurrentChange",value:function(e){this.page_info.current=e,this.get_pod_host_list()}}]),s}(f["e"]);Object(h["a"])([Object(f["f"])("multi_rows",{immediate:!0,deep:!0})],Y.prototype,"watch_multi",null),Object(h["a"])([Object(f["f"])("$store.state.az_id")],Y.prototype,"watch_az",null),Y=Object(h["a"])([Object(f["a"])({components:{Set_label:U,RightClick:k["a"],SearchFrom:v["a"],SvgIcon:b["a"],CustomListItem:g["a"],Operate:C["a"],UploadFile:S["a"],Migrate:z["a"],Record:F["a"],Resource:R["a"],BusinessTest:T["a"],Remark:$["a"],ActionBlock:m["a"]}})],Y);var H=Y,V=H,q=(s("59ee"),Object(N["a"])(V,i,a,!1,null,"7730da4e",null));t["default"]=q.exports},"039b":function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_snapshot_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_list/",e))},get_snapshot_chains_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_list/",e))},chains_detail:function(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_detail/",e))},record:function(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/history_record/",e))},get_monitor_id:function(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_disk_ids/",e))},get_snapshot_info:function(e){return Object(i["a"])(Object(a["i"])("POST","/snapshot/snapshot_use_monitor",e))}}},"047d":function(e,t,s){},"04d1":function(e,t,s){var i=s("342f"),a=i.match(/firefox\/(\d+)/i);e.exports=!!a&&+a[1]},"0692":function(e,t,s){},"06c5":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));s("fb6a"),s("d3b7"),s("b0c0"),s("a630"),s("3ca3"),s("ac1f"),s("00b4");var i=s("6b75");function a(e,t){if(e){if("string"===typeof e)return Object(i["a"])(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Object(i["a"])(e,t):void 0}}},"07ac":function(e,t,s){var i=s("23e7"),a=s("6f53").values;i({target:"Object",stat:!0},{values:function(e){return a(e)}})},"07e6":function(e,t,s){"use strict";s("89f7")},"0a4c":function(e,t,s){"use strict";s("1bfb")},"0ae5":function(e,t,s){"use strict";s("2325")},"0faa":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"info"},[e._m(0),s("div",{staticClass:"item"},e._l(e.base_info,(function(t,i){return s("div",{key:i},[s("span",{staticClass:"m-right20"},[e._v(e._s(t.label))]),s("span",[e._v(e._s(t.value))])])})),0),s("div",{staticClass:"progress"},e._l(e.progress_info,(function(t,i){return s("div",{key:i,staticClass:"bar"},[s("div",{staticClass:"flex-between m-bottom5"},[s("span",[e._v(e._s(t.label))])]),s("el-progress",{attrs:{"stroke-width":16,color:"#455cc6",percentage:Math.round(t.percentage)}}),s("div",{staticClass:"flex-between m-top5"},[s("span",[e._v("已用："+e._s(t.used+"/"+t.total))]),s("span",[e._v("可用："+e._s(t.available))])])],1)})),0)])},a=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icon"},[s("i",{staticClass:"iconfont icon-xinxi",staticStyle:{"font-size":"100px"}})])}],n=s("5530"),r=s("1da1"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("9ab4")),d=s("1b40"),p=s("3673"),h=s("da8b"),f=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.base_info={cluster_count:{label:"集群",value:"10"},host_count:{label:"主机",value:"20"},ecs_count:{label:"虚拟机",value:"100"}},e.progress_info={cpu:{label:"CPU",used:"200GHz",available:"",total:"4THz",percentage:0},memory:{label:"内存",used:"0",available:"",total:"0TB",percentage:0},gpu:{label:"GPU",used:"0块",available:"",total:"100块",breakdown:"20块",percentage:0},storage:{label:"存储",used:"0TB",available:"",total:"0TB",percentage:0}},e.detail_info={},e}return Object(c["a"])(s,[{key:"created",value:function(){this.get_pod_outline()}},{key:"watch_az",value:function(e){e&&this.get_pod_outline()}},{key:"get_pod_outline",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$store.state.az_id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,h["a"].get_pod_outline({az_id:this.$store.state.az_id,pod_id:this.$route.params.id});case 4:if(t=e.sent,"Success"===t.code){for(s in this.detail_info=t.data,this.base_info)this.base_info[s].value=this.detail_info[s];this.progress_info.cpu=Object(n["a"])(Object(n["a"])({},this.progress_info.cpu),{},{used:this.detail_info.cpu_statistic.used+"核",total:this.detail_info.cpu_statistic.total+"核",available:this.detail_info.cpu_statistic.available+"核",percentage:100*this.detail_info.cpu_statistic.rate}),this.progress_info.memory=Object(n["a"])(Object(n["a"])({},this.progress_info.memory),{},{used:this.detail_info.ram_statistic.used+"TB",total:this.detail_info.ram_statistic.total+"TB",available:this.detail_info.ram_statistic.available+"TB",percentage:100*this.detail_info.ram_statistic.rate}),this.progress_info.gpu=Object(n["a"])(Object(n["a"])({},this.progress_info.gpu),{},{used:this.detail_info.gpu_statistic.used+"个",total:this.detail_info.gpu_statistic.total+"个",available:this.detail_info.gpu_statistic.available+"个",percentage:100*this.detail_info.gpu_statistic.rate,breakdown:this.detail_info.gpu_statistic.fault+"块"}),this.progress_info.storage=Object(n["a"])(Object(n["a"])({},this.progress_info.storage),{},{used:this.detail_info.storage_statistic.used+"TB",total:this.detail_info.storage_statistic.total+"TB",available:this.detail_info.storage_statistic.available+"TB",percentage:100*this.detail_info.storage_statistic.rate})}case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),s}(d["e"]);Object(_["a"])([Object(d["c"])({default:""})],f.prototype,"cluster_id",void 0),Object(_["a"])([Object(d["f"])("$store.state.az_id")],f.prototype,"watch_az",null),f=Object(_["a"])([Object(d["a"])({components:{SvgIcon:p["a"]}})],f);var m=f,b=m,v=(s("1fb4"),s("2877")),g=Object(v["a"])(b,i,a,!1,null,"0461030c",null);t["default"]=g.exports},1116:function(e,t,s){"use strict";s("cb4f")},1148:function(e,t,s){"use strict";var i=s("da84"),a=s("5926"),n=s("577e"),r=s("1d80"),o=i.RangeError;e.exports=function(e){var t=n(r(this)),s="",i=a(e);if(i<0||i==1/0)throw o("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(s+=t);return s}},"13d5":function(e,t,s){"use strict";var i=s("23e7"),a=s("d58f").left,n=s("a640"),r=s("2d00"),o=s("605d"),c=n("reduce"),l=!o&&r>79&&r<83;i({target:"Array",proto:!0,forced:!c||l},{reduce:function(e){var t=arguments.length;return a(this,e,t,t>1?arguments[1]:void 0)}})},1477:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_host_list:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_list/",e))},get_room_list:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/machine_room_list/",e))},get_status_list:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_status_list/",e))},external_management:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/external_management/",e))},migrate:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/migration_operation/",e))},disperse:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/disperse_operation/",e))},record:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_operation_record/",e))},recommended_host:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/recommended_host/",e))},host_maintenance:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",e))},finish_maintenance:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_finish_maintenance/",e))},shelves:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_off_shelves/",e))},get_detail_overview:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_main_details/",e))},get_detail_storage:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_disk/",e))},down:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_list_download/",e))},host_operate:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/operate/",e))},host_import:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/import/",e))},get_host_attribution:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_attribution/",e))},set_host_attribution:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_attribution/",e))},get_host_type:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_config/",e))},update_attribute:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_config/",e))},getCustomerList:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_customer_list/",e))},getFamilyList:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_family_list/",e))},finish_validate:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/verification_finish/",e))},get_host_recycle_department:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_recycle_department/",e))},get_host_list_field:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_list_field/",e))},get_task_list:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/business_test_task/",e))},create_test_task:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/create_test_task/",e))},get_host_filter_item:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_filter_item/",e))},set_remark:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_remark/",e))},set_flag:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_tag/",e))},update_ecs_info:function(e){return Object(i["a"])(Object(a["d"])("POST","/ecs/update_ecs_info/",e))},crash_clear:function(e){return Object(i["a"])(Object(a["b"])("POST","/host/crash_clear/",e))},crash_recover:function(e){return Object(i["a"])(Object(a["b"])("POST","/host/crash_recover/",e))},set_lock:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_lock/",e))},set_unlock:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_unlock/",e))},set_maintenance:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",e))},get_maintenance_record:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_maintenance_record/",e))},get_lock_record:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_lock_record/",e))},recover_storage_error:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/recover_storage_error/",e))},agent_update:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_update/",e))},agent_rollback:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_rollback/",e))},set_prepare_host:function(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_prepare_host/",e))},get_ovs_version:function(e){return Object(i["a"])(Object(a["d"])("GET","/host/ovs_version_list/",e))}}},"14a9":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.title,visible:e.visible_sync,width:"760px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",["restart_host"===e.oper_type?s("el-alert",{attrs:{title:"操作重启请检查是否有虚机运行，若有，请谨慎操作！",type:"warning",center:"",closable:!1}}):e._e(),["lock","maintenance"].includes(e.oper_type)?e._e():s("el-alert",{attrs:{title:e.alert_title,type:"warning",center:"",closable:!1}}),["lock","maintenance"].includes(e.oper_type)?s("el-alert",{attrs:{title:"lock"===e.oper_type?"请确认将下述机器置为锁定状态，置为锁定状态后，无法在此机器上开出云主机":"请确认将下述机器置为维护状态，置为维护状态后，机器将屏蔽告警和任务下发等功能",type:"warning",center:"",closable:!1}}):e._e(),s("el-table",{attrs:{data:e.list,border:"","max-height":"253"}},[s("el-table-column",{attrs:{prop:"host_name",label:"主机名",width:"150"}}),["lock","maintenance"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"out_band_address",label:"宿主机带外"}}):e._e(),"finish_validate"===e.oper_type?s("el-table-column",{attrs:{prop:"az_name",label:"区域"}}):e._e(),e.status_list.concat(e.flag_list).includes(e.title)?e._e():s("el-table-column",{attrs:{prop:"machine_status_name",label:"主机状态"}}),["lock"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"ecs_count",label:"虚拟机数量",width:"150"}}):e._e(),["lock","maintenance"].includes(e.oper_type)?e._e():s("el-table-column",{attrs:{prop:"power_status_name",label:"电源状态"}}),["schedule","migrate_flag","cheat"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"machine_status_name",label:"机器状态"}}):e._e(),"finish_validate"===e.oper_type?s("el-table-column",{attrs:{prop:"host_purpose",label:"主机用途"}}):e._e(),["finish_validate","shelves"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"host_source",label:"主机来源"}}):e._e(),["schedule"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"scheduled_display",label:"允许调度"}}):e._e(),["migrate_flag"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"migrated_display",label:"允许迁移"}}):e._e(),["cheat"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"dummy_display",label:"欺骗器"}}):e._e(),["change_cluster"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"cluster_name",label:"当前集群"}}):e._e(),["maintenance"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"maintenance",label:"维护原因"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"请输入维护原因",maxlength:"50","show-word-limit":""},model:{value:t.row.maintenanceReason,callback:function(s){e.$set(t.row,"maintenanceReason",s)},expression:"scope.row.maintenanceReason"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.row.maintenanceReason,expression:"!scope.row.maintenanceReason"}],staticClass:"error_message"},[e._v("请输入维护原因")])]}}],null,!1,3682531027)}):e._e(),["lock"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"lock",label:"锁定原因"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"请输入锁定原因",maxlength:"50","show-word-limit":""},model:{value:t.row.lockReason,callback:function(s){e.$set(t.row,"lockReason",s)},expression:"scope.row.lockReason"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.row.lockReason,expression:"!scope.row.lockReason"}],staticClass:"error_message"},[e._v("请输入锁定原因")])]}}],null,!1,2858309765)}):e._e()],1),e.notSelectVmList.length>0?s("div",{staticClass:"m-top10"},[s("span",{staticClass:"tip_message"},[e._v("仅支持对状态为“锁定中”且无虚拟机运行的宿主机进行“设置维护”操作，有"+e._s(e.notSelectVmList.length)+"台宿主机不满足要求")])]):e._e(),["shelves","finish_validate","schedule","migrate_flag","cheat","change_cluster"].includes(e.oper_type)?s("el-form",{ref:"form",staticClass:"m-top20",attrs:{model:e.form_data,"label-width":"100px","label-position":"left"}},["finish_validate"===e.oper_type?s("el-form-item",{attrs:{prop:"valid",label:"验证结果:",rules:[{required:!0,message:"请选择验证结果",trigger:"blur"}]}},[s("el-radio-group",{model:{value:e.form_data.valid,callback:function(t){e.$set(e.form_data,"valid",t)},expression:"form_data.valid"}},[s("el-radio",{attrs:{label:"1"}},[e._v("成功")]),s("el-radio",{attrs:{label:"0"}},[e._v("失败")])],1)],1):e._e(),["schedule","migrate_flag","cheat"].includes(e.oper_type)?s("el-form-item",{attrs:{prop:"isFlag",label:e.labelObj[e.oper_type]}},[s("el-radio-group",{model:{value:e.form_data.isSet,callback:function(t){e.$set(e.form_data,"isSet",t)},expression:"form_data.isSet"}},[s("el-radio",{attrs:{label:"1"}},[e._v(e._s(e.valueObj[e.oper_type][0]))]),s("el-radio",{attrs:{label:"0"}},[e._v(e._s(e.valueObj[e.oper_type][1]))])],1)],1):e._e(),["schedule","migrate_flag","cheat"].includes(e.oper_type)||"finish_validate"===e.oper_type&&"0"===e.form_data.valid?s("el-form-item",{attrs:{prop:"reason",label:"说明:"}},[s("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:["schedule","migrate_flag","cheat"].includes(e.oper_type)?128:256},model:{value:e.form_data.reason,callback:function(t){e.$set(e.form_data,"reason",t)},expression:"form_data.reason"}})],1):e._e(),["schedule","migrate_flag","cheat","change_cluster"].includes(e.oper_type)?e._e():s("el-form-item",{attrs:{prop:"recycleId",label:"finish_validate"===e.oper_type?"通知对象：":"回收部门：",rules:[{required:!0,message:"请选择"+("finish_validate"===e.oper_type?"通知对象":"回收部门"),trigger:"blur"}]}},[s("el-select",{model:{value:e.form_data.recycleId,callback:function(t){e.$set(e.form_data,"recycleId",t)},expression:"form_data.recycleId"}},e._l(e.recycle_list,(function(e){return s("el-option",{key:e.department_en,attrs:{label:e.department_name,value:e.department_name}})})),1)],1),"change_cluster"===e.oper_type?s("el-form-item",{attrs:{prop:"reason",label:"选择集群:"}},[s("el-select",{attrs:{placeholder:"请选择要加入的集群"},model:{value:e.form_data.toCluster,callback:function(t){e.$set(e.form_data,"toCluster",t)},expression:"form_data.toCluster"}},e._l(e.cluster_list,(function(e){return s("el-option",{key:e.cluster_id,attrs:{value:e.cluster_id,label:e.cluster_name}})})),1)],1):e._e()],1):e._e()],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",disabled:0===e.list.length},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},a=[],n=s("b85c"),r=s("ade3"),o=s("1da1"),c=s("2909"),l=s("5530"),u=s("d4ec"),_=s("bee2"),d=s("262e"),p=s("2caf"),h=(s("96cf"),s("99af"),s("caad"),s("d3b7"),s("159b"),s("d81d"),s("b0c0"),s("2532"),s("a9e3"),s("9ab4")),f=s("1b40"),m=s("c811"),b=s("1477"),v=s("da8b"),g=s("3fa7"),y=s("6285"),k=function(e){Object(d["a"])(s,e);var t=Object(p["a"])(s);function s(){var e;return Object(u["a"])(this,s),e=t.apply(this,arguments),e.alert_title="是否确定对以下".concat(e.rows.length,"台物理机执行").concat(e.title,"操作？"),e.status_list=["开机","关机","重启"],e.flag_list=["调度标记","迁移标记","欺骗器管理"],e.valid=1,e.isFlag=1,e.selectVmList=[],e.notSelectVmList=[],e.list=[],e.cluster_list=[],e.labelObj={schedule:"是否允许调度",migrate_flag:"是否允许迁移",cheat:"欺骗器"},e.op_typ_list={schedule:"set_host_scheduled",migrate_flag:"set_host_migrated",cheat:"set_host_dummy"},e.op_typ_req={schedule:"scheduled",migrate_flag:"migrated",cheat:"dummy"},e.valueObj={schedule:["是","否"],migrate_flag:["是","否"],cheat:["有","无"]},e.recycle_list=[],e.form_data={valid:"",recycleId:"",reason:"",isSet:"cheat"===e.oper_type?"0":"1",toCluster:""},e.operate_info={start_up_host:"host_operate",shutdown_host:"host_operate",restart_host:"host_operate",online_maintenance:"host_maintenance",offline_maintenance:"host_maintenance",finish:"finish_maintenance",shelves:"shelves",disperse:"disperse",finish_validate:"finish_validate",schedule:"set_flag",migrate_flag:"set_flag",cheat:"set_flag",under_sync:"update_ecs_info",data_clear:"crash_clear",down_recover:"crash_recover",lock:"set_lock",unlock:"set_unlock",maintenance:"set_maintenance",change_cluster:"add_cluster",unstore_exception:"recover_storage_error",set_prepar_host:"set_prepare_host",set_resource_pools:"set_prepare_host"},e}return Object(_["a"])(s,[{key:"created",value:function(){var e=this;["shelves","finish_validate"].includes(this.oper_type)&&this.get_host_recycle_department(),"change_cluster"===this.oper_type&&this.getClusterList(),"maintenance"===this.oper_type?(this.rows.forEach((function(t){"lock"===t.machine_status&&0===t.ecs_count?e.selectVmList.push(t):e.notSelectVmList.push(t)})),this.list=this.selectVmList.map((function(e){return Object(l["a"])(Object(l["a"])({},e),{},{maintenanceReason:""})}))):"lock"===this.oper_type?this.list=this.rows.map((function(e){return Object(l["a"])(Object(l["a"])({},e),{},{lockReason:""})})):(this.list=[],this.list=[].concat(Object(c["a"])(this.list),Object(c["a"])(this.rows)))}},{key:"getClusterList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(y["a"])(this.$route.params.id),s={page_index:1,page_size:1e3,az_id:this.$store.state.az_id,pod_id:"pod_host"===this.$route.name?this.$route.params.id:t},e.next=4,v["a"].get_pod_cluster_list(s);case 4:i=e.sent,"Success"===i.code&&(this.cluster_list=i.data.result);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_host_recycle_department",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["a"].get_host_recycle_department({});case 2:t=e.sent,"Success"===t.code&&(this.recycle_list=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,o,c,u,_,d,p,h,f,m,y,k,O,j,w=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(this.rows[0].host_id,"-------",this.oper_type),!["shelves","finish_validate"].includes(this.oper_type)){e.next=7;break}if(s=!0,i=this.$refs.form,i.validate((function(e){e||(s=!1)})),s){e.next=7;break}return e.abrupt("return",!1);case 7:if("maintenance"!==this.oper_type){e.next=11;break}if(a=this.list.some((function(e){return!e.maintenanceReason})),!a){e.next=11;break}return e.abrupt("return",!1);case 11:if("lock"!==this.oper_type){e.next=15;break}if(o=this.list.some((function(e){return!e.lockReason})),!o){e.next=15;break}return e.abrupt("return",!1);case 15:if(c=this.list.map((function(e){return{host_id:e.host_id,reason:e.maintenanceReason}})),u=this.list.map((function(e){return{host_id:e.host_id,reason:e.lockReason}})),_=this.list.map((function(e){return{host_id:e.host_id,cluster_id:w.form_data.toCluster}})),d=this.list.map((function(e){return{host_id:e.host_id,cluster_id:"0-0"}})),p="set_prepar_host"===this.oper_type?"prepare_host":"resource_pool",h=this.status_list.includes(this.title)?{op_type:this.oper_type,host_ids:this.rows.map((function(e){return e.host_id}))}:["schedule","migrate_flag","cheat"].includes(this.oper_type)?(t={host_ids:this.rows.map((function(e){return e.host_id}))},Object(r["a"])(t,this.op_typ_req[this.oper_type],Number(this.form_data.isSet)),Object(r["a"])(t,"description",this.form_data.reason),Object(r["a"])(t,"op_type",this.op_typ_list[this.oper_type]),t):["online_maintenance","offline_maintenance"].includes(this.oper_type)?{maintenance_type:this.oper_type,host_ids:this.rows.map((function(e){return e.host_id}))}:"finish_validate"===this.oper_type?{host_ids:this.rows.map((function(e){return e.host_id})),status:"1"===this.form_data.valid?"READY":"INIT_ERROR",noticer:this.form_data.recycleId,reason:"0"===this.form_data.valid?this.form_data.reason:void 0}:"shelves"===this.oper_type?{host_ids:this.rows.map((function(e){return e.host_id})),department_name:this.form_data.recycleId}:"under_sync"===this.oper_type?{pod_id:this.$store.state.pod_id,host_ecs:{}}:"maintenance"===this.oper_type?{maintenance_detail:c,host_ids:this.list.map((function(e){return e.host_id}))}:"lock"===this.oper_type?{lock_detail:u,host_ids:this.list.map((function(e){return e.host_id}))}:"change_cluster"===this.oper_type?{param:_}:"remove_cluster"===this.oper_type?{param:d,is_move_out:"1"}:"set_prepar_host"===this.oper_type||"set_resource_pools"===this.oper_type?{host_id:this.rows[0].host_id,set_type:p}:{host_ids:this.rows.map((function(e){return e.host_id}))},"under_sync"===this.oper_type){f=Object(n["a"])(this.rows);try{for(y=function(){var e=m.value;h.host_ecs[e.host_id]=[],e.ecs_list.length>0&&e.ecs_list.map((function(t){h.host_ecs[e.host_id].push(t.ecs_id)}))},f.s();!(m=f.n()).done;)y()}catch(x){f.e(x)}finally{f.f()}}if(k={},"change_cluster"===this.oper_type||"remove_cluster"===this.oper_type){e.next=29;break}return e.next=26,b["a"][this.operate_info[this.oper_type]](Object(l["a"])({},h));case 26:k=e.sent,e.next=32;break;case 29:return e.next=31,v["a"].add_cluster(Object(l["a"])({},h));case 31:k=e.sent;case 32:if("Success"!==k.code){e.next=67;break}if(!["finish_validate","disperse","under_sync","set_prepar_host","set_resource_pools"].includes(this.oper_type)){e.next=38;break}this.$message.success(k.message),this.back("1"),e.next=65;break;case 38:if(!["data_clear","down_recover","change_cluster","remove_cluster"].includes(this.oper_type)){e.next=50;break}if(!(k.data.fail_host_list.length>0)){e.next=45;break}return this.$message.warning(k.message+"。"+k.data.error_msg),this.back("0"),e.abrupt("return");case 45:this.$message.success(k.message),this.back("1"),["change_cluster","remove_cluster"].includes(this.oper_type)&&g["a"].$emit("getTreeData",!1);case 48:e.next=65;break;case 50:if(!(k.data.fail_host_list.length>0)){e.next=63;break}if("maintenance"!==this.oper_type){e.next=58;break}for(j in O="",k.data.fail_msg_group_by_host)O+=k.data.fail_msg_group_by_host[j]+"\n";this.$message.error(O),this.back("0"),e.next=61;break;case 58:return this.$message.warning(k.message+k.data.fail_msg),this.back("0"),e.abrupt("return");case 61:e.next=65;break;case 63:this.$message.success(k.message),this.back("1");case 65:e.next=68;break;case 67:this.back("0");case 68:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(f["e"]);Object(h["a"])([Object(f["d"])("visible")],k.prototype,"visible_sync",void 0),Object(h["a"])([Object(f["c"])({default:function(){return[]}})],k.prototype,"rows",void 0),Object(h["a"])([Object(f["c"])(String)],k.prototype,"title",void 0),Object(h["a"])([Object(f["c"])(String)],k.prototype,"oper_type",void 0),Object(h["a"])([Object(f["b"])("close")],k.prototype,"back",null),k=Object(h["a"])([Object(f["a"])({components:{ActionBlock:m["a"]}})],k);var O=k,j=O,w=s("2877"),x=Object(w["a"])(j,i,a,!1,null,null,null);t["a"]=x.exports},1827:function(e,t,s){},"1b7c":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-tooltip",{attrs:{content:e.content,placement:e.placement,effect:e.effect,"popper-class":"tooltip-class"},scopedSlots:e._u([{key:"content",fn:function(){return[e._t("content")]},proxy:!0}],null,!0)},[s("el-button",{attrs:{type:"text"}},[s("svg-icon",{attrs:{icon:"info",viewBox:"0 0 18 18"}})],1)],1)},a=[],n=s("bee2"),r=s("d4ec"),o=s("262e"),c=s("2caf"),l=s("9ab4"),u=s("1b40"),_=s("3673"),d=function(e){Object(o["a"])(s,e);var t=Object(c["a"])(s);function s(){return Object(r["a"])(this,s),t.apply(this,arguments)}return Object(n["a"])(s)}(u["e"]);Object(l["a"])([Object(u["c"])({default:""})],d.prototype,"content",void 0),Object(l["a"])([Object(u["c"])({default:"right"})],d.prototype,"placement",void 0),Object(l["a"])([Object(u["c"])({default:"light"})],d.prototype,"effect",void 0),d=Object(l["a"])([Object(u["a"])({components:{svgIcon:_["a"]}})],d);var p=d,h=p,f=(s("b4f2"),s("2877")),m=Object(f["a"])(h,i,a,!1,null,null,null);t["a"]=m.exports},"1bfb":function(e,t,s){},"1c59":function(e,t,s){"use strict";var i=s("6d61"),a=s("6566");i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a)},"1c98":function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={create:function(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/create_disk/",e))},get_disk_type:function(e){return Object(i["a"])(Object(a["b"])("GET","/ebs/disk_info/",e))},get_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/get_price/",e))},get_capacity_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/get_ebs_price/",e))},get_disk_limit:function(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/get_disk_limit/",e))},get_disk_detail:function(e){return Object(i["a"])(Object(a["b"])("GET","/ebs/get_disk_detail/",e))},getDiskRules:function(e){return Object(i["a"])(Object(a["b"])("POST","/ebs/disk_rules/",e))}}},"1e61":function(e,t,s){},"1f00":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"制作公共镜像",visible:e.visible_sync,width:"500px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t}}},[s("el-form",{ref:"form_ecs",attrs:{model:e.form_data,"label-position":"left","label-width":"100px","label-suffix":":"}},[s("el-form-item",{staticClass:"content",attrs:{label:"实例名称/ID"}},[s("span",[e._v(e._s(e.form_data.ecs))])]),s("el-form-item",{staticClass:"content",attrs:{label:"客户名称/ID"}},[s("span",[e._v(e._s(e.form_data.customer))])]),s("el-form-item",{staticClass:"content",attrs:{label:"可用区"}},[s("span",[e._v(e._s(e.form_data.az))])]),s("el-form-item",{staticClass:"content",attrs:{label:"实例规格"}},[s("span",[e._v(e._s(e.form_data.spec))])]),s("el-form-item",{staticClass:"content",attrs:{label:"系统盘"}},[s("span",[e._v(e._s(e.form_data.system_disk))])]),s("el-form-item",{staticClass:"content",attrs:{label:"镜像"}},[s("span",[e._v(e._s(e.form_data.mirror))])]),s("el-form-item",{attrs:{label:"镜像名称",prop:"name",rules:[{required:!0,message:"请输入镜像名称",trigger:"blur"}]}},[s("el-input",{model:{value:e.form_data.name,callback:function(t){e.$set(e.form_data,"name",t)},expression:" form_data.name"}})],1),s("el-form-item",{staticClass:"test",attrs:{label:"测试账户ID",prop:"test_id",rules:[{required:!0,trigger:"blur",validator:e.validate_account}]}},[s("div",{staticClass:"test"},[s("customer-input",{on:{FnCustomer:e.FnCustomer}})],1),s("el-tooltip",{attrs:{content:"请选择测试账户ID，待镜像制作完成进行测试",placement:"right",effect:"light"}},[s("el-button",{staticClass:"m-left10",attrs:{type:"text"}},[s("svg-icon",{attrs:{icon:"info"}})],1)],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")]),s("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("96cf"),s("99af"),s("d9e2"),s("b0c0"),s("9ab4")),_=s("1b40"),d=s("3673"),p=s("e527"),h=s("bad9"),f=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.form_data={ecs:"".concat(e.ecs_info.ecs_name," / ").concat(e.ecs_info.ecs_id),customer:"".concat(e.ecs_info.customer_name," / ").concat(e.ecs_info.customer_id),az:e.ecs_info.az_name,spec:e.ecs_info.is_gpu?"".concat(e.ecs_info.cpu_size,"vCPU").concat(e.ecs_info.ram_size,"GiB  ").concat(e.ecs_info.gpu_size,"*").concat(e.ecs_info.gpu_show_type):"".concat(e.ecs_info.cpu_size,"vCPU").concat(e.ecs_info.ram_size,"GiB"),system_disk:e.new?"".concat(e.ecs_info.disk_info.system.system_disk_type," ").concat(e.ecs_info.disk_info.system.disk_size,"GB"):"".concat(e.ecs_info.system_disk_type," ").concat(e.ecs_info.system_disk_size,"GB"),mirror:e.ecs_info.os_name,name:"",test_id:""},e}return Object(o["a"])(s,[{key:"FnCustomer",value:function(e){this.form_data.test_id=e}},{key:"validate_account",value:function(e,t,s){return 0===t.length?s(new Error("请选择测试账户ID")):s()}},{key:"confirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.$refs.form_ecs,t.validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,p["a"].add_common_mirror({display_name:s.form_data.name,az_id:s.ecs_info.az_id,ecs_id:s.ecs_info.ecs_id,customer_id:s.ecs_info.customer_id,customer_ids:s.form_data.test_id});case 3:i=e.sent,"Success"===i.code&&s.$message.success(i.message),s.visible_sync=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"cancel",value:function(){this.visible_sync=!1}}]),s}(_["e"]);Object(u["a"])([Object(_["d"])("visible")],f.prototype,"visible_sync",void 0),Object(u["a"])([Object(_["c"])({default:function(){}})],f.prototype,"ecs_info",void 0),Object(u["a"])([Object(_["c"])({default:!1})],f.prototype,"new",void 0),f=Object(u["a"])([Object(_["a"])({components:{SvgIcon:d["a"],CustomerInput:h["a"]}})],f);var m=f,b=m,v=(s("e52b"),s("2877")),g=Object(v["a"])(b,i,a,!1,null,"22e3d05c",null);t["a"]=g.exports},"1fb4":function(e,t,s){"use strict";s("315f")},2325:function(e,t,s){},"268f":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"操作记录",visible:e.visible,width:"60%","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[s("div",[s("el-dialog",{attrs:{title:"响应信息",visible:e.res_visible,width:"60%","destroy-on-close":!0,"append-to-body":"","custom-class":"response-data"},on:{"update:visible":function(t){e.res_visible=t},close:e.clost_res}},[s("div",[e._v(e._s(e.response))])])],1),s("div",[s("action-block",{attrs:{search_option:["physical","message"].includes(e.type)?Object.assign({},e.search):e.search},on:{"fn-search":e.fn_search}}),["physical","message"].includes(e.type)?s("div",{staticClass:"icon m-bottom10"},[s("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.getOperateRecordList}},[s("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1)],1):e._e(),s("el-table",{staticClass:"record-table",attrs:{data:e.record_list,border:""}},[s("el-table-column",{attrs:{prop:"oper_time",label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.oper_time?e.moment(t.row.oper_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),s("el-table-column",{attrs:{prop:"oper_type_display",label:"操作内容"}}),s("el-table-column",{attrs:{prop:"status_display",label:"状态"}}),["message","physical"].includes(e.type)?s("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.response?s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.view(t.row.response)}}},[e._v("查看")]):s("span",[e._v("-")])]}}])}):s("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.view(t.row.result)}}},[e._v("查看")]):s("span",[e._v("-")])]}}],null,!1,79404134)}),s("el-table-column",{attrs:{prop:"finish_time",label:"完成时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.finish_time?e.moment(t.row.finish_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),s("el-table-column",{attrs:{prop:"oper_user",label:"nas"===e.type?"操作用户":"用户名"}}),["physical","message"].includes(e.type)?e._e():s("el-table-column",{attrs:{prop:"flag_display",label:"操作标识"}})],1),s("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},a=[],n=s("5530"),r=s("1da1"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("ac1f"),s("841c"),s("caad"),s("9ab4")),d=s("1b40"),p=s("c811"),h=s("d772"),f=s("1477"),m=s("e4d0"),b=s("039b"),v=s("fc43"),g=s("c1df"),y=s.n(g),k=s("8ce4"),O=s("3673"),j=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.state_list=[{type:"",label:"全部"},{type:"doing",label:"执行中"},{type:"success",label:"成功"},{type:"failed",label:"失败"}],e.search={state:{list:e.state_list,placeholder:"请选择状态"},content:{placeholder:"请输入操作内容"}},e.record_list=[],e.current=1,e.size=20,e.total=0,e.search_data={},e.moment=y.a,e.response="",e.res_visible=!1,e}return Object(c["a"])(s,[{key:"created",value:function(){this.fn_search()}},{key:"fn_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.current=1,this.search_data=e,this.getOperateRecordList()}},{key:"getOperateRecordList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,r,o,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=this.search_data,i="physical"!==this.type?{task_type:s.content,cloud_id:this.record_id}:{content:s.content,cloud_id:this.record_id,cloud_type:"host"},a=Object(n["a"])({status:s.state||"",page_size:this.size,page_index:this.current},i),"physical"!==this.type){e.next=9;break}return e.next=6,f["a"].record(Object(n["a"])({},a));case 6:t=e.sent,e.next=30;break;case 9:if("message"!==this.type){e.next=15;break}return e.next=12,m["a"].get_pub_operate_record({os_id:this.record_id,status:s.state||"",content_type:s.content,page_size:this.size,page_index:this.current});case 12:t=e.sent,e.next=30;break;case 15:if("snapshot"!==this.type){e.next=21;break}return e.next=18,b["a"].record({cloud_id:this.record_id,cloud_type:"snapshot",status:s.state||"",task_type:s.content,page_size:this.size,page_index:this.current});case 18:t=e.sent,e.next=30;break;case 21:if("nas"!==this.type){e.next=27;break}return e.next=24,v["a"].get_nas_record(Object(n["a"])({},a));case 24:t=e.sent,e.next=30;break;case 27:return e.next=29,h["a"].get_operate_record_list(Object(n["a"])({cloud_type:this.type?this.type:"ecs"},a));case 29:t=e.sent;case 30:"Success"===t.code&&(["physical","message"].includes(this.type)?(l=["create_time","content","status_name","response","update_time","op_user"],u=["oper_time","oper_type_display","status_display","response","finish_time","oper_user"],this.record_list=Object(k["b"])(t.data.operation_list,u,l)):this.record_list=(null===(c=t.data)||void 0===c?void 0:c.history_record)||[],this.total=(null===(r=t.data)||void 0===r||null===(o=r.page_info)||void 0===o?void 0:o.count)||0);case 31:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.size=e,this.getOperateRecordList()}},{key:"handleCurrentChange",value:function(e){this.current=e,this.getOperateRecordList()}},{key:"view",value:function(e){this.response=e,this.res_visible=!0}},{key:"clost_res",value:function(){this.res_visible=!1,this.response=""}},{key:"back",value:function(){}}]),s}(d["e"]);Object(_["a"])([Object(d["c"])(Boolean)],j.prototype,"visible",void 0),Object(_["a"])([Object(d["c"])(String)],j.prototype,"record_id",void 0),Object(_["a"])([Object(d["c"])(String)],j.prototype,"type",void 0),Object(_["a"])([Object(d["b"])("close")],j.prototype,"back",null),j=Object(_["a"])([Object(d["a"])({components:{ActionBlock:p["a"],SvgIcon:O["a"]}})],j);var w=j,x=w,C=(s("1116"),s("2877")),S=Object(C["a"])(x,i,a,!1,null,null,null);t["a"]=S.exports},"26c7":function(e,t,s){"use strict";s("a72b")},2909:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var i=s("6b75");function a(e){if(Array.isArray(e))return Object(i["a"])(e)}s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0"),s("a630");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var r=s("06c5");s("d9e2");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return a(e)||n(e)||Object(r["a"])(e)||o()}},"29ab":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"resetForm",staticClass:"pwd-form",attrs:{model:e.data,"label-position":"left","label-width":"120px",rules:e.rules,"inline-message":!0}},[s("el-form-item",{attrs:{label:"镜像"}},[s("el-radio-group",{model:{value:e.default_os_template_type.os_template_type,callback:function(t){e.$set(e.default_os_template_type,"os_template_type",t)},expression:"default_os_template_type.os_template_type"}},e._l(e.os_list,(function(t,i){return s("el-radio-button",{key:i,attrs:{label:i}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),s("div",{staticClass:"inline-form"},[s("el-form-item",{staticClass:"m-right20",attrs:{prop:"default_os_type"}},[s("el-select",{model:{value:e.data.default_os_type,callback:function(t){e.$set(e.data,"default_os_type",t)},expression:"data.default_os_type"}},e._l(e.default_os_template_type.os_types,(function(e){return s("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1),s("el-form-item",{attrs:{prop:"default_os_version"}},[s("el-select",{attrs:{"value-key":"os_id"},on:{change:e.FnEmit},model:{value:e.data.default_os_version,callback:function(t){e.$set(e.data,"default_os_version",t)},expression:"data.default_os_version"}},e._l(e.default_os_version_list,(function(e){return s("el-option",{key:e.os_id,attrs:{value:e,label:e.name}})})),1)],1)],1)],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("96cf"),s("d9e2"),s("b64b"),s("4de4"),s("d3b7"),s("caad"),s("2532"),s("b0c0"),s("7db0"),s("9ab4")),_=s("1b40"),d=s("9074"),p=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.os_list={},e.default_os_template_type={os_template_type:"",os_types:[],os_versions:{}},e.default_os_version_list=[],e.data={default_os_type:"",default_os_version:{os_id:"",os_type:"",username:"",disk_size:0}},e.FnCheckOs=function(e,t,s){t.os_id||s(new Error("请选择镜像")),s()},e.rules={default_os_type:[{required:!0,trigger:"change",message:" "}],default_os_version:[{required:!0,validator:e.FnCheckOs,trigger:"change"}]},e}return Object(o["a"])(s,[{key:"FnGetOsList",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.az_id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,d["a"].get_os_list({customer_id:this.customer_id,az_id:this.az_id});case 4:t=e.sent,"Success"==t.code&&(this.os_list=t.data,this.FnHandleInitData());case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnHandleInitData",value:function(){this.default_os_type&&(this.default_os_template_type.os_template_type=this.default_os_type),this.default_os_template_type.os_template_type===Object.keys(this.os_list)[0]?this.FnChangeOsTemType(this.default_os_template_type.os_template_type):this.default_os_template_type.os_template_type=Object.keys(this.os_list)[0]}},{key:"FnHandleOsList",value:function(e){var t=this;if(!e||0===e.length)return[];var s=e.filter((function(e){return e.support_type.includes("gpu")&&e.support_type.includes("cpu")?e:t.is_gpu?e.support_type.includes("gpu")&&e.support_gpu_driver==t.support_gpu_driver:e.support_type.includes("cpu")&&e.support_gpu_driver==t.support_gpu_driver}));return s}},{key:"FnEmit",value:function(){var e=this;return{os_id:this.data.default_os_version.os_id,os_type:this.data.default_os_version.os_type,username:this.data.default_os_version.username,disk_size:this.data.default_os_version.disk_size,os_label:this.default_os_version_list.find((function(t){return t.os_id===e.data.default_os_version.os_id})).name}}},{key:"FnSubmit",value:function(){var e=!1;return this.$refs["resetForm"].validate((function(t){e=t})),{flag:e,os_info:this.FnEmit()}}},{key:"FnResetForm",value:function(){this.FnHandleInitData()}},{key:"created",value:function(){this.FnGetOsList()}},{key:"FnChangeOsTemType",value:function(e){var t=this;this.default_os_type?"windows"===this.default_os_type.toLowerCase()?this.default_os_template_type.os_types=this.os_list[e].os_types.filter((function(e){return e===t.default_os_type})):this.default_os_template_type.os_types=this.os_list[e].os_types.filter((function(e){return"windows"!=e.toLowerCase()})):this.default_os_template_type.os_types=this.os_list[e].os_types,this.default_os_template_type.os_versions=this.os_list[e].os_versions,this.data.default_os_type!==this.default_os_template_type.os_types[0]?this.data.default_os_type=this.default_os_template_type.os_types[0]:this.FnChangeOsType(this.data.default_os_type)}},{key:"FnChangeOsType",value:function(e){this.default_os_version_list=this.FnHandleOsList(this.default_os_template_type.os_versions[e]),this.default_os_version_list.length>0?this.data.default_os_version=this.default_os_version_list[0]:this.data.default_os_version={os_id:"",os_type:"",username:"",disk_size:0},this.FnEmit()}},{key:"FnChangeAz",value:function(e,t){this.FnGetOsList()}},{key:"FnChangeCustomer",value:function(e,t){this.FnGetOsList()}},{key:"FnChangeGpuDriver",value:function(e){this.FnChangeOsType(this.data.default_os_type)}},{key:"FnChangeGpu",value:function(e){this.FnChangeOsType(this.data.default_os_type)}}]),s}(_["e"]);Object(u["a"])([Object(_["c"])({default:""})],p.prototype,"az_id",void 0),Object(u["a"])([Object(_["c"])({default:""})],p.prototype,"customer_id",void 0),Object(u["a"])([Object(_["c"])({default:0})],p.prototype,"is_gpu",void 0),Object(u["a"])([Object(_["c"])({default:""})],p.prototype,"support_gpu_driver",void 0),Object(u["a"])([Object(_["c"])({default:""})],p.prototype,"default_os_type",void 0),Object(u["a"])([Object(_["b"])("fn-os")],p.prototype,"FnEmit",null),Object(u["a"])([Object(_["f"])("default_os_template_type.os_template_type")],p.prototype,"FnChangeOsTemType",null),Object(u["a"])([Object(_["f"])("data.default_os_type")],p.prototype,"FnChangeOsType",null),Object(u["a"])([Object(_["f"])("az_id")],p.prototype,"FnChangeAz",null),Object(u["a"])([Object(_["f"])("customer_id")],p.prototype,"FnChangeCustomer",null),Object(u["a"])([Object(_["f"])("support_gpu_driver")],p.prototype,"FnChangeGpuDriver",null),Object(u["a"])([Object(_["f"])("is_gpu")],p.prototype,"FnChangeGpu",null),p=Object(u["a"])([_["a"]],p);var h=p,f=h,m=(s("56c7"),s("2877")),b=Object(m["a"])(f,i,a,!1,null,"cdbbdb54",null);t["a"]=b.exports},"315f":function(e,t,s){},"343a":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"数据批量导入",visible:e.visible_sync,width:"600px","destroy-on-close":!0,"custom-class":"upload","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",{staticClass:"upload"},[s("div",{staticClass:"m-bottom10"},[e._v("请选择需要导入的可用区")]),s("el-select",{attrs:{filterable:"","filter-method":e.getPodList,placeholder:"请选择"},on:{"visible-change":e.change_pod},model:{value:e.az,callback:function(t){e.az=t},expression:"az"}},e._l(e.az_list,(function(t){return s("el-option",{key:t.pod_id,attrs:{label:t.az_name+" ( "+t.pod_name+" ) ",value:t.pod_id}},[e._v(e._s(t.az_name)+" ("+e._s(t.pod_name)+")")])})),1),0===e.az.length?s("span",{staticClass:"error_message m-left10"},[e._v("请选择可用区")]):e._e(),s("div",{staticClass:"flex-between m-top10 m-bottom20 down"},[s("span",[e._v("请选择需要上传的文件")]),s("a",{staticClass:"clickble",on:{click:e.down}},[e._v("下载导入模板")])]),s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/ecs_business/v1/host/import_host/?pod_id="+e.az,"before-upload":e.before_upload,"file-list":e.fileList,accept:".xls,.xlsx",name:"host_template","auto-upload":!1,"on-success":e.FnSuccess,headers:{"Access-Token":e.$store.state.token}}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择文件")])],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("96cf"),s("4de4"),s("d3b7"),s("e9c4"),s("9ab4")),_=s("1b40"),d=s("c839"),p=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.fileList=[],e.az_list=[],e.az="",e}return Object(o["a"])(s,[{key:"created",value:function(){this.getPodList()}},{key:"change_pod",value:function(e){e||this.getPodList()}},{key:"getPodList",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:"",e.next=3,d["a"].get_pod_list({page_index:1,page_size:20,search_info:t});case 3:s=e.sent,"Success"===s.code&&(this.az_list=s.data.pod_list.filter((function(e){return e.status})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"before_upload",value:function(e){}},{key:"FnSuccess",value:function(e,t,s){if("Success"===e.code){if(e.data.fail_host_list.length>0)return this.$message.warning("物理机导入任务下发失败！"),void this.back("1");this.$message.success("物理机导入任务下发成功！"),this.back("1")}else this.$message.error(JSON.stringify(e.message)),this.back("0")}},{key:"down",value:function(){window.location.href="/ecs_business/v1/host/download_template/"}},{key:"confirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.az){e.next=2;break}return e.abrupt("return");case 2:t=this.$refs.upload,t.submit();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(_["e"]);Object(u["a"])([Object(_["d"])("visible")],p.prototype,"visible_sync",void 0),Object(u["a"])([Object(_["b"])("close")],p.prototype,"back",null),p=Object(u["a"])([Object(_["a"])({})],p);var h=p,f=h,m=(s("b2ed"),s("2877")),b=Object(m["a"])(f,i,a,!1,null,null,null);t["a"]=b.exports},"372e":function(e,t,s){},3874:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"resetForm",staticClass:"spec-form",attrs:{model:e.data,"label-position":"left"}},[s("div",{staticClass:"inline-form"},[s("el-form-item",{staticClass:"m-right20"},[s("el-select",{attrs:{placeholder:"全部vCPU",clearable:""},model:{value:e.default_cpu_size,callback:function(t){e.default_cpu_size=t},expression:"default_cpu_size"}},e._l(e.cpu_ram_size_list,(function(t,i){return s("el-option",{key:i+"cpu",attrs:{value:String(i)}},[e._v(e._s(i)+" vCPU")])})),1)],1),s("el-form-item",[s("el-select",{attrs:{placeholder:"全部内存",clearable:""},model:{value:e.default_ram_size,callback:function(t){e.default_ram_size=t},expression:"default_ram_size"}},e._l(e.ram_size_list,(function(t,i){return s("el-option",{key:t+i+"ram",attrs:{value:String(t)}},[e._v(e._s(t)+" GiB")])})),1)],1)],1),s("el-form-item",{attrs:{prop:""}},[s("span",[e._v("分类： ")]),s("el-radio-group",{model:{value:e.data.category_id,callback:function(t){e.$set(e.data,"category_id",t)},expression:"data.category_id"}},e._l(e.category_list,(function(t){return s("el-radio-button",{key:t.category_id,attrs:{label:t.category_id}},[e._v(e._s(t.name))])})),1)],1),s("el-form-item",{staticClass:"table-form"},[s("div",{staticClass:"table-box"},[s("el-table",{attrs:{data:e.family_list,border:"","max-height":"300px"}},[s("el-table-column",{attrs:{label:"选择",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-radio",{attrs:{label:t.row.id},on:{change:function(s){return e.FnChangeSpec(t.row)}},model:{value:e.data.id,callback:function(t){e.$set(e.data,"id",t)},expression:"data.id"}},[e._v(" ")])]}}])}),s("el-table-column",{attrs:{prop:"ecs_family_name",label:"规格族"}}),s("el-table-column",{attrs:{prop:"cpu",label:"vCPU"}}),s("el-table-column",{attrs:{prop:"ram",label:"内存"}}),e.is_gpu?s("el-table-column",{attrs:{prop:"gpu",label:"GPU"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.gpu)+"*"+e._s(t.row.gpu_show_type)+" ")]}}],null,!1,3740856225)}):e._e(),s("el-table-column",{attrs:{prop:"cpu_name",label:"处理器型号",width:"200"}}),s("el-table-column",{attrs:{label:"参考价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.price_symbol+t.row.original_amount.toFixed(2)+"/"+e.priceSymble()))])]}}])})],1)],1)]),e.enable_change||"batch_update"!==e.type?e._e():s("el-form-item",[s("span",{staticClass:"error_message m-left8"},[e._v("所选规格资源不足，请重新选择")])]),s("el-form-item",{staticClass:"total-price"},[s("span",[e._v("差价为：")]),s("span",{staticClass:"num_message price"},[e._v(" "+e._s(this.difference_price?this.difference_price:"0.00"))])])],1)},a=[],n=s("2909"),r=s("1da1"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("d3b7"),s("6062"),s("3ca3"),s("ddb0"),s("99af"),s("4e82"),s("4de4"),s("b680"),s("d81d"),s("7db0"),s("159b"),s("a9e3"),s("9ab4")),d=s("1b40"),p=s("9074"),h=s("8ce4"),f=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.cpu_ram_size_list=[],e.all_ram_size_list=[],e.ram_size_list=[],e.default_cpu_size="",e.default_ram_size="",e.category_list=[],e.family_list=[],e.is_gpu=0,e.billing_info={},e.cpu_ram_gpu_price={},e.data={category_id:"",spec_id:"",id:""},e.price_unit="",e.prime_price=0,e.difference_price="",e.price_symbol="￥",e.ecs_list=[],e.row={},e.ecs_goods_info=[],e.ecs_billing_info={},e.price=0,e.category_id="",e.ecs_goods_id="",e.method="",e.enable_change=!0,e}return Object(c["a"])(s,[{key:"priceSymble",value:function(){return"1"==this.method?"月":"天"}},{key:"FnGetAllCpuRam",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].get_all_cpu_ram();case 2:if(t=e.sent,"Success"==t.code){for(i in this.cpu_ram_size_list=t.data,s=[],this.cpu_ram_size_list)s=Object(n["a"])(new Set([].concat(Object(n["a"])(s),Object(n["a"])(this.cpu_ram_size_list[i]))));this.all_ram_size_list=s.sort((function(e,t){return e-t})),this.ram_size_list=this.all_ram_size_list}case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnGetCategoryList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.az_id){e.next=2;break}return e.abrupt("return");case 2:return this.family_list=[],e.next=5,p["a"].get_category_list({az_id:this.az_id,customer_id:this.customer_id,billing_method:this.billing_method,cpu:String(this.default_cpu_size),ram:String(this.default_ram_size)});case 5:t=e.sent,"Success"==t.code&&(this.category_list="batch_update"===this.type?t.data.category_list.filter((function(e){return e.is_gpu==s.default_is_gpu})):t.data.category_list,this.data.category_id===this.category_list[0].category_id?this.FnChangeCate(this.data.category_id):this.data.category_id=this.category_list[0].category_id);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"DifferencePrice",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.row,s=this.FnGetDefaultFamily(this.data.id),s){e.next=5;break}return this.difference_price="".concat(this.price_symbol,"0.0/").concat(this.price_unit),e.abrupt("return");case 5:if(this.category_id=this.data.category_id,"1"!==this.method||!this.category_id){e.next=11;break}return e.next=9,p["a"].difference_price({ecs_info:t,ecs_list:this.ecs_list,billing_method:this.method,az_id:this.az_id,customer_id:this.ecs_list_info[0].customer_id,billing_info:this.billing_info[s.ecs_goods_id]});case 9:i=e.sent,"Success"===i.code&&(this.difference_price="".concat(this.price_symbol).concat(Math.abs(i.data.change_price.toFixed(2)),"/").concat(this.price_unit));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnGetFamilyList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.ecs_list=this.ecs_list_info.map((function(e){return{ecs_id:e.ecs_id,ecs_goods_id:e.ecs_goods_id,is_gpu:e.is_gpu,cpu_size:e.cpu_size,ram_size:e.ram_size,gpu_size:e.gpu_size,gpu_driver:e.support_gpu_driver,billing_method:e.billing_method,system_disk_feature:e.system_disk_feature,az_id:e.az_id,customer_id:e.customer_id}})),this.method=this.ecs_list_info[0].billing_method,e.next=4,p["a"].get_ram_cpu_price_list({customer_id:this.customer_id,ecs_list:this.ecs_list,category_id:this.data.category_id,az_id:this.az_id});case 4:t=e.sent,"Success"===t.code&&(this.prime_price=t.data.max_ecs_rule_price,this.family_list=t.data.ecs_goods_info,this.price_symbol=t.data.price_symbol,this.price_unit=t.data.price_unit,this.row=this.family_list[0],this.ecs_billing_info=t.data.billing_info,this.ecs_goods_info=t.data.ecs_goods_info||"",this.billing_info=Object(h["a"])(t.data.billing_info,!0),this.price=t.data.all_ecs_spec_price,this.data.id="",this.data.id||(this.data.id=null===(s=this.family_list[0])||void 0===s?void 0:s.id),this.FnEmit(),"0"===this.method?(i=Math.abs(this.ecs_list_info.length*(this.prime_price-this.family_list[0].trade_amount)),this.difference_price="".concat(this.price_symbol).concat(t.data.ecs_goods_info.length>0?i.toFixed(2):0,"/").concat(this.price_unit)):this.DifferencePrice());case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnSpecLimit",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].change_configure_limit({ecs_list:this.ecs_list.map((function(e){return e.ecs_id})),az_id:this.az_id,customer_id:this.customer_id,ecs_spec_info:this.FnGetDefaultFamily(this.data.id)});case 2:t=e.sent,"Success"===t.code&&(this.enable_change=t.data.enable_change,this.$emit("enable-change",this.enable_change));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnGetDefaultFamily",value:function(e){return this.family_list.find((function(t){return t.id===e}))}},{key:"FnGetPrice",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={customer_id:this.customer_id,az_id:this.az_id,is_gpu:this.is_gpu,batch:1,billing_method:this.billing_method,ecs_info:{billing_info:this.billing_info,ecs_goods_info:this.family_list},number:1},e.next=3,p["a"].get_price(t);case 3:s=e.sent,"Success"===s.code&&s.data.ecs.forEach((function(e){i.$set(i.cpu_ram_gpu_price,e.spec_id,s.data.price_symbol+Number(e.price).toFixed(2)+"/"+s.data.price_unit)}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnChangeSpec",value:function(e){this.row=e,this.category_id=this.data.category_id,this.ecs_goods_id=e.ecs_goods_id,"0"===this.method?this.difference_price=this.difference_price="".concat(this.price_symbol).concat(Math.abs(this.ecs_list_info.length*(this.prime_price-e.trade_amount)).toFixed(2),"/").concat(this.price_unit):this.DifferencePrice(),this.FnSpecLimit()}},{key:"FnEmit",value:function(){var e=this.FnGetDefaultFamily(this.data.id);return console.log("FnEmit",e),{ecs_goods_id:e.ecs_goods_id,ecs_goods_name:e.ecs_family_name,cpu:e.cpu,ram:e.ram,gpu:e.gpu,gpu_id:e.gpu_type_id,gpu_card_name:e.gpu_card_name,card_name:e.gpu_show_type,is_gpu:this.is_gpu,cpu_model:e.cpu_name,support_gpu_driver:e.support_gpu_driver,spec_family_id:e.spec_family_id,spec_id:e.spec_id,cpu_real_name:e.cpu_real_name,billing_info:this.billing_info,ecs_list:this.ecs_list}}},{key:"FnSubmit",value:function(){var e=!1;return this.$refs["resetForm"].validate((function(t){e=t})),{flag:e,spec_info:this.FnEmit()}}},{key:"created",value:function(){this.FnGetAllCpuRam()}},{key:"FnChangeCpuSize",value:function(e){this.default_ram_size="",this.ram_size_list=e?this.cpu_ram_size_list[Number(e)]:this.all_ram_size_list,this.FnGetCategoryList()}},{key:"FnChangeRamSize",value:function(e){this.FnGetCategoryList()}},{key:"FnChangeCate",value:function(e){var t=this;e&&(this.FnGetFamilyList().then((function(){t.family_list.length>0&&t.FnSpecLimit()})),this.is_gpu=this.category_list.find((function(t){return t.category_id===e})).is_gpu?1:0)}},{key:"FnChangeAz",value:function(e,t){this.FnGetCategoryList()}},{key:"FnChangeCustomer",value:function(e,t){this.FnGetCategoryList()}}]),s}(d["e"]);Object(_["a"])([Object(d["c"])({default:""})],f.prototype,"az_id",void 0),Object(_["a"])([Object(d["c"])({default:""})],f.prototype,"customer_id",void 0),Object(_["a"])([Object(d["c"])({default:"0"})],f.prototype,"billing_method",void 0),Object(_["a"])([Object(d["c"])({default:""})],f.prototype,"type",void 0),Object(_["a"])([Object(d["c"])({default:0})],f.prototype,"default_is_gpu",void 0),Object(_["a"])([Object(d["c"])({default:function(){return[]}})],f.prototype,"ecs_list_info",void 0),Object(_["a"])([Object(d["b"])("fn-spec")],f.prototype,"FnEmit",null),Object(_["a"])([Object(d["f"])("default_cpu_size")],f.prototype,"FnChangeCpuSize",null),Object(_["a"])([Object(d["f"])("default_ram_size")],f.prototype,"FnChangeRamSize",null),Object(_["a"])([Object(d["f"])("data.category_id")],f.prototype,"FnChangeCate",null),Object(_["a"])([Object(d["f"])("az_id")],f.prototype,"FnChangeAz",null),Object(_["a"])([Object(d["f"])("customer_id",{immediate:!0})],f.prototype,"FnChangeCustomer",null),f=Object(_["a"])([d["a"]],f);var m=f,b=m,v=(s("51ef"),s("2877")),g=Object(v["a"])(b,i,a,!1,null,"3113994e",null);t["a"]=g.exports},"3e47":function(e,t,s){"use strict";s("1e61")},"3f8d":function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return o}));var i={building:"创建中",running:"运行中",restarting:"重启中",shutting_down:"关机中",shutdown:"已关机",starting_up:"开机中",deleting:"删除中",deleted:"已删除",destroying:"销毁中",destroy:"已销毁",updating:"更新中",error:"错误",recovering:"恢复中",failed:"创建失败"},a={start_up_ecs:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"开 机"},shutdown_ecs:{auth:["running"],msg:"已选实例需为运行中！",label:"关 机"},restart_ecs:{auth:["running"],msg:"已选实例状态需为运行中！",label:"重 启"},delete_ecs:{auth:["running","shutdown","error"],msg:"已选实例状态需为已关机或运行中或错误！",label:"逻辑删除"},recover_ecs:{auth:["deleted"],msg:"已选实例状态需为已删除！",label:"恢 复"},destroy_ecs:{auth:["deleted","failed"],msg:"已选实例状态需为已删除或创建失败！",label:"销 毁"},update_spec:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换实例规格"},update_system:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换操作系统"},reset_pwd:{auth:["running"],msg:"已选实例状态需为运行中！",label:"更换密码"},open_bill:{auth:["running","shutdown"],msg:"已选实例状态需为运行中或已关机！",label:"开启计费"},net_set:{auth:["running"],msg:"已选实例状态需为运行中！",label:"网络设置"}},n={start_up_host:{power:["shutdown"],host:["offline","online","exception","maintenance"],msg:"已选主机需为在线、离线、异常或维护状态",label:"开机"},shutdown_host:{power:["running"],host:["maintenance"],vm:1,msg:"已选主机需为维护状态",msg2:"操作关机前，请确保物理机上无云主机运行",label:"关机"},restart_host:{power:["running"],host:["offline","online","maintenance"],msg:"已选主机需为在线、离线或维护状态",label:"重启"},online_maintenance:{power:[],host:["online","exception"],msg:"已选主机需为在线状态",label:"在线维护"},maintenance:{power:[],host:[],msg:"",label:"设置维护"},offline_maintenance:{power:[],host:["offline","online","exception"],vm:1,msg:"已选主机需为在线或离线状态且已选主机上不能有虚拟机运行",label:"离线维护"},finish:{power:[],host:["maintenance","online_maintenance","offline_maintenance"],msg:"已选主机需为维护中状态",label:"完成维护"},shelves:{power:[],host:[],vm:1,msg:"已选主机上不能有虚拟机运行",label:"下架"},disperse:{power:["running"],host:["online"],msg:"已选主机需为在线状态",label:"驱散"},out_of_band:{power:[],host:["offline","online"],msg:"已选主机需为在线或离线状态",label:"进入带外管理"},migrate:{power:["running"],host:["online","storage_error","crash"],msg:"已选主机需为在线、存储异常或宕机状态",label:"迁移"},lock:{power:[],host:[],msg:"",label:"锁定"},unlock:{power:[],host:["lock"],msg:"已选主机需为锁定状态",label:"解锁"},unstore_exception:{power:[],host:["storage_error"],msg:"已选主机需为存储异常状态",label:"解除存储异常"},service:{power:[],host:[],msg:"",label:"服务更新"},rollback:{power:[],host:[],label:"回滚"},physical_detail:{power:[],host:[],msg:"",label:"详情"},data_clear:{power:[],host:["crash_clear"],msg:"",label:"数据清理同步"},down_recover:{power:[],host:["crash_recover"],msg:"",label:"宕机恢复"},sign:{power:[],host:[],msg:"",label:"设备标记"},upload:{power:[],host:[],msg:"",label:"导入"},under_sync:{power:[],host:[],msg:"",label:"底层同步"},cheat:{power:[],host:[],msg:"",label:"欺骗器管理"},business_test:{power:[],host:[],msg:"",label:"业务测试"},record:{power:[],host:[],msg:"",label:"操作记录"},resource:{power:[],host:[],msg:"",label:"分配资源"},remark:{power:[],host:[],msg:"",label:"编辑备注"},add_cluster:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"加入集群"},change_cluster:{power:[],host:[],msg:"",label:"更换集群"},remove_cluster:{power:[],host:["maintenance"],mag:"",label:"移出集群"},set_label:{power:[],host:[],msg:"",label:"添加标签"},set_prepar_host:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"设为备机"},set_resource_pools:{power:[],host:["online"],msg:"",label:"设为资源池"}};t["a"]={getInsOperateAuth:function(e){return a[e]}};var r=function(e){return i[e]},o=function(e){return n[e]}},"408a":function(e,t,s){var i=s("e330");e.exports=i(1..valueOf)},"427f":function(e,t,s){},4364:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("action-block",{attrs:{search_option:e.search_con,type:!0},on:{"fn-search":e.FnSearch}}),s("div",{staticClass:"icon m-bottom10"},[s("el-tooltip",{attrs:{content:"自定义列表项",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.FnCustom}},[s("i",{staticClass:"el-icon-s-tools"})])],1),s("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.refresh}},[s("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1),s("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[s("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"text"},on:{click:e.FnExport}},[s("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1)],1),s("div",{staticClass:"main-2"},[s("el-table",{ref:"table",attrs:{data:e.list,border:"",height:"100%","row-class-name":e.rowStyle},on:{"row-click":e.FnOperRow,"row-contextmenu":e.FnRightClick,"selection-change":e.handleSelectionChange,"sort-change":e.FnSortChange,"filter-change":e.handleFilterChange}},[s("el-table-column",{attrs:{type:"selection"}}),e._l(e.custom_host,(function(t){return s("el-table-column",{key:t.prop,attrs:{"filter-multiple":t.column_key?t.multiple:null,prop:t.prop,"column-key":t.column_key?t.column_key:null,filters:t.column_key?t.list:null,sortable:t.sortable?t.sortable:null,width:t.width?t.width:null,type:t.type,label:t.label,"show-overflow-tooltip":t.overflow},scopedSlots:e._u(["eip_info"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.eip_info[t.row.pub_net]?t.row.eip_info[t.row.pub_net].eip_ip:"-"))])]}}:"status_display"===t.prop?{key:"default",fn:function(t){return[s("div",{class:t.row.status},[e._v(e._s(t.row.status_display))]),t.row.no_charge_shutdown_ecs&&"shutdown"===t.row.status?s("div",{staticClass:"warning_message"},[e._v("关机不计费")]):e._e()]}}:"private_net"===t.prop?{key:"default",fn:function(t){return e._l(t.row.private_net.split(";"),(function(i){return s("div",{key:i},[s("span",[e._v(" "+e._s(t.row.eip_info[i]?i:"-")+" ")])])}))}}:"pub_net"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.pub_net?t.row.pub_net:"-"))])]}}:"product_source"===t.prop?{key:"default",fn:function(t){return e._l(e.product_list,(function(i){return s("span",[i.key===t.row.product_source?s("span",[e._v(" "+e._s(i.value)+" ")]):e._e()])}))}}:null],null,!0)})}))],2)],1),s("el-pagination",{attrs:{"current-page":e.page_info.current,"page-sizes":[20,50,100],"page-size":e.page_info.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),s("custom-list-item",{attrs:{visible:e.show_custom,all_item:e.all_item,all_column_item:e.all_column_item,type:"pod_vm",newView:!0},on:{"update:visible":function(t){e.show_custom=t},"fn-custom":e.get_custom_columns}}),e.record_visible?[s("Record",{attrs:{visible:e.record_visible,record_id:e.record_id},on:{close:e.closeRecord}})]:e._e(),e.detail_visible?[s("Detail",{attrs:{visible:e.detail_visible,detail_id:e.detail_id},on:{"close-detail":e.closeDetail}})]:e._e(),e.common_visible?[s("add-common",{attrs:{visible:e.common_visible,ecs_info:e.ecs_info,new:!0},on:{"update:visible":function(t){e.common_visible=t}}})]:e._e(),e.net_visible?[s("net-set",{attrs:{visible:e.net_visible,ecs_list:e.multiple_selection},on:{"update:visible":function(t){e.net_visible=t}}})]:e._e(),e.migrate_visible?[s("Migrate",{attrs:{visible:e.migrate_visible,ecs_list:e.multiple_selection},on:{"update:visible":function(t){e.migrate_visible=t}}})]:e._e(),e.rescue_visible?[s("rescue-mode",{attrs:{visible:e.rescue_visible,ecs_id:e.ecs_id,customer_id:e.customer_id},on:{"update:visible":function(t){e.rescue_visible=t}}})]:e._e(),s("operate",{attrs:{title:e.operate_title,visible:e.show_operate_dialog,oper_type:e.default_operate_type,multiple_selection:e.multiple_selection,customer_id:e.customer_id,az_id:e.az_id,is_gpu:e.is_gpu,origin_disk_size:e.origin_disk_size,multiple_selection_id:e.multiple_selection_id,system_disk_feature:e.system_disk_feature,spec_family_id:e.spec_family_id,os_type:e.os_type,support_gpu_driver:e.support_gpu_driver},on:{"update:visible":function(t){e.show_operate_dialog=t},close:e.close}}),s("right-click",{attrs:{multi_rows:e.multiple_selection,menus:e.menus,name:e.multiple_selection.length>0?e.multiple_selection[0].ecs_name:"",error_msg:e.error_msg},on:{"fn-click":e.infoClick}})],2)},a=[],n=s("5530"),r=s("2909"),o=s("ade3"),c=s("1da1"),l=s("b85c"),u=s("d4ec"),_=s("bee2"),d=s("262e"),p=s("2caf"),h=(s("96cf"),s("d3b7"),s("caad"),s("2532"),s("b0c0"),s("ac1f"),s("1276"),s("99af"),s("a9e3"),s("b680"),s("d81d"),s("25f0"),s("3ca3"),s("ddb0"),s("2b3d"),s("9861"),s("4de4"),s("a15b"),s("159b"),s("9ab4")),f=s("1b40"),m=s("3673"),b=s("bfc6"),v=s("af7d"),g=s("8ce4"),y=s("4d8e"),k=s("e8c0"),O=s("cf88"),j=s("bd4d"),w=s("268f"),x=s("76ff"),C=s("1f00"),S=s("e03a"),z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:e.title,visible:e.show_operate_dialog,"close-on-click-modal":!1,width:"60%"},on:{"update:visible":function(t){e.show_operate_dialog=t},close:e.back}},["restore"===e.oper_type?[s("Recover",{ref:"recover",attrs:{multiple_selection:e.multiple_selection,customer_id:e.customer_id,is_gpu:e.is_gpu},on:{"fn-close":e.back}})]:s("div",[s("el-alert",{attrs:{title:"是否确定要对以下实例执行 "+e.title+" 操作",type:"warning",closable:!1,center:""}}),s("el-table",{staticClass:"operate-table",attrs:{data:e.multiple_selection,border:""}},[s("el-table-column",{attrs:{label:"客户名称/客户ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(e._s(t.row.customer_name))]),s("div",[e._v(e._s(t.row.customer_id))])]}}])}),s("el-table-column",{attrs:{label:"云服务器名称/云服务器ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("pre",[e._v(e._s(t.row.ecs_name))])]),s("div",[e._v(e._s(t.row.ecs_id))])]}}])}),s("el-table-column",{attrs:{label:"云服务器规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(" "+e._s(t.row.ecs_goods_name)+" "+e._s(t.row.cpu_size)+"vCPU "+e._s(t.row.ram_size)+"GiB "),e.is_gpu?s("span",[e._v(e._s(t.row.gpu_size)+"*"+e._s(t.row.card_name))]):e._e()])]}}])}),"update_system"===e.oper_type?s("el-table-column",{attrs:{label:"系统盘"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(" "+e._s(t.row.system_disk_type)+" "+e._s(t.row.system_disk_size)+"GB ")])]}}],null,!1,3861243780)}):e._e(),"update_system"===e.oper_type?s("el-table-column",{attrs:{label:"操作系统"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(e._s(t.row.os_name))])]}}],null,!1,3179532245)}):e._e(),s("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{class:t.row.status},[e._v(e._s(t.row.status_display))])]}}])}),s("el-table-column",{attrs:{prop:"gpu_card_status",label:"显卡状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{class:["正常"===t.row.gpu_card_status?"running":"已卸载"===t.row.gpu_card_status?"destroy":"关闭"===t.row.gpu_card_status?"error":""]},[e._v(e._s(t.row.gpu_card_status))])]}}])}),"open_bill"===e.oper_type?s("el-table-column",{attrs:{prop:"",label:"价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.ecs_list_price[t.row.ecs_id]))])]}}],null,!1,260281309)}):e._e()],1),s("div",{staticClass:"component-box"},["update_spec"===e.oper_type?[s("update-spec",{ref:"update_spec",attrs:{ecs_list_info:e.multiple_selection,customer_id:e.customer_id,az_id:e.az_id,type:"batch_update",default_is_gpu:e.is_gpu}})]:e._e(),"update_system"===e.oper_type?[s("update-os",{ref:"update_os",attrs:{customer_id:e.customer_id,az_id:e.az_id,is_gpu:e.is_gpu,default_os_type:e.os_type,support_gpu_driver:e.support_gpu_driver},on:{"fn-os":e.FnGetOsInfo}}),s("update-disk",{ref:"update_disk",attrs:{system_disk:!0,customer_id:e.customer_id,az_id:e.az_id,is_gpu:e.is_gpu,os_disk_size:Number(e.os_info.disk_size),origin_disk_size:e.origin_disk_size,spec_family_id:e.spec_family_id,disk_feature:e.system_disk_feature},on:{"fn-billing-info":e.FnGetDiskBillingInfo,"fn-system-disk":e.FnChangeSystem}}),s("reset-pwd",{ref:"reset_pwd",attrs:{customer_id:e.customer_id,az_id:e.az_id,username:e.os_info.username}})]:e._e(),"gpu_manage"===e.oper_type?s("div",[e._v(" 操作： "),s("el-radio-group",{model:{value:e.gpu_card_operate,callback:function(t){e.gpu_card_operate=t},expression:"gpu_card_operate"}},[s("el-radio",{attrs:{label:"ecs_attach_gpu_card",disabled:!e.multiple_selection[0].gpu_operate_list.includes("ecs_attach_gpu_card")}},[e._v("挂载显卡")]),s("el-radio",{attrs:{label:"ecs_detach_gpu_card",disabled:!e.multiple_selection[0].gpu_operate_list.includes("ecs_detach_gpu_card")}},[e._v("卸载显卡")]),s("el-radio",{attrs:{label:"ecs_change_fault_card",disabled:!e.multiple_selection[0].gpu_operate_list.includes("ecs_change_fault_card")}},[e._v("切换显卡 "),s("el-tooltip",{attrs:{content:"当云主机显卡关闭时，切换成正常可用的显卡。",placement:"right",effect:"light"}},[s("el-button",{attrs:{type:"text"}},[s("svg-icon",{attrs:{icon:"info",viewBox:"0 0 18 18"}})],1)],1)],1)],1)],1):e._e(),"reset_pwd"===e.oper_type?[s("reset-pwd",{ref:"reset_pwd",attrs:{label:"新密码",customer_id:e.customer_id,az_id:e.az_id}})]:e._e()],2),e.total_price&&"update_spec"!==e.oper_type?s("div",{staticClass:"text-right m-right20"},["update_system"===e.oper_type?s("span",[e._v("变更后需支付费用")]):s("span",[e._v("变更后总价：")]),s("span",{staticClass:"num_message"},[e._v(e._s(e.total_price))])]):e._e(),"shutdown_ecs"===e.oper_type?s("div",{staticClass:"text-center"},[e._v(" 关机方式： "),s("el-radio",{staticClass:"m-left20",attrs:{label:"shutdown_ecs"},model:{value:e.shutdown_ecs_type,callback:function(t){e.shutdown_ecs_type=t},expression:"shutdown_ecs_type"}},[e._v("正常关机")]),s("el-radio",{staticClass:"m-left20",attrs:{label:"compel_shutdown_ecs"},model:{value:e.shutdown_ecs_type,callback:function(t){e.shutdown_ecs_type=t},expression:"shutdown_ecs_type"}},[e._v("强制关机")]),s("mark-tip",{staticClass:"mark-tip",attrs:{content:"等同于断电处理，Windows操作系统可能会损坏，请谨慎选择"}})],1):e._e(),"restart_ecs"===e.oper_type?[s("div",{staticClass:"text-center"},[e._v(" 重启方式: "),s("el-radio",{staticClass:"m-left20",attrs:{label:"restart_ecs"},model:{value:e.restart_ecs_type,callback:function(t){e.restart_ecs_type=t},expression:"restart_ecs_type"}},[e._v("正常重启")]),s("el-radio",{staticClass:"m-left20",attrs:{label:"hard_restart_ecs"},model:{value:e.restart_ecs_type,callback:function(t){e.restart_ecs_type=t},expression:"restart_ecs_type"}},[e._v("硬重启")])],1),s("div",{staticClass:"warning_message"},[e._v("说明：若云主机故障，请选择“硬重启”，使云主机快速恢复正常。")])]:e._e()],2),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.FnConfirm}},[e._v("确 定")]),s("el-button",{on:{click:e.back}},[e._v("取 消")])],1)],2)},F=[],R=s("0003"),T=s("3874"),$=s("29ab"),E=s("d4fd"),I=s("ed60"),P=s("1b7c"),D=function(e){Object(d["a"])(s,e);var t=Object(p["a"])(s);function s(){var e;return Object(u["a"])(this,s),e=t.apply(this,arguments),e.gpu_card_operate="",e.billing_method="0",e.shutdown_ecs_type="shutdown_ecs",e.restart_ecs_type="restart_ecs",e.os_info={},e.disk_billing_info={},e.total_price="",e.ecs_list_price={},e.page_info={page_sizes:[20,50,100],page_size:20,page_index:1,total:0},e}return Object(_["a"])(s,[{key:"back",value:function(e){this.show_operate_dialog=!1}},{key:"FnChangeSpec",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.billing_method){e.next=2;break}return e.abrupt("return");case 2:return s={customer_id:this.customer_id,az_id:this.az_id,billing_method:this.billing_method||"0",ecs_ids:this.multiple_selection_id,is_gpu:this.is_gpu,ecs_goods_info:{cpu:t.cpu,ram:t.ram,gpu:t.gpu},billing_info:t.billing_info[t.ecs_goods_id]},e.next=5,y["a"].change_config_price(s);case 5:i=e.sent,"Success"===i.code&&(this.total_price=i.data.price_symbol+i.data.total_price.toFixed(2)+"/"+i.data.price_unit);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnGetOsInfo",value:function(e){this.os_info=e}},{key:"FnGetDiskBillingInfo",value:function(e){this.disk_billing_info=e}},{key:"FnChangeSystem",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==this.billing_method){e.next=2;break}return e.abrupt("return");case 2:return s={customer_id:this.customer_id,az_id:this.az_id,billing_method:this.billing_method||"0",is_gpu:this.is_gpu,ecs_ids:this.multiple_selection_id,ebs_goods_info:{},billing_info:this.disk_billing_info[t.ecs_goods_id]},"local"===this.system_disk_feature?(s.ebs_goods_info["local_disk-IOPS"]=t.iops,s.ebs_goods_info["local_disk-space"]=t.storage_space,s.ebs_goods_info["local_disk-throughput"]=t.handling_capacity):(s.ebs_goods_info["iops"]=t.iops,s.ebs_goods_info["storage_space"]=t.storage_space,s.ebs_goods_info["handling_capacity"]=t.handling_capacity),e.next=6,y["a"].change_system_price(s);case 6:i=e.sent,"0"===this.billing_method?this.total_price=i.data.price_symbol+i.data.total_price.toFixed(2)+"/"+i.data.price_unit:this.total_price=i.data.price_symbol+i.data.total_price.toFixed(2);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnConfirm",value:function(){if("restore"!==this.oper_type){var e={op_type:this.oper_type,customer_id:this.customer_id,az_id:this.az_id,ecs_ids:this.multiple_selection_id};["start_up_ecs","shutdown_ecs","restart_ecs"].indexOf(this.oper_type)>=0?this.FnPowerOperate(e):"delete_ecs"===this.oper_type?this.FnDelete(e):"destroy_ecs"===this.oper_type?this.FnDestroy(e):"reset_pwd"===this.oper_type?this.FnResetPwd(e):"update_spec"===this.oper_type?this.FnUpdateSpec(e):"update_system"===this.oper_type?this.FnUpdateSystem(e):"open_bill"===this.oper_type?this.FnOpenBill(Object.assign({billing_method:this.billing_method},e)):"gpu_manage"===this.oper_type&&this.mount_gpu_card()}else this.$refs.recover.FnRecover()}},{key:"FnPowerOperate",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return"restart_ecs"===this.oper_type&&(t.op_type=this.restart_ecs_type),"shutdown_ecs"===this.oper_type&&(t.op_type=this.shutdown_ecs_type),e.next=4,y["a"].operate_instance(t);case 4:s=e.sent,"Success"==s.code&&(this.$message.success(s.msg||"成功下发 ".concat(this.title," 任务！")),this.FnClose());case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnDelete",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].delete_instance(Object.assign({is_gpu:this.is_gpu},t));case 2:s=e.sent,"Success"==s.code&&(this.$message.success(s.msg||"成功下发 ".concat(this.title," 任务！")),this.FnClose());case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnDestroy",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].destroy_instance(Object.assign({is_gpu:this.is_gpu},t));case 2:s=e.sent,"Success"==s.code&&(this.$message.success(s.msg||"成功下发 ".concat(this.title," 任务！")),this.page_info.page_index=1,this.FnClose());case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnResetPwd",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=this.$refs.reset_pwd.FnSubmit(),!s.flag){e.next=8;break}return t.password=s.password,e.next=5,y["a"].reset_password(t);case 5:i=e.sent,"Success"===i.code&&this.$message.success(i.msg||"成功下发 ".concat(this.title," 任务！")),this.FnClose();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnUpdateSpec",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=this.$refs.update_spec.FnSubmit(),!s.flag){e.next=10;break}return t.ecs_list=s.spec_info.ecs_list,t.billing_info=s.spec_info.billing_info[s.spec_info.ecs_goods_id],t.ecs_info={ecs_family_name:s.spec_info.ecs_goods_name,cpu:s.spec_info.cpu,gpu:s.spec_info.gpu,ram:s.spec_info.ram,spec_id:s.spec_info.spec_id,ecs_goods_id:s.spec_info.ecs_goods_id,spec_family_id:s.spec_info.spec_family_id,cpu_name:s.spec_info.cpu_model,gpu_card_name:s.spec_info.gpu_card_name,gpu_type_id:s.spec_info.gpu_id,cpu_real_name:s.spec_info.cpu_real_name},e.next=7,y["a"].update_spec(t);case 7:i=e.sent,"Success"===i.code&&this.$message.success(i.msg||"成功下发 ".concat(this.title," 任务！")),this.FnClose();case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnUpdateSystem",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=this.$refs.update_os.FnSubmit(),i=this.$refs.update_disk.FnSubmit(),a=this.$refs.reset_pwd.FnSubmit(),!(s.flag&&i.flag&&a.flag)){e.next=18;break}return t.os_id=s.os_info.os_id,t.os_type=s.os_info.os_type,t.username=s.os_info.username,t.billing_method=this.billing_method,t.disk_info={system_disk:{ecs_goods_id:i.system_disk.ecs_goods_id,ebs_goods_id:i.system_disk.ecs_goods_id,gic_goods_id:null===(n=this.disk_billing_info[i.system_disk.ecs_goods_id])||void 0===n?void 0:n.gic_goods_id,goods_name:i.system_disk.disk_name,disk_feature:i.system_disk.disk_feature,disk_type:i.system_disk.disk_type,disk_size:i.system_disk.disk_size,storage_space:i.system_disk.disk_size,handling_capacity:i.system_disk.handling_capacity,iops:i.system_disk.iops,is_follow_delete:i.system_disk.is_follow_delete,origin_disk_size:this.origin_disk_size}},"local"===i.system_disk.disk_feature&&(t.disk_info.system_disk["local_disk-IOPS"]=t.disk_info.system_disk["iops"],t.disk_info.system_disk["local_disk-space"]=t.disk_info.system_disk["storage_space"],t.disk_info.system_disk["local_disk-throughput"]=t.disk_info.system_disk["handling_capacity"]),t.password=a.password,t.billing_info=this.disk_billing_info,t.is_gpu=this.is_gpu,e.next=15,y["a"].update_system(t);case 15:r=e.sent,"Success"===r.code&&this.$message.success(r.msg||"成功下发 ".concat(this.title," 任务！")),this.FnClose();case 18:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnOpenBill",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={resource_ids:t.ecs_ids,customer_id:t.customer_id,billing_method:t.billing_method||"0",resource_type:"ecs"},e.next=3,y["a"].start_charge(s);case 3:i=e.sent,"Success"===i.code&&this.$message.success("成功开启计费！"),this.FnClose();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"mount_gpu_card",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("ecs_detach_gpu_card"!==this.gpu_card_operate||"deleted"!==this.multiple_selection[0].status){e.next=3;break}return this.$message.warning("不支持对已删除的云服务器进行卸载显卡操作"),e.abrupt("return");case 3:return e.next=5,y["a"].mount_gpu_card({ecs_id:this.multiple_selection[0].ecs_id,customer_id:this.multiple_selection[0].customer_id,event_type:this.gpu_card_operate});case 5:t=e.sent,"Success"==t.code&&(this.$message.success(t.message),this.FnClose());case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnClose",value:function(){this.total_price="",this.gpu_card_operate="",this.back("1")}}]),s}(f["e"]);Object(h["a"])([Object(f["d"])("visible")],D.prototype,"show_operate_dialog",void 0),Object(h["a"])([Object(f["c"])({default:function(){return[]}})],D.prototype,"multiple_selection",void 0),Object(h["a"])([Object(f["c"])(String)],D.prototype,"title",void 0),Object(h["a"])([Object(f["c"])(String)],D.prototype,"oper_type",void 0),Object(h["a"])([Object(f["c"])(String)],D.prototype,"customer_id",void 0),Object(h["a"])([Object(f["c"])(String)],D.prototype,"az_id",void 0),Object(h["a"])([Object(f["c"])(Number)],D.prototype,"is_gpu",void 0),Object(h["a"])([Object(f["c"])({default:function(){return[]}})],D.prototype,"multiple_selection_id",void 0),Object(h["a"])([Object(f["c"])({default:""})],D.prototype,"system_disk_feature",void 0),Object(h["a"])([Object(f["c"])(Number)],D.prototype,"origin_disk_size",void 0),Object(h["a"])([Object(f["c"])(String)],D.prototype,"spec_family_id",void 0),Object(h["a"])([Object(f["c"])(String)],D.prototype,"os_type",void 0),Object(h["a"])([Object(f["c"])(String)],D.prototype,"support_gpu_driver",void 0),Object(h["a"])([Object(f["b"])("close")],D.prototype,"back",null),D=Object(h["a"])([Object(f["a"])({components:{Recover:R["a"],updateSpec:T["a"],updateOs:$["a"],updateDisk:E["a"],resetPwd:I["a"],MarkTip:P["a"],SvgIcon:m["a"]}})],D);var G=D,L=G,A=(s("8de2"),s("5fdb"),s("2877")),N=Object(A["a"])(L,z,F,!1,null,"45d324eb",null),M=N.exports,U=s("3f8d"),B=s("c811"),Y=s("c1df"),H=s.n(Y),V=s("e527"),q=s("77d2"),W=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"迁移",visible:e.visible_sync,width:"830px","destroy-on-close":!0,"custom-class":"upload","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t}}},[s("el-alert",{attrs:{title:"是否确定要对以下实例执行迁移操作",type:"warning",closable:!1,center:""}}),s("el-table",{staticClass:"operate-table",attrs:{data:e.ecs_list,border:"","max-height":"400px"}},[s("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),s("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),s("el-table-column",{attrs:{prop:"ecs_id",label:"实例名称/实例ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(e._s(t.row.ecs_name)+" / ")]),e.useable_list.includes(t.row.ecs_id)?s("span",[e._v(e._s(t.row.ecs_id))]):s("el-tooltip",{attrs:{content:e.getMsg(t.row),effect:"light"}},[s("div",[e._v(e._s(t.row.ecs_id))])])]}}])}),s("el-table-column",{attrs:{prop:"status_display",label:"状态"}}),s("el-table-column",{attrs:{prop:"genre",label:"计算规格"}}),s("el-table-column",{attrs:{prop:"genre",label:"存储",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.disk_info?s("div",[e._v("系统盘："+e._s(Object.keys(t.row.disk_info.system)[0])+" "+e._s(t.row.disk_info.system[Object.keys(t.row.disk_info.system)[0]])+e._s(t.row.disk_info.unit))]):e._e(),t.row.disk_info&&Object.keys(t.row.disk_info.data).length>0?s("div",{staticClass:"data-item"},[e._v(" 数据盘： "),e._l(t.row.disk_info.data,(function(i,a){return s("div",{key:a},[e._v(e._s(a)+" "+e._s(i)+e._s(t.row.disk_info.unit))])}))],2):e._e()]}}])})],1),s("div",{staticClass:"right"},[s("h4",[e._v("目的主机:")]),s("div",{staticClass:"m-bottom20"},[s("span",{staticClass:"m-right10"},[e._v("可用区:")]),s("span",[e._v(e._s(e.$store.state.az_list.az_name))])]),s("div",[e._v("物理机："),s("span",{staticClass:"prompt_message"},[e._v("（若不选择则随机迁移至合适的目的主机）")])]),e.recommend.length>0?s("div",{staticClass:"recommend"},e._l(e.recommend,(function(t){return s("div",{key:t.host_id,staticClass:"item",class:e.physical.includes(t.host_id)?"active":"",on:{click:function(s){return e.handle(t.host_id)}}},[e._v(" "+e._s(t.host_name)+" "),s("el-tooltip",{attrs:{content:t.cpu_usage?parseFloat(t.cpu_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.cpu_usage}}),s("div",[e._v("CPU")])],1)]),s("el-tooltip",{attrs:{content:t.memory_usage?parseFloat(t.memory_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.memory_usage}}),s("div",[e._v("内存")])],1)]),s("el-tooltip",{attrs:{content:t.local_storage_usage?parseFloat(t.local_storage_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.local_storage_usage}}),s("div",[e._v("本地存储")])],1)]),s("el-tooltip",{attrs:{content:(t.used_gpu_num?t.used_gpu_num:0)+" / "+(t.total_gpu_num?t.total_gpu_num:0),placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:0===t.total_gpu_num?0:100*Number((t.used_gpu_num/t.total_gpu_num).toFixed(2))}}),s("div",[e._v("显卡")])],1)])],1)})),0):s("div",{staticClass:"error_message m-top10"},[e._v("无合适的物理机，无法迁移。")])]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",disabled:0===this.recommend.length},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){e.visible_sync=!1}}},[e._v("取消")])],1)],1)],1)},J=[],K=(s("b64b"),s("1477")),X=s("682f"),Z=function(e){Object(d["a"])(s,e);var t=Object(p["a"])(s);function s(){var e;return Object(u["a"])(this,s),e=t.apply(this,arguments),e.recommend=[],e.physical=[],e.useable_list=[],e}return Object(_["a"])(s,[{key:"created",value:function(){this.get_recommended_host()}},{key:"get_recommended_host",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s.length>0&&void 0!==s[0]?s[0]:"",this.$store.commit("SET_LOADING",!1),e.next=4,K["a"].recommended_host({host_id:this.ecs_list[0].host_id,host_name:this.ecs_list[0].host_name,ecs_ids:this.ecs_list.map((function(e){return e.ecs_id})),is_gpu:this.ecs_list[0].is_gpu?"1":"0"});case 4:t=e.sent,"Success"===t.code&&(this.recommend=t.data.data,0===this.ecs_list.length&&(this.physical=[]));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setUsableList",value:function(e){var t=e[0].ecs_list.filter((function(e){return["已关机","运行中"].includes(e.status)})),s=[];t.map((function(e){e.is_gpu&&"已关机"===e.status&&!e.no_charge_shutdown_ecs?s.push(e.ecs_id):!e.is_gpu&&e.disk_info&&e.disk_info.system&&("local"!==Object.keys(e.disk_info.system)[0]?["已关机","运行中"].includes(e.status)&&s.push(e.ecs_id):"已关机"===e.status&&s.push(e.ecs_id))})),this.useable_list=s}},{key:"getMsg",value:function(e){return e.is_gpu||e.disk_info&&"local"===Object.keys(e.disk_info.system)[0]?"仅支持关机迁移":"仅运行中和已关机状态下迁移"}},{key:"handle",value:function(e){this.physical.includes(e)?this.physical=this.physical.filter((function(t){return t!==e})):this.physical.push(e)}},{key:"confirm",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,K["a"].migrate({ecs_ids:this.ecs_list.map((function(e){return e.ecs_id})),start_host_id:this.ecs_list[0].host_id,end_host_ids:this.physical,is_gpu:this.ecs_list[0].is_gpu?"1":"0"});case 2:t=e.sent,"Success"===t.code?(this.$message.success("物理机迁移任务下发成功！"),this.visible_sync=!1):this.visible_sync=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),s}(f["e"]);Object(h["a"])([Object(f["d"])("visible")],Z.prototype,"visible_sync",void 0),Object(h["a"])([Object(f["c"])({default:function(){return[]}})],Z.prototype,"ecs_list",void 0),Z=Object(h["a"])([Object(f["a"])({components:{CustomIcon:X["a"]}})],Z);var Q=Z,ee=Q,te=Object(A["a"])(ee,W,J,!1,null,"a307000c",null),se=te.exports,ie=s("6285"),ae=s("81b2"),ne=function(e){Object(d["a"])(s,e);var t=Object(p["a"])(s);function s(){var e;return Object(u["a"])(this,s),e=t.apply(this,arguments),e.list=[],e.all_column_item=[],e.multiple_selection=[],e.search_data={},e.sort_prop_name="",e.sort_order=void 0,e.ecs_status_list=[],e.search_reqData={},e.search_billing_method="all",e.search_op_source="",e.search_product_source="",e.search_ecs_goods_name=[],e.search_status=[],e.instance_list=[],e.customer_id="",e.az_id="",e.is_gpu=0,e.origin_disk_size=0,e.support_gpu_driver="",e.spec_family_id="",e.gpu_card_operate="",e.os_type="",e.billing_method="0",e.multiple_selection_id=[],e.operate_auth=[],e.show_operate_dialog=!1,e.operate_title="",e.default_operate_type="",e.shutdown_ecs_type="shutdown_ecs",e.restart_ecs_type="restart_ecs",e.record_visible=!1,e.record_id="",e.detail_visible=!1,e.detail_id="",e.net_visible=!1,e.migrate_visible=!1,e.product_source_list=[],e.product_server_id="",e.search_card_status_type="",e.search_product_status_type="",e.billing_method_relation={"":"不计费",0:"按需计费",1:"包年包月"},e.billing_method_list=[],e.ecs_goods_name_list=[],e.timer=null,e.os_info={},e.ecs_info={},e.common_visible=!1,e.disk_billing_info={},e.total_price="",e.ecs_list_price={},e.loading=!1,e.select_tag=[],e.isComponentDestroying=!1,e.ecs_id="",e.system_disk_feature="",e.rescue_visible=!1,e.page_info={current:1,size:20,total:0},e.gpu_status_list=[{text:"正常",value:"0"},{text:"卸载",value:"1"},{text:"关闭",value:"2"},{text:"非GPU无显卡",value:"3"}],e.product_list=[{key:"",value:"云主机"},{key:"gcw",value:"云桌面"},{key:"nas",value:"文件存储转发"},{key:"eks",value:"容器"},{key:"slb",value:"负载均衡"},{key:"paas",value:"数据库"},{key:"bm",value:"裸金属"}],e.search_con={ecs_id:{placeholder:"请输入云服务器ID"},ecs_name:{placeholder:"请输入云服务器名称"},customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},os_info:{placeholder:"请输入操作系统ID/名称"},private_net:{placeholder:"请输入私网IP"},public_net:{placeholder:"请输入公网IP"},host_id:{placeholder:"请输入物理机ID"},host_name:{placeholder:"请输入物理机名称"},host_ip:{placeholder:"请输入物理机管理IP"},out_band_address:{placeholder:"请输入物理机带外IP"},create_time:{placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!0,dis_day:1,defaultTime:[]}},e.all_item=[],e.custom_host=[],e.show_custom=!1,e.switch_power=[{label:"开机",value:"start_up_ecs",disabled:!1},{label:"关机",value:"shutdown_ecs",disabled:!1},{label:"重启",value:"restart_ecs",disabled:!1}],e.rescue_list=[{label:"进入救援模式",value:"rescue_mode",disabled:!1},{label:"退出救援模式",value:"exit_rescue_mode",disabled:!1}],e.menus=[{label:"详情",value:"instance_detail",single:!0,disabled:!1},{label:"开关机",value:"start_or_shutdown",list:e.switch_power,disabled:!1},{label:"操作记录",value:"instance_record",single:!0,disabled:!1},{label:"迁移",value:"migrate",disabled:!1},{label:"监控",value:"monitor",single:!0,disabled:!1},{label:"远程连接",value:"vnc",single:!0,disabled:!1},{label:"制作公共镜像",value:"add_common_mirror",single:!0,disabled:!1},{label:"显卡管理",value:"gpu_manage",single:!0,disabled:!1},{label:"逻辑删除",value:"delete_ecs",disabled:!1},{label:"销毁",value:"destroy_ecs",disabled:!1},{label:"恢复",value:"restore",disabled:!1},{label:"更换实例规格",value:"update_spec",disabled:!1},{label:"更换操作系统",value:"update_system",disabled:!1},{label:"重置密码",value:"reset_pwd",disabled:!1},{label:"网络设置",value:"net_set",disabled:!1},{label:"救援模式",value:"rescue",single:!0,list:e.rescue_list,disabled:!1},{label:"查看安全组",value:"security_group",single:!0,disabled:!1}],e.error_msg={vnc:"已选虚拟机状态需为运行中",add_common_mirror:"仅内部账号且状态为已关机的实例支持操作",gpu_manage:"仅支持对GPU型实例支持显卡管理",net_set:"实例需为运行中",migrate:"迁移虚拟机需全为关机或全为开机",security_group:"该虚拟机未配置安全组"},e}return Object(_["a"])(s,[{key:"watch_multi",value:function(){this.handleMenus()}},{key:"watch_search",value:function(e){this.search_reqData=e?{ecs_id:this.$store.state.search_vm}:{},this.get_pod_ecs_list()}},{key:"handleMenus",value:function(){var e,t=Object(l["a"])(this.menus);try{for(t.s();!(e=t.n()).done;){var s=e.value;if(s.list){var i,a=Object(l["a"])(s.list);try{for(a.s();!(i=a.n()).done;){var n=i.value;switch(n.value){case"rescue_mode":n.disabled=this.multiple_selection.every((function(e){return"shutdown"!==e.status}));break;case"exit_rescue_mode":n.disabled=this.multiple_selection.every((function(e){return"rescue"!==e.status}));break;default:n.disabled=!1}}}catch(r){a.e(r)}finally{a.f()}}else switch(s.value){case"gpu_manage":s.disabled=!this.multiple_selection.every((function(e){return e.is_gpu}))||!this.operate_auth.includes(s.value);break;case"vnc":s.disabled=this.multiple_selection.every((function(e){return"running"!==e.status}))||!this.operate_auth.includes(s.value);break;case"add_common_mirror":s.disabled=this.multiple_selection.every((function(e){return"shutdown"!==e.status}))||this.multiple_selection.every((function(e){return"内部"!==e.customer_type}))||!this.operate_auth.includes(s.value);break;case"net_set":s.disabled=this.multiple_selection.every((function(e){return"running"!==e.status}))||!this.operate_auth.includes(s.value);break;case"restore":s.disabled=!0;break;case"migrate":s.disabled=this.setUsableList();break;case"security_group":s.disabled=this.multiple_selection.every((function(e){return 0===e.security_num}));break;default:s.disabled=!1}}}catch(r){t.e(r)}finally{t.f()}}},{key:"created",value:function(){this.FnGetCateGoryList(),this.get_source_type(),this.FnGetStatus(),this.get_field(),this.operate_auth=this.$store.state.auth_info["instance_list"],this.$store.state.search_vm?this.search_reqData={ecs_id:this.$store.state.search_vm}:this.search_reqData={}}},{key:"setUsableList",value:function(){if(!this.multiple_selection||0===this.multiple_selection.length)return!1;var e=this.multiple_selection.every((function(e){return"运行中"===e.status_display})),t=this.multiple_selection.every((function(e){return"已关机"===e.status_display})),s=this.multiple_selection.every((function(e){return!0===e.is_gpu}));if(e||t)return!1;if(t)if(s){var i=this.multiple_selection.every((function(e){return e.no_charge_shutdown_ecs}));if(i)return!1}else{var a=this.multiple_selection[0].disk_info;if(a&&"local"===a.system)return!1}else if(e){var n=this.multiple_selection[0].disk_info;if(n&&"local"!==n.system&&!s)return!1}return!0}},{key:"FnSearch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.FnClearTimer(),this.search_reqData={ecs_id:e.ecs_id,ecs_name:e.ecs_name,customer_id:e.customer_id,customer_name:e.customer_name,os_info:e.os_info,private_net:e.private_net,public_net:e.public_net,host_id:e.host_id,host_name:e.host_name,host_ip:e.host_ip,out_band_address:e.out_band_address,start_time:e.create_time&&e.create_time[0]?H()(e.create_time[0]).format("YYYY-MM-DD"):void 0,end_time:e.create_time&&e.create_time[1]?H()(e.create_time[1]).format("YYYY-MM-DD"):void 0},this.page_info.page_index=1,this.get_pod_ecs_list()}},{key:"infoClick",value:function(e){e.label;var t=e.value;if(!e.list&&!e.disabled){if("instance_record"===t)this.record_id=this.ecs_id,this.record_visible=!0;else if("instance_detail"===t)this.detail_id=this.ecs_id,this.detail_visible=!0;else if("add_common_mirror"===t)this.ecs_info=this.multiple_selection[0],this.common_visible=!0;else if("vnc"===t)this.FnToVnc(this.ecs_id);else if("gpu_manage"===t)this.operateGpu();else if("migrate"===t){var s=this.multiple_selection[0].host_id;if(this.multiple_selection.some((function(e){return e.host_id!==s})))return this.$message.warning("请选择同一宿主机的实例"),void Object(O["a"])();this.migrate_visible=!0}else"monitor"===t?this.$router.push({path:"/vm_monitor/".concat(this.multiple_selection[0].ecs_id)}):"rescue_mode"===t?this.FnToRescue():"exit_rescue_mode"===t&&this.FnExitRescue();if("security_group"===t&&this.$router.push({name:"security_group",query:{ecs_id:this.multiple_selection[0].ecs_id}}),["start_up_ecs","shutdown_ecs","restart_ecs","delete_ecs","restore","destroy_ecs","update_spec","update_system","reset_pwd","net_set"].includes(t)){var i=U["a"].getInsOperateAuth(t);if(["reset_pwd","update_spec","update_system","open_bill","net_set"].indexOf(t)>=0){if(!this.FnJudegCustomerAz(i,t))return;if("open_bill"===e.value&&(this.FnGetEcsPrice(),Object(O["a"])()),"net_set"===e.value)return this.net_visible=!0,void Object(O["a"])()}else if(!this.FnJudgeCustomer(i,t))return;this.operate_title=i.label,this.show_operate_dialog=!0,this.default_operate_type=t,this.FnClearTimer()}Object(O["a"])()}}},{key:"FnToRescue",value:function(){this.ecs_id=this.multiple_selection[0].ecs_id,this.customer_id=this.multiple_selection[0].customer_id,this.rescue_visible=!0}},{key:"FnExitRescue",value:function(){var e=this,t=this.multiple_selection[0];this.$confirm("是否退出救援模式？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(c["a"])(regeneratorRuntime.mark((function s(){var i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,y["a"].exit_rescue({customer_id:t.customer_id,ecs_id:t.ecs_id});case 2:i=s.sent,"Success"===i.code&&(e.$message.success(i.message),e.get_pod_ecs_list());case 4:case"end":return s.stop()}}),s)})))).catch((function(){e.$message({type:"info",message:"已取消退出救援模式"})}))}},{key:"operateGpu",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.multiple_selection[0].ecs_id,e.next=3,y["a"].update_gpu_status({ecs_id:t});case 3:s=e.sent,"Success"===s.code&&this.FnGetGraphics(t);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnGetGraphics",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=Object(o["a"])({page_index:this.page_info.current,page_size:this.page_info.size,is_op:!0,az_id:this.$store.state.az_id},this.sort_prop_name,this.sort_order),"pod_vm"===this.$route.name?s["pod_id"]=this.$route.params.id:"cluster_vm"===this.$route.name?s["pod_id"]=Object(ie["a"])(this.$route.params.id):"host_vm"===this.$route.name&&(s["pod_id"]=Object(ie["b"])(this.$route.params.id)),s["ecs_id"]=t,e.next=5,V["a"].get_instance_list(s);case 5:i=e.sent,"Success"==i.code&&(this.multiple_selection=i.data.ecs_list,this.show_operate_dialog=!0,this.operate_title="显卡管理",this.default_operate_type="gpu_manage",this.FnClearTimer());case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"FnToVnc",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].get_vnc_url({ecs_id:t});case 2:s=e.sent,"Success"===s.code&&(i=s.data.vnc_info.split("/vnc_lite.html"),a="".concat(i[0],"/vnc_lite.html?op-token=").concat(this.$store.state.token,"?path=/?id=").concat(t),window.open(a));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"close",value:function(e){this.get_pod_ecs_list(),this.show_operate_dialog=!1,this.default_operate_type="",this.operate_title="",this.multiple_selection=[];var t=this.$refs.table;t.clearSelection()}},{key:"FnJudgeCustomer",value:function(e,t){this.customer_id="";var s=!0;this.multiple_selection_id=[];for(var i=0;i<this.multiple_selection.length;i++){var a=this.multiple_selection[i];if(this.multiple_selection_id.push(a.ecs_id),0===i&&(this.customer_id=a.customer_id,this.is_gpu=Number(a.is_gpu)),a.customer_id!==this.customer_id){this.$message.warning("只允许对同一客户的实例进行批量操作！"),s=!1;break}if(["recover_ecs"].indexOf(t)>=0&&a.is_gpu!=this.is_gpu){this.$message.warning("只允许对同一类型实例进行批量".concat(e.label,"操作！")),s=!1;break}if(e.auth.indexOf(a.status)<0){this.$message.warning(e.msg),s=!1;break}}return s}},{key:"FnJudegCustomerAz",value:function(e,t){this.customer_id="",this.az_id="",this.billing_method="0",this.origin_disk_size=0,this.support_gpu_driver="",this.spec_family_id="",this.system_disk_feature="",this.os_type="";var s=!0;this.multiple_selection_id=[];for(var i=0;i<this.multiple_selection.length;i++){var a=this.multiple_selection[i];if(this.multiple_selection_id.push(a.ecs_id),0===i&&(this.customer_id=a.customer_id,this.az_id=a.az_id,this.billing_method=a.billing_method,this.is_gpu=Number(a.is_gpu),this.support_gpu_driver=a.support_gpu_driver,this.spec_family_id=a.spec_family_id,this.os_type=a.os_type,this.system_disk_feature=a.system_disk_feature),a.customer_id!==this.customer_id||a.az_id!==this.az_id){this.$message.warning("只允许对同一客户的同一可用区下实例进行批量操作！"),s=!1;break}if(["update_spec","update_system"].indexOf(t)>=0&&(a.is_gpu!=this.is_gpu||a.billing_method!==this.billing_method)){this.$message.warning("只允许对同一类型同一计费方式实例进行批量".concat(e.label,"操作！")),s=!1;break}if("open_bill"===t&&a.is_charge){this.$message.warning("只允许对未开启计费的实例开启计费！"),s=!1;break}if("update_system"===t&&a.support_gpu_driver!=this.support_gpu_driver){this.$message.warning("只允许对同一驱动类型实例进行批量".concat(e.label,"操作！")),s=!1;break}if("update_system"===t&&a.spec_family_id!=this.spec_family_id){this.$message.warning("只允许对同一规格族实例进行批量".concat(e.label,"操作！")),s=!1;break}if("update_system"===t&&a.os_type!=this.os_type){this.$message.warning("Windows和linux系统不可以互换重装！"),s=!1;break}if("update_spec"===t&&this.is_gpu){this.$message.warning("不允许对GPU实例".concat(e.label,"操作！")),s=!1;break}if(["update_spec","update_system"].includes(t)&&a.no_charge_shutdown_ecs){this.$message.warning("不允许对关机不计费的实例".concat(e.label,"操作！")),s=!1;break}if(e.auth.indexOf(a.status)<0){this.$message.warning(e.msg),s=!1;break}this.origin_disk_size=Math.max(this.origin_disk_size,a.system_disk_size)}return s}},{key:"FnGetEcsPrice",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.ecs_list_price={},e.next=3,y["a"].each_resource_price({customer_id:this.customer_id,az_id:this.az_id,billing_method:"0",resource_ids:this.multiple_selection_id,resource_type:"ecs"});case 3:if(t=e.sent,"Success"===t.code)for(s in t.data.total_price)this.$set(this.ecs_list_price,s,t.data.price_symbol+t.data.total_price[s].toFixed(2)+"/"+t.data.price_unit);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnSetTimer",value:function(){var e=this;this.timer&&this.FnClearTimer(),this.timer=setTimeout((function(){e.get_pod_ecs_list(!1)}),5e3)}},{key:"FnClearTimer",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"watch_az",value:function(e){e&&this.refresh()}},{key:"refresh",value:function(){this.get_pod_ecs_list()}},{key:"FnExport",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t=this.search_ecs_goods_name.map((function(e){return e.toString()})),s=Object.assign({billing_method:""==this.search_billing_method?"no":this.search_billing_method,op_source:this.search_op_source,spec_family_ids:t,product_source:this.search_product_source},this.search_reqData),"pod_vm"===this.$route.name?s["pod_id"]=this.$route.params.id:"cluster_vm"===this.$route.name?s["cluster_id"]=this.$route.params.id:"host_vm"===this.$route.name&&(s["host_id"]=this.$route.params.id),e.next=6,V["a"].export_list(s);case 6:i=e.sent,i&&(this.loading=!1,a=new Blob([i],{type:"application/octet-stream"}),n=new FileReader,r="云服务器-"+q["a"].get("pod_name")+"-"+H()(new Date).format("YYYYMMDD"),n.readAsText(a,"utf-8"),n.onload=function(){var e=document.createElement("a");e.href=window.URL.createObjectURL(a),e.download=r+".xlsx",e.click(),window.URL.revokeObjectURL(e.href)});case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_source_type",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].get_product_source();case 2:t=e.sent,"Success"===t.code&&t.data.map((function(e){s.product_source_list.push({text:e.value,value:e.value})}));case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnGetCateGoryList",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].get_family_data();case 2:if(t=e.sent,"Success"===t.code){s=Object(l["a"])(t.data.spec_family_list);try{for(s.s();!(i=s.n()).done;)a=i.value,this.ecs_goods_name_list.push({value:a.spec_family_id,text:a.name})}catch(n){s.e(n)}finally{s.f()}}case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_field",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].get_pod_ecs_field();case 2:t=e.sent,"Success"===t.code&&(s=["field_name","show_name"],i=["prop","label"],a=[],this.all_item=t.data.map((function(e){return a=[].concat(Object(r["a"])(a),Object(r["a"])(e.filed)),e})),this.all_column_item=Object(g["b"])(a,i,s),this.get_custom_columns(this.$store.state.pod.vm_host),this.get_custom_columns(this.$store.state.pod.vm_host));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_custom_columns",value:function(e){var t=this;0!==e.length&&(this.custom_host=this.all_column_item.filter((function(t){return e.includes(t.label)})),this.custom_host.map((function(e){return["gpu_card_status","status_display","ecs_goods_name","product_source"].includes(e.prop)||(e=Object.assign(e,{},{sortable:"custom"})),["ecs_id","ecs_name","host_name","create_time","update_time","gpu_card_status"].includes(e.prop)&&(e=Object.assign(e,{},{width:"150px",overflow:!0})),["gpu_card_status","eip_info","private_net","customer_id","customer_name","status_display","ecs_goods_name","pub_net","product_source"].includes(e.prop)&&(e=Object.assign(e,{},{width:"120px",overflow:!0})),"status_display"===e.prop&&(e=Object.assign(e,{},{column_key:"status",list:t.ecs_status_list,multiple:!0})),"gpu_card_status"===e.prop&&(e=Object.assign(e,{},{column_key:"card_status_type",list:t.gpu_status_list,multiple:!1})),"ecs_goods_name"===e.prop&&(e=Object.assign(e,{},{column_key:"ecs_goods_name",list:t.ecs_goods_name_list,multiple:!0})),"product_source"===e.prop&&(e=Object.assign(e,{},{column_key:"product_source",list:t.product_source_list,multiple:!1})),e})),this.FnDoLayout())}},{key:"FnGetStatus",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,y["a"].get_vm_status_list();case 2:if(t=e.sent,"Success"===t.code){for(s in this.ecs_status_list=[],t.data)"destroy_ecs"!==s&&this.ecs_status_list.push({text:t.data[s],value:s});this.get_pod_ecs_list()}case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleFilterChange",value:function(e){var t=this;this.FnClearTimer(),setTimeout((function(){e.status&&(t.search_status=e.status),e.card_status_type&&(t.search_card_status_type=e.card_status_type[0]),e.ecs_goods_name&&(t.search_ecs_goods_name=e.ecs_goods_name),e.product_source&&(t.search_product_source=e.product_source[0]),t.get_pod_ecs_list()}),500)}},{key:"FnCustom",value:function(){this.show_custom=!0}},{key:"get_pod_ecs_list",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=!(a.length>0&&void 0!==a[0])||a[0],this.$store.state.az_id){e.next=3;break}return e.abrupt("return");case 3:return this.multiple_selection_id=[],t||(this.$store.commit("SET_LOADING",!1),this.multiple_selection_id=this.multiple_selection.map((function(e){return e.ecs_id}))),s=Object(n["a"])(Object(o["a"])({page_index:this.page_info.current,page_size:this.page_info.size,is_op:!0,az_id:this.$store.state.az_id},this.sort_prop_name,this.sort_order),this.search_reqData),"pod_vm"===this.$route.name?s["pod_id"]=this.$route.params.id:"cluster_vm"===this.$route.name?s["cluster_id"]=this.$route.params.id:"host_vm"===this.$route.name&&(s["host_id"]=this.$route.params.id),this.search_status.length>0&&(s["status"]=this.search_status.join(",")),this.search_card_status_type&&(s["card_status_type"]=this.search_card_status_type),this.search_ecs_goods_name.length>0&&(s["spec_family_ids"]=this.search_ecs_goods_name.join(",")),this.search_product_source&&(s["product_source"]=this.search_product_source),e.next=13,y["a"].get_pod_ecs_list(s);case 13:i=e.sent,"Success"===i.code&&(this.list=i.data.result,this.page_info.total=i.data.page_info.count);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnRightClick",value:function(e,t,s){var i=this.multiple_selection.some((function(t){return t.ecs_id===e.ecs_id}));i||this.$refs.table.toggleRowSelection(e),this.ecs_id=e.ecs_id,Object(k["a"])(e,t,s)}},{key:"FnOperRow",value:function(e){this.$refs.table.toggleRowSelection(e)}},{key:"rowStyle",value:function(e){var t=e.row,s=this.multiple_selection.some((function(e){return e.ecs_id===t.ecs_id}));if(s)return"rowStyle"}},{key:"FnDoLayout",value:function(){var e=this;this.$nextTick((function(){e.$refs.table.doLayout()}))}},{key:"closeRecord",value:function(){this.record_visible=!1}},{key:"closeDetail",value:function(){this.detail_visible=!1}},{key:"handleSelectionChange",value:function(e){this.multiple_selection=e}},{key:"FnSortChange",value:function(e){this.FnClearTimer();var t={};this.all_item.forEach((function(e){e.filed.forEach((function(e){t[e.field_name]="sort_".concat(e.field_name)}))})),this.sort_prop_name=t[e.prop],this.sort_order="ascending"===e.order?"0":"descending"===e.order?"1":void 0,this.get_pod_ecs_list()}},{key:"handleSizeChange",value:function(e){this.FnClearTimer(),this.page_info.size=e,this.get_pod_ecs_list()}},{key:"handleCurrentChange",value:function(e){this.FnClearTimer(),this.page_info.current=e,this.get_pod_ecs_list()}}]),s}(f["e"]);Object(h["a"])([Object(f["f"])("multiple_selection",{immediate:!0,deep:!0})],ne.prototype,"watch_multi",null),Object(h["a"])([Object(f["f"])("$store.state.search_vm")],ne.prototype,"watch_search",null),Object(h["a"])([Object(f["f"])("$store.state.az_id")],ne.prototype,"watch_az",null),ne=Object(h["a"])([Object(f["a"])({components:{Migrate:se,Operate:M,SearchFrom:b["a"],SvgIcon:m["a"],CustomListItem:v["a"],RightClick:j["a"],Record:w["a"],Detail:x["a"],AddCommon:C["a"],netSet:S["a"],actionBlock:B["a"],RescueMode:ae["a"]}})],ne);var re=ne,oe=re,ce=(s("ff8b"),Object(A["a"])(oe,i,a,!1,null,"5a219a02",null));t["default"]=ce.exports},"44e6":function(e,t,s){},"485b":function(e,t,s){},4875:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-input-number",{attrs:{disabled:e.disable,step:e.size_info.disk_step,min:e.size_info.disk_min,max:e.size_info.disk_max},on:{blur:e.FnChange,change:e.FnChange},model:{value:e.size_info.size,callback:function(t){e.$set(e.size_info,"size",t)},expression:"size_info.size"}})},a=[],n=s("1da1"),r=s("5530"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("9ab4")),d=s("1b40"),p=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.size_info=Object(r["a"])(Object(r["a"])({},e.info),{},{size:NaN}),e}return Object(c["a"])(s,[{key:"watch_info",value:function(e){this.size_info=Object(r["a"])(Object(r["a"])({},this.size_info),this.info),console.log("info",this.size_info),this.FnChange()}},{key:"FnChange",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=0,this.size_info.size?(console.log("bbb",this.size_info.disk_max,this.size_info.size),s=Math.min(this.size_info.disk_max,this.size_info.size)-this.size_info.disk_min,s=s>0?s:0,i=Math.floor(s/this.size_info.disk_step),t=i*this.size_info.disk_step+this.size_info.disk_min,console.log("size",i,t)):(console.log("aaa"),t=this.size_info.disk_min),this.$nextTick((function(){a.size_info.size=t,a.returnValue()}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"returnValue",value:function(){return this.size_info}}]),s}(d["e"]);Object(_["a"])([Object(d["c"])({default:!1})],p.prototype,"disable",void 0),Object(_["a"])([Object(d["c"])({default:function(){return{disk_step:1,disk_min:1,disk_max:1}}})],p.prototype,"info",void 0),Object(_["a"])([Object(d["f"])("info",{deep:!0,immediate:!0})],p.prototype,"watch_info",null),Object(_["a"])([Object(d["b"])("func")],p.prototype,"returnValue",null),p=Object(_["a"])([Object(d["a"])({})],p);var h=p,f=h,m=s("2877"),b=Object(m["a"])(f,i,a,!1,null,null,null);t["a"]=b.exports},"498a":function(e,t,s){"use strict";var i=s("23e7"),a=s("58a8").trim,n=s("c8d2");i({target:"String",proto:!0,forced:n("trim")},{trim:function(){return a(this)}})},"4d8e":function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_pod_ecs_field:function(){return Object(i["a"])(Object(a["b"])("GET","/pod/get_pod_ecs_field/"))},get_vm_status_list:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/ecs_status_list/"))},get_vnc_url:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/vnc_info/",e))},update_gpu_status:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/update_gpu_status/",e))},each_resource_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/each_resource_price/",e))},get_pod_ecs_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/pod/get_pod_ecs_list/",e))},change_config_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_config_price/",e))},change_system_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_system_price/",e))},operate_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/operate/",e))},delete_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/delete/",e))},destroy_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/destroy/",e))},reset_password:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_reset_password/",e))},update_spec:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_configure/",e))},update_system:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_system/",e))},start_charge:function(e){return Object(i["a"])(Object(a["b"])("POST","/resource/start_charge/",e))},mount_gpu_card:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/instance_gpu_card/",e))},get_family_data:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_family_data/"))},get_product_source:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_product_source/"))},enter_rescue:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/enter_rescue/",e))},exit_rescue:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/exit_rescue/",e))},get_security_info:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/security_info/",e))}}},"4e82":function(e,t,s){"use strict";var i=s("23e7"),a=s("e330"),n=s("59ed"),r=s("7b0b"),o=s("07fa"),c=s("577e"),l=s("d039"),u=s("addb"),_=s("a640"),d=s("04d1"),p=s("d998"),h=s("2d00"),f=s("512ce"),m=[],b=a(m.sort),v=a(m.push),g=l((function(){m.sort(void 0)})),y=l((function(){m.sort(null)})),k=_("sort"),O=!l((function(){if(h)return h<70;if(!(d&&d>3)){if(p)return!0;if(f)return f<603;var e,t,s,i,a="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(i=0;i<47;i++)m.push({k:t+i,v:s})}for(m.sort((function(e,t){return t.v-e.v})),i=0;i<m.length;i++)t=m[i].k.charAt(0),a.charAt(a.length-1)!==t&&(a+=t);return"DGBEFHACIJK"!==a}})),j=g||!y||!k||!O,w=function(e){return function(t,s){return void 0===s?-1:void 0===t?1:void 0!==e?+e(t,s)||0:c(t)>c(s)?1:-1}};i({target:"Array",proto:!0,forced:j},{sort:function(e){void 0!==e&&n(e);var t=r(this);if(O)return void 0===e?b(t):b(t,e);var s,i,a=[],c=o(t);for(i=0;i<c;i++)i in t&&v(a,t[i]);u(a,w(e)),s=a.length,i=0;while(i<s)t[i]=a[i++];while(i<c)delete t[i++];return t}})},"4fad":function(e,t,s){var i=s("d039"),a=s("861d"),n=s("c6b6"),r=s("d86b"),o=Object.isExtensible,c=i((function(){o(1)}));e.exports=c||r?function(e){return!!a(e)&&((!r||"ArrayBuffer"!=n(e))&&(!o||o(e)))}:o},5049:function(e,t,s){},"512ce":function(e,t,s){var i=s("342f"),a=i.match(/AppleWebKit\/(\d+)\./);e.exports=!!a&&+a[1]},"51ef":function(e,t,s){"use strict";s("047d")},"542d":function(e,t,s){},"56c7":function(e,t,s){"use strict";s("e776")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,s){var i=s("e330"),a=s("1d80"),n=s("577e"),r=s("5899"),o=i("".replace),c="["+r+"]",l=RegExp("^"+c+c+"*"),u=RegExp(c+c+"*$"),_=function(e){return function(t){var s=n(a(t));return 1&e&&(s=o(s,l,"")),2&e&&(s=o(s,u,"")),s}};e.exports={start:_(1),end:_(2),trim:_(3)}},"59ee":function(e,t,s){"use strict";s("485b")},"5fdb":function(e,t,s){"use strict";s("7bb9")},6062:function(e,t,s){s("1c59")},6285:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return r}));var i=s("b85c"),a=s("0613");function n(e){var t,s=Object(i["a"])(a["a"].state.tree_list);try{for(s.s();!(t=s.n()).done;){var n,r=t.value,o=Object(i["a"])(r.children);try{for(o.s();!(n=o.n()).done;){var c=n.value;if(c.cluster_id===e)return r.pod_id}}catch(l){o.e(l)}finally{o.f()}}}catch(l){s.e(l)}finally{s.f()}return null}function r(e){var t,s=Object(i["a"])(a["a"].state.tree_list);try{for(s.s();!(t=s.n()).done;){var n,r=t.value,o=Object(i["a"])(r.children||[]);try{for(o.s();!(n=o.n()).done;){var c,l=n.value,u=Object(i["a"])(l.children||[]);try{for(u.s();!(c=u.n()).done;){var _=c.value;if(_.host_id===e)return r.pod_id}}catch(d){u.e(d)}finally{u.f()}}}catch(d){o.e(d)}finally{o.f()}}}catch(d){s.e(d)}finally{s.f()}return null}},6566:function(e,t,s){"use strict";var i=s("9bf2").f,a=s("7c73"),n=s("e2cc"),r=s("0366"),o=s("19aa"),c=s("2266"),l=s("7dd0"),u=s("2626"),_=s("83ab"),d=s("f183").fastKey,p=s("69f3"),h=p.set,f=p.getterFor;e.exports={getConstructor:function(e,t,s,l){var u=e((function(e,i){o(e,p),h(e,{type:t,index:a(null),first:void 0,last:void 0,size:0}),_||(e.size=0),void 0!=i&&c(i,e[l],{that:e,AS_ENTRIES:s})})),p=u.prototype,m=f(t),b=function(e,t,s){var i,a,n=m(e),r=v(e,t);return r?r.value=s:(n.last=r={index:a=d(t,!0),key:t,value:s,previous:i=n.last,next:void 0,removed:!1},n.first||(n.first=r),i&&(i.next=r),_?n.size++:e.size++,"F"!==a&&(n.index[a]=r)),e},v=function(e,t){var s,i=m(e),a=d(t);if("F"!==a)return i.index[a];for(s=i.first;s;s=s.next)if(s.key==t)return s};return n(p,{clear:function(){var e=this,t=m(e),s=t.index,i=t.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete s[i.index],i=i.next;t.first=t.last=void 0,_?t.size=0:e.size=0},delete:function(e){var t=this,s=m(t),i=v(t,e);if(i){var a=i.next,n=i.previous;delete s.index[i.index],i.removed=!0,n&&(n.next=a),a&&(a.previous=n),s.first==i&&(s.first=a),s.last==i&&(s.last=n),_?s.size--:t.size--}return!!i},forEach:function(e){var t,s=m(this),i=r(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:s.first){i(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!v(this,e)}}),n(p,s?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return b(this,0===e?0:e,t)}}:{add:function(e){return b(this,e=0===e?0:e,e)}}),_&&i(p,"size",{get:function(){return m(this).size}}),u},setStrong:function(e,t,s){var i=t+" Iterator",a=f(t),n=f(i);l(e,t,(function(e,t){h(this,{type:i,target:e,state:a(e),kind:t,last:void 0})}),(function(){var e=n(this),t=e.kind,s=e.last;while(s&&s.removed)s=s.previous;return e.target&&(e.last=s=s?s.next:e.state.first)?"keys"==t?{value:s.key,done:!1}:"values"==t?{value:s.value,done:!1}:{value:[s.key,s.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),s?"entries":"values",!s,!0),u(t)}}},"682f":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"total"},[s("div",{staticClass:"used",style:{height:e.hei&&0!==e.hei?e.hei+"%":0,background:e.hei>=0&&e.hei<50?"#67c23a":e.hei<80?"yellow":"red"}})])},a=[],n=s("bee2"),r=s("d4ec"),o=s("262e"),c=s("2caf"),l=(s("a9e3"),s("9ab4")),u=s("1b40"),_=function(e){Object(o["a"])(s,e);var t=Object(c["a"])(s);function s(){return Object(r["a"])(this,s),t.apply(this,arguments)}return Object(n["a"])(s)}(u["e"]);Object(l["a"])([Object(u["c"])(Number)],_.prototype,"hei",void 0),_=Object(l["a"])([Object(u["a"])({})],_);var d=_,p=d,h=(s("c765"),s("2877")),f=Object(h["a"])(p,i,a,!1,null,"43aeadcd",null);t["a"]=f.exports},6959:function(e,t,s){"use strict";s("44e6")},"6b75":function(e,t,s){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}s.d(t,"a",(function(){return i}))},"6d61":function(e,t,s){"use strict";var i=s("23e7"),a=s("da84"),n=s("e330"),r=s("94ca"),o=s("6eeb"),c=s("f183"),l=s("2266"),u=s("19aa"),_=s("1626"),d=s("861d"),p=s("d039"),h=s("1c7e"),f=s("d44e"),m=s("7156");e.exports=function(e,t,s){var b=-1!==e.indexOf("Map"),v=-1!==e.indexOf("Weak"),g=b?"set":"add",y=a[e],k=y&&y.prototype,O=y,j={},w=function(e){var t=n(k[e]);o(k,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(v&&!d(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return v&&!d(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!d(e))&&t(this,0===e?0:e)}:function(e,s){return t(this,0===e?0:e,s),this})},x=r(e,!_(y)||!(v||k.forEach&&!p((function(){(new y).entries().next()}))));if(x)O=s.getConstructor(t,e,b,g),c.enable();else if(r(e,!0)){var C=new O,S=C[g](v?{}:-0,1)!=C,z=p((function(){C.has(1)})),F=h((function(e){new y(e)})),R=!v&&p((function(){var e=new y,t=5;while(t--)e[g](t,t);return!e.has(-0)}));F||(O=t((function(e,t){u(e,k);var s=m(new y,e,O);return void 0!=t&&l(t,s[g],{that:s,AS_ENTRIES:b}),s})),O.prototype=k,k.constructor=O),(z||R)&&(w("delete"),w("has"),b&&w("get")),(R||S)&&w(g),v&&k.clear&&delete k.clear}return j[e]=O,i({global:!0,forced:O!=y},j),f(O,e),v||s.setStrong(O,e,b),O}},"6f53":function(e,t,s){var i=s("83ab"),a=s("e330"),n=s("df75"),r=s("fc6a"),o=s("d1e7").f,c=a(o),l=a([].push),u=function(e){return function(t){var s,a=r(t),o=n(a),u=o.length,_=0,d=[];while(u>_)s=o[_++],i&&!c(a,s)||l(d,e?[s,a[s]]:a[s]);return d}};e.exports={entries:u(!0),values:u(!1)}},7141:function(e,t,s){},"74b1":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"迁移",visible:e.visible_sync,width:"1180px","destroy-on-close":!0,"custom-class":"upload","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",{staticClass:"migrate"},[s("div",{staticClass:"left"},[s("div",{staticClass:"m-bottom10"},[s("el-checkbox",{attrs:{indeterminate:e.isIndeterminate,disabled:0===e.useable_list.length},on:{change:e.handleCheckAllChange},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}),e._v(" "+e._s(e.rows[0].host_name)+"("),s("span",{staticClass:"num_message"},[e._v(e._s(e.selected.length))]),e._v("/"+e._s(e.list.length)+") "),s("span",{staticClass:"warning_message"},[e._v("(若是GPU型云主机，建议单选虚拟机)")]),s("el-button",{attrs:{type:"text"},on:{click:e.getHostList}},[s("svg-icon",{attrs:{icon:"refresh"}})],1)],1),s("el-table",{ref:"table",attrs:{data:e.list,border:"","max-height":"500"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",selectable:e.checkSelectable}}),s("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),s("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),s("el-table-column",{attrs:{prop:"ecs_id",label:"实例名称/实例ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(e._s(t.row.name)+" / ")]),e.useable_list.includes(t.row.ecs_id)?s("span",[e._v(e._s(t.row.ecs_id))]):s("el-tooltip",{attrs:{content:e.getMsg(t.row),effect:"light"}},[s("div",[e._v(e._s(t.row.ecs_id))])])]}}])}),s("el-table-column",{attrs:{prop:"status",label:"状态"}}),s("el-table-column",{attrs:{prop:"genre",label:"计算规格"}}),s("el-table-column",{attrs:{prop:"genre",label:"存储",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.disk_info?s("div",[e._v("系统盘："+e._s(Object.keys(t.row.disk_info.system)[0])+" "+e._s(t.row.disk_info.system[Object.keys(t.row.disk_info.system)[0]])+e._s(t.row.disk_info.unit))]):e._e(),t.row.disk_info&&Object.keys(t.row.disk_info.data).length>0?s("div",{staticClass:"data-item"},[e._v(" 数据盘： "),e._l(t.row.disk_info.data,(function(i,a){return s("div",{key:a},[e._v(e._s(a)+" "+e._s(i)+e._s(t.row.disk_info.unit))])}))],2):e._e()]}}])})],1),0===e.selected.length?s("div",{staticClass:"error_message m-top10"},[e._v("请选择虚拟机")]):e._e()],1),s("div",{staticClass:"center"},[s("div",[e._v("迁移至")]),s("div",[e._v("------------\x3e")])]),s("div",{staticClass:"right"},[s("h4",[e._v("目的主机:")]),s("div",{staticClass:"m-bottom20"},[s("span",{staticClass:"m-right10"},[e._v("可用区:")]),s("span",[e._v(e._s(e.rows[0].az_name))])]),s("div",[e._v("物理机："),s("span",{staticClass:"prompt_message"},[e._v("（若不选择则随机迁移至合适的目的主机）")])]),e.recommend.length>0?s("div",{staticClass:"recommend"},e._l(e.recommend,(function(t){return s("div",{key:t.host_id,staticClass:"item",class:e.physical.includes(t.host_id)?"active":"",on:{click:function(s){return e.handle(t.host_id)}}},[e._v(" "+e._s(t.host_name)+" "),s("el-tooltip",{attrs:{content:t.cpu_usage?parseFloat(t.cpu_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.cpu_usage}}),s("div",[e._v("CPU")])],1)]),s("el-tooltip",{attrs:{content:t.memory_usage?parseFloat(t.memory_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.memory_usage}}),s("div",[e._v("内存")])],1)]),s("el-tooltip",{attrs:{content:t.local_storage_usage?parseFloat(t.local_storage_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.local_storage_usage}}),s("div",[e._v("本地存储")])],1)]),s("el-tooltip",{attrs:{content:(t.used_gpu_num?t.used_gpu_num:0)+" / "+(t.total_gpu_num?t.total_gpu_num:0),placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:0===t.total_gpu_num?0:100*Number((t.used_gpu_num/t.total_gpu_num).toFixed(2))}}),s("div",[e._v("显卡")])],1)])],1)})),0):s("div",{staticClass:"error_message m-top10"},[e._v("无合适的物理机，无法迁移。可选择单台虚机再次尝试")])])]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",disabled:0===this.recommend.length},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},a=[],n=s("2909"),r=s("1da1"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("4de4"),s("d3b7"),s("caad"),s("d81d"),s("b64b"),s("2532"),s("6062"),s("3ca3"),s("ddb0"),s("99af"),s("9ab4")),d=s("1b40"),p=s("1477"),h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"total"},[s("div",{staticClass:"used",style:{height:e.hei&&0!==e.hei?e.hei+"%":0,background:e.hei>=0&&e.hei<50?"#67c23a":e.hei<80?"yellow":"red"}})])},f=[],m=(s("a9e3"),function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){return Object(o["a"])(this,s),t.apply(this,arguments)}return Object(c["a"])(s)}(d["e"]));Object(_["a"])([Object(d["c"])(Number)],m.prototype,"hei",void 0),m=Object(_["a"])([Object(d["a"])({})],m);var b=m,v=b,g=(s("74cb"),s("2877")),y=Object(g["a"])(v,h,f,!1,null,"7a62b7c8",null),k=y.exports,O=s("3673"),j=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.list=e.rows[0].ecs_list,e.selected=[],e.checked=!1,e.isIndeterminate=!1,e.physical=[],e.physical_list=[],e.recommend=[],e.useable_list=[],e}return Object(c["a"])(s,[{key:"created",value:function(){this.get_recommended_host(),this.setUsableList(this.rows),this.list=this.rows[0].ecs_list}},{key:"setUsableList",value:function(e){var t=e[0].ecs_list.filter((function(e){return["已关机","运行中"].includes(e.status)})),s=[];t.map((function(e){e.is_gpu&&"已关机"===e.status&&!e.no_charge_shutdown_ecs?s.push(e.ecs_id):!e.is_gpu&&e.disk_info&&e.disk_info.system&&("local"!==Object.keys(e.disk_info.system)[0]?["已关机","运行中"].includes(e.status)&&s.push(e.ecs_id):"已关机"===e.status&&s.push(e.ecs_id))})),this.useable_list=s}},{key:"getHostList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].get_host_list({host_name:this.rows[0].host_name});case 2:t=e.sent,"Success"===t.code&&(this.list=t.data.host_list[0].ecs_list,this.setUsableList(t.data.host_list));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getMsg",value:function(e){return e.is_gpu||e.disk_info&&"local"===Object.keys(e.disk_info.system)[0]?"仅支持关机迁移":"仅运行中和已关机状态下迁移"}},{key:"checkSelectable",value:function(e,t){return!!this.useable_list.includes(e.ecs_id)}},{key:"judge",value:function(){var e=this.physical_list.filter((function(e){return"CPU"===e.host_purpose})),t=e.map((function(e){return e.host_id})),s=Object(n["a"])(new Set([].concat(Object(n["a"])(t),Object(n["a"])(this.physical)))).length;this.selected.some((function(e){return e.is_gpu}))&&s<[].concat(Object(n["a"])(t),Object(n["a"])(this.physical)).length&&(this.$message.warning("GPU云主机不能被迁移到非GPU物理机上"),this.physical=[])}},{key:"get_recommended_host",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:"",this.$store.commit("SET_LOADING",!1),e.next=4,p["a"].recommended_host({host_id:this.rows[0].host_id,host_name:t,ecs_ids:this.selected.map((function(e){return e.ecs_id})),is_gpu:"GPU"===this.rows[0].host_purpose?"1":"0",gpu_card_name:this.rows[0].gpu_real_name});case 4:s=e.sent,"Success"===s.code&&(this.recommend=s.data.data,0===this.selected.length&&(this.physical=[]));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCheckAllChange",value:function(e){var t=this.$refs.table;e?t.toggleAllSelection():t.clearSelection(),this.isIndeterminate=!1}},{key:"handleSelectionChange",value:function(e){this.selected=e,this.get_recommended_host(),this.checked=e.length===this.list.length,this.isIndeterminate=e.length>0&&e.length<this.list.length}},{key:"handle",value:function(e){this.physical.includes(e)?this.physical=this.physical.filter((function(t){return t!==e})):this.physical.push(e)}},{key:"confirm",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.selected.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,p["a"].migrate({ecs_ids:this.selected.map((function(e){return e.ecs_id})),start_host_id:this.rows[0].host_id,end_host_ids:this.physical,is_gpu:"GPU"===this.rows[0].host_purpose?"1":"0"});case 4:t=e.sent,"Success"===t.code?(this.$message.success("物理机迁移任务下发成功！"),this.back("1")):this.back("0");case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(d["e"]);Object(_["a"])([Object(d["d"])("visible")],j.prototype,"visible_sync",void 0),Object(_["a"])([Object(d["c"])({default:function(){return[]}})],j.prototype,"rows",void 0),Object(_["a"])([Object(d["b"])("close")],j.prototype,"back",null),j=Object(_["a"])([Object(d["a"])({components:{CustomIcon:k,svgIcon:O["a"]}})],j);var w=j,x=w,C=(s("e160"),s("f43d"),Object(g["a"])(x,i,a,!1,null,null,null));t["a"]=C.exports},"74cb":function(e,t,s){"use strict";s("fd00")},"76ff":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"配置详情",visible:e.visible,width:"60%","destroy-on-close":!0},on:{"update:visible":function(t){e.visible=t},close:e.back}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("云服务器ID:")]),s("span",[e._v(e._s(e.detail&&e.detail.ecs_id))])]),s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("地域:")]),s("span",[e._v(e._s(e.detail&&e.detail.region_name))])])],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{staticClass:"name-row",attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("云服务器名称:")]),s("span",[s("pre",[e._v(e._s(e.detail&&e.detail.ecs_name))])])]),s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("可用区:")]),s("span",[e._v(e._s(e.detail&&e.detail.az_name))])])],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("状态:")]),s("span",[e._v(e._s(e.detail&&e.detail.status_display))])])],1),s("div",{staticClass:"title"},[e._v("计算规格")]),s("el-row",{attrs:{gutter:20}},[e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name?s("el-col",{attrs:{span:20}},[s("span",{staticClass:"label"},[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name)+":")]),s("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.name))]),e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num?s("span",[e._v("   "+e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num)+"vCPU "),s("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.ram)+"GiB")]),e.detail&&e.detail.is_gpu?s("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.gpu)+"*"+e._s(e.detail&&e.detail.card_name))]):e._e()]):e._e()]):e._e()],1),s("div",{staticClass:"title"},[e._v("操作系统")]),s("div",{staticClass:"content"},[e._v(e._s(e.detail&&e.detail.os_info&&e.detail.os_info.name))]),s("div",{staticClass:"title"},[e._v("存储")]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("系统盘：")]),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf?s("span",{staticClass:"data-disk"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.disk_name))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size?s("span",{staticClass:"data-disk-unit"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size)+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.unit))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id?s("span",{staticClass:"id_name"},[e._v("("+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id)+" / "+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.name)+")")]):e._e()]),s("div",{staticClass:"content data_disk"},[s("span",{staticClass:"label"},[e._v("数据盘：")]),e.detail&&e.detail.disk&&e.detail.disk.data_disk_conf?s("div",{staticClass:"disk_content"},e._l(e.detail.disk.data_disk_conf,(function(t){return s("div",{key:t.id},[s("span",{staticClass:"data-disk"},[e._v(e._s(t.disk_name))]),s("span",{staticClass:"data-disk-unit"},[e._v(e._s(t.size)+e._s(t.unit))]),s("span",{staticClass:"id_name"},[e._v("("+e._s(t.id)+" / "+e._s(t.name)+")")]),s("span",[e._v(e._s(t.is_follow_delete?"随实例删除":"不随实例删除"))])])})),0):e._e()]),s("div",{staticClass:"title"},[e._v("网络")]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("VPC:")]),e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id?s("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_name))]):e._e()]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("子网:")]),e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id?s("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_name))]):e._e()]),s("div",{staticClass:"content display-flex"},[s("span",{staticClass:"label"},[e._v("私网IP：")]),e.detail&&e.detail.pipe?s("span",[e.detail.pipe.private_net?[e._v(e._s(e.detail.pipe.private_net)+" （主）")]:e._e(),s("br"),e.detail.pipe.pub_net?[e._v(" "+e._s(e.detail.pipe.pub_net)+" "),e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） ")]:e._e(),s("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(t){return s("span",{key:t},[e._v(" "+e._s(t)+" "),e.detail.pipe.eip_info[t]&&e.detail.pipe.eip_info[t].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[t].conf_name)+"） ")]:e._e(),s("br")],2)}))],2):e._e()]),s("div",{staticClass:"content display-flex"},[s("span",{staticClass:"label"},[e._v("公网IP：")]),e.detail&&e.detail.pipe?s("span",[e.detail.pipe.pub_net&&e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip?[e._v(" "+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip)+" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） "),s("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(t){return s("span",{key:t},[e.detail.pipe.eip_info[t]&&e.detail.pipe.eip_info[t].conf_name?[e._v(" "+e._s(t.eip_ip)+" （"+e._s(e.detail.pipe.eip_info[t].conf_name)+"） ")]:e._e(),s("br")],2)}))],2):e._e()]),s("div",{staticClass:"divider"}),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("所属机房:")]),s("span",[e._v(e._s(e.detail&&e.detail.engine_room))])]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("所属节点:")]),s("span",[e._v(e._s(e.detail&&e.detail.host_name))])]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("所属物理机:")]),e.detail&&e.detail.host_id?s("span",[e._v(e._s(e.detail&&e.detail.host_id)+"   "),e.detail&&e.detail.host_status?s("span",[e._v("( "+e._s(e.detail&&e.detail.host_status)+" )")]):e._e()]):e._e()]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("处理器型号:")]),s("span",[e._v(e._s(e.detail&&e.detail.cpu_type))])]),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("96cf"),s("9ab4")),_=s("1b40"),d=s("d772"),p=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.detail=null,e.loading=!1,e}return Object(o["a"])(s,[{key:"getDetail",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].get_detail({ecs_id:this.detail_id});case 2:t=e.sent,"Success"===t.code?(this.loading=!1,this.detail=t.data):this.loading=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(){}},{key:"created",value:function(){this.getDetail()}}]),s}(_["e"]);Object(u["a"])([Object(_["c"])(Boolean)],p.prototype,"visible",void 0),Object(u["a"])([Object(_["c"])(String)],p.prototype,"detail_id",void 0),Object(u["a"])([Object(_["b"])("close-detail")],p.prototype,"back",null),p=Object(u["a"])([_["a"]],p);var h=p,f=h,m=(s("d8a7"),s("2877")),b=Object(m["a"])(f,i,a,!1,null,"33b12e64",null);t["a"]=b.exports},"786f":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"操作记录",visible:e.visible,width:"60%","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[s("div",[s("el-dialog",{attrs:{title:"响应信息",visible:e.res_visible,width:"60%","destroy-on-close":!0,"append-to-body":"","custom-class":"response-data"},on:{"update:visible":function(t){e.res_visible=t},close:e.clost_res}},[s("div",[e._v(e._s(e.response))])])],1),s("div",[s("action-block",{attrs:{search_option:["physical","message"].includes(e.type)?Object.assign({},e.search):e.search},on:{"fn-search":e.fn_search}}),["physical","message"].includes(e.type)?s("div",{staticClass:"icon m-bottom10"},[s("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.getOperateRecordList}},[s("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1)],1):e._e(),s("el-table",{staticClass:"record-table",attrs:{data:e.record_list,border:""}},[s("el-table-column",{attrs:{prop:"oper_time",label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.oper_time?e.moment(t.row.oper_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),s("el-table-column",{attrs:{prop:"oper_type_display",label:"操作内容"}}),s("el-table-column",{attrs:{prop:"status_display",label:"状态"}}),["message","physical"].includes(e.type)?s("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.response?s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.view(t.row.response)}}},[e._v("查看")]):s("span",[e._v("-")])]}}])}):s("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.result?s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.view(t.row.result)}}},[e._v("查看")]):s("span",[e._v("-")])]}}],null,!1,79404134)}),s("el-table-column",{attrs:{prop:"finish_time",label:"完成时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.finish_time?e.moment(t.row.finish_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),s("el-table-column",{attrs:{prop:"oper_user",label:"nas"===e.type?"操作用户":"用户名"}}),["physical","message"].includes(e.type)?e._e():s("el-table-column",{attrs:{prop:"flag_display",label:"操作标识"}})],1),s("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},a=[],n=s("5530"),r=s("1da1"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("ac1f"),s("841c"),s("caad"),s("9ab4")),d=s("1b40"),p=s("c811"),h=s("d772"),f=s("1477"),m=s("e4d0"),b=s("039b"),v=s("fc43"),g=s("c1df"),y=s.n(g),k=s("8ce4"),O=s("3673"),j=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.state_list=[{type:"",label:"全部"},{type:"doing",label:"执行中"},{type:"success",label:"成功"},{type:"failed",label:"失败"}],e.search={state:{list:e.state_list,placeholder:"请选择状态"},content:{placeholder:"请输入操作内容"}},e.record_list=[],e.current=1,e.size=20,e.total=0,e.search_data={},e.moment=y.a,e.response="",e.res_visible=!1,e}return Object(c["a"])(s,[{key:"created",value:function(){this.fn_search()}},{key:"fn_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.current=1,this.search_data=e,this.getOperateRecordList()}},{key:"getOperateRecordList",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,r,o,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=this.search_data,i="physical"!==this.type?{task_type:s.content,cloud_id:this.record_id}:{content:s.content,cloud_id:this.record_id,cloud_type:"host"},a=Object(n["a"])({status:s.state||"",page_size:this.size,page_index:this.current},i),"physical"!==this.type){e.next=9;break}return e.next=6,f["a"].record(Object(n["a"])({},a));case 6:t=e.sent,e.next=30;break;case 9:if("message"!==this.type){e.next=15;break}return e.next=12,m["a"].get_pub_operate_record({os_id:this.record_id,status:s.state||"",content_type:s.content,page_size:this.size,page_index:this.current});case 12:t=e.sent,e.next=30;break;case 15:if("snapshot"!==this.type){e.next=21;break}return e.next=18,b["a"].record({cloud_id:this.record_id,cloud_type:"snapshot",status:s.state||"",task_type:s.content,page_size:this.size,page_index:this.current});case 18:t=e.sent,e.next=30;break;case 21:if("nas"!==this.type){e.next=27;break}return e.next=24,v["a"].get_nas_record(Object(n["a"])({},a));case 24:t=e.sent,e.next=30;break;case 27:return e.next=29,h["a"].get_operate_record_list(Object(n["a"])({cloud_type:this.type?this.type:"ecs"},a));case 29:t=e.sent;case 30:"Success"===t.code&&(["physical","message"].includes(this.type)?(l=["create_time","content","status_name","response","update_time","op_user"],u=["oper_time","oper_type_display","status_display","response","finish_time","oper_user"],this.record_list=Object(k["b"])(t.data.operation_list,u,l)):this.record_list=(null===(c=t.data)||void 0===c?void 0:c.history_record)||[],this.total=(null===(r=t.data)||void 0===r||null===(o=r.page_info)||void 0===o?void 0:o.count)||0);case 31:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.size=e,this.getOperateRecordList()}},{key:"handleCurrentChange",value:function(e){this.current=e,this.getOperateRecordList()}},{key:"view",value:function(e){this.response=e,this.res_visible=!0}},{key:"clost_res",value:function(){this.res_visible=!1,this.response=""}},{key:"back",value:function(){}}]),s}(d["e"]);Object(_["a"])([Object(d["c"])(Boolean)],j.prototype,"visible",void 0),Object(_["a"])([Object(d["c"])(String)],j.prototype,"record_id",void 0),Object(_["a"])([Object(d["c"])(String)],j.prototype,"type",void 0),Object(_["a"])([Object(d["b"])("close")],j.prototype,"back",null),j=Object(_["a"])([Object(d["a"])({components:{ActionBlock:p["a"],SvgIcon:O["a"]}})],j);var w=j,x=w,C=(s("fdfe"),s("2877")),S=Object(C["a"])(x,i,a,!1,null,null,null);t["a"]=S.exports},"7bb9":function(e,t,s){},"7d2d":function(e,t,s){"use strict";s("b6d9")},"7db0":function(e,t,s){"use strict";var i=s("23e7"),a=s("b727").find,n=s("44d2"),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),i({target:"Array",proto:!0,forced:o},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(r)},"81b2":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"进入救援模式",visible:e.visibleSync,width:"700px","destroy-on-close":!0},on:{"update:visible":function(t){e.visibleSync=t}}},[s("div",{staticClass:"tip_box"},[s("div",[e._v("1. 进入救援模式需要在实例关机状态下进行，建议主动关机，强制关机可能会造成数据丢失或文件损坏")]),s("div",[e._v("2. Linux系统的实例默认使用Ubuntu22.04的引导文件，Windows系统默认使用Windows 10的引导文件")]),s("div",[e._v("3. 处于救援模式的实例不能执行开关机操作")]),s("div",[e._v("4. 退出救援模式后，实例恢复到进入救援模式之前的状态。")])]),s("div",[s("el-form",{ref:"form",staticClass:"m-top10",attrs:{model:e.os_data,"label-width":"100px","label-position":"left"}},[s("el-form-item",{attrs:{label:"镜像:"}},[s("el-select",{staticClass:"m-r-12",on:{change:e.changeOsType},model:{value:e.os_data.os_type,callback:function(t){e.$set(e.os_data,"os_type",t)},expression:"os_data.os_type"}},e._l(e.image_type,(function(e){return s("el-option",{key:e,attrs:{value:e}})})),1),s("el-select",{staticClass:"m-left10",on:{change:e.changeOsType},model:{value:e.os_data.os_id,callback:function(t){e.$set(e.os_data,"os_id",t)},expression:"os_data.os_id"}},e._l(e.image_type_list,(function(e){return s("el-option",{key:e.os_id,attrs:{value:e.os_id,label:e.display_name}})})),1)],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"danger"},on:{click:e.confirm}},[e._v("进入救援模式")]),s("el-button",{attrs:{type:"default"},on:{click:function(t){e.visibleSync=!1}}},[e._v("取消")])],1)])],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("4de4"),s("d3b7"),s("96cf"),s("9ab4")),_=s("1b40"),d=s("e527"),p=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.os_data={os_type:"",os_id:""},e.image_type=[],e.image_list=[],e.image_type_list=[],e}return Object(o["a"])(s,[{key:"created",value:function(){this.FnGetImage()}},{key:"FnGetImage",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].get_rescue_image_list({pod_id:this.$store.state.pod_id,ecs_id:this.ecs_id});case 2:t=e.sent,"Success"===t.code&&(this.image_type=t.data.image_types,this.image_list=t.data.image_list,this.os_data.os_type=this.image_type[0],this.FnInitImageList());case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeOsType",value:function(){this.FnInitImageList()}},{key:"FnInitImageList",value:function(){var e=this;this.image_type_list=this.image_list.filter((function(t){return t.os_type===e.os_data.os_type})),this.os_data.os_id=this.image_type_list[0].os_id}},{key:"confirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={customer_id:this.customer_id,ecs_id:this.ecs_id,os_id:this.os_data.os_id},e.next=3,d["a"].enter_rescue(t);case 3:s=e.sent,"Success"===s.code&&(this.$message.success(s.message),this.visibleSync=!1);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),s}(_["e"]);Object(u["a"])([Object(_["d"])("visible")],p.prototype,"visibleSync",void 0),Object(u["a"])([Object(_["c"])(String)],p.prototype,"ecs_id",void 0),Object(u["a"])([Object(_["c"])(String)],p.prototype,"customer_id",void 0),p=Object(u["a"])([_["a"]],p);var h=p,f=h,m=(s("df2c"),s("2877")),b=Object(m["a"])(f,i,a,!1,null,"c2059ba4",null);t["a"]=b.exports},"89f7":function(e,t,s){},"8b1ad":function(e,t,s){},"8bcb":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));s("a9e3");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN,s=t?(t-Number(e.disk_min))/Number(e.disk_step):0,i=Number(e.min_iops)+Number(e.iops_step)*s>e.max_iops?e.max_iops:Number(e.min_iops)+Number(e.iops_step)*s,a=Number(e.min_throughput)+Number(e.throughput_step)*s>e.max_throughput?e.max_throughput:Number(e.min_throughput)+Number(e.throughput_step)*s;return{iops_show:i+" "+e.iops_unit,throughput_show:a+" "+e.throughput_unit,iops:i,throughput:a}}},"8ce4":function(e,t,s){"use strict";s.d(t,"e",(function(){return n})),s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return o})),s.d(t,"c",(function(){return c})),s.d(t,"d",(function(){return l}));var i=s("5530"),a=s("ade3");s("d81d"),s("b0c0"),s("99af"),s("fb6a");function n(e,t,s,i,n){var r=[];return e.map((function(e){var o;r.push((o={},Object(a["a"])(o,i,e[t]),Object(a["a"])(o,n,e[s]),o))})),r}function r(e,t,s){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=[];return e.map((function(e){var r={};t.map((function(t,i){r[t]=e[s[i]]})),n.push(Object(i["a"])(Object(i["a"])({},r),a))})),n}function o(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s={};for(var a in e){var n=e[a],r=n.billing_scheme_id,o=n.billing_cycle_id,c=n.billing_items,l=n.gic_goods_id,u={};for(var _ in c){var d={attr_id:c[_].attr_id,name:c[_].name},p={id:c[_].id,key:_};u[_]=t?Object(i["a"])(Object(i["a"])({},d),p):p}s[a]={billing_scheme_id:r,billing_cycle_id:o,billing_items:u,gic_goods_id:t?l:void 0}}return s}function c(e,t){return e.map((function(e){return e[t]}))}function l(e){var t="";for(var s in e)e[s]&&(t+="".concat(s,"=").concat(e[s],"&"));return""===t?"":"?".concat(t.slice(0,t.length-1))}},"8de2":function(e,t,s){"use strict";s("1827")},9074:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_customer_name:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/get_customer_name/",e))},get_region_az_list:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/region_az_info/",e))},get_net_list:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/net_info/",e))},get_all_cpu_ram:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/ram_cpu_list/"))},get_category_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/ecs_category_list/",e))},ecs_family_info:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/ecs_family_info/",e))},get_os_list:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/image_info/",e))},get_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/get_price/",e))},create_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/create_ecs/",e))},get_ecs_limit:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/get_ecs_limit/",e))},get_ram_cpu_price_list:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_spec_attach_price/",e))},difference_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_difference_price/",e))},change_configure_limit:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_configure_limit/",e))}}},"94d7":function(e,t,s){},"99af":function(e,t,s){"use strict";var i=s("23e7"),a=s("da84"),n=s("d039"),r=s("e8b5"),o=s("861d"),c=s("7b0b"),l=s("07fa"),u=s("8418"),_=s("65f0"),d=s("1dde"),p=s("b622"),h=s("2d00"),f=p("isConcatSpreadable"),m=9007199254740991,b="Maximum allowed index exceeded",v=a.TypeError,g=h>=51||!n((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),y=d("concat"),k=function(e){if(!o(e))return!1;var t=e[f];return void 0!==t?!!t:r(e)},O=!g||!y;i({target:"Array",proto:!0,forced:O},{concat:function(e){var t,s,i,a,n,r=c(this),o=_(r,0),d=0;for(t=-1,i=arguments.length;t<i;t++)if(n=-1===t?r:arguments[t],k(n)){if(a=l(n),d+a>m)throw v(b);for(s=0;s<a;s++,d++)s in n&&u(o,d,n[s])}else{if(d>=m)throw v(b);u(o,d++,n)}return o.length=d,o}})},a00c:function(e,t,s){},a05b:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"添加计算节点",visible:e.visible_sync,width:"760px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("action-block",{attrs:{search_option:e.search},on:{"fn-search":e.fn_search}}),s("el-table",{attrs:{data:e.list,"max-height":"400px"},on:{"selection-change":e.handleSelectionChange,"sort-change":e.FnSortChange,"filter-change":e.filterAttribute}},[s("el-table-column",{attrs:{type:"selection"}}),s("el-table-column",{attrs:{label:"主机名称",prop:"host_name",sortable:"custom"}}),s("el-table-column",{attrs:{label:"管理网IP",prop:"host_ip"}}),s("el-table-column",{attrs:{label:"CPU型号",prop:"cpu_model",filters:e.cpu_list,"filter-multiple":!1,"column-key":"cpu_model"}}),s("el-table-column",{attrs:{label:"GPU型号",prop:"gpu_model"}}),s("el-table-column",{attrs:{label:"块存储集群",prop:"storage_cluster_name"}}),s("el-table-column",{attrs:{label:"存储类型",prop:"storage_type"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s("local"===t.row.storage_type?"本地盘":"云盘"))])]}}])})],1),s("div",{staticClass:"footer"},[s("div",{staticClass:"m-top10"},[e._v("共"+e._s(e.page_info.total)+"条/已选择"+e._s(e.multiple_selection.length)+"条")]),s("el-pagination",{attrs:{"current-page":e.page_info.current,"page-sizes":[20,50,100],"page-size":e.page_info.size,layout:"sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)],1)],1)},a=[],n=s("1da1"),r=s("5530"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("ac1f"),s("841c"),s("d81d"),s("b0c0"),s("e9c4"),s("9ab4")),d=s("1b40"),p=s("6285"),h=s("da8b"),f=s("3fa7"),m=s("c811"),b=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.search_data={},e.list=[],e.filter_data={},e.multiple_selection=[],e.filter_dict={},e.cpu_list=[],e.search={host_info:{placeholder:"输入主机名称/管理网IP搜索"}},e.sort_host_name="",e.page_info={current:1,size:20,total:0},e}return Object(c["a"])(s,[{key:"watch_visible",value:function(e){e?this.get_host_list():this.search_data=""}},{key:"fn_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.page_info.current=1,this.search_data=Object(r["a"])(Object(r["a"])({},e),this.filter_data),this.get_host_list()}},{key:"confirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.multiple_selection.map((function(e){return{host_id:e.host_id,cluster_id:i.cluster_id}})),e.next=3,h["a"].add_cluster({param:t});case 3:s=e.sent,"Success"===s.code?(""==s.data.error_msg?this.$message.success(s.message):this.$message.warning(s.data.error_msg),this.back("1"),f["a"].$emit("getTreeData",!1)):this.back("0");case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_host_list",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$store.state.az_id){e.next=2;break}return e.abrupt("return");case 2:return t=this.search_data,s=Object(p["a"])(this.$route.params.id),i={page_index:this.page_info.current,page_size:this.page_info.size,az_id:this.$store.state.az_id,pod_id:"pod_cluster"===this.$route.name?this.$route.params.id:s,is_unassigned_cluster:2,host_info:t.host_info||"",cpu_type_id:JSON.stringify(this.info.cpu_type_id),gpu_type_id:this.info.gpu_type_id,storage_cluster_id:this.info.storage_cluster_id,cpu:t.cpu_model?t.cpu_model[0]:void 0,sort_host_name:this.sort_host_name},e.next=7,h["a"].get_pod_host_list(i);case 7:a=e.sent,"Success"===a.code&&(this.list=a.data.result,this.page_info.total=a.data.page_info.count,this.filter_dict=a.data.filter_dict,this.cpu_list=this.filter_dict.cpu_dict.map((function(e){return{text:e,value:e}})));case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.page_info.size=e,this.get_host_list()}},{key:"handleCurrentChange",value:function(e){this.page_info.current=e,this.get_host_list()}},{key:"handleSelectionChange",value:function(e){this.multiple_selection=e}},{key:"FnSortChange",value:function(e){this.sort_host_name=void 0,this.sort_host_name="descending"===e.order?"1":"ascending"===e.order?"0":void 0,this.get_host_list()}},{key:"filterAttribute",value:function(e){this.filter_data=Object(r["a"])(Object(r["a"])({},this.filter_data),e),this.fn_search()}},{key:"back",value:function(e){this.multiple_selection=[],this.visible_sync=!1}}]),s}(d["e"]);Object(_["a"])([Object(d["d"])("visible")],b.prototype,"visible_sync",void 0),Object(_["a"])([Object(d["c"])({default:""})],b.prototype,"cluster_id",void 0),Object(_["a"])([Object(d["c"])({default:function(){}})],b.prototype,"info",void 0),Object(_["a"])([Object(d["f"])("visible")],b.prototype,"watch_visible",null),Object(_["a"])([Object(d["b"])("close")],b.prototype,"back",null),b=Object(_["a"])([Object(d["a"])({components:{ActionBlock:m["a"]}})],b);var v=b,g=v,y=(s("d057"),s("2877")),k=Object(y["a"])(g,i,a,!1,null,"ac635e1a",null);t["a"]=k.exports},a15b:function(e,t,s){"use strict";var i=s("23e7"),a=s("e330"),n=s("44ad"),r=s("fc6a"),o=s("a640"),c=a([].join),l=n!=Object,u=o("join",",");i({target:"Array",proto:!0,forced:l||!u},{join:function(e){return c(r(this),void 0===e?",":e)}})},a434:function(e,t,s){"use strict";var i=s("23e7"),a=s("da84"),n=s("23cb"),r=s("5926"),o=s("07fa"),c=s("7b0b"),l=s("65f0"),u=s("8418"),_=s("1dde"),d=_("splice"),p=a.TypeError,h=Math.max,f=Math.min,m=9007199254740991,b="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var s,i,a,_,d,v,g=c(this),y=o(g),k=n(e,y),O=arguments.length;if(0===O?s=i=0:1===O?(s=0,i=y-k):(s=O-2,i=f(h(r(t),0),y-k)),y+s-i>m)throw p(b);for(a=l(g,i),_=0;_<i;_++)d=k+_,d in g&&u(a,_,g[d]);if(a.length=i,s<i){for(_=k;_<y-i;_++)d=_+i,v=_+s,d in g?g[v]=g[d]:delete g[v];for(_=y;_>y-i+s;_--)delete g[_-1]}else if(s>i)for(_=y-i;_>k;_--)d=_+i-1,v=_+s-1,d in g?g[v]=g[d]:delete g[v];for(_=0;_<s;_++)g[_+k]=arguments[_+2];return g.length=y-i+s,a}})},a630:function(e,t,s){var i=s("23e7"),a=s("4df4"),n=s("1c7e"),r=!n((function(e){Array.from(e)}));i({target:"Array",stat:!0,forced:r},{from:a})},a72b:function(e,t,s){},a881:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.title,visible:e.visible_sync,width:"760px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",[0!==e.rows.length?s("el-alert",{attrs:{title:e.alert_title,type:"warning",center:"",closable:!1}}):e._e(),0!==e.rows.length?s("el-table",{attrs:{data:e.rows,border:"","max-height":"253"}},[s("el-table-column",{attrs:{prop:"host_name",label:"主机名",width:"150"}}),s("el-table-column",{attrs:{label:"节点"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$store.state.az_list.az_name)+" ")]}}],null,!1,3791243258)}),s("el-table-column",{attrs:{prop:"machine_status_name",label:"机器状态"}}),s("el-table-column",{attrs:{prop:"host_purpose",label:"主机用途"}}),s("el-table-column",{attrs:{prop:"host_attribution_name",label:"主机归属"}})],1):e._e(),["resource"].includes(e.oper_type)?s("div",{staticClass:"ecs-belong m-top20"},[s("span",{staticClass:"m-right20"},[e._v("设置主机归属：")]),s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ecs_id,callback:function(t){e.ecs_id=t},expression:"ecs_id"}},e._l(e.ecs_list,(function(e){return s("el-option",{key:e.host_attribution_id,attrs:{label:e.name,value:e.host_attribution_id}})})),1)],1):s("el-form",{ref:"form",staticClass:"m-top20",attrs:{model:e.form_data,"label-width":"100px","label-position":"left"}},[["service"].includes(e.oper_type)?s("el-form-item",{attrs:{prop:"tag",label:"tag:",rules:[{required:!0,message:"请输入tag",trigger:"blur"}]}},[s("el-input",{attrs:{maxlength:64},model:{value:e.form_data.tag,callback:function(t){e.$set(e.form_data,"tag",t)},expression:"form_data.tag"}})],1):e._e(),0===e.rows.length?s("el-form-item",{attrs:{prop:"az_id",label:"节点:",rules:[{required:!0,message:"请选择节点",trigger:"blur"}]}},[s("el-select",{staticStyle:{width:"100%"},model:{value:e.form_data.az_id,callback:function(t){e.$set(e.form_data,"az_id",t)},expression:"form_data.az_id"}},e._l(e.az_list,(function(e){return s("el-option",{key:e.az_id,attrs:{value:e.az_id,label:e.az_name}})})),1)],1):e._e(),s("el-form-item",{attrs:{prop:"serviceType",label:"服务类型:",rules:[{required:!0,message:"请选择服务类型",trigger:"blur"}]}},[s("el-radio-group",{model:{value:e.form_data.serviceType,callback:function(t){e.$set(e.form_data,"serviceType",t)},expression:"form_data.serviceType"}},[s("el-radio",{attrs:{label:"cds-os-agent"}},[e._v("agent")]),s("el-radio",{attrs:{label:"monitor-instance",disabled:""}},[e._v("monitor-instance")]),s("el-radio",{attrs:{label:"monitor-host",disabled:""}},[e._v("monitor-host")])],1)],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},a=[],n=s("5530"),r=s("2909"),o=s("1da1"),c=s("d4ec"),l=s("bee2"),u=s("262e"),_=s("2caf"),d=(s("96cf"),s("99af"),s("d3b7"),s("159b"),s("d81d"),s("9ab4")),p=s("1b40"),h=s("c811"),f=s("1477"),m=s("9074"),b=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(c["a"])(this,s),e=t.apply(this,arguments),e.alert_title="是否确定对以下".concat(e.rows.length,"台物理机执行").concat(e.title,"操作？"),e.ecs_list=[],e.ecs_id="",e.az_list=[],e.form_data={tag:"",az_id:"",serviceType:"cds-os-agent"},e}return Object(l["a"])(s,[{key:"created",value:function(){"resource"===this.oper_type?this.get_host_attribution():this.get_az_list()}},{key:"get_az_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.az_list=[],e.next=3,m["a"].get_region_az_list({need_open_az:"1"});case 3:t=e.sent,"Success"===t.code&&(t.data.forEach((function(e){e.region_list.forEach((function(e){var t;(t=s.az_list).push.apply(t,Object(r["a"])(e.az_list))}))})),this.form_data.az_id=this.az_list[0].az_id);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_host_attribution",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].get_host_attribution({});case 2:t=e.sent,"Success"===t.code&&(this.ecs_list=t.data.host_attribution_list,this.ecs_id=this.ecs_list[0].host_attribution_id);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=!0,"resource"!==this.oper_type){e.next=7;break}return e.next=4,f["a"].set_host_attribution({host_ids:this.rows.map((function(e){return e.host_id})),host_attribution_id:this.ecs_id});case 4:t=e.sent,e.next=21;break;case 7:if(i=this.$refs.form,i.validate((function(e){e||(s=!1)})),s){e.next=11;break}return e.abrupt("return",!1);case 11:if(a={az_id:0===this.rows.length?this.form_data.az_id:this.rows[0].az_id,host_ids:this.rows.map((function(e){return e.host_id})),server_name:this.form_data.serviceType,is_node_update:0===this.rows.length?"1":void 0},"service"!==this.oper_type){e.next=18;break}return e.next=15,f["a"].agent_update(Object(n["a"])(Object(n["a"])({},a),{},{server_tag:this.form_data.tag}));case 15:t=e.sent,e.next=21;break;case 18:return e.next=20,f["a"].agent_rollback(a);case 20:t=e.sent;case 21:"Success"===t.code?"resource"===this.oper_type&&t.data.fail_host_list.length>0?(this.$message.warning(t.message),this.back("1")):(this.$message.success(t.message),this.back("1")):this.back("0");case 22:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(p["e"]);Object(d["a"])([Object(p["d"])("visible")],b.prototype,"visible_sync",void 0),Object(d["a"])([Object(p["c"])({default:function(){return[]}})],b.prototype,"rows",void 0),Object(d["a"])([Object(p["c"])(String)],b.prototype,"title",void 0),Object(d["a"])([Object(p["c"])(String)],b.prototype,"oper_type",void 0),Object(d["a"])([Object(p["b"])("close")],b.prototype,"back",null),b=Object(d["a"])([Object(p["a"])({components:{ActionBlock:h["a"]}})],b);var v=b,g=v,y=(s("3e47"),s("2877")),k=Object(y["a"])(g,i,a,!1,null,null,null);t["a"]=k.exports},a9e3:function(e,t,s){"use strict";var i=s("83ab"),a=s("da84"),n=s("e330"),r=s("94ca"),o=s("6eeb"),c=s("1a2d"),l=s("7156"),u=s("3a9b"),_=s("d9b5"),d=s("c04e"),p=s("d039"),h=s("241c").f,f=s("06cf").f,m=s("9bf2").f,b=s("408a"),v=s("58a8").trim,g="Number",y=a[g],k=y.prototype,O=a.TypeError,j=n("".slice),w=n("".charCodeAt),x=function(e){var t=d(e,"number");return"bigint"==typeof t?t:C(t)},C=function(e){var t,s,i,a,n,r,o,c,l=d(e,"number");if(_(l))throw O("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=v(l),t=w(l,0),43===t||45===t){if(s=w(l,2),88===s||120===s)return NaN}else if(48===t){switch(w(l,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+l}for(n=j(l,2),r=n.length,o=0;o<r;o++)if(c=w(n,o),c<48||c>a)return NaN;return parseInt(n,i)}return+l};if(r(g,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var S,z=function(e){var t=arguments.length<1?0:y(x(e)),s=this;return u(k,s)&&p((function(){b(s)}))?l(Object(t),s,z):t},F=i?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),R=0;F.length>R;R++)c(y,S=F[R])&&!c(z,S)&&m(z,S,f(y,S));z.prototype=k,k.constructor=z,o(a,g,z)}},af7d:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{visible:e.visible,title:"自定义列表项","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t}}},[s("div",{staticClass:"m-bottom10"},[e._v("清除缓存或者更换浏览器，自定义列表失效"),s("span",{staticClass:"warning_message m-left10"},[e._v("(最少选择5项，最多选择25项)")])]),s("div",{staticClass:"item"},[e._l(e.all_item,(function(t){return[s("div",{staticClass:"label"},[e._v(e._s(t.name))]),s("div",{class:[e.newView?"checkbox-box2":"checkbox-box"]},[s("el-checkbox-group",{model:{value:e.select_item,callback:function(t){e.select_item=t},expression:"select_item"}},e._l(t.filed,(function(e){return s("el-checkbox",{key:e.show_name,attrs:{label:e.show_name,disabled:"主机名"===e.show_name}})})),1)],1)]}))],2),s("span",[e._v("已选择："),s("span",{staticClass:"num_message"},[e._v(e._s(e.select_item.length))])]),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.FnConfirm}},[e._v("确 定")]),s("el-button",{on:{click:e.FnClose}},[e._v("取 消")])],1)])},a=[],n=s("2909"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("d81d"),s("fb6a"),s("9ab4")),_=s("1b40"),d=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.select_item=[],e.typeObj={host:{func:"SET_CUSTOM_HOST",value:"custom_host"},nas:{func:"SET_NAS_HOST",value:"nas_host"},cluster:{func:"SET_CLUSTER_HOST",value:"pod"},pod_host:{func:"SET_HOST_LIST",value:"pod"},pod_vm:{func:"SET_VM_HOST",value:"pod"}},e}return Object(o["a"])(s,[{key:"created",value:function(){"cluster"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].cluster_host):"pod_host"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].host_list):"pod_vm"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].vm_host):this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value])}},{key:"FnHandleSelectItem",value:function(e){e.length>0?this.select_item=Object(n["a"])(e):this.select_item=this.all_column_item.slice(0,25).map((function(e){return e.label})),this.FnEmit()}},{key:"FnConfirm",value:function(){this.select_item.length<5||this.select_item.length>25?this.$message.warning("自定义列表项最少为5项，最多为25项"):(this.$store.commit(this.typeObj[this.type].func,this.select_item),this.FnEmit(),this.FnClose())}},{key:"FnClose",value:function(){this.$emit("update:visible",!1)}},{key:"FnEmit",value:function(){return this.select_item}}]),s}(_["e"]);Object(u["a"])([Object(_["c"])({default:!1})],d.prototype,"visible",void 0),Object(u["a"])([Object(_["c"])({default:"host"})],d.prototype,"type",void 0),Object(u["a"])([Object(_["c"])({default:function(){return[]}})],d.prototype,"all_column_item",void 0),Object(u["a"])([Object(_["c"])({default:function(){return[]}})],d.prototype,"all_item",void 0),Object(u["a"])([Object(_["c"])({default:!1})],d.prototype,"newView",void 0),Object(u["a"])([Object(_["b"])("fn-custom")],d.prototype,"FnEmit",null),d=Object(u["a"])([_["a"]],d);var p=d,h=p,f=(s("0a4c"),s("2877")),m=Object(f["a"])(h,i,a,!1,null,"b2dbf330",null);t["a"]=m.exports},b2ed:function(e,t,s){"use strict";s("f5d0")},b4f2:function(e,t,s){"use strict";s("0692")},b52c:function(e,t,s){},b680:function(e,t,s){"use strict";var i=s("23e7"),a=s("da84"),n=s("e330"),r=s("5926"),o=s("408a"),c=s("1148"),l=s("d039"),u=a.RangeError,_=a.String,d=Math.floor,p=n(c),h=n("".slice),f=n(1..toFixed),m=function(e,t,s){return 0===t?s:t%2===1?m(e,t-1,s*e):m(e*e,t/2,s)},b=function(e){var t=0,s=e;while(s>=4096)t+=12,s/=4096;while(s>=2)t+=1,s/=2;return t},v=function(e,t,s){var i=-1,a=s;while(++i<6)a+=t*e[i],e[i]=a%1e7,a=d(a/1e7)},g=function(e,t){var s=6,i=0;while(--s>=0)i+=e[s],e[s]=d(i/t),i=i%t*1e7},y=function(e){var t=6,s="";while(--t>=0)if(""!==s||0===t||0!==e[t]){var i=_(e[t]);s=""===s?i:s+p("0",7-i.length)+i}return s},k=l((function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)}))||!l((function(){f({})}));i({target:"Number",proto:!0,forced:k},{toFixed:function(e){var t,s,i,a,n=o(this),c=r(e),l=[0,0,0,0,0,0],d="",f="0";if(c<0||c>20)throw u("Incorrect fraction digits");if(n!=n)return"NaN";if(n<=-1e21||n>=1e21)return _(n);if(n<0&&(d="-",n=-n),n>1e-21)if(t=b(n*m(2,69,1))-69,s=t<0?n*m(2,-t,1):n/m(2,t,1),s*=4503599627370496,t=52-t,t>0){v(l,0,s),i=c;while(i>=7)v(l,1e7,0),i-=7;v(l,m(10,i,1),0),i=t-1;while(i>=23)g(l,1<<23),i-=23;g(l,1<<i),v(l,1,1),g(l,2),f=y(l)}else v(l,0,s),v(l,1<<-t,0),f=y(l)+p("0",c);return c>0?(a=f.length,f=d+(a<=c?"0."+p("0",c-a)+f:h(f,0,a-c)+"."+h(f,a-c))):f=d+f,f}})},b6d9:function(e,t,s){},b85c:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0"),s("d9e2");var i=s("06c5");function a(e,t){var s="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=Object(i["a"])(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return o=e.done,e},e:function(e){c=!0,r=e},f:function(){try{o||null==s["return"]||s["return"]()}finally{if(c)throw r}}}}},b986:function(e,t,s){"use strict";s("cd38")},bad9:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"customer"},[s("el-select",{attrs:{multiple:"",placeholder:"输入关键字可进行搜索",filterable:"",remote:"","remote-method":e.getCustomerList},on:{"visible-change":e.changeCustomer},model:{value:e.customer_id,callback:function(t){e.customer_id=t},expression:"customer_id"}},e._l(e.customerList,(function(t){return s("el-option",{key:t.id,attrs:{value:t.id,label:t.id+"("+t.name+")"}},[e._v(e._s(t.id+"("+t.name+")"))])})),1)],1)},a=[],n=s("1da1"),r=s("2909"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("96cf"),s("d81d"),s("9ab4")),d=s("1b40"),p=s("1477"),h=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.customer_id=[],e.customerList=[],e.flag=!0,e}return Object(c["a"])(s,[{key:"created",value:function(){this.customerList=Object(r["a"])(this.list),this.customer_id=this.customers,this.getDefaultCustomerList()}},{key:"changeCustomer",value:function(e){e&&(this.customerList=[])}},{key:"getDefaultCustomerList",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.list.length>0)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,p["a"].getCustomerList({host_ids:this.rows.map((function(e){return e.host_id})),customer_ids:Array.isArray(this.customer_id)?this.customer_id:[]});case 4:t=e.sent,"Success"==t.code&&(this.customerList=t.data.customer_list);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getCustomerList",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:"",s=a.length>1&&void 0!==a[1]&&a[1],t||s){e.next=4;break}return e.abrupt("return");case 4:return e.next=7,p["a"].getCustomerList({host_ids:this.rows.map((function(e){return e.host_id})),customer_id:t});case 7:i=e.sent,"Success"==i.code&&(this.customerList=i.data.customer_list);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"watch_customer_id",value:function(){this.FnCustomer()}},{key:"FnCustomer",value:function(){return this.customer_id}}]),s}(d["e"]);Object(_["a"])([Object(d["c"])({default:function(){return[]}})],h.prototype,"customers",void 0),Object(_["a"])([Object(d["c"])({default:function(){return[]}})],h.prototype,"rows",void 0),Object(_["a"])([Object(d["c"])({default:function(){return[]}})],h.prototype,"list",void 0),Object(_["a"])([Object(d["f"])("customer_id",{immediate:!0,deep:!0})],h.prototype,"watch_customer_id",null),Object(_["a"])([Object(d["b"])("FnCustomer")],h.prototype,"FnCustomer",null),h=Object(_["a"])([Object(d["a"])({})],h);var f=h,m=f,b=(s("ecd5"),s("2877")),v=Object(b["a"])(m,i,a,!1,null,null,null);t["a"]=v.exports},bb2f:function(e,t,s){var i=s("d039");e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bd33:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tabBox"},[s("div",{staticClass:"currentInfo"},[e._v(" "+e._s(e.$store.state.display)+" ")]),s("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.active_tab,callback:function(t){e.active_tab=t},expression:"active_tab"}},e._l(e.tab_list,(function(e,t){return s("el-tab-pane",{key:t,attrs:{label:e,name:t}})})),1),s("router-view")],1)},a=[],n=s("d4ec"),r=s("bee2"),o=s("262e"),c=s("2caf"),l=(s("b0c0"),s("9ab4")),u=s("1b40"),_=s("d5aa"),d=s("0faa"),p=s("4364"),h=s("018b"),f=function(e){Object(o["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(n["a"])(this,s),e=t.apply(this,arguments),e.active_tab="",e.pod_id=e.$route.params.id,e.tab_list={pod_info:"概要",pod_cluster:"集群",pod_host:"主机",pod_vm:"虚拟机"},e}return Object(r["a"])(s,[{key:"handleClick",value:function(e,t){this.$route.name!==e.name&&this.$router.push({name:e.name,params:{id:this.pod_id}})}},{key:"created",value:function(){this.active_tab=this.$route.name}}]),s}(u["e"]);f=Object(l["a"])([Object(u["a"])({components:{ClusterList:_["default"],Info:d["default"],VmList:p["default"],HostList:h["default"]}})],f);var m=f,b=m,v=(s("be06"),s("2877")),g=Object(v["a"])(b,i,a,!1,null,null,null);t["default"]=g.exports},be06:function(e,t,s){"use strict";s("8b1ad")},be60:function(e,t,s){"use strict";s("00b7")},bfc6:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"icon m-bottom10"},[s("el-tooltip",{attrs:{content:"自定义列表项",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"}},[s("i",{staticClass:"el-icon-s-tools"})])],1),s("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"}},[s("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1),s("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"}},[s("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1)],1)])},a=[],n=s("bee2"),r=s("d4ec"),o=s("262e"),c=s("2caf"),l=s("9ab4"),u=s("1b40"),_=function(e){Object(o["a"])(s,e);var t=Object(c["a"])(s);function s(){return Object(r["a"])(this,s),t.apply(this,arguments)}return Object(n["a"])(s)}(u["e"]);_=Object(l["a"])([Object(u["a"])({components:{}})],_);var d=_,p=d,h=(s("26c7"),s("2877")),f=Object(h["a"])(p,i,a,!1,null,"1fe47d89",null);t["a"]=f.exports},c765:function(e,t,s){"use strict";s("542d")},c839:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_pod_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/pod/get_pod_list/",e))},get_az_info:function(e){return Object(i["a"])(Object(a["b"])("GET","/pod/get_pod_info/",e))},create_pod:function(e){return Object(i["a"])(Object(a["b"])("POST","/pod/create_pod/",e))},update_pod:function(e){return Object(i["a"])(Object(a["b"])("POST","/pod/update_pod/",e))},get_pod_history:function(e){return Object(i["a"])(Object(a["b"])("GET","/pod/get_pod_history/",e))}}},c8d2:function(e,t,s){var i=s("5e77").PROPER,a=s("d039"),n=s("5899"),r="​᠎";e.exports=function(e){return a((function(){return!!n[e]()||r[e]()!==r||i&&n[e].name!==e}))}},cb4f:function(e,t,s){},cd38:function(e,t,s){},cf80:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"业务测试",visible:e.visible_sync,width:"1000px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.cancel}},[s("div",{staticClass:"m-left10"},[s("el-button",{staticClass:"m-bottom10",attrs:{type:"primary",disabled:e.selectedTasks.length===e.selectable.length},on:{click:e.add}},[e._v("新增测试任务")]),s("div",{staticClass:"m-bottom20"},[e._v("将对"),s("span",{staticClass:"m-left10 num_message m-right10"},[e._v(e._s(e.az_info.az_name))]),e._v("未通过业务测试的物理机进行业务测试，已通过业务测试的物理机不会再次进行以下测试。业务测试完成情况可在"),s("span",{staticClass:"clickble m-left10 m-right10",on:{click:function(t){return e.$router.push("/message")}}},[e._v("消息通知")]),e._v("进行查看")]),s("div",{staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:1}}),e._v(e._s(e.first.description?e.first.description:""))],1),e._l(e.selectedTasks,(function(t,i){return s("div",{key:i,staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:i+2}}),s("el-select",{attrs:{placeholder:"请选择测试任务列表"},on:{change:function(t){return e.changeTask(t,i)}},model:{value:t.task_id,callback:function(s){e.$set(t,"task_id",s)},expression:"item.task_id"}},e._l(e.selectable,(function(e){return s("el-option",{key:e.maintask_name,attrs:{value:e.maintask_name,label:e.display_name,disabled:t.disList.includes(e.maintask_name)}})})),1),t.task_id?s("span",{staticClass:"m-left10"},[e._v("该任务需设置参数，请点击"),s("el-button",{attrs:{type:"text"},on:{click:e.setParams}},[e._v("设置参数")])],1):e._e(),s("el-button",{staticClass:"m-left10",attrs:{type:"text"},on:{click:function(t){return e.del(i)}}},[e._v("删除")])],1)})),s("div",{staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:e.selectedTasks.length+2}}),e._v(e._s(e.second.description?e.second.description:""))],1),s("div",{staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:e.selectedTasks.length+3}}),e._v(e._s(e.third.description?e.third.description:""))],1)],2),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")]),s("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)])},a=[],n=s("5530"),r=s("2909"),o=s("1da1"),c=s("d4ec"),l=s("bee2"),u=s("262e"),_=s("2caf"),d=(s("96cf"),s("d81d"),s("caad"),s("4de4"),s("d3b7"),s("9ab4")),p=s("1b40"),h=s("3673"),f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"circle"},[e._v(e._s(e.num))])},m=[],b=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){return Object(c["a"])(this,s),t.apply(this,arguments)}return Object(l["a"])(s)}(p["e"]);Object(d["a"])([Object(p["c"])()],b.prototype,"num",void 0),b=Object(d["a"])([Object(p["a"])({})],b);var v=b,g=v,y=(s("e79e"),s("2877")),k=Object(y["a"])(g,f,m,!1,null,"a2f85430",null),O=k.exports,j=s("1477"),w=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(c["a"])(this,s),e=t.apply(this,arguments),e.taskList=[],e.selectedTasks=[],e.task="",e.selectable=[],e.first={},e.second={},e.third={},e}return Object(l["a"])(s,[{key:"created",value:function(){this.get_task_list()}},{key:"get_task_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j["a"].get_task_list({});case 2:t=e.sent,"Success"===t.code&&(this.taskList=Object(r["a"])(t.data.task_list),this.taskList.map((function(e){return["CreateEcsGpuInstanceForTestPipeline","DeleteEcsGpuInstanceForTestPipeline","UpdateHostForTestPipeline"].includes(e.maintask_name)||s.selectable.push(e),"CreateEcsGpuInstanceForTestPipeline"===e.maintask_name&&(s.first=e),"DeleteEcsGpuInstanceForTestPipeline"===e.maintask_name&&(s.second=e),"UpdateHostForTestPipeline"===e.maintask_name&&(s.third=e),e})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"set_disList",value:function(){var e=this.selectedTasks.map((function(e){return e.task_id}));this.selectedTasks.map((function(t){return t.disList=e.filter((function(e){return e!==t.maintask_name})),t}))}},{key:"add",value:function(){this.selectedTasks.length!==this.selectable.length&&(this.selectedTasks.push({task_id:"",params:{},disList:[]}),this.set_disList())}},{key:"changeTask",value:function(e,t){this.set_disList()}},{key:"del",value:function(e){var t=[];this.selectedTasks.map((function(s,i){return i!==e&&t.push(s),s})),this.selectedTasks=t,this.set_disList()}},{key:"setParams",value:function(){}},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[Object(n["a"])({},this.first)],this.selectedTasks.map((function(e){return t.push({maintask_name:e.task_id,dep_params:e.params}),e})),t.push(this.second),t.push(this.third),e.next=6,j["a"].create_test_task({az_id:this.az_info.az_id,task_list:t});case 6:s=e.sent,"Success"===s.code&&this.$message.success(s.message),this.visible_sync=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"cancel",value:function(){this.visible_sync=!1}}]),s}(p["e"]);Object(d["a"])([Object(p["d"])("visible")],w.prototype,"visible_sync",void 0),Object(d["a"])([Object(p["c"])({default:function(){return{az_id:"",az_name:""}}})],w.prototype,"az_info",void 0),w=Object(d["a"])([Object(p["a"])({components:{SvgIcon:h["a"],CircleIcon:O}})],w);var x=w,C=x,S=(s("008d"),Object(y["a"])(C,i,a,!1,null,"eb9ffe1e",null));t["a"]=S.exports},d057:function(e,t,s){"use strict";s("d84b")},d4fd:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"resetForm",staticClass:"pwd-form",attrs:{model:e.data,"label-position":"left","label-width":"120px"}},[e.system_disk?s("div",{staticClass:"inline-form"},[s("el-form-item",{staticClass:"m-right20",attrs:{label:"系统盘",prop:"system_disk"}},[s("el-select",{attrs:{"value-key":"ecs_goods_id"},on:{change:e.FnChangeSystemType},model:{value:e.data.default_system_info,callback:function(t){e.$set(e.data,"default_system_info",t)},expression:"data.default_system_info"}},e._l(e.system_disk_info,(function(e){return s("el-option",{key:e.ecs_goods_id,attrs:{value:e,label:e.disk_name}})})),1)],1),s("el-form-item",[s("el-input-number",{attrs:{min:Number(e.data.system_disk_min),max:e.systemDiskMax,step:e.data.default_system_info?Number(e.data.default_system_info.disk_step):0},on:{blur:e.FnChangeSystemSize,change:e.FnChangeSystemSize},model:{value:e.data.system_size,callback:function(t){e.$set(e.data,"system_size",t)},expression:"data.system_size"}}),e._v(" "+e._s(e.data.default_system_info?e.data.default_system_info.disk_unit:"GB")+" ")],1)],1):e._e(),e.data_disk&&e.data_disk_info.length>0?[e._l(e.data_disk_list,(function(t,i){return s("div",{key:i},[s("div",{staticClass:"inline-form"},[s("el-form-item",{staticClass:"short-select",attrs:{label:0===i?"数据盘":""}},[s("i",{staticClass:"el-icon-remove-outline delete-icon",on:{click:function(t){return e.FnDelDataDisk(i)}}}),s("el-select",{staticClass:"m-right20",attrs:{"value-key":"ecs_goods_id"},on:{change:e.FnDataEmit},model:{value:t.default_disk_info,callback:function(s){e.$set(t,"default_disk_info",s)},expression:"disk.default_disk_info"}},e._l(e.data_disk_info,(function(t){return s("el-option",{key:t.ecs_goods_id,attrs:{value:t,label:t.disk_name,disabled:!e.FnSelectedDiskIds.includes(t.ecs_goods_id)}})})),1)],1),s("el-form-item",[s("input-number",{attrs:{info:e.data_disk_info?t.default_disk_info:null},on:{func:e.FnChangeDataSize}}),e._v(" "+e._s(e.data.default_system_info?t.default_disk_info.disk_unit:"GB")+" ")],1),s("el-form-item",[s("el-input-number",{staticClass:"m-left10 m-right10",attrs:{min:t.min,max:e.getEveryMaxNum(t),step:1},on:{blur:function(s){return e.FnCheckDataNum(t)},change:function(s){return e.FnChangeDataNum(t)}},model:{value:t.num,callback:function(s){e.$set(t,"num",s)},expression:"disk.num"}})],1),s("el-form-item",[s("el-checkbox",{on:{change:e.FnDataEmit},model:{value:t.del,callback:function(s){e.$set(t,"del",s)},expression:"disk.del"}},[e._v("随实例删除")])],1)],1),"local"!==t.default_disk_info.disk_feature?s("div",{staticClass:"prompt_message data-prompt"},[e._v(" 当前区域已购买 "),s("span",{staticClass:"num_message"},[e._v(e._s(t.default_disk_info.disk_feature)+" "+e._s(e.getResetInfo(t).used)+" "+e._s(t.default_disk_info.disk_unit))]),e._v(" ，还可以购买的容量额度为："),s("span",{class:[e.getResetInfo(t).reset>=0?"num_message":"error_message"]},[e._v(e._s(Math.max(e.getResetInfo(t).reset,0))+" "+e._s(t.default_disk_info.disk_unit))])]):e._e()])})),s("el-form-item",{attrs:{label:0===e.data_disk_list.length?"数据盘":""}},[s("div",{staticClass:"disk-btn"},[s("el-button",{attrs:{type:"text",disabled:e.data_disk_list.some((function(e){return 16===e.num}))||Object.keys(e.showResetVolume).length===e.data_disk_list.length},on:{click:e.FnAddDataDisk}},[s("i",{staticClass:"el-icon-circle-plus"}),e._v(" 添加数据盘")]),s("div",{staticClass:"prompt_message"},[e._v("您已选择 "),s("span",{staticClass:"num_message"},[e._v(e._s(e.FnGetDiskNum))]),e._v(" 块盘， 还可以添加 "),s("span",{staticClass:"num_message"},[e._v(e._s(e.FnGetSurplus))]),e._v(" 块盘")])],1)])]:e._e()],2)},a=[],n=s("5530"),r=s("1da1"),o=s("d4ec"),c=s("bee2"),l=s("262e"),u=s("2caf"),_=(s("d81d"),s("4de4"),s("d3b7"),s("13d5"),s("a434"),s("b64b"),s("a9e3"),s("96cf"),s("9ab4")),d=s("1b40"),p=s("1c98"),h=s("8bcb"),f=s("8ce4"),m=s("4875"),b=function(e){Object(l["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(o["a"])(this,s),e=t.apply(this,arguments),e.all_disk_info={system_disk:[],data_disk:[]},e.system_disk_info=[],e.data_disk_info=[],e.data_disk_list=[],e.showResetVolume={},e.data={default_system_info:{ecs_goods_id:"",disk_name:"",disk_unit:"",disk_feature:"",disk_type:"",disk_min:0,disk_max:500,disk_step:10,min_iops:0,max_iops:0,min_throughput:0,throughput_step:0,throughput_unit:"",max_throughput:0,iops_step:0,iops_unit:""},system_disk_min:0,system_size:0},e}return Object(c["a"])(s,[{key:"FnGetDiskInfo",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.az_id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,p["a"].get_disk_type({az_id:this.az_id,customer_id:this.customer_id,billing_method:this.billing_method,spec_family_id:this.spec_family_id});case 4:t=e.sent,"Success"==t.code&&(this.all_disk_info={system_disk:t.data.system_disk,data_disk:t.data.data_disk},this.FnBillingInfo(Object(f["a"])(t.data.billing_info,!0)),this.FnFilterDisk());case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getDiskLimit",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("local"!==this.data.default_system_info.disk_feature){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,p["a"].get_disk_limit({customer_id:this.customer_id,az_id:this.az_id,feature:this.data_disk_info.map((function(e){return e.disk_feature}))});case 4:if(t=e.sent,"Success"===t.code){for(s in this.showResetVolume={},t.data)this.showResetVolume[s]=t.data[s].rest_volume;this.FnSysEmit()}case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnFilterDisk",value:function(){var e=this;this.system_disk_info=this.all_disk_info.system_disk.filter((function(t){return t.disk_feature===e.disk_feature})),this.data_disk_info=this.all_disk_info.data_disk,this.data.default_system_info=this.system_disk_info[0],this.data.default_system_info?(this.FnChangeSystemType(),this.getDiskLimit()):(this.data.default_system_info=null,this.data_disk_info=[],this.FnSysEmit(),this.$message.error("该产品规格无可用的存储类型，请联系管理员"))}},{key:"FnChangeSystemType",value:function(){this.data_disk_list=[],"local"===this.data.default_system_info.disk_feature?this.data_disk_info=this.all_disk_info.data_disk.filter((function(e){return"local"===e.disk_feature})):this.data_disk_info=this.all_disk_info.data_disk.filter((function(e){return"local"!==e.disk_feature})),this.data.system_size=this.FnSystemMinSize(),this.FnSysEmit()}},{key:"FnGetDiskNum",get:function(){return this.data_disk_list.length>0?this.data_disk_list.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{num:0};return e+t.num}),0):0}},{key:"FnGetSurplus",get:function(){var e=this,t=(this.data_disk_list.length,0===this.data_disk_list.length?16:0);return this.data_disk_list.map((function(s){t+=Math.floor((e.showResetVolume[s.default_disk_info.disk_feature]-s.disk_size*s.num)/s.disk_size)})),Math.min(16-this.FnGetDiskNum,t)}},{key:"getEveryMaxNum",value:function(e){var t=this.data.default_system_info.disk_feature===e.default_disk_info.disk_feature?this.data.system_size:0,s=Math.floor(Math.max(this.showResetVolume[e.default_disk_info.disk_feature]-e.disk_size*e.num-t,0)/e.disk_size);return s>16-this.FnGetDiskNum?16-this.FnGetDiskNum+e.num:s+e.num}},{key:"FnGetSystemIops",get:function(){return Object(h["a"])(this.data.default_system_info,this.data.system_size)}},{key:"getResetInfo",value:function(e){var t=this.data.default_system_info.disk_feature===e.default_disk_info.disk_feature?this.data.system_size:0,s=e.disk_size*e.num+t,i=this.showResetVolume[e.default_disk_info.disk_feature]?this.showResetVolume[e.default_disk_info.disk_feature]-s:e.default_disk_info.disk_max;return{reset:i,used:s}}},{key:"FnSelectedDiskIds",get:function(){var e=this,t=this.data_disk_info.filter((function(t){return!e.data_disk_list.some((function(e){return e.default_disk_info.ecs_goods_id===t.ecs_goods_id}))}));return t.map((function(e){return e.ecs_goods_id}))}},{key:"FnAddDataDisk",value:function(){var e=this,t=this.data_disk_info.filter((function(t){return!e.data_disk_list.some((function(e){return e.default_disk_info.ecs_goods_id===t.ecs_goods_id}))}));if(0!==t.length){var s={default_disk_info:{disk_min:0,disk_max:0,disk_step:0,disk_unit:"G",disk_name:""},disk_size:0,num:1,min:1,del:!0};s.default_disk_info=Object(n["a"])(Object(n["a"])({},t[0]),{},{disk_max:this.showResetVolume[t[0].disk_feature]?Math.min(t[0].disk_max,this.showResetVolume[t[0].disk_feature]):t[0].disk_max})||{},s.default_disk_info.disk_name&&(s.disk_size=s.default_disk_info.disk_min,this.FnGetDataIops(s),this.data_disk_list.push(s),this.FnDataEmit())}}},{key:"FnDelDataDisk",value:function(e){this.data_disk_list.splice(e,1),this.FnDataEmit()}},{key:"FnGetDataIops",value:function(e){var t=Object(h["a"])(e.default_disk_info,e.disk_size);e.iops=t.iops,e.iops_show=t.iops_show,e.handling_capacity=t.throughput,e.throughput_show=t.throughput_show,e.storage_space=e.disk_size}},{key:"systemDiskMax",get:function(){var e=this,t=this.system_disk_info.filter((function(t){return t.disk_feature===e.data.default_system_info.disk_feature})),s=0;return s=0===this.system_disk_info.length?0:0!==Object.keys(this.showResetVolume).length&&this.showResetVolume[t[0].disk_feature]?Math.min(t[0].disk_max,this.showResetVolume[t[0].disk_feature]):t[0].disk_max,s}},{key:"FnCheckSystemSize",value:function(){this.data.system_size||(this.data.system_size=this.data.system_disk_min,this.FnSysEmit())}},{key:"FnChangeSystemSize",value:function(){if(this.data.system_size){var e=Math.min(this.systemDiskMax,this.data.system_size),t=Math.floor((e-this.data.system_disk_min)/this.data.default_system_info.disk_step);this.data.system_size=t*this.data.default_system_info.disk_step+this.data.system_disk_min}else this.data.system_size=this.data.system_disk_min;this.FnSysEmit()}},{key:"FnSysEmit",value:function(){var e,t,s,i,a;return{ecs_goods_id:(null===(e=this.data.default_system_info)||void 0===e?void 0:e.ecs_goods_id)||"",disk_name:(null===(t=this.data.default_system_info)||void 0===t?void 0:t.disk_name)||"",disk_feature:(null===(s=this.data.default_system_info)||void 0===s?void 0:s.disk_feature)||"",disk_type:(null===(i=this.data.default_system_info)||void 0===i?void 0:i.disk_type)||"",disk_size:this.data.default_system_info?this.data.system_size:0,disk_unit:(null===(a=this.data.default_system_info)||void 0===a?void 0:a.disk_unit)||"",iops:this.data.default_system_info?this.FnGetSystemIops.iops:0,handling_capacity:this.data.default_system_info?this.FnGetSystemIops.throughput:0,storage_space:this.data.default_system_info?this.data.system_size:0,is_follow_delete:1}}},{key:"FnChangeDataSize",value:function(e){var t={};this.data_disk_list.map((function(s){if(s.default_disk_info.disk_feature===e.disk_feature)return s.disk_size=e.size,s.disk_size*s.num>s.default_disk_info.disk_max&&(s.num=1),t=s,s})),this.FnGetDataIops(t),this.FnDataEmit()}},{key:"FnCheckDataNum",value:function(e){e.num||(e.num=e.min,this.FnDataEmit())}},{key:"FnChangeDataNum",value:function(e){e.num&&this.FnDataEmit()}},{key:"FnDataEmit",value:function(){return this.data_disk_list}},{key:"FnBillingInfo",value:function(e){return e}},{key:"FnSubmit",value:function(){var e=!1;return this.$refs["resetForm"].validate((function(t){e=t})),{flag:e,system_disk:this.FnSysEmit()}}},{key:"FnResetForm",value:function(e){this.$refs["resetForm"].resetFields(),this.data.default_system_info=this.system_disk_info[0]}},{key:"FnSystemMinSize",value:function(){return this.data.system_disk_min=Math.max(Number(this.data.default_system_info.disk_min),this.os_disk_size,this.origin_disk_size),this.data.system_disk_min}},{key:"created",value:function(){this.az_id&&this.FnGetDiskInfo()}},{key:"FnChangeAz",value:function(e,t){t!==this.az_id&&this.FnGetDiskInfo()}},{key:"FnChangeFamily",value:function(e){e&&(this.data_disk_list=[],this.FnGetDiskInfo())}},{key:"FnChangeOs",value:function(e){var t=this.FnSystemMinSize();t!==this.data.system_size&&this.data.system_size&&(this.data.system_size=t,this.FnSysEmit())}}]),s}(d["e"]);Object(_["a"])([Object(d["c"])({default:""})],b.prototype,"az_id",void 0),Object(_["a"])([Object(d["c"])({default:""})],b.prototype,"customer_id",void 0),Object(_["a"])([Object(d["c"])({default:"0"})],b.prototype,"billing_method",void 0),Object(_["a"])([Object(d["c"])({default:!1})],b.prototype,"system_disk",void 0),Object(_["a"])([Object(d["c"])({default:!1})],b.prototype,"data_disk",void 0),Object(_["a"])([Object(d["c"])({default:0})],b.prototype,"os_disk_size",void 0),Object(_["a"])([Object(d["c"])({default:0})],b.prototype,"origin_disk_size",void 0),Object(_["a"])([Object(d["c"])({default:""})],b.prototype,"spec_family_id",void 0),Object(_["a"])([Object(d["c"])({default:0})],b.prototype,"is_gpu",void 0),Object(_["a"])([Object(d["c"])({default:""})],b.prototype,"disk_feature",void 0),Object(_["a"])([Object(d["b"])("fn-system-disk")],b.prototype,"FnSysEmit",null),Object(_["a"])([Object(d["b"])("fn-data-disk")],b.prototype,"FnDataEmit",null),Object(_["a"])([Object(d["b"])("fn-billing-info")],b.prototype,"FnBillingInfo",null),Object(_["a"])([Object(d["f"])("az_id")],b.prototype,"FnChangeAz",null),Object(_["a"])([Object(d["f"])("spec_family_id")],b.prototype,"FnChangeFamily",null),Object(_["a"])([Object(d["f"])("os_disk_size")],b.prototype,"FnChangeOs",null),b=Object(_["a"])([Object(d["a"])({components:{InputNumber:m["a"]}})],b);var v=b,g=v,y=(s("b986"),s("2877")),k=Object(y["a"])(g,i,a,!1,null,"38c10e3c",null);t["a"]=k.exports},d58f:function(e,t,s){var i=s("da84"),a=s("59ed"),n=s("7b0b"),r=s("44ad"),o=s("07fa"),c=i.TypeError,l=function(e){return function(t,s,i,l){a(s);var u=n(t),_=r(u),d=o(u),p=e?d-1:0,h=e?-1:1;if(i<2)while(1){if(p in _){l=_[p],p+=h;break}if(p+=h,e?p<0:d<=p)throw c("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=h)p in _&&(l=s(l,_[p],p,u));return l}};e.exports={left:l(!1),right:l(!0)}},d5aa:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"search-box"},[s("div",{staticClass:"icon m-bottom10"},[s("el-dropdown",{staticClass:"aliFont",on:{command:e.handleOperate}},[s("el-button",{attrs:{type:"text"}},[s("svg-icon-font",{attrs:{iconName:"icon-gengduo"}})],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.rows_operate_btns,(function(t){return s("el-dropdown-item",{key:t.value,attrs:{command:{label:t.value}}},[e._v(e._s(t.label))])})),1)],1),s("el-tooltip",{attrs:{content:"自定义列表项",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.FnCustom}},[s("i",{staticClass:"el-icon-s-tools"})])],1),s("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.refresh}},[s("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1)],1)]),s("el-table",{ref:"table",attrs:{data:e.list,border:"",height:"100%","row-class-name":e.rowStyle},on:{"row-contextmenu":e.FnRightClick,"row-click":e.FnOperRow,"selection-change":e.handleSelectionChange,"sort-change":e.FnSortChange}},[s("el-table-column",{attrs:{type:"selection"}}),e._l(e.custom_host,(function(t){return s("el-table-column",{key:t.prop,attrs:{"filter-multiple":!t.column_key&&null,prop:t.prop,"column-key":t.column_key?t.column_key:null,filters:t.column_key?t.list:null,sortable:t.sortable?t.sortable:null,width:t.width?t.width:null,type:t.type,label:t.label,"show-overflow-tooltip":t.overflow,"min-width":t.minWidth},scopedSlots:e._u(["cpu_rate"===t.prop?{key:"default",fn:function(e){return[s("el-progress",{attrs:{"stroke-width":14,color:"#455cc6",percentage:Math.round(100*e.row.cpu_rate)}})]}}:"ram_rate"===t.prop?{key:"default",fn:function(e){return[s("el-progress",{attrs:{"stroke-width":14,color:"#455cc6",percentage:Math.round(100*e.row.ram_rate)}})]}}:"gpu_rate"===t.prop?{key:"default",fn:function(e){return[s("el-progress",{attrs:{"stroke-width":14,color:"#455cc6",percentage:Math.round(100*e.row.gpu_rate)}})]}}:"storage_rate"===t.prop?{key:"default",fn:function(e){return[s("el-progress",{attrs:{"stroke-width":14,color:"#455cc6",percentage:Math.round(100*e.row.storage_rate)}})]}}:"cpu_model"===t.prop?{key:"default",fn:function(t){return[t.row.cpu_model.length>0?s("el-tooltip",{attrs:{effect:"dark"}},[s("div",{attrs:{slot:"content"},slot:"content"},e._l(t.row.cpu_model,(function(t,i){return s("div",{key:i},[e._v(e._s(t))])})),0),s("div",{staticClass:"tooltip-cell"},[e._v(e._s(t.row.cpu_model[0]))])]):s("div")]}}:"available_prepare_host_count"===t.prop?{key:"default",fn:function(t){return[s("span",{style:{color:t.row.available_prepare_host_count!==t.row.prepare_host_total?"red":""}},[e._v(" "+e._s(t.row.available_prepare_host_count+"/"+t.row.prepare_host_total)+" ")])]}}:null],null,!0)})}))],2),s("el-pagination",{attrs:{"current-page":e.page_info.current,"page-sizes":[20,50,100],"page-size":e.page_info.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),s("custom-list-item",{attrs:{visible:e.show_custom,all_item:e.all_item,all_column_item:e.all_column_item,type:"cluster",newView:!0},on:{"update:visible":function(t){e.show_custom=t},"fn-custom":e.get_custom_columns}}),s("right-click",{attrs:{multi_rows:e.multi_rows,menus:e.menus,name:e.multi_rows.length>0?e.multi_rows[0].cluster_name:"",error_msg:e.error_msg},on:{"fn-click":e.infoClick}}),s("create-cluster",{attrs:{visible:e.visible,oper_info:e.multi_rows,isCreate:e.isCreate},on:{"update:visible":function(t){e.visible=t}}}),s("add-host",{attrs:{visible:e.add_host_visible,cluster_id:e.multi_rows.length>0?e.multi_rows[0].cluster_id:"",info:e.multi_rows[0]},on:{"update:visible":function(t){e.add_host_visible=t}}}),s("el-dialog",{attrs:{visible:e.prepare_host_visible,title:"设置集群备机数量",width:"500px"},on:{"update:visible":function(t){e.prepare_host_visible=t}}},[s("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px","label-position":"left"}},[s("el-form-item",{attrs:{label:"备机数量",prop:"standby_num",rules:[{required:!0,message:"请输入备机数量",trigger:"blur"},{type:"number",min:0,max:2,message:"备机数量必须在0到2之间",trigger:"blur"}]}},[s("el-input",{attrs:{label:"备机数量",placeholder:"请输入备机数量"},model:{value:e.form.standby_num,callback:function(t){e.$set(e.form,"standby_num",e._n(t))},expression:"form.standby_num"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},a=[],n=s("ade3"),r=s("2909"),o=s("1da1"),c=s("d4ec"),l=s("bee2"),u=s("262e"),_=s("2caf"),d=(s("96cf"),s("d3b7"),s("159b"),s("d81d"),s("99af"),s("4de4"),s("caad"),s("2532"),s("9ab4")),p=s("1b40"),h=s("3673"),f=s("bfc6"),m=s("af7d"),b=s("8ce4"),v=s("da8b"),g=s("e8c0"),y=s("cf88"),k=s("bd4d"),O=s("58d1"),j=s("3fa7"),w=s("a05b"),x=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(c["a"])(this,s),e=t.apply(this,arguments),e.list=[],e.all_column_item=[],e.multi_rows=[],e.search_data={},e.isCreate=!1,e.visible=!1,e.add_host_visible=!1,e.prepare_host_visible=!1,e.form={standby_num:""},e.rows_operate_btns=[{label:"新建集群",value:"create_cluster"}],e.menus=[{label:"添加计算节点",value:"add_host",single:!0,disable:!1},{label:"编辑集群",value:"edit_cluster",single:!0,disabled:!1},{label:"删除集群",value:"delete_cluster",disabled:!1},{label:"设置集群备机数量",value:"prepare_host_count",disabled:!1}],e.error_msg={delete_cluster:"仅支持无物理机的cluster进行删除"},e.sort_prop_name="",e.sort_order=void 0,e.page_info={current:1,size:20,total:0},e.all_item=[],e.custom_host=[],e.show_custom=!1,e}return Object(l["a"])(s,[{key:"watch_visible",value:function(e){e||(this.multi_rows=[],this.get_pod_cluster_list())}},{key:"watch_multi",value:function(){this.handleMenus()}},{key:"created",value:function(){this.get_field(),this.get_pod_cluster_list()}},{key:"watch_az",value:function(e){e&&this.refresh()}},{key:"handleMenus",value:function(){var e=this;this.menus.forEach((function(t){t.disabled=e.judge(t.value)}))}},{key:"judge",value:function(e){var t=!1;switch(e){case"delete_cluster":t=!this.multi_rows.every((function(e){return 0===e.host_count}));break;case"add_vm":break;case"edit_cluster":break}return t}},{key:"handleOperate",value:function(e){this.isCreate=!0,this.visible=!0}},{key:"infoClick",value:function(e){var t=this;if(!e.disabled){if("edit_cluster"===e.value)this.isCreate=!1,this.visible=!0;else if("delete_cluster"===e.value){var s=this.multi_rows.map((function(e){return e.cluster_name}));this.$confirm("是否确认删除集群：".concat(s,"?"),"删除集群",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function e(){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.multi_rows.map((function(e){return e.cluster_id})),e.next=3,v["a"].delete_cluster({cluster_id:s});case 3:i=e.sent,"Success"===i.code&&(t.$message.success(i.message),t.refresh(),j["a"].$emit("getTreeData",!1));case 5:case"end":return e.stop()}}),e)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}else"add_host"===e.value?this.add_host_visible=!0:"prepare_host_count"===e.value&&(this.prepare_host_visible=!0);e.list||Object(y["a"])()}}},{key:"refresh",value:function(){this.get_pod_cluster_list()}},{key:"FnRightClick",value:function(e,t,s){var i=this.multi_rows.some((function(t){return t.cluster_id===e.cluster_id}));i||this.$refs.table.toggleRowSelection(e),Object(g["a"])(e,t,s)}},{key:"FnOperRow",value:function(e){this.$refs.table.toggleRowSelection(e)}},{key:"rowStyle",value:function(e){var t=e.row,s=this.multi_rows.some((function(e){return e.cluster_id===t.cluster_id}));if(s)return"rowStyle"}},{key:"get_field",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v["a"].get_cluster_field();case 2:t=e.sent,"Success"===t.code&&(s=["field_name","show_name"],i=["prop","label"],a=[],this.all_item=t.data.map((function(e){return a=[].concat(Object(r["a"])(a),Object(r["a"])(e.filed)),e})),this.all_column_item=Object(b["b"])(a,i,s),this.get_custom_columns(this.$store.state.pod.cluster_host),this.FnDoLayout());case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_custom_columns",value:function(e){0!==e.length&&(this.custom_host=this.all_column_item.filter((function(t){return e.includes(t.label)})),this.custom_host.map((function(e){return["cpu_model","gpu_model","available_prepare_host_count"].includes(e.prop)||(e=Object.assign(e,{},{sortable:"custom"})),["cluster_id","cpu_model","gpu_model"].includes(e.prop)&&(e=Object.assign(e,{},{minWidth:"240px",overflow:!0})),["cpu_model"].includes(e.prop)&&(e=Object.assign(e,{},{width:"180"})),["storage_cluster_name","cluster_name","cpu_rate","ram_rate","gpu_rate","storage_rate","host_count","ecs_count","gpu_count","storage_count"].includes(e.prop)&&(e=Object.assign(e,{},{width:"120px"})),e})),this.FnDoLayout())}},{key:"FnDoLayout",value:function(){var e=this;this.$nextTick((function(){e.$refs.table.doLayout()}))}},{key:"FnCustom",value:function(){this.show_custom=!0}},{key:"get_pod_cluster_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$store.state.az_id){e.next=2;break}return e.abrupt("return");case 2:return t=Object(n["a"])({page_index:this.page_info.current,page_size:this.page_info.size,az_id:this.$store.state.az_id,pod_id:this.$route.params.id},this.sort_prop_name,this.sort_order),e.next=5,v["a"].get_pod_cluster_list(t);case 5:s=e.sent,"Success"===s.code&&(this.list=s.data.result,this.page_info.total=s.data.page_info.count);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSelectionChange",value:function(e){this.multi_rows=e}},{key:"FnSortChange",value:function(e){var t={};this.all_item.forEach((function(e){e.filed.forEach((function(e){t[e.field_name]="sort_".concat(e.field_name)}))})),this.sort_prop_name=t[e.prop],this.sort_order="ascending"===e.order?"0":"descending"===e.order?"1":void 0,this.get_pod_cluster_list()}},{key:"handleSizeChange",value:function(e){this.page_info.size=e,this.get_pod_cluster_list()}},{key:"handleCurrentChange",value:function(e){this.page_info.current=e,this.get_pod_cluster_list()}},{key:"confirm",value:function(){var e=this,t=this.$refs.form;t.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(s){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s){t.next=5;break}return t.next=3,v["a"].set_cluster_prepare_host({cluster_id:e.multi_rows[0].cluster_id,prepare_host_count:e.form.standby_num});case 3:i=t.sent,"Success"===i.code&&(e.$message.success(i.message),e.prepare_host_visible=!1,e.get_pod_cluster_list());case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"cancel",value:function(){var e=this.$refs.form;e.resetFields(),this.prepare_host_visible=!1}}]),s}(p["e"]);Object(d["a"])([Object(p["f"])("visible")],x.prototype,"watch_visible",null),Object(d["a"])([Object(p["f"])("multi_rows",{immediate:!0,deep:!0})],x.prototype,"watch_multi",null),Object(d["a"])([Object(p["f"])("$store.state.az_id")],x.prototype,"watch_az",null),x=Object(d["a"])([Object(p["a"])({components:{AddHost:w["a"],CreateCluster:O["a"],SearchFrom:f["a"],SvgIcon:h["a"],CustomListItem:m["a"],RightClick:k["a"]}})],x);var C=x,S=C,z=(s("7d2d"),s("f647"),s("2877")),F=Object(z["a"])(S,i,a,!1,null,"6be13bcc",null);t["default"]=F.exports},d772:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_operate_record_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/history_record/",e))},get_detail:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_ecs_detail/",e))}}},d828:function(e,t,s){},d84b:function(e,t,s){},d86b:function(e,t,s){var i=s("d039");e.exports=i((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},d8a7:function(e,t,s){"use strict";s("fceb")},d998:function(e,t,s){var i=s("342f");e.exports=/MSIE|Trident/.test(i)},df2c:function(e,t,s){"use strict";s("372e")},e03a:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"网络设置",visible:e.visibleSync,width:"60%","destroy-on-close":!0},on:{"update:visible":function(t){e.visibleSync=t}}},[s("el-alert",{attrs:{title:"注：若批量选中实例，将以填写的私有IP地址为起始IP地址，依次配置至各实例中。",type:"warning",closable:!1,center:""}}),s("el-table",{attrs:{data:e.list}},[s("el-table-column",{attrs:{prop:"vlan",label:"VLAN"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{oninput:"value = value.replace(/^(0+)|[^\\d]+/g,'')"},model:{value:t.row.vlan_id,callback:function(s){e.$set(t.row,"vlan_id",s)},expression:"scope.row.vlan_id"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.judge("vlan",t.row.vlan_id),expression:"!judge('vlan',scope.row.vlan_id)"}],staticClass:"error_message"},[e._v("vlan需为大于0的数字")])]}}])}),s("el-table-column",{attrs:{prop:"ip",label:"IP地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{model:{value:t.row.ip_address,callback:function(s){e.$set(t.row,"ip_address",s)},expression:"scope.row.ip_address"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.judge("ip",t.row.ip_address),expression:"!judge('ip',scope.row.ip_address)"}],staticClass:"error_message"},[e._v("ip地址格式不正确")])]}}])}),s("el-table-column",{attrs:{prop:"subnet",label:"子网掩码"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{oninput:"value = value.replace(/^(0+)|[^\\d]+/g,'')"},model:{value:t.row.mask,callback:function(s){e.$set(t.row,"mask",s)},expression:"scope.row.mask"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.judge("subnet",t.row.mask),expression:"!judge('subnet',scope.row.mask)"}],staticClass:"error_message"},[e._v("子网掩码范围为1-32")])]}}])}),s("el-table-column",{attrs:{prop:"operate",label:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-remove-outline delete-icon",on:{click:function(s){return e.del(t.$index)}}})]}}])})],1),s("div",{staticClass:"m-top10"},[s("el-button",{attrs:{type:"text",disabled:5===e.list.length},on:{click:e.add}},[s("i",{staticClass:"el-icon-circle-plus"}),e._v(" 添加网卡")])],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")]),s("el-button",{attrs:{type:"default"},on:{click:function(t){e.visibleSync=!1}}},[e._v("取消")])],1)],1)],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("96cf"),s("d81d"),s("a9e3"),s("ac1f"),s("00b4"),s("4de4"),s("d3b7"),s("ddb0"),s("9ab4")),_=s("1b40"),d=s("e527"),p=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.list=[],e.dnsObj={main:"",slave:""},e}return Object(o["a"])(s,[{key:"created",value:function(){var e=this;1===this.ecs_list.length?this.ecs_list[0].base_nic_info.length>0&&this.ecs_list[0].base_nic_info.map((function(t){return e.list.push({netcard_id:t.netcard_id,vlan_id:t.vlan_id,ip_address:t.ip_address,mask:t.mask}),t})):this.list=[{netcard_id:"",vlan_id:"",ip_address:"",mask:""}]}},{key:"get_default_dns",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].get_default_dns({ecs_ids:this.ecs_list.map((function(e){return e.ecs_id}))});case 2:t=e.sent,"Success"===t.code&&(this.dnsObj=t.data,this.ecs_list.length>1&&(this.list[0].mainDns=this.dnsObj.main,this.list[0].dns=this.dnsObj.slave));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"add",value:function(){this.list.length>=5||this.list.push({netcard_id:"",vlan_id:"",ip_address:"",mask:""})}},{key:"judge",value:function(e,t){if("vlan"===e)return Number(t)>0;if("ip"===e){var s=/^((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)$/;return t&&s.test(t)}return Number(t)>0&&Number(t)<=32}},{key:"del",value:function(e){this.list=this.list.filter((function(t,s){return s!==e}))}},{key:"confirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,i,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t={vlan_id:"vlan",ip_address:"ip",mask:"subnet"},e.t0=regeneratorRuntime.keys(this.list);case 2:if((e.t1=e.t0()).done){e.next=13;break}s=e.t1.value,e.t2=regeneratorRuntime.keys(this.list[s]);case 5:if((e.t3=e.t2()).done){e.next=11;break}if(i=e.t3.value,"netcard_id"===i||this.judge(t[i],this.list[s][i])){e.next=9;break}return e.abrupt("return");case 9:e.next=5;break;case 11:e.next=2;break;case 13:return a=[],this.list.map((function(e){var t=e.vlan_id,s=e.ip_address,i=e.mask,n=(e.mainDns,e.dns,e.netcard_id);a.push({netcard_id:n,vlan_id:Number(t),ip_address:s,mask:Number(i),gateway:"",dns:[]})})),e.next=17,d["a"].set_net({ecs_ids:this.ecs_list.map((function(e){return e.ecs_id})),base_nic_info:a});case 17:n=e.sent,"Success"===n.code&&this.$message.success(n.message),this.visibleSync=!1;case 20:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),s}(_["e"]);Object(u["a"])([Object(_["d"])("visible")],p.prototype,"visibleSync",void 0),Object(u["a"])([Object(_["c"])({default:function(){return[]}})],p.prototype,"ecs_list",void 0),p=Object(u["a"])([_["a"]],p);var h=p,f=h,m=(s("07e6"),s("2877")),b=Object(m["a"])(f,i,a,!1,null,"0d4251ae",null);t["a"]=b.exports},e160:function(e,t,s){"use strict";s("a00c")},e4d0:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_pub_mirror_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_pub_image_list/",e))},check_name:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/name_check/",e))},get_mirror_type:function(e){return Object(i["a"])(Object(a["b"])("GET","/img/image_type/",e))},get_model_image_type:function(e){return Object(i["a"])(Object(a["b"])("GET","/img/model_image_type/",e))},add_pub_mirror:function(e){return Object(i["a"])(Object(a["b"])("GET","/img/create_pub_image/",e))},edit_pub_mirror:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/edit_image/",e))},change_status:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/alter_image/",e))},del_pub_mirror_az:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/delete_pub_image/",e))},del_pub_mirror:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/batch_delete_pub_image/",e))},get_pub_operate_record:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_operation_list/",e))},get_pub_sync_detail:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_info/",e))},sync_mirror:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/sync_pub_image/",e))},get_private_mirror_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_private_image_list/",e))},get_status_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_image_status_list/",e))},get_available_az:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/get_available_az/",e))},get_disk_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/img/backend_type/",e))},get_product_source:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_product_source/"))}}},e527:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7"),n=s("4328"),r=s.n(n);t["a"]={get_instance_list:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_list/",e))},operate_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/operate/",e))},delete_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/delete/",e))},recover_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/recover/",e))},destroy_instance:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/destroy/",e))},get_status_list:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/ecs_status_list/"))},get_family_data:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_family_data/"))},reset_password:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_reset_password/",e))},update_spec:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_configure/",e))},update_system:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_system/",e))},get_usage_ip:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_deleted_ecs_ip/",e))},get_vnc_url:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/vnc_info/",e))},start_charge:function(e){return Object(i["a"])(Object(a["b"])("POST","/resource/start_charge/",e))},change_config_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_config_price/",e))},change_system_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_system_price/",e))},each_resource_price:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/each_resource_price/",e))},add_common_mirror:function(e){return Object(i["a"])(Object(a["b"])("POST","/img/create_pub_image_by_ecs/",e))},set_net:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_set_base_nic/",e))},get_default_dns:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/az_default_dns/",e))},mount_gpu_card:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/instance_gpu_card/",e))},update_gpu_status:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/update_gpu_status/",e))},export_list:function(e){return Object(i["a"])({method:"GET",url:"/ecs_business/v1/ecs/ecs_list_download/",params:e,paramsSerializer:function(e){return r.a.stringify(e)},responseType:"blob"})},get_tag_list:function(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_tag_list/"))},get_rescue_image_list:function(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_rescue_image_list/",e))},enter_rescue:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/enter_rescue/",e))},exit_rescue:function(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/exit_rescue/",e))}}},e52b:function(e,t,s){"use strict";s("7141")},e776:function(e,t,s){},e79e:function(e,t,s){"use strict";s("427f")},e8c0:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s("cf88");function a(e,t,s){s.preventDefault(),document.addEventListener("contextmenu",(function(e){var t=e.target;if(t.closest(".el-table")){var s=document.querySelector("#menu");if(s){s.style.display="block";var a=s.offsetHeight,n=s.offsetWidth;console.log("menuHeight",a);var r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=e.clientX,l=e.clientY,u=c,_=l;o<c+n&&(u=c-n),r<l+a&&(_=r-a),s.style.left=u-250+"px",s.style.top=_-50+"px",s.style.display="block",s.style.zIndex="1000",document.addEventListener("click",i["a"])}}})),document.addEventListener("contextmenu",i["a"])}},ecd5:function(e,t,s){"use strict";s("5049")},ed60:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"resetForm",staticClass:"pwd-form",attrs:{model:e.data,rules:e.rules,"label-position":"left","label-width":"120px"}},[s("el-form-item",{attrs:{label:"用户名"}},[e._v(" "+e._s(e.username)+" ")]),s("el-form-item",{attrs:{label:e.label,prop:"password"}},[s("div",{staticClass:"long-input"},[s("el-input",{attrs:{type:"password","show-password":""},model:{value:e.data.password,callback:function(t){e.$set(e.data,"password",t)},expression:"data.password"}})],1),s("div",{staticClass:"prompt_message"},[e._v(" 8-30个字符，且同时包含三项（大写字母、小写字母、数字、()`~!@#$%^&*-+=_|{}[]:;,.?/中的特殊字符）")])]),s("el-form-item",{attrs:{label:"确认密码",prop:"confirm_password"}},[s("div",{staticClass:"long-input"},[s("el-input",{attrs:{type:"password","show-password":""},model:{value:e.data.confirm_password,callback:function(t){e.$set(e.data,"confirm_password",t)},expression:"data.confirm_password"}})],1)])],1)},a=[],n=s("d4ec"),r=s("bee2"),o=s("262e"),c=s("2caf"),l=(s("d9e2"),s("9ab4")),u=s("1b40");s("ac1f"),s("00b4");function _(e){var t=/[A-Z]+/,s=/\d+/,i=/[a-z]+/,a=/[~`·！!@#￥$%……^&*()（）——+=【】[\]{}|、\\：:;；"”“’''<>《》,，。.?？/].*/,n=0,r=!0,o="";return t.test(e)&&n++,s.test(e)&&n++,i.test(e)&&n++,a.test(e)&&n++,(e.length<8||e.length>30)&&(o="长度应为8-30位之间",r=!1),n<3&&(o="需要包含大小写字母、数字、特殊符号中的任意三项",r=!1),{flag:r,msg:o}}var d=function(e){Object(o["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(n["a"])(this,s),e=t.apply(this,arguments),e.data={password:"",confirm_password:""},e.FnCheckPwd=function(e,t,s){var i=_(t);i.flag||s(new Error(i.msg)),s()},e.FnCheckConfirmPwd=function(t,s,i){""===s?i(new Error("请输入确认密码")):s!==e.data.password&&i(new Error("两次密码输入不一致")),i()},e.rules={password:[{required:!0,validator:e.FnCheckPwd,trigger:"blur"}],confirm_password:[{required:!0,validator:e.FnCheckConfirmPwd,trigger:"blur"}]},e}return Object(r["a"])(s,[{key:"FnSubmit",value:function(){var e=!1;return this.$refs["resetForm"].validate((function(t){e=t})),{flag:e,password:this.data.password}}},{key:"FnResetForm",value:function(){this.$refs["resetForm"].resetFields()}}]),s}(u["e"]);Object(l["a"])([Object(u["c"])({default:"root/administrator"})],d.prototype,"username",void 0),Object(l["a"])([Object(u["c"])({default:"密码"})],d.prototype,"label",void 0),d=Object(l["a"])([u["a"]],d);var p=d,h=p,f=(s("0ae5"),s("2877")),m=Object(f["a"])(h,i,a,!1,null,"61a0d7cc",null);t["a"]=m.exports},edc2:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"编辑备注-"+e.rows.host_name,visible:e.visible_sync,width:"400px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t}}},[s("el-input",{attrs:{type:"textarea",maxlength:"128","show-word-limit":"",rows:"5"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){e.visible_sync=!1}}},[e._v("取消")])],1)],1)},a=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),u=(s("96cf"),s("9ab4")),_=s("1b40"),d=s("1477"),p=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.value=e.rows.remark,e}return Object(o["a"])(s,[{key:"created",value:function(){}},{key:"confirm",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].set_remark({host_ids:[this.rows.host_id],remark:this.value});case 2:t=e.sent,"Success"===t.code?(this.$message.success(t.message),this.back("1")):this.back("0");case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(_["e"]);Object(u["a"])([Object(_["d"])("visible")],p.prototype,"visible_sync",void 0),Object(u["a"])([Object(_["c"])({default:function(){return{host_name:"",remark:""}}})],p.prototype,"rows",void 0),Object(u["a"])([Object(_["b"])("close")],p.prototype,"back",null),p=Object(u["a"])([Object(_["a"])({})],p);var h=p,f=h,m=(s("6959"),s("2877")),b=Object(m["a"])(f,i,a,!1,null,"1d3ae641",null);t["a"]=b.exports},f183:function(e,t,s){var i=s("23e7"),a=s("e330"),n=s("d012"),r=s("861d"),o=s("1a2d"),c=s("9bf2").f,l=s("241c"),u=s("057f"),_=s("4fad"),d=s("90e3"),p=s("bb2f"),h=!1,f=d("meta"),m=0,b=function(e){c(e,f,{value:{objectID:"O"+m++,weakData:{}}})},v=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,f)){if(!_(e))return"F";if(!t)return"E";b(e)}return e[f].objectID},g=function(e,t){if(!o(e,f)){if(!_(e))return!0;if(!t)return!1;b(e)}return e[f].weakData},y=function(e){return p&&h&&_(e)&&!o(e,f)&&b(e),e},k=function(){O.enable=function(){},h=!0;var e=l.f,t=a([].splice),s={};s[f]=1,e(s).length&&(l.f=function(s){for(var i=e(s),a=0,n=i.length;a<n;a++)if(i[a]===f){t(i,a,1);break}return i},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},O=e.exports={enable:k,fastKey:v,getWeakData:g,onFreeze:y};n[f]=!0},f415:function(e,t,s){},f43d:function(e,t,s){"use strict";s("d828")},f5d0:function(e,t,s){},f647:function(e,t,s){"use strict";s("b52c")},f999:function(e,t,s){},fb6a:function(e,t,s){"use strict";var i=s("23e7"),a=s("da84"),n=s("e8b5"),r=s("68ee"),o=s("861d"),c=s("23cb"),l=s("07fa"),u=s("fc6a"),_=s("8418"),d=s("b622"),p=s("1dde"),h=s("f36a"),f=p("slice"),m=d("species"),b=a.Array,v=Math.max;i({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var s,i,a,d=u(this),p=l(d),f=c(e,p),g=c(void 0===t?p:t,p);if(n(d)&&(s=d.constructor,r(s)&&(s===b||n(s.prototype))?s=void 0:o(s)&&(s=s[m],null===s&&(s=void 0)),s===b||void 0===s))return h(d,f,g);for(i=new(void 0===s?b:s)(v(g-f,0)),a=0;f<g;f++,a++)f in d&&_(i,a,d[f]);return i.length=a,i}})},fceb:function(e,t,s){},fd00:function(e,t,s){},fdfe:function(e,t,s){"use strict";s("94d7")},ff8b:function(e,t,s){"use strict";s("f415")}}]);
//# sourceMappingURL=chunk-e84dbbbc.1750128822803.js.map