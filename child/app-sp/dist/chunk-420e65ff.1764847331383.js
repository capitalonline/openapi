(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-420e65ff"],{"0003":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("el-alert",{attrs:{type:"warning",closable:!1},scopedSlots:e._u([{key:"title",fn:function(){return[t("p",[e._v("支持自定义填写恢复后新IP，若原IP未被占用则可以使用原IP；")]),t("p",[e._v("若未自定义填写恢复后新IP，则默认随机生成新可用IP；")]),t("p",[e._v("为避免自定义IP成功可用率较低，建议使用随机生成的新IP。")])]},proxy:!0}])}),t("el-table",{attrs:{data:e.multiple_selection,border:""}},[t("el-table-column",{attrs:{prop:"ecs_id",label:"云服务器ID"}}),t("el-table-column",{attrs:{prop:"ecs_name",label:"云服务器名称"}}),t("el-table-column",{attrs:{label:"原IP（最近使用）"},scopedSlots:e._u([{key:"default",fn:function(s){return[e.ip_usage[s.row.ecs_id]?t("div",[e._v(" "+e._s(e.ip_usage[s.row.ecs_id].ip_address)+" "),e.ip_usage[s.row.ecs_id].is_used?t("span",{staticClass:"destroy"},[e._v("（已占用）")]):e._e()]):e._e()]}}])}),t("el-table-column",{attrs:{label:"恢复后新IP"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-input",{attrs:{placeholder:"请输入自定义IP"},model:{value:e.new_ip_address[s.row.ecs_id],callback:function(t){e.$set(e.new_ip_address,s.row.ecs_id,t)},expression:"new_ip_address[scope.row.ecs_id]"}})]}}])})],1)],1)},a=[],o=(s("14d9"),s("e9f5"),s("7d54"),s("ab43"),s("9ab4")),r=s("1b40"),n=s("e527");let _=class extends r["e"]{constructor(){super(...arguments),this.ip_usage={},this.ip_available_list={},this.new_ip_address={}}async FnGetIpUsage(){let e={customer_id:this.customer_id,ecs_ids:this.multiple_selection.map(e=>e.ecs_id)};this.ip_usage={};let t=await n["a"].get_usage_ip(e);"Success"===t.code&&(t.data.forEach(e=>{this.ip_usage[e.ecs_id]={ip_address:e.ip_address,is_used:e.is_used}}),this.$set(this.ip_usage))}async FnRecover(){let e=Object.values(this.new_ip_address),t=[];for(let a in this.new_ip_address){let e=this.new_ip_address[a];if(this.ip_usage[a].is_used&&this.ip_usage[a].ip_address===e)return void this.$message.warning("恢复后新IP已被占用！");(t.indexOf(e)<0||!e)&&t.push(e)}if(e.length>t.length)return void this.$message.warning("恢复后新IP重复！");let s={customer_id:this.customer_id,is_gpu:this.is_gpu,ecs_list:this.multiple_selection.map(e=>({ecs_id:e.ecs_id,ip_address:this.new_ip_address[e.ecs_id]}))};const i=await n["a"].recover_instance(s);"Success"==i.code&&(this.$message.success(i.msg||"成功下发 恢 复 任务！"),this.Fnclose())}Fnclose(){}created(){this.FnGetIpUsage()}};Object(o["a"])([Object(r["c"])({default:""})],_.prototype,"customer_id",void 0),Object(o["a"])([Object(r["c"])({default:[]})],_.prototype,"multiple_selection",void 0),Object(o["a"])([Object(r["c"])({default:0})],_.prototype,"is_gpu",void 0),Object(o["a"])([Object(r["b"])("fn-close")],_.prototype,"Fnclose",null),_=Object(o["a"])([r["a"]],_);var c=_,l=c,d=s("2877"),u=Object(d["a"])(l,i,a,!1,null,null,null);t["a"]=u.exports},"039b":function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_snapshot_list(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_list/",e))},get_snapshot_chains_list(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_list/",e))},chains_detail(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_chains_detail/",e))},record(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/history_record/",e))},get_monitor_id(e){return Object(i["a"])(Object(a["b"])("GET","/snapshot/snapshot_disk_ids/",e))},get_snapshot_info(e){return Object(i["a"])(Object(a["i"])("POST","/snapshot/snapshot_use_monitor",e))}}},"0d26":function(e,t,s){"use strict";var i=s("e330"),a=Error,o=i("".replace),r=function(e){return String(new a(e).stack)}("zxcasd"),n=/\n\s*at [^:]*:[^\n]*/,_=n.test(r);e.exports=function(e,t){if(_&&"string"==typeof e&&!a.prepareStackTrace)while(t--)e=o(e,n,"");return e}},1163:function(e,t,s){"use strict";s("390e")},1477:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_host_list(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_list/",e))},get_room_list(e){return Object(i["a"])(Object(a["d"])("GET","/host/machine_room_list/",e))},get_status_list(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_status_list/",e))},external_management(e){return Object(i["a"])(Object(a["d"])("GET","/host/external_management/",e))},migrate(e){return Object(i["a"])(Object(a["d"])("POST","/host/migration_operation/",e))},disperse(e){return Object(i["a"])(Object(a["d"])("POST","/host/disperse_operation/",e))},record(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_operation_record/",e))},recommended_host(e){return Object(i["a"])(Object(a["d"])("POST","/host/recommended_host/",e))},host_maintenance(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",e))},finish_maintenance(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_finish_maintenance/",e))},shelves(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_off_shelves/",e))},get_detail_overview(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_main_details/",e))},get_detail_storage(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_disk/",e))},down(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_list_download/",e))},host_operate(e){return Object(i["a"])(Object(a["d"])("POST","/host/operate/",e))},host_import(e){return Object(i["a"])(Object(a["d"])("POST","/host/import/",e))},get_host_attribution(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_attribution/",e))},set_host_attribution(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_attribution/",e))},get_host_type(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_config/",e))},update_attribute(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_config/",e))},getCustomerList(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_customer_list/",e))},getFamilyList(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_family_list/",e))},finish_validate(e){return Object(i["a"])(Object(a["d"])("POST","/host/verification_finish/",e))},get_host_recycle_department(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_recycle_department/",e))},get_host_list_field(e){return Object(i["a"])(Object(a["d"])("GET","/host/get_host_list_field/",e))},get_task_list(e){return Object(i["a"])(Object(a["d"])("GET","/host/business_test_task/",e))},create_test_task(e){return Object(i["a"])(Object(a["d"])("POST","/host/create_test_task/",e))},get_host_filter_item(e){return Object(i["a"])(Object(a["d"])("POST","/host/get_host_filter_item/",e))},set_remark(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_remark/",e))},set_flag(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_host_tag/",e))},update_ecs_info(e){return Object(i["a"])(Object(a["d"])("POST","/ecs/update_ecs_info/",e))},crash_clear(e){return Object(i["a"])(Object(a["b"])("POST","/host/crash_clear/",e))},crash_recover(e){return Object(i["a"])(Object(a["b"])("POST","/host/crash_recover/",e))},set_lock(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_lock/",e))},set_unlock(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_unlock/",e))},set_maintenance(e){return Object(i["a"])(Object(a["d"])("POST","/host/host_maintenance/",e))},get_maintenance_record(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_maintenance_record/",e))},get_lock_record(e){return Object(i["a"])(Object(a["d"])("GET","/host/host_lock_record/",e))},recover_storage_error(e){return Object(i["a"])(Object(a["d"])("POST","/host/recover_storage_error/",e))},agent_update(e){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_update/",e))},agent_rollback(e){return Object(i["a"])(Object(a["d"])("POST","/host/handle_host_agent_rollback/",e))},set_prepare_host(e){return Object(i["a"])(Object(a["d"])("POST","/host/set_prepare_host/",e))},get_ovs_version(e){return Object(i["a"])(Object(a["d"])("GET","/host/ovs_version_list/",e))},update_host_power_status(e){return Object(i["a"])(Object(a["d"])("POST","/host/update_host_power_status/",e))},update_ecs_status(e){return Object(i["a"])(Object(a["d"])("POST","/host/update_host_ecs_status/",e))}}},1787:function(e,t,s){"use strict";var i=s("861d");e.exports=function(e){return i(e)||null===e}},"1b7c":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-tooltip",{attrs:{content:e.content,placement:e.placement,effect:e.effect,"popper-class":"tooltip-class"},scopedSlots:e._u([{key:"content",fn:function(){return[e._t("content")]},proxy:!0}],null,!0)},[t("el-button",{attrs:{type:"text"}},[t("svg-icon",{attrs:{icon:"info",viewBox:"0 0 18 18"}})],1)],1)},a=[],o=s("9ab4"),r=s("1b40"),n=s("3673");let _=class extends r["e"]{};Object(o["a"])([Object(r["c"])({default:""})],_.prototype,"content",void 0),Object(o["a"])([Object(r["c"])({default:"right"})],_.prototype,"placement",void 0),Object(o["a"])([Object(r["c"])({default:"light"})],_.prototype,"effect",void 0),_=Object(o["a"])([Object(r["a"])({components:{svgIcon:n["a"]}})],_);var c=_,l=c,d=(s("74c5"),s("2877")),u=Object(d["a"])(l,i,a,!1,null,null,null);t["a"]=u.exports},"1f00":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{title:"制作公共镜像",visible:e.visible_sync,width:"500px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t}}},[t("el-form",{ref:"form_ecs",attrs:{model:e.form_data,"label-position":"left","label-width":"100px","label-suffix":":"}},[t("el-form-item",{staticClass:"content",attrs:{label:"实例名称/ID"}},[t("span",[e._v(e._s(e.form_data.ecs))])]),t("el-form-item",{staticClass:"content",attrs:{label:"客户名称/ID"}},[t("span",[e._v(e._s(e.form_data.customer))])]),t("el-form-item",{staticClass:"content",attrs:{label:"可用区"}},[t("span",[e._v(e._s(e.form_data.az))])]),t("el-form-item",{staticClass:"content",attrs:{label:"实例规格"}},[t("span",[e._v(e._s(e.form_data.spec))])]),t("el-form-item",{staticClass:"content",attrs:{label:"系统盘"}},[t("span",[e._v(e._s(e.form_data.system_disk))])]),t("el-form-item",{staticClass:"content",attrs:{label:"镜像"}},[t("span",[e._v(e._s(e.form_data.mirror))])]),t("el-form-item",{attrs:{label:"镜像名称",prop:"name",rules:[{required:!0,message:"请输入镜像名称",trigger:"blur"}]}},[t("el-input",{model:{value:e.form_data.name,callback:function(t){e.$set(e.form_data,"name",t)},expression:" form_data.name"}})],1),t("el-form-item",{staticClass:"test",attrs:{label:"测试账户ID",prop:"test_id",rules:[{required:!0,trigger:"blur",validator:e.validate_account}]}},[t("div",{staticClass:"test"},[t("customer-input",{on:{FnCustomer:e.FnCustomer}})],1),t("el-tooltip",{attrs:{content:"请选择测试账户ID，待镜像制作完成进行测试",placement:"right",effect:"light"}},[t("el-button",{staticClass:"m-left10",attrs:{type:"text"}},[t("svg-icon",{attrs:{icon:"info"}})],1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")]),t("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)},a=[],o=(s("d9e2"),s("9ab4")),r=s("1b40"),n=s("3673"),_=s("e527"),c=s("bad9");let l=class extends r["e"]{constructor(){super(...arguments),this.form_data={ecs:`${this.ecs_info.ecs_name} / ${this.ecs_info.ecs_id}`,customer:`${this.ecs_info.customer_name} / ${this.ecs_info.customer_id}`,az:this.ecs_info.az_name,spec:this.ecs_info.is_gpu?`${this.ecs_info.cpu_size}vCPU${this.ecs_info.ram_size}GiB  ${this.ecs_info.gpu_size}*${this.ecs_info.gpu_show_type}`:`${this.ecs_info.cpu_size}vCPU${this.ecs_info.ram_size}GiB`,system_disk:this.new?`${this.ecs_info.disk_info.system.system_disk_type} ${this.ecs_info.disk_info.system.disk_size}GB`:`${this.ecs_info.system_disk_type} ${this.ecs_info.system_disk_size}GB`,mirror:this.ecs_info.os_name,name:"",test_id:""}}FnCustomer(e){this.form_data.test_id=e}validate_account(e,t,s){return 0===t.length?s(new Error("请选择测试账户ID")):s()}async confirm(){let e=this.$refs.form_ecs;e.validate(async e=>{if(e){let e=await _["a"].add_common_mirror({display_name:this.form_data.name,az_id:this.ecs_info.az_id,ecs_id:this.ecs_info.ecs_id,customer_id:this.ecs_info.customer_id,customer_ids:this.form_data.test_id});"Success"===e.code&&this.$message.success(e.message),this.visible_sync=!1}})}cancel(){this.visible_sync=!1}};Object(o["a"])([Object(r["d"])("visible")],l.prototype,"visible_sync",void 0),Object(o["a"])([Object(r["c"])({default:()=>{}})],l.prototype,"ecs_info",void 0),Object(o["a"])([Object(r["c"])({default:!1})],l.prototype,"new",void 0),l=Object(o["a"])([Object(r["a"])({components:{SvgIcon:n["a"],CustomerInput:c["a"]}})],l);var d=l,u=d,p=(s("f6ea"),s("2877")),h=Object(p["a"])(u,i,a,!1,null,"22e3d05c",null);t["a"]=h.exports},"268f":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("el-dialog",{attrs:{title:"操作记录",visible:e.visible,width:"60%","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("div",[t("el-dialog",{attrs:{title:"响应信息",visible:e.res_visible,width:"60%","destroy-on-close":!0,"append-to-body":"","custom-class":"response-data"},on:{"update:visible":function(t){e.res_visible=t},close:e.clost_res}},[t("div",[e._v(e._s(e.response))])])],1),t("div",[t("action-block",{attrs:{search_option:["physical","message"].includes(e.type)?{...e.search}:e.search},on:{"fn-search":e.fn_search}}),["physical","message"].includes(e.type)?t("div",{staticClass:"icon m-bottom10"},[t("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[t("el-button",{attrs:{type:"text"},on:{click:e.getOperateRecordList}},[t("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1)],1):e._e(),t("el-table",{staticClass:"record-table",attrs:{data:e.record_list,border:""}},[t("el-table-column",{attrs:{prop:"oper_time",label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.oper_time?e.moment(s.row.oper_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),t("el-table-column",{attrs:{prop:"oper_type_display",label:"操作内容"}}),t("el-table-column",{attrs:{prop:"status_display",label:"状态"}}),["message","physical"].includes(e.type)?t("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.response?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.view(s.row.response)}}},[e._v("查看")]):t("span",[e._v("-")])]}}])}):t("el-table-column",{attrs:{prop:"response",label:"响应信息"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.result?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.view(s.row.result)}}},[e._v("查看")]):t("span",[e._v("-")])]}}],null,!1,79404134)}),t("el-table-column",{attrs:{prop:"finish_time",label:"完成时间"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.finish_time?e.moment(s.row.finish_time).format("YYYY-MM-DD HH:mm:ss"):""))])]}}])}),t("el-table-column",{attrs:{prop:"oper_user",label:"nas"===e.type?"操作用户":"用户名"}}),["physical","message"].includes(e.type)?e._e():t("el-table-column",{attrs:{prop:"flag_display",label:"操作标识"}})],1),t("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},a=[],o=s("9ab4"),r=s("1b40"),n=s("c811"),_=s("d772"),c=s("1477"),l=s("e4d0"),d=s("039b"),u=s("fc43"),p=s("c1df"),h=s.n(p),m=s("8ce4"),b=s("3673");let f=class extends r["e"]{constructor(){super(...arguments),this.state_list=[{type:"",label:"全部"},{type:"doing",label:"执行中"},{type:"success",label:"成功"},{type:"failed",label:"失败"}],this.search={state:{list:this.state_list,placeholder:"请选择状态"},content:{placeholder:"请输入操作内容"}},this.record_list=[],this.current=1,this.size=20,this.total=0,this.search_data={},this.moment=h.a,this.response="",this.res_visible=!1}created(){this.fn_search()}fn_search(e={}){this.current=1,this.search_data=e,this.getOperateRecordList()}async getOperateRecordList(){let e;const{search_data:t}=this;let s="physical"!==this.type?{task_type:t.content,cloud_id:this.record_id}:{content:t.content,cloud_id:this.record_id,cloud_type:"host"},i={status:t.state||"",page_size:this.size,page_index:this.current,...s};if(e="physical"===this.type?await c["a"].record({...i}):"message"===this.type?await l["a"].get_pub_operate_record({os_id:this.record_id,status:t.state||"",content_type:t.content,page_size:this.size,page_index:this.current}):"snapshot"===this.type?await d["a"].record({cloud_id:this.record_id,cloud_type:"snapshot",status:t.state||"",task_type:t.content,page_size:this.size,page_index:this.current}):"nas"===this.type?await u["a"].get_nas_record({...i}):await _["a"].get_operate_record_list({cloud_type:this.type?this.type:"ecs",...i}),"Success"===e.code){var a,o;if(["physical","message"].includes(this.type)){let t=["create_time","content","status_name","response","update_time","op_user"],s=["oper_time","oper_type_display","status_display","response","finish_time","oper_user"];this.record_list=Object(m["b"])(e.data.operation_list,s,t)}else{var r;this.record_list=(null===(r=e.data)||void 0===r?void 0:r.history_record)||[]}this.total=(null===(a=e.data)||void 0===a||null===(o=a.page_info)||void 0===o?void 0:o.count)||0}}handleSizeChange(e){this.size=e,this.getOperateRecordList()}handleCurrentChange(e){this.current=e,this.getOperateRecordList()}view(e){this.response=e,this.res_visible=!0}clost_res(){this.res_visible=!1,this.response=""}back(){}};Object(o["a"])([Object(r["c"])(Boolean)],f.prototype,"visible",void 0),Object(o["a"])([Object(r["c"])(String)],f.prototype,"record_id",void 0),Object(o["a"])([Object(r["c"])(String)],f.prototype,"type",void 0),Object(o["a"])([Object(r["b"])("close")],f.prototype,"back",null),f=Object(o["a"])([Object(r["a"])({components:{ActionBlock:n["a"],SvgIcon:b["a"]}})],f);var g=f,v=g,y=(s("f813"),s("2877")),w=Object(y["a"])(v,i,a,!1,null,null,null);t["a"]=w.exports},"2ba4":function(e,t,s){"use strict";var i=s("40d5"),a=Function.prototype,o=a.apply,r=a.call;e.exports="object"==typeof Reflect&&Reflect.apply||(i?r.bind(o):function(){return r.apply(o,arguments)})},"2dc0":function(e,t,s){},"2f5d":function(e,t,s){},"390e":function(e,t,s){},"3bbe":function(e,t,s){"use strict";var i=s("1787"),a=String,o=TypeError;e.exports=function(e){if(i(e))return e;throw new o("Can't set "+a(e)+" as a prototype")}},"3f8d":function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return n}));const i={building:"创建中",running:"运行中",restarting:"重启中",shutting_down:"关机中",shutdown:"已关机",starting_up:"开机中",deleting:"删除中",deleted:"已删除",destroying:"销毁中",destroy:"已销毁",updating:"更新中",error:"错误",recovering:"恢复中",failed:"创建失败"},a={start_up_ecs:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"开 机"},shutdown_ecs:{auth:["running"],msg:"已选实例需为运行中！",label:"关 机"},restart_ecs:{auth:["running"],msg:"已选实例状态需为运行中！",label:"重 启"},delete_ecs:{auth:["running","shutdown","error"],msg:"已选实例状态需为已关机或运行中或错误！",label:"逻辑删除"},recover_ecs:{auth:["deleted"],msg:"已选实例状态需为已删除！",label:"恢 复"},destroy_ecs:{auth:["deleted","failed"],msg:"已选实例状态需为已删除或创建失败！",label:"销 毁"},update_spec:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换实例规格"},update_system:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换操作系统"},reset_pwd:{auth:["running"],msg:"已选实例状态需为运行中！",label:"更换密码"},open_bill:{auth:["running","shutdown"],msg:"已选实例状态需为运行中或已关机！",label:"开启计费"},net_set:{auth:["running"],msg:"已选实例状态需为运行中！",label:"网络设置"}},o={start_up_host:{power:["shutdown"],host:["offline","online","exception","maintenance"],msg:"已选主机需为在线、离线、异常或维护状态",label:"开机"},shutdown_host:{power:["running"],host:["maintenance"],vm:1,msg:"已选主机需为维护状态",msg2:"操作关机前，请确保物理机上无云主机运行",label:"关机"},restart_host:{power:["running"],host:["offline","online","maintenance"],msg:"已选主机需为在线、离线或维护状态",label:"重启"},online_maintenance:{power:[],host:["online","exception"],msg:"已选主机需为在线状态",label:"在线维护"},maintenance:{power:[],host:[],msg:"",label:"设置维护"},offline_maintenance:{power:[],host:["offline","online","exception"],vm:1,msg:"已选主机需为在线或离线状态且已选主机上不能有虚拟机运行",label:"离线维护"},finish:{power:[],host:["maintenance","online_maintenance","offline_maintenance"],msg:"已选主机需为维护中状态",label:"完成维护"},shelves:{power:[],host:[],vm:1,msg:"已选主机上不能有虚拟机运行",label:"下架"},disperse:{power:["running"],host:["online"],msg:"已选主机需为在线状态",label:"驱散"},out_of_band:{power:[],host:["offline","online"],msg:"已选主机需为在线或离线状态",label:"进入带外管理"},migrate:{power:["running"],host:["online","storage_error","crash"],msg:"已选主机需为在线、存储异常或宕机状态",label:"迁移"},lock:{power:[],host:[],msg:"",label:"锁定"},unlock:{power:[],host:["lock"],msg:"已选主机需为锁定状态",label:"解锁"},unstore_exception:{power:[],host:["storage_error"],msg:"已选主机需为存储异常状态",label:"解除存储异常"},service:{power:[],host:[],msg:"",label:"服务更新"},rollback:{power:[],host:[],label:"回滚"},physical_detail:{power:[],host:[],msg:"",label:"详情"},data_clear:{power:[],host:["crash_clear"],msg:"",label:"数据清理同步"},down_recover:{power:[],host:["crash_recover"],msg:"",label:"宕机恢复"},sign:{power:[],host:[],msg:"",label:"设备标记"},upload:{power:[],host:[],msg:"",label:"导入"},under_sync:{power:[],host:[],msg:"",label:"底层同步"},cheat:{power:[],host:[],msg:"",label:"欺骗器管理"},business_test:{power:[],host:[],msg:"",label:"业务测试"},record:{power:[],host:[],msg:"",label:"操作记录"},resource:{power:[],host:[],msg:"",label:"分配资源"},remark:{power:[],host:[],msg:"",label:"编辑备注"},add_cluster:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"加入集群"},change_cluster:{power:[],host:[],msg:"",label:"更换集群"},remove_cluster:{power:[],host:["maintenance"],mag:"",label:"移出集群"},set_label:{power:[],host:[],msg:"",label:"添加标签"},set_prepar_host:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"设为备机"},set_resource_pools:{power:[],host:["online"],msg:"",label:"设为资源池"}};t["a"]={getInsOperateAuth(e){return a[e]}};const r=e=>i[e],n=e=>o[e]},"494e":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"instance-list"},[t("action-block",{attrs:{search_option:e.search_con,type:!0},on:{"fn-search":e.FnSearch},scopedSlots:e._u([{key:"default",fn:function(){return[t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("start_up")},on:{click:function(t){return e.FnOperate("start_up_ecs")}}},[e._v("开 机")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("shutdown")},on:{click:function(t){return e.FnOperate("shutdown_ecs")}}},[e._v("关 机")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("restart")},on:{click:function(t){return e.FnOperate("restart_ecs")}}},[e._v("重 启")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("delete")},on:{click:function(t){return e.FnOperate("delete_ecs")}}},[e._v("逻辑删除")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("destroy")},on:{click:function(t){return e.FnOperate("destroy_ecs")}}},[e._v("销 毁")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("restore")},on:{click:function(t){return e.FnOperate("restore_ecs")}}},[e._v("恢 复")]),e.$store.state.is_special_user?e._e():t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("update_spec")},on:{click:function(t){return e.FnOperate("update_spec")}}},[e._v("更换实例规格")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("update_system")},on:{click:function(t){return e.FnOperate("update_system")}}},[e._v("更换操作系统")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("reset_pwd")},on:{click:function(t){return e.FnOperate("reset_pwd")}}},[e._v("重置密码")]),t("el-button",{attrs:{type:"primary",disabled:!e.operate_auth.includes("reset_pwd")},on:{click:function(t){return e.FnOperate("net_set")}}},[e._v("网络设置")])]},proxy:!0}])}),t("div",{staticClass:"icon m-bottom10"},[t("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"text"},on:{click:e.FnExport}},[t("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1)],1),t("el-table",{ref:"multipleTable",attrs:{data:e.instance_list,border:""},on:{"selection-change":e.handleSelectionChange,"filter-change":e.handleFilterChange,"sort-change":e.handleSortChange}},[t("el-table-column",{attrs:{type:"selection",width:"40"}}),t("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),t("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),t("el-table-column",{attrs:{prop:"ecs_id",label:"云服务器ID"}}),t("el-table-column",{attrs:{prop:"ecs_name",label:"云服务器名称",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("pre",[e._v(e._s(s.row.ecs_name))])]}}])}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"90","column-key":"status",filters:e.ecs_status_list},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{class:s.row.status},[e._v(e._s(s.row.status_display))]),s.row.no_charge_shutdown_ecs&&"shutdown"===s.row.status?t("div",{staticClass:"warning_message"},[e._v("关机不计费")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"计算规格",filters:e.ecs_goods_name_list,"column-key":"ecs_goods_name",width:"100"},scopedSlots:e._u([{key:"default",fn:function(s){return[e._v(" "+e._s(s.row.ecs_goods_name)+" "),t("br"),e._v(" "+e._s(s.row.cpu_size)+"vCPU | "+e._s(s.row.ram_size)+"GiB "),t("br"),s.row.gpu_size?t("span",[e._v("| "+e._s(s.row.gpu_size)+"*"+e._s(s.row.card_name))]):e._e()]}}])}),t("el-table-column",{attrs:{label:"管理网IP",prop:"host_ip"}}),t("el-table-column",{attrs:{prop:"private_net",label:"私网IP",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(s){return e._l(s.row.private_net.split(";"),(function(i){return t("div",{key:i},[s.row.eip_info[i]?t("span",[e._v(" "+e._s(i)+" （vlan "+e._s(s.row.eip_info[i].vlan_id)+"） ")]):e._e()])}))}}])}),t("el-table-column",{attrs:{label:"虚拟出网网关IP"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.pub_net?t("div",[s.row.pub_net&&s.row.eip_info[s.row.pub_net]&&s.row.eip_info[s.row.pub_net].conf_name?t("span",{staticClass:"circel-border"},[e._v(" "+e._s(s.row.eip_info[s.row.pub_net].conf_name)+" ")]):e._e(),e._v(" "+e._s(s.row.pub_net)+" （vlan "+e._s(s.row.eip_info[s.row.pub_net].vlan_id)+"） ")]):e._e(),e._l(s.row.virtual_net,(function(i){return t("div",{key:i},[s.row.eip_info[i]&&s.row.eip_info[i].conf_name?t("span",{staticClass:"circel-border"},[e._v(" "+e._s(s.row.eip_info[i].conf_name)+" ")]):e._e(),e._v(" "+e._s(i)+" （vlan "+e._s(s.row.eip_info[i].vlan_id)+"） ")])}))]}}])}),t("el-table-column",{attrs:{label:"公网IP"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.eip_info[s.row.pub_net]&&s.row.eip_info[s.row.pub_net].conf_name?t("div",[t("span",{staticClass:"circel-border"},[e._v(" "+e._s(s.row.eip_info[s.row.pub_net].conf_name)+" ")]),e._v(" "+e._s(s.row.eip_info[s.row.pub_net].eip_ip)+" ")]):e._e(),e._l(s.row.virtual_net,(function(i){return t("div",{key:i},[s.row.eip_info[i]&&s.row.eip_info[i].conf_name?[t("span",{staticClass:"circel-border"},[e._v(" "+e._s(s.row.eip_info[i].conf_name)+" ")]),e._v(" "+e._s(s.row.eip_info[i].eip_ip)+" ")]:e._e()],2)}))]}}])}),t("el-table-column",{attrs:{prop:"host_name",label:"所属物理机",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"update_time",label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"time-box"},[e._v(e._s(s.row.update_time))])]}}])}),t("el-table-column",{attrs:{prop:"create_time",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"time-box"},[e._v(e._s(s.row.create_time))])]}}])}),t("el-table-column",{attrs:{prop:"gpu_card_status",label:"显卡状态","filter-multiple":!1,"column-key":"card_status_type",filters:e.gpu_status_list},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",{class:["正常"===s.row.gpu_card_status?"running":"已卸载"===s.row.gpu_card_status?"destroy":"关闭"===s.row.gpu_card_status?"error":""]},[e._v(e._s(s.row.gpu_card_status))])]}}])}),t("el-table-column",{attrs:{prop:"product_source",label:"产品来源","filter-multiple":!1,"column-key":"search_product_source",filters:e.product_source_list},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(s.row.product_source))])]}}])}),t("el-table-column",{attrs:{prop:"tag",label:"标签",width:"110px"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.tag.length>0?t("span",{staticClass:"time-box"},[1===s.row.tag.length?t("span",e._l(s.row.tag,(function(s){return t("span",{key:s.label_id},[e._v(e._s(s.label_value))])})),0):t("span",[t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover"}},[t("div",e._l(s.row.tag,(function(s,i){return t("span",{key:s.label_id},[t("span",{staticStyle:{width:"100%",display:"inline-block"}},[e._v(e._s(s.label_value))])])})),0),t("el-button",{staticStyle:{"white-space":"normal"},attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[t("span",[e._v(e._s(s.row.tag[0].label_value+"+"))]),t("span",[e._v(e._s(s.row.tag.length-1))])])],1)],1)]):t("span",[e._v("--")])]}}])}),t("el-table-column",{attrs:{prop:"product_server_id",label:"计费账户ID"}}),t("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"text",disabled:!e.operate_auth.includes("instance_detail")},on:{click:function(t){return e.FnToDetail(s.row.ecs_id)}}},[e._v("详情")]),t("el-button",{attrs:{type:"text",disabled:!e.operate_auth.includes("monitor")},on:{click:function(t){return e.FnToMonitor(s.row.ecs_id)}}},[e._v("监控")]),t("el-dropdown",{on:{command:e.handleCommand}},[t("span",{staticClass:"el-dropdown-link"},[e._v("更多操作"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:{type:"record",obj:s.row},disabled:!e.operate_auth.includes("instance_record")}},[e._v("操作记录 ")]),t("el-dropdown-item",{attrs:{command:{type:"vnc",obj:s.row},disabled:"running"!==s.row.status&&"rescue"!==s.row.status||!e.operate_auth.includes("vnc")}},[e._v("远程连接 ")]),"shutdown"===s.row.status&&e.operate_auth.includes("add_common_mirror")&&"内部"===s.row.customer_type?t("el-dropdown-item",{attrs:{command:{type:"mirror",obj:s.row}}},[e._v("制作公共镜像 ")]):t("el-tooltip",{attrs:{placement:"left",content:"仅内部账号且状态为已关机的实例支持操作",effect:"light"}},[t("el-dropdown-item",{staticClass:"not-clickable",attrs:{command:{type:"none",obj:s.row}}},[e._v("制作公共镜像")])],1),s.row.is_gpu?t("el-dropdown-item",{attrs:{command:{type:"gpu",obj:s.row}}},[e._v("显卡管理")]):t("el-tooltip",{attrs:{placement:"left",content:"仅支持对GPU型实例支持显卡管理",effect:"light"}},[t("el-dropdown-item",{staticClass:"not-clickable",attrs:{command:{type:"none",obj:s.row}}},[e._v("显卡管理")])],1),"running"!==s.row.status?t("el-tooltip",{attrs:{placement:"left",content:"实例需为运行中",effect:"light"}},[t("el-dropdown-item",{staticClass:"not-clickable",attrs:{command:{type:"none",obj:s.row}}},[e._v("网络设置")])],1):t("el-dropdown-item",{attrs:{command:{type:"network",obj:s.row}}},[e._v("网络设置")]),"rescue"!==s.row.status&&"rescuing"!==s.row.status?t("el-dropdown-item",{attrs:{command:{type:"rescue_mode",obj:s.row},disabled:"shutdown"!==s.row.status}},[e._v("进入救援模式")]):t("el-dropdown-item",{attrs:{command:{type:"exit_rescue_mode",obj:s.row},disabled:"rescuing"===s.row.status}},[e._v("退出救援模式")])],1)],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.page_info.page_index,"page-sizes":e.page_info.page_sizes,"page-size":e.page_info.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.page_info,"page_index",t)},"update:current-page":function(t){return e.$set(e.page_info,"page_index",t)},"update:pageSize":function(t){return e.$set(e.page_info,"page_size",t)},"update:page-size":function(t){return e.$set(e.page_info,"page_size",t)}}}),t("el-dialog",{attrs:{title:e.operate_title,visible:e.show_operate_dialog,"close-on-click-modal":!1,width:"60%"},on:{"update:visible":function(t){e.show_operate_dialog=t},close:e.FnClose}},["recover_ecs"===e.default_operate_type?[t("Recover",{ref:"recover",attrs:{multiple_selection:e.multiple_selection,customer_id:e.customer_id,is_gpu:e.is_gpu},on:{"fn-close":e.FnClose}})]:t("div",[t("el-alert",{attrs:{title:`是否确定要对以下实例执行 ${e.operate_title} 操作`,type:"warning",closable:!1,center:""}}),t("el-table",{staticClass:"operate-table",attrs:{data:e.multiple_selection,border:""}},[t("el-table-column",{attrs:{label:"客户名称/客户ID"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[e._v(e._s(s.row.customer_name))]),t("div",[e._v(e._s(s.row.customer_id))])]}}])}),t("el-table-column",{attrs:{label:"云服务器名称/云服务器ID"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[t("pre",[e._v(e._s(s.row.ecs_name))])]),t("div",[e._v(e._s(s.row.ecs_id))])]}}])}),t("el-table-column",{attrs:{label:"云服务器规格"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[e._v(" "+e._s(s.row.ecs_goods_name)+" "+e._s(s.row.cpu_size)+"vCPU "+e._s(s.row.ram_size)+"GiB "),e.is_gpu?t("span",[e._v(e._s(s.row.gpu_size)+"*"+e._s(s.row.card_name))]):e._e()])]}}])}),"update_system"===e.default_operate_type?t("el-table-column",{attrs:{label:"系统盘"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[e._v(" "+e._s(s.row.system_disk_type)+" "+e._s(s.row.system_disk_size)+"GB ")])]}}],null,!1,3861243780)}):e._e(),"update_system"===e.default_operate_type?t("el-table-column",{attrs:{label:"操作系统"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[e._v(e._s(s.row.os_name))])]}}],null,!1,3179532245)}):e._e(),t("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",{class:s.row.status},[e._v(e._s(s.row.status_display))])]}}])}),t("el-table-column",{attrs:{prop:"gpu_card_status",label:"显卡状态"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",{class:["正常"===s.row.gpu_card_status?"running":"已卸载"===s.row.gpu_card_status?"destroy":"关闭"===s.row.gpu_card_status?"error":""]},[e._v(e._s(s.row.gpu_card_status))])]}}])}),"open_bill"===e.default_operate_type?t("el-table-column",{attrs:{prop:"",label:"价格"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("span",[e._v(e._s(e.ecs_list_price[s.row.ecs_id]))])]}}],null,!1,260281309)}):e._e()],1),t("div",{staticClass:"component-box"},["update_spec"===e.default_operate_type?[t("update-spec",{ref:"update_spec",attrs:{ecs_list_info:e.multiple_selection,customer_id:e.customer_id,az_id:e.az_id,type:"batch_update",default_is_gpu:e.is_gpu},on:{"enable-change":e.handleEnableChange}})]:e._e(),"update_system"===e.default_operate_type?[t("update-os",{ref:"update_os",attrs:{customer_id:e.customer_id,az_id:e.az_id,is_gpu:e.is_gpu,default_os_type:e.os_type,support_gpu_driver:e.support_gpu_driver},on:{"fn-os":e.FnGetOsInfo}}),t("update-disk",{ref:"update_disk",attrs:{system_disk:!0,customer_id:e.customer_id,az_id:e.az_id,is_gpu:e.is_gpu,os_disk_size:Number(e.os_info.disk_size),origin_disk_size:e.origin_disk_size,spec_family_id:e.spec_family_id,disk_feature:e.system_disk_feature},on:{"fn-billing-info":e.FnGetDiskBillingInfo,"fn-system-disk":e.FnChangeSystem}}),t("reset-pwd",{ref:"reset_pwd",attrs:{customer_id:e.customer_id,az_id:e.az_id,username:e.os_info.username}})]:e._e(),"operateGpu"===e.default_operate_type?t("div",[e._v(" 操作： "),t("el-radio-group",{model:{value:e.gpu_card_operate,callback:function(t){e.gpu_card_operate=t},expression:"gpu_card_operate"}},[t("el-radio",{attrs:{label:"ecs_attach_gpu_card",disabled:!e.multiple_selection[0].gpu_operate_list.includes("ecs_attach_gpu_card")}},[e._v("挂载显卡")]),t("el-radio",{attrs:{label:"ecs_detach_gpu_card",disabled:!e.multiple_selection[0].gpu_operate_list.includes("ecs_detach_gpu_card")}},[e._v("卸载显卡")]),t("el-radio",{attrs:{label:"ecs_change_fault_card",disabled:!e.multiple_selection[0].gpu_operate_list.includes("ecs_change_fault_card")}},[e._v("切换显卡 "),t("el-tooltip",{attrs:{content:"当云主机显卡关闭时，切换成正常可用的显卡。",placement:"right",effect:"light"}},[t("el-button",{attrs:{type:"text"}},[t("svg-icon",{attrs:{icon:"info",viewBox:"0 0 18 18"}})],1)],1)],1)],1)],1):e._e(),"reset_pwd"===e.default_operate_type?[t("reset-pwd",{ref:"reset_pwd",attrs:{label:"新密码",customer_id:e.customer_id,az_id:e.az_id}})]:e._e()],2),e.total_price?t("div",{staticClass:"text-right m-right20"},["update_system"===e.default_operate_type?t("span",[e._v("变更后需支付费用")]):t("span",[e._v("变更后总价：")]),t("span",{staticClass:"num_message"},[e._v(e._s(e.total_price))])]):e._e(),"shutdown_ecs"===e.default_operate_type?t("div",{staticClass:"text-center"},[e._v(" 关机方式： "),t("el-radio",{staticClass:"m-left20",attrs:{label:"shutdown_ecs"},model:{value:e.shutdown_ecs_type,callback:function(t){e.shutdown_ecs_type=t},expression:"shutdown_ecs_type"}},[e._v("正常关机")]),t("el-radio",{staticClass:"m-left20",attrs:{label:"compel_shutdown_ecs"},model:{value:e.shutdown_ecs_type,callback:function(t){e.shutdown_ecs_type=t},expression:"shutdown_ecs_type"}},[e._v("强制关机")]),t("mark-tip",{staticClass:"mark-tip",attrs:{content:"等同于断电处理，Windows操作系统可能会损坏，请谨慎选择"}})],1):e._e(),"restart_ecs"===e.default_operate_type?[t("div",{staticClass:"text-center"},[e._v(" 重启方式: "),t("el-radio",{staticClass:"m-left20",attrs:{label:"restart_ecs"},model:{value:e.restart_ecs_type,callback:function(t){e.restart_ecs_type=t},expression:"restart_ecs_type"}},[e._v("正常重启")]),t("el-radio",{staticClass:"m-left20",attrs:{label:"hard_restart_ecs"},model:{value:e.restart_ecs_type,callback:function(t){e.restart_ecs_type=t},expression:"restart_ecs_type"}},[e._v("硬重启")])],1),t("div",{staticClass:"warning_message"},[e._v("说明：若云主机故障，请选择“硬重启”，使云主机快速恢复正常。")])]:e._e()],2),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",disabled:"update_spec"===e.default_operate_type&&!e.enable_change},on:{click:e.FnConfirm}},[e._v("确 定")]),t("el-button",{on:{click:e.FnClose}},[e._v("取 消")])],1)],2),e.record_visible?[t("Record",{attrs:{visible:e.record_visible,record_id:e.record_id},on:{close:e.closeRecord}})]:e._e(),e.detail_visible?[t("Detail",{attrs:{visible:e.detail_visible,detail_id:e.detail_id},on:{"close-detail":e.closeDetail}})]:e._e(),e.common_visible?[t("add-common",{attrs:{visible:e.common_visible,ecs_info:e.ecs_info,new:!1},on:{"update:visible":function(t){e.common_visible=t}}})]:e._e(),e.net_visible?[t("net-set",{attrs:{visible:e.net_visible,ecs_list:e.multiple_selection},on:{"update:visible":function(t){e.net_visible=t}}})]:e._e(),e.rescue_visible?[t("rescue-mode",{attrs:{visible:e.rescue_visible,ecs_id:e.ecs_id,customer_id:e.customer_id},on:{"update:visible":function(t){e.rescue_visible=t}}})]:e._e()],2)},a=[],o=(s("14d9"),s("e9f5"),s("910d"),s("7d54"),s("ab43"),s("a732"),s("88a7"),s("271a"),s("5494"),s("9ab4")),r=s("1b40"),n=s("98c9"),_=s("c811"),c=s("3673"),l=s("3f8d"),d=s("e527"),u=s("9074"),p=s("e4d0"),h=s("268f"),m=s("76ff"),b=s("ed60"),f=s("3874"),g=s("29ab"),v=s("d4fd"),y=s("0003"),w=s("1b7c"),O=s("1f00"),k=s("c1df"),j=s.n(k),S=s("77d2"),C=s("e03a"),x=s("81b2");let T=class extends r["e"]{constructor(){super(...arguments),this.search_con={ecs_id:{placeholder:"请输入云服务器ID",multi:!0},ecs_name:{placeholder:"请输入云服务器名称",multi:!0},customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},os_info:{placeholder:"请输入操作系统ID/名称"},private_net:{placeholder:"请输入私网IP",multi:!0},public_net:{placeholder:"请输入公网IP",multi:!0},host_id:{placeholder:"请输入物理机ID"},host_name:{placeholder:"请输入物理机名称",multi:!0},host_ip:{placeholder:"请输入物理机管理IP"},out_band_address:{placeholder:"请输入物理机带外IP"},tag:{placeholder:"请选择标签",list:[],filter:!0},create_time:{placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!0,dis_day:1,defaultTime:[]}},this.search_reqData={},this.search_billing_method="all",this.search_op_source="",this.search_product_source="",this.search_ecs_goods_name=[],this.search_status=[],this.instance_list=[],this.customer_id="",this.az_id="",this.is_gpu=0,this.origin_disk_size=0,this.support_gpu_driver="",this.spec_family_id="",this.gpu_card_operate="",this.os_type="",this.billing_method="0",this.multiple_selection=[],this.multiple_selection_id=[],this.operate_auth=[],this.show_operate_dialog=!1,this.operate_title="",this.default_operate_type="",this.shutdown_ecs_type="shutdown_ecs",this.restart_ecs_type="restart_ecs",this.record_visible=!1,this.record_id="",this.detail_visible=!1,this.detail_id="",this.net_visible=!1,this.rescue_visible=!1,this.gpu_status_list=[{text:"正常",value:"0"},{text:"卸载",value:"1"},{text:"关闭",value:"2"}],this.product_source_list=[],this.product_server_id="",this.search_card_status_type="",this.search_product_status_type="",this.page_info={page_sizes:[20,50,100],page_size:20,page_index:1,total:0},this.billing_method_relation={"":"不计费",0:"按需计费",1:"包年包月"},this.billing_method_list=[],this.ecs_goods_name_list=[],this.timer=null,this.os_info={},this.ecs_info={},this.common_visible=!1,this.total_price="",this.disk_billing_info={},this.ecs_list_price={},this.loading=!1,this.sort_prop_name="",this.sort_order=void 0,this.ecs_status_list=[],this.select_tag=[],this.isComponentDestroying=!1,this.system_disk_feature="",this.ecs_id="",this.enable_change=!1}watch_pod(e){e&&this.FnSearch(this.search_reqData)}handleCommand(e){const{type:t,obj:s}=e;"record"===t?this.FnToRecord(s.ecs_id):"vnc"===t?this.FnToVnc(s.ecs_id):"mirror"===t?this.addCommon(s):"gpu"===t?this.operateGpu(s):"network"===t?this.netSet("single",s):"rescue_mode"===t?this.FnToRescue(s):"exit_rescue_mode"===t&&this.FnExitRescue(s)}FnExitRescue(e){this.$confirm("是否退出救援模式？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=await d["a"].exit_rescue({customer_id:e.customer_id,ecs_id:e.ecs_id});"Success"===t.code&&(this.$message.success(t.message),this.FnGetList())}).catch(()=>{this.$message({type:"info",message:"已取消退出救援模式"})})}FnToRescue(e){this.ecs_id=e.ecs_id,this.customer_id=e.customer_id,this.rescue_visible=!0}FnSearch(e={}){e.tag&&(this.select_tag=[],this.search_con.tag.list.forEach(t=>{e.tag===t.type&&this.select_tag.push(t)})),this.FnClearTimer(),this.search_reqData={pod_id:this.$store.state.pod_id,ecs_id:e.ecs_id,ecs_name:e.ecs_name,customer_id:e.customer_id,customer_name:e.customer_name,os_info:e.os_info,private_net:e.private_net,public_net:e.public_net,host_id:e.host_id,host_name:e.host_name,host_ip:e.host_ip,out_band_address:e.out_band_address,tag_list:e.tag?this.select_tag.map(e=>({label_id:e.type,customer_id:e.customer_id})):[],start_time:e.create_time&&e.create_time[0]?j()(e.create_time[0]).format("YYYY-MM-DD"):void 0,end_time:e.create_time&&e.create_time[1]?j()(e.create_time[1]).format("YYYY-MM-DD"):void 0},this.page_info.page_index=1,this.FnGetList()}async get_source_type(){let e=await p["a"].get_product_source();"Success"===e.code&&e.data.map(e=>{this.product_source_list.push({text:e.value,value:e.value})})}async FnGetTag(){const e=await d["a"].get_tag_list();if("Success"===e.code){this.search_con.tag.list=[];const t=e.data.label_info.map(e=>({label:e.label_value,type:e.label_id,customer_id:e.customer_id}));this.search_con.tag.list=t}}handleFilterChange(e){this.FnClearTimer(),setTimeout(()=>{e.op_source&&(this.search_op_source=e.op_source[0]),e.billing_method&&(this.search_billing_method=e.billing_method.length>0?e.billing_method[0]:"all"),e.ecs_goods_name&&(this.search_ecs_goods_name=e.ecs_goods_name),e.status&&(this.search_status=e.status),e.card_status_type&&(this.search_card_status_type=e.card_status_type[0]),e.search_product_source&&(this.search_product_source=e.search_product_source[0]),this.FnGetList()},500)}handleSizeChange(e){this.FnClearTimer(),this.page_info.page_size=e,this.FnGetList()}handleCurrentChange(e){this.FnClearTimer(),this.page_info.page_index=e,this.FnGetList()}handleSortChange(e){this.FnClearTimer();let t={private_net:"sort_private_ip",host_name:"sort_host_name",ecs_name:"sort_ecs_name"};this.sort_prop_name=t[e.prop],this.sort_order="ascending"===e.order?"0":"descending"===e.order?"1":void 0,this.FnGetList()}FnGetNet(e){let t=e.split(".");return[t[0],t[1],t[2],"0"].join(".")}async FnGetGraphics(e){let t={billing_method:""==this.search_billing_method?"no":this.search_billing_method,page_index:this.page_info.page_index,page_size:this.page_info.page_size,status:this.search_status.length>0?this.search_status.join(","):this.ecs_status_list.map(e=>e.value).join(","),[this.sort_prop_name]:this.sort_order,is_op:!0,...this.search_reqData};this.search_op_source&&(t["op_source"]=this.search_op_source),this.search_card_status_type&&(t["card_status_type"]=this.search_card_status_type),this.search_ecs_goods_name.length>0&&(t["spec_family_ids"]=JSON.stringify(this.search_ecs_goods_name)),t["ecs_id"]=e;const s=await d["a"].get_instance_list(t);"Success"==s.code&&(this.multiple_selection=s.data.ecs_list,this.show_operate_dialog=!0,this.operate_title="显卡管理",this.default_operate_type="operateGpu",this.FnClearTimer())}async FnGetList(e=!0){if(!this.$store.state.pod_id)return;this.multiple_selection_id=[],e||(this.$store.commit("SET_LOADING",!1),this.multiple_selection_id=this.multiple_selection.map(e=>e.ecs_id));let t={billing_method:""==this.search_billing_method?"no":this.search_billing_method,page_index:this.page_info.page_index,page_size:this.page_info.page_size,status:this.search_status.length>0?this.search_status.join(","):this.ecs_status_list.map(e=>e.value).join(","),[this.sort_prop_name]:this.sort_order,is_op:!0,product_source:this.search_product_source,...this.search_reqData};this.search_op_source&&(t["op_source"]=this.search_op_source),this.search_product_source&&(t["product_source"]=this.search_product_source),this.search_card_status_type&&(t["card_status_type"]=this.search_card_status_type),this.search_ecs_goods_name.length>0&&(t["spec_family_ids"]=JSON.stringify(this.search_ecs_goods_name));const s=await d["a"].get_instance_list(t);if("Success"===s.code){this.instance_list=s.data.ecs_list;var i=[];this.multiple_selection_id.length>0&&(i=s.data.ecs_list.filter(e=>this.multiple_selection_id.includes(e.ecs_id))),i&&i.length>0&&this.$nextTick(()=>{i.forEach(e=>{this.$refs.multipleTable.toggleRowSelection(e)})}),this.page_info.total=s.data.page.count}this.isComponentDestroying||this.FnSetTimer()}handleSelectionChange(e){this.multiple_selection=e}FnToCreate(){this.$router.push("/instance/create")}FnOperate(e){if(0===this.multiple_selection.length)return void this.$message.warning("请选择要操作的实例！");const t=l["a"].getInsOperateAuth(e);if(["reset_pwd","update_spec","update_system","open_bill","net_set"].indexOf(e)>=0){if(!this.FnJudegCustomerAz(t,e))return;if("open_bill"===e&&this.FnGetEcsPrice(),"net_set"===e)return void this.netSet("batch");if("update_spec"===e){let e=this.multiple_selection.some(e=>"3"==e.billing_method);if(e)return void this.$message.warning("已选实例存在竞价实例，不支持更换实例规格操作！")}}else if(!this.FnJudgeCustomer(t,e))return;this.operate_title=t.label,this.show_operate_dialog=!0,this.default_operate_type=e,this.FnClearTimer()}FnJudgeCustomer(e,t){this.customer_id="";let s=!0;this.multiple_selection_id=[];for(let i=0;i<this.multiple_selection.length;i++){let a=this.multiple_selection[i];if(this.multiple_selection_id.push(a.ecs_id),0===i&&(this.customer_id=a.customer_id,this.is_gpu=Number(a.is_gpu)),a.customer_id!==this.customer_id){this.$message.warning("只允许对同一客户的实例进行批量操作！"),s=!1;break}if(["recover_ecs"].indexOf(t)>=0&&a.is_gpu!=this.is_gpu){this.$message.warning(`只允许对同一类型实例进行批量${e.label}操作！`),s=!1;break}if(e.auth.indexOf(a.status)<0){this.$message.warning(e.msg),s=!1;break}}return s}FnJudegCustomerAz(e,t){this.customer_id="",this.az_id="",this.billing_method="0",this.origin_disk_size=0,this.support_gpu_driver="",this.spec_family_id="",this.system_disk_feature="",this.os_type="";let s=!0;this.multiple_selection_id=[];for(let i=0;i<this.multiple_selection.length;i++){let a=this.multiple_selection[i];if(this.multiple_selection_id.push(a.ecs_id),0===i&&(this.customer_id=a.customer_id,this.az_id=a.az_id,this.billing_method=a.billing_method,this.is_gpu=Number(a.is_gpu),this.support_gpu_driver=a.support_gpu_driver,this.spec_family_id=a.spec_family_id,this.os_type=a.os_type,this.system_disk_feature=a.system_disk_feature),a.customer_id!==this.customer_id||a.az_id!==this.az_id){this.$message.warning("只允许对同一客户的同一可用区下实例进行批量操作！"),s=!1;break}if(["update_spec","update_system"].indexOf(t)>=0&&(a.is_gpu!=this.is_gpu||a.billing_method!==this.billing_method)){this.$message.warning(`只允许对同一类型同一计费方式实例进行批量${e.label}操作！`),s=!1;break}if("open_bill"===t&&a.is_charge){this.$message.warning("只允许对未开启计费的实例开启计费！"),s=!1;break}if("update_system"===t&&a.support_gpu_driver!=this.support_gpu_driver){this.$message.warning(`只允许对同一驱动类型实例进行批量${e.label}操作！`),s=!1;break}if("update_system"===t&&a.spec_family_id!=this.spec_family_id){this.$message.warning(`只允许对同一规格族实例进行批量${e.label}操作！`),s=!1;break}if("update_system"===t&&a.os_type!=this.os_type){this.$message.warning("Windows和linux系统不可以互换重装！"),s=!1;break}if("update_system"===t&&("local"===this.system_disk_feature&&"local"!==a.system_disk_feature||"local"!==this.system_disk_feature&&"local"===a.system_disk_feature)){this.$message.warning("只允许对同一类型盘实例"+e.label),s=!1;break}if("update_spec"===t&&this.is_gpu){this.$message.warning(`不允许对GPU实例${e.label}操作！`),s=!1;break}if("update_spec"===t&&a.system_disk_feature!=this.system_disk_feature){this.$message.warning("只允许对同一存储类型下实例更换实例规格"),s=!1;break}if(["update_spec","update_system"].includes(t)&&a.no_charge_shutdown_ecs){this.$message.warning(`不允许对关机不计费的实例${e.label}操作！`),s=!1;break}if(e.auth.indexOf(a.status)<0){this.$message.warning(e.msg),s=!1;break}this.origin_disk_size=Math.max(this.origin_disk_size,a.system_disk_size)}return s}FnConfirm(){if("recover_ecs"===this.default_operate_type)return void this.$refs.recover.FnRecover();const e={op_type:this.default_operate_type,customer_id:this.customer_id,az_id:this.az_id,ecs_ids:this.multiple_selection_id};["start_up_ecs","shutdown_ecs","restart_ecs"].indexOf(this.default_operate_type)>=0?this.FnPowerOperate(e):"delete_ecs"===this.default_operate_type?this.FnDelete(e):"destroy_ecs"===this.default_operate_type?this.FnDestroy(e):"reset_pwd"===this.default_operate_type?this.FnResetPwd(e):"update_spec"===this.default_operate_type?this.FnUpdateSpec(e):"update_system"===this.default_operate_type?this.FnUpdateSystem(e):"open_bill"===this.default_operate_type?this.FnOpenBill(Object.assign({billing_method:this.billing_method},e)):"operateGpu"===this.default_operate_type&&this.mount_gpu_card()}async mount_gpu_card(){if("ecs_detach_gpu_card"===this.gpu_card_operate&&"deleted"===this.multiple_selection[0].status)return void this.$message.warning("不支持对已删除的云服务器进行卸载显卡操作");let e=await d["a"].mount_gpu_card({ecs_id:this.multiple_selection[0].ecs_id,customer_id:this.multiple_selection[0].customer_id,event_type:this.gpu_card_operate});"Success"==e.code&&(this.$message.success(e.message),this.FnClose())}async FnPowerOperate(e){"restart_ecs"===this.default_operate_type&&(e.op_type=this.restart_ecs_type),"shutdown_ecs"===this.default_operate_type&&(e.op_type=this.shutdown_ecs_type);const t=await d["a"].operate_instance(e);"Success"==t.code&&(this.$message.success(t.msg||`成功下发 ${this.operate_title} 任务！`),this.FnClose())}netSet(e,t={}){"single"===e&&(this.multiple_selection=[t]),this.net_visible=!0}async operateGpu(e){let{ecs_id:t}=e;const s=await d["a"].update_gpu_status({ecs_id:t});"Success"===s.code&&this.FnGetGraphics(t)}async FnDelete(e){const t=await d["a"].delete_instance(Object.assign({is_gpu:this.is_gpu},e));"Success"==t.code&&(this.$message.success(t.msg||`成功下发 ${this.operate_title} 任务！`),this.FnClose())}async FnDestroy(e){const t=await d["a"].destroy_instance(Object.assign({is_gpu:this.is_gpu},e));"Success"==t.code&&(this.$message.success(t.msg||`成功下发 ${this.operate_title} 任务！`),this.page_info.page_index=1,this.FnClose())}async FnResetPwd(e){let t=this.$refs.reset_pwd.FnSubmit();if(t.flag){e.password=t.password;let s=await d["a"].reset_password(e);"Success"===s.code&&this.$message.success(s.msg||`成功下发 ${this.operate_title} 任务！`),this.FnClose()}}async FnChangeSpec(e){if(""===this.billing_method)return;let t={customer_id:this.customer_id,az_id:this.az_id,billing_method:this.billing_method||"0",ecs_ids:this.multiple_selection_id,is_gpu:this.is_gpu,ecs_goods_info:{cpu:e.cpu,ram:e.ram,gpu:e.gpu},billing_info:e.billing_info[e.ecs_goods_id]};const s=await d["a"].change_config_price(t);"Success"===s.code&&(this.total_price=s.data.price_symbol+s.data.total_price.toFixed(2)+"/"+s.data.price_unit)}async FnUpdateSpec(e){let t=this.$refs.update_spec.FnSubmit();if(t.flag){e.ecs_list=t.spec_info.ecs_list,e.billing_info=t.spec_info.billing_info[t.spec_info.ecs_goods_id],e.ecs_info={ecs_family_name:t.spec_info.ecs_goods_name,cpu:t.spec_info.cpu,gpu:t.spec_info.gpu,ram:t.spec_info.ram,spec_id:t.spec_info.spec_id,ecs_goods_id:t.spec_info.ecs_goods_id,spec_family_id:t.spec_info.spec_family_id,cpu_name:t.spec_info.cpu_model,gpu_card_name:t.spec_info.gpu_card_name,gpu_type_id:t.spec_info.gpu_id,cpu_real_name:t.spec_info.cpu_real_name};let s=await d["a"].update_spec(e);"Success"===s.code&&this.$message.success(s.msg||`成功下发 ${this.operate_title} 任务！`),this.FnClose()}}FnGetOsInfo(e){this.os_info=e}FnGetDiskBillingInfo(e){this.disk_billing_info=e}async FnChangeSystem(e){if(""===this.billing_method)return;let t={customer_id:this.customer_id,az_id:this.az_id,billing_method:this.billing_method||"0",is_gpu:this.is_gpu,ecs_ids:this.multiple_selection_id,ebs_goods_info:{},billing_info:this.disk_billing_info[e.ecs_goods_id]};"local"===e.disk_feature?(t.ebs_goods_info["local_disk-IOPS"]=e.iops,t.ebs_goods_info["local_disk-space"]=e.storage_space,t.ebs_goods_info["local_disk-throughput"]=e.handling_capacity):(t.ebs_goods_info["iops"]=e.iops,t.ebs_goods_info["storage_space"]=e.storage_space,t.ebs_goods_info["handling_capacity"]=e.handling_capacity);const s=await d["a"].change_system_price(t);"Success"===s.code&&("0"===this.billing_method?this.total_price=s.data.price_symbol+s.data.total_price.toFixed(2)+"/"+s.data.price_unit:this.total_price=s.data.price_symbol+s.data.total_price.toFixed(2))}async FnUpdateSystem(e){let t=this.$refs.update_os.FnSubmit(),s=this.$refs.update_disk.FnSubmit(),i=this.$refs.reset_pwd.FnSubmit();if(t.flag&&s.flag&&i.flag){var a;e.os_id=t.os_info.os_id,e.os_type=t.os_info.os_type,e.username=t.os_info.username,e.billing_method=this.billing_method,e.disk_info={system_disk:{ecs_goods_id:s.system_disk.ecs_goods_id,ebs_goods_id:s.system_disk.ecs_goods_id,gic_goods_id:null===(a=this.disk_billing_info[s.system_disk.ecs_goods_id])||void 0===a?void 0:a.gic_goods_id,goods_name:s.system_disk.disk_name,disk_feature:s.system_disk.disk_feature,disk_type:s.system_disk.disk_type,disk_size:s.system_disk.disk_size,storage_space:s.system_disk.disk_size,handling_capacity:s.system_disk.handling_capacity,iops:s.system_disk.iops,is_follow_delete:s.system_disk.is_follow_delete,origin_disk_size:this.origin_disk_size}},"local"===s.system_disk.disk_feature&&(e.disk_info.system_disk["local_disk-IOPS"]=e.disk_info.system_disk["iops"],e.disk_info.system_disk["local_disk-space"]=e.disk_info.system_disk["storage_space"],e.disk_info.system_disk["local_disk-throughput"]=e.disk_info.system_disk["handling_capacity"]),e.password=i.password,e.billing_info=this.disk_billing_info,e.is_gpu=this.is_gpu;let o=await d["a"].update_system(e);"Success"===o.code&&this.$message.success(o.msg||`成功下发 ${this.operate_title} 任务！`),this.FnClose()}}async FnGetEcsPrice(){this.ecs_list_price={};const e=await d["a"].each_resource_price({customer_id:this.customer_id,az_id:this.az_id,billing_method:"0",resource_ids:this.multiple_selection_id,resource_type:"ecs"});if("Success"===e.code)for(let t in e.data.total_price)this.$set(this.ecs_list_price,t,e.data.price_symbol+e.data.total_price[t].toFixed(2)+"/"+e.data.price_unit)}async FnOpenBill(e){let t={resource_ids:e.ecs_ids,customer_id:e.customer_id,billing_method:e.billing_method||"0",resource_type:"ecs"};const s=await d["a"].start_charge(t);"Success"===s.code&&this.$message.success("成功开启计费！"),this.FnClose()}async FnToVnc(e){let t=await d["a"].get_vnc_url({ecs_id:e});if("Success"===t.code){let s=t.data.vnc_info.split("/vnc_lite.html"),i=`${s[0]}/vnc_lite.html?op-token=${this.$store.state.token}?path=/?id=${e}`;window.open(i)}}addCommon(e){this.FnClearTimer(),this.ecs_info=e,this.common_visible=!0}watch_common_visible(e){e||this.FnGetList()}watch_net_visible(e){e||this.FnGetList()}FnClose(){this.show_operate_dialog=!1,this.default_operate_type="",this.total_price="",this.gpu_card_operate="",this.FnGetList()}FnToDetail(e){this.detail_id=e,this.detail_visible=!0}FnToRecord(e){this.record_id=e,this.record_visible=!0}FnToMonitor(e){this.$router.push("/instance/monitor/"+e)}closeRecord(){this.record_visible=!1}closeDetail(){this.detail_visible=!1}FnSetTimer(){this.timer&&this.FnClearTimer(),this.timer=setTimeout(()=>{this.FnGetList(!1)},5e3)}FnClearTimer(){this.timer&&clearTimeout(this.timer)}async FnGetStatus(){const e=await d["a"].get_status_list();if("Success"===e.code){this.ecs_status_list=[];for(let t in e.data)"destroy"!==t&&this.ecs_status_list.push({text:e.data[t],value:t});this.$route.query.host_id||this.FnSearch()}}async get_az_list(){const e=await u["a"].get_region_az_list({employee_no:this.$store.state.employee_no,user_name:this.$store.state.login_name});"Success"===e.code&&e.data.forEach(e=>{e.region_list.forEach(e=>{})})}async FnGetCateGoryList(){const e=await d["a"].get_family_data();"Success"===e.code&&(this.ecs_goods_name_list=e.data.spec_family_list.map(e=>({value:e.spec_family_id,text:e.name})))}async FnExport(){this.loading=!0;let e=this.search_ecs_goods_name.map(e=>e.toString()),t=Object.assign({billing_method:""==this.search_billing_method?"no":this.search_billing_method,op_source:this.search_op_source,spec_family_ids:e,product_source:this.search_product_source},this.search_reqData);const s=await d["a"].export_list(t);if(s){this.loading=!1;let e=new Blob([s],{type:"application/octet-stream"}),t=new FileReader,i="云服务器-"+S["a"].get("pod_name")+"-"+j()(new Date).format("YYYYMMDD");t.readAsText(e,"utf-8"),t.onload=()=>{let t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download=i+".xlsx",t.click(),window.URL.revokeObjectURL(t.href)}}}created(){this.operate_auth=this.$store.state.auth_info[this.$route.name],this.FnGetStatus(),this.get_az_list(),this.get_source_type(),this.FnGetTag(),this.FnGetCateGoryList();for(let e in this.billing_method_relation)this.billing_method_list.push({value:e,text:this.billing_method_relation[e]})}beforeDestroy(){this.FnClearTimer(),this.isComponentDestroying=!0}handleEnableChange(e){this.enable_change=e}};Object(o["a"])([Object(r["f"])("$store.state.pod_id")],T.prototype,"watch_pod",null),Object(o["a"])([Object(r["f"])("common_visible")],T.prototype,"watch_common_visible",null),Object(o["a"])([Object(r["f"])("net_visible")],T.prototype,"watch_net_visible",null),T=Object(o["a"])([Object(r["a"])({components:{RescueMode:x["a"],LabelBlock:n["a"],actionBlock:_["a"],Record:h["a"],Detail:m["a"],resetPwd:b["a"],updateSpec:f["a"],updateOs:g["a"],updateDisk:v["a"],Recover:y["a"],SvgIcon:c["a"],MarkTip:w["a"],AddCommon:O["a"],netSet:C["a"]}})],T);var F=T,P=F,z=(s("1163"),s("f847"),s("2877")),$=Object(z["a"])(P,i,a,!1,null,"25cb24f7",null);t["default"]=$.exports},"62df":function(e,t,s){},"6e78":function(e,t,s){"use strict";s("2f5d")},"6f19":function(e,t,s){"use strict";var i=s("9112"),a=s("0d26"),o=s("b980"),r=Error.captureStackTrace;e.exports=function(e,t,s,n){o&&(r?r(e,t):i(e,"stack",a(s,n)))}},7156:function(e,t,s){"use strict";var i=s("1626"),a=s("861d"),o=s("d2bb");e.exports=function(e,t,s){var r,n;return o&&i(r=t.constructor)&&r!==s&&a(n=r.prototype)&&n!==s.prototype&&o(e,n),e}},7282:function(e,t,s){"use strict";var i=s("e330"),a=s("59ed");e.exports=function(e,t,s){try{return i(a(Object.getOwnPropertyDescriptor(e,t)[s]))}catch(o){}}},"74c5":function(e,t,s){"use strict";s("2dc0")},"76ff":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("el-dialog",{attrs:{title:"配置详情",visible:e.visible,width:"60%","destroy-on-close":!0},on:{"update:visible":function(t){e.visible=t},close:e.back}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:10}},[t("span",{staticClass:"label"},[e._v("云服务器ID:")]),t("span",[e._v(e._s(e.detail&&e.detail.ecs_id))])]),t("el-col",{attrs:{span:10}},[t("span",{staticClass:"label"},[e._v("地域:")]),t("span",[e._v(e._s(e.detail&&e.detail.region_name))])])],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"name-row",attrs:{span:10}},[t("span",{staticClass:"label"},[e._v("云服务器名称:")]),t("span",[t("pre",[e._v(e._s(e.detail&&e.detail.ecs_name))])])]),t("el-col",{attrs:{span:10}},[t("span",{staticClass:"label"},[e._v("可用区:")]),t("span",[e._v(e._s(e.detail&&e.detail.az_name))])])],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:10}},[t("span",{staticClass:"label"},[e._v("状态:")]),t("span",[e._v(e._s(e.detail&&e.detail.status_display))])])],1),t("div",{staticClass:"title"},[e._v("计算规格")]),t("el-row",{attrs:{gutter:20}},[e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name?t("el-col",{attrs:{span:20}},[t("span",{staticClass:"label"},[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name)+":")]),t("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.name))]),e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num?t("span",[e._v("   "+e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num)+"vCPU "),t("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.ram)+"GiB")]),e.detail&&e.detail.is_gpu?t("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.gpu)+"*"+e._s(e.detail&&e.detail.card_name))]):e._e()]):e._e()]):e._e()],1),t("div",{staticClass:"title"},[e._v("操作系统")]),t("div",{staticClass:"content"},[e._v(e._s(e.detail&&e.detail.os_info&&e.detail.os_info.name))]),t("div",{staticClass:"title"},[e._v("存储")]),t("div",{staticClass:"content"},[t("span",{staticClass:"label"},[e._v("系统盘：")]),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf?t("span",{staticClass:"data-disk"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.disk_name))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size?t("span",{staticClass:"data-disk-unit"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size)+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.unit))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id?t("span",{staticClass:"id_name"},[e._v("("+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id)+" / "+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.name)+")")]):e._e()]),t("div",{staticClass:"content data_disk"},[t("span",{staticClass:"label"},[e._v("数据盘：")]),e.detail&&e.detail.disk&&e.detail.disk.data_disk_conf?t("div",{staticClass:"disk_content"},e._l(e.detail.disk.data_disk_conf,(function(s){return t("div",{key:s.id},[t("span",{staticClass:"data-disk"},[e._v(e._s(s.disk_name))]),t("span",{staticClass:"data-disk-unit"},[e._v(e._s(s.size)+e._s(s.unit))]),t("span",{staticClass:"id_name"},[e._v("("+e._s(s.id)+" / "+e._s(s.name)+")")]),t("span",[e._v(e._s(s.is_follow_delete?"随实例删除":"不随实例删除"))])])})),0):e._e()]),t("div",{staticClass:"title"},[e._v("网络")]),t("div",{staticClass:"content"},[t("span",{staticClass:"label"},[e._v("VPC:")]),e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id?t("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_name))]):e._e()]),t("div",{staticClass:"content"},[t("span",{staticClass:"label"},[e._v("子网:")]),e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id?t("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_name))]):e._e()]),t("div",{staticClass:"content display-flex"},[t("span",{staticClass:"label"},[e._v("私网IP：")]),e.detail&&e.detail.pipe?t("span",[e.detail.pipe.private_net?[e._v(e._s(e.detail.pipe.private_net)+" （主）")]:e._e(),t("br"),e.detail.pipe.pub_net?[e._v(" "+e._s(e.detail.pipe.pub_net)+" "),e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） ")]:e._e(),t("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(s){return t("span",{key:s},[e._v(" "+e._s(s)+" "),e.detail.pipe.eip_info[s]&&e.detail.pipe.eip_info[s].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[s].conf_name)+"） ")]:e._e(),t("br")],2)}))],2):e._e()]),t("div",{staticClass:"content display-flex"},[t("span",{staticClass:"label"},[e._v("公网IP：")]),e.detail&&e.detail.pipe?t("span",[e.detail.pipe.pub_net&&e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip?[e._v(" "+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip)+" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） "),t("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(s){return t("span",{key:s},[e.detail.pipe.eip_info[s]&&e.detail.pipe.eip_info[s].conf_name?[e._v(" "+e._s(s.eip_ip)+" （"+e._s(e.detail.pipe.eip_info[s].conf_name)+"） ")]:e._e(),t("br")],2)}))],2):e._e()]),t("div",{staticClass:"divider"}),t("div",{staticClass:"content"},[t("span",{staticClass:"label"},[e._v("所属机房:")]),t("span",[e._v(e._s(e.detail&&e.detail.engine_room))])]),t("div",{staticClass:"content"},[t("span",{staticClass:"label"},[e._v("所属节点:")]),t("span",[e._v(e._s(e.detail&&e.detail.host_name))])]),t("div",{staticClass:"content"},[t("span",{staticClass:"label"},[e._v("所属物理机:")]),e.detail&&e.detail.host_id?t("span",[e._v(e._s(e.detail&&e.detail.host_id)+"   "),e.detail&&e.detail.host_status?t("span",[e._v("( "+e._s(e.detail&&e.detail.host_status)+" )")]):e._e()]):e._e()]),t("div",{staticClass:"content"},[t("span",{staticClass:"label"},[e._v("处理器型号:")]),t("span",[e._v(e._s(e.detail&&e.detail.cpu_type))])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},a=[],o=s("9ab4"),r=s("1b40"),n=s("d772");let _=class extends r["e"]{constructor(){super(...arguments),this.detail=null,this.loading=!1}async getDetail(){let e=await n["a"].get_detail({ecs_id:this.detail_id});"Success"===e.code?(this.loading=!1,this.detail=e.data):this.loading=!1}back(){}created(){this.getDetail()}};Object(o["a"])([Object(r["c"])(Boolean)],_.prototype,"visible",void 0),Object(o["a"])([Object(r["c"])(String)],_.prototype,"detail_id",void 0),Object(o["a"])([Object(r["b"])("close-detail")],_.prototype,"back",null),_=Object(o["a"])([r["a"]],_);var c=_,l=c,d=(s("88bb"),s("2877")),u=Object(d["a"])(l,i,a,!1,null,"33b12e64",null);t["a"]=u.exports},"81b2":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("el-dialog",{attrs:{title:"进入救援模式",visible:e.visibleSync,width:"700px","destroy-on-close":!0},on:{"update:visible":function(t){e.visibleSync=t}}},[t("div",{staticClass:"tip_box"},[t("div",[e._v("1. 进入救援模式需要在实例关机状态下进行，建议主动关机，强制关机可能会造成数据丢失或文件损坏")]),t("div",[e._v("2. Linux系统的实例默认使用Ubuntu22.04的引导文件，Windows系统默认使用Windows 10的引导文件")]),t("div",[e._v("3. 处于救援模式的实例不能执行开关机操作")]),t("div",[e._v("4. 退出救援模式后，实例恢复到进入救援模式之前的状态。")])]),t("div",[t("el-form",{ref:"form",staticClass:"m-top10",attrs:{model:e.os_data,"label-width":"100px","label-position":"left"}},[t("el-form-item",{attrs:{label:"镜像:"}},[t("el-select",{staticClass:"m-r-12",on:{change:e.changeOsType},model:{value:e.os_data.os_type,callback:function(t){e.$set(e.os_data,"os_type",t)},expression:"os_data.os_type"}},e._l(e.image_type,(function(e){return t("el-option",{key:e,attrs:{value:e}})})),1),t("el-select",{staticClass:"m-left10",on:{change:e.changeOsType},model:{value:e.os_data.os_id,callback:function(t){e.$set(e.os_data,"os_id",t)},expression:"os_data.os_id"}},e._l(e.image_type_list,(function(e){return t("el-option",{key:e.os_id,attrs:{value:e.os_id,label:e.display_name}})})),1)],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"danger"},on:{click:e.confirm}},[e._v("进入救援模式")]),t("el-button",{attrs:{type:"default"},on:{click:function(t){e.visibleSync=!1}}},[e._v("取消")])],1)])],1)},a=[],o=(s("e9f5"),s("910d"),s("9ab4")),r=s("1b40"),n=s("e527");let _=class extends r["e"]{constructor(){super(...arguments),this.os_data={os_type:"",os_id:""},this.image_type=[],this.image_list=[],this.image_type_list=[]}created(){this.FnGetImage()}async FnGetImage(){let e=await n["a"].get_rescue_image_list({pod_id:this.$store.state.pod_id,ecs_id:this.ecs_id});"Success"===e.code&&(this.image_type=e.data.image_types,this.image_list=e.data.image_list,this.os_data.os_type=this.image_type[0],this.FnInitImageList())}changeOsType(){this.FnInitImageList()}FnInitImageList(){this.image_type_list=this.image_list.filter(e=>e.os_type===this.os_data.os_type),this.os_data.os_id=this.image_type_list[0].os_id}async confirm(){let e={customer_id:this.customer_id,ecs_id:this.ecs_id,os_id:this.os_data.os_id},t=await n["a"].enter_rescue(e);"Success"===t.code&&(this.$message.success(t.message),this.visibleSync=!1)}};Object(o["a"])([Object(r["d"])("visible")],_.prototype,"visibleSync",void 0),Object(o["a"])([Object(r["c"])(String)],_.prototype,"ecs_id",void 0),Object(o["a"])([Object(r["c"])(String)],_.prototype,"customer_id",void 0),_=Object(o["a"])([r["a"]],_);var c=_,l=c,d=(s("acc5"),s("2877")),u=Object(d["a"])(l,i,a,!1,null,"c2059ba4",null);t["a"]=u.exports},"88bb":function(e,t,s){"use strict";s("d9aa")},"8ee3":function(e,t,s){},"8ff0":function(e,t,s){},9409:function(e,t,s){},"98c9":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"box"},[t("div",{staticClass:"left-label",class:{"is-required":e.is_required}},[e._v(e._s(e.label))]),t("div",{staticClass:"right-content"},[e._t("default")],2)])},a=[],o=s("9ab4"),r=s("1b40");let n=class extends r["e"]{};Object(o["a"])([Object(r["c"])({default:""})],n.prototype,"label",void 0),Object(o["a"])([Object(r["c"])({default:!1})],n.prototype,"is_required",void 0),n=Object(o["a"])([Object(r["a"])({})],n);var _=n,c=_,l=(s("ca9f"),s("2877")),d=Object(l["a"])(c,i,a,!1,null,"3b58a324",null);t["a"]=d.exports},ab36:function(e,t,s){"use strict";var i=s("861d"),a=s("9112");e.exports=function(e,t){i(t)&&"cause"in t&&a(e,"cause",t.cause)}},ab43:function(e,t,s){"use strict";var i=s("23e7"),a=s("c65b"),o=s("59ed"),r=s("825a"),n=s("46c4"),_=s("c5cc"),c=s("9bdd"),l=s("2a62"),d=s("2baa"),u=s("f99f"),p=s("c430"),h=!p&&!d("map",(function(){})),m=!p&&!h&&u("map",TypeError),b=p||h||m,f=_((function(){var e=this.iterator,t=r(a(this.next,e)),s=this.done=!!t.done;if(!s)return c(e,this.mapper,[t.value,this.counter++],!0)}));i({target:"Iterator",proto:!0,real:!0,forced:b},{map:function(e){r(this);try{o(e)}catch(t){l(this,"throw",t)}return m?a(m,this,e):new f(n(this),{mapper:e})}})},acc5:function(e,t,s){"use strict";s("8ff0")},aeb0:function(e,t,s){"use strict";var i=s("9bf2").f;e.exports=function(e,t,s){s in e||i(e,s,{configurable:!0,get:function(){return t[s]},set:function(e){t[s]=e}})}},b980:function(e,t,s){"use strict";var i=s("d039"),a=s("5c6c");e.exports=!i((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",a(1,7)),7!==e.stack)}))},bad9:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"customer"},[t("el-select",{attrs:{multiple:"",placeholder:"输入关键字可进行搜索",filterable:"",remote:"","remote-method":e.getCustomerList},on:{"visible-change":e.changeCustomer},model:{value:e.customer_id,callback:function(t){e.customer_id=t},expression:"customer_id"}},e._l(e.customerList,(function(s){return t("el-option",{key:s.id,attrs:{value:s.id,label:`${s.id}(${s.name})`}},[e._v(e._s(`${s.id}(${s.name})`))])})),1)],1)},a=[],o=(s("e9f5"),s("ab43"),s("9ab4")),r=s("1b40"),n=s("1477");let _=class extends r["e"]{constructor(){super(...arguments),this.customer_id=[],this.customerList=[],this.flag=!0}created(){this.customerList=[...this.list],this.customer_id=this.customers,this.getDefaultCustomerList()}changeCustomer(e){e&&(this.customerList=[])}async getDefaultCustomerList(){if(this.list.length>0)return;let e=await n["a"].getCustomerList({host_ids:this.rows.map(e=>e.host_id),customer_ids:Array.isArray(this.customer_id)?this.customer_id:[]});"Success"==e.code&&(this.customerList=e.data.customer_list)}async getCustomerList(e="",t=!1){if(!e&&!t)return;let s=await n["a"].getCustomerList({host_ids:this.rows.map(e=>e.host_id),customer_id:e});"Success"==s.code&&(this.customerList=s.data.customer_list)}watch_customer_id(){this.FnCustomer()}FnCustomer(){return this.customer_id}};Object(o["a"])([Object(r["c"])({default:()=>[]})],_.prototype,"customers",void 0),Object(o["a"])([Object(r["c"])({default:()=>[]})],_.prototype,"rows",void 0),Object(o["a"])([Object(r["c"])({default:()=>[]})],_.prototype,"list",void 0),Object(o["a"])([Object(r["f"])("customer_id",{immediate:!0,deep:!0})],_.prototype,"watch_customer_id",null),Object(o["a"])([Object(r["b"])("FnCustomer")],_.prototype,"FnCustomer",null),_=Object(o["a"])([Object(r["a"])({})],_);var c=_,l=c,d=(s("fb2b"),s("2877")),u=Object(d["a"])(l,i,a,!1,null,null,null);t["a"]=u.exports},ca9f:function(e,t,s){"use strict";s("da48")},ce0f:function(e,t,s){},d2bb:function(e,t,s){"use strict";var i=s("7282"),a=s("861d"),o=s("1d80"),r=s("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,s={};try{e=i(Object.prototype,"__proto__","set"),e(s,[]),t=s instanceof Array}catch(n){}return function(s,i){return o(s),r(i),a(s)?(t?e(s,i):s.__proto__=i,s):s}}():void 0)},d772:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_operate_record_list(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/history_record/",e))},get_detail(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_ecs_detail/",e))}}},d9aa:function(e,t,s){},d9e2:function(e,t,s){"use strict";var i=s("23e7"),a=s("cfe9"),o=s("2ba4"),r=s("e5cb"),n="WebAssembly",_=a[n],c=7!==new Error("e",{cause:7}).cause,l=function(e,t){var s={};s[e]=r(e,t,c),i({global:!0,constructor:!0,arity:1,forced:c},s)},d=function(e,t){if(_&&_[e]){var s={};s[e]=r(n+"."+e,t,c),i({target:n,stat:!0,constructor:!0,arity:1,forced:c},s)}};l("Error",(function(e){return function(t){return o(e,this,arguments)}})),l("EvalError",(function(e){return function(t){return o(e,this,arguments)}})),l("RangeError",(function(e){return function(t){return o(e,this,arguments)}})),l("ReferenceError",(function(e){return function(t){return o(e,this,arguments)}})),l("SyntaxError",(function(e){return function(t){return o(e,this,arguments)}})),l("TypeError",(function(e){return function(t){return o(e,this,arguments)}})),l("URIError",(function(e){return function(t){return o(e,this,arguments)}})),d("CompileError",(function(e){return function(t){return o(e,this,arguments)}})),d("LinkError",(function(e){return function(t){return o(e,this,arguments)}})),d("RuntimeError",(function(e){return function(t){return o(e,this,arguments)}}))},da48:function(e,t,s){},e03a:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("el-dialog",{attrs:{title:"网络设置",visible:e.visibleSync,width:"60%","destroy-on-close":!0},on:{"update:visible":function(t){e.visibleSync=t}}},[t("el-alert",{attrs:{title:"注：若批量选中实例，将以填写的私有IP地址为起始IP地址，依次配置至各实例中。",type:"warning",closable:!1,center:""}}),t("el-table",{attrs:{data:e.list}},[t("el-table-column",{attrs:{prop:"vlan",label:"VLAN"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-input",{attrs:{oninput:"value = value.replace(/^(0+)|[^\\d]+/g,'')"},model:{value:s.row.vlan_id,callback:function(t){e.$set(s.row,"vlan_id",t)},expression:"scope.row.vlan_id"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.judge("vlan",s.row.vlan_id),expression:"!judge('vlan',scope.row.vlan_id)"}],staticClass:"error_message"},[e._v("vlan需为大于0的数字")])]}}])}),t("el-table-column",{attrs:{prop:"ip",label:"IP地址"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-input",{model:{value:s.row.ip_address,callback:function(t){e.$set(s.row,"ip_address",t)},expression:"scope.row.ip_address"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.judge("ip",s.row.ip_address),expression:"!judge('ip',scope.row.ip_address)"}],staticClass:"error_message"},[e._v("ip地址格式不正确")])]}}])}),t("el-table-column",{attrs:{prop:"subnet",label:"子网掩码"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-input",{attrs:{oninput:"value = value.replace(/^(0+)|[^\\d]+/g,'')"},model:{value:s.row.mask,callback:function(t){e.$set(s.row,"mask",t)},expression:"scope.row.mask"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.judge("subnet",s.row.mask),expression:"!judge('subnet',scope.row.mask)"}],staticClass:"error_message"},[e._v("子网掩码范围为1-32")])]}}])}),t("el-table-column",{attrs:{prop:"operate",label:""},scopedSlots:e._u([{key:"default",fn:function(s){return[t("i",{staticClass:"el-icon-remove-outline delete-icon",on:{click:function(t){return e.del(s.$index)}}})]}}])})],1),t("div",{staticClass:"m-top10"},[t("el-button",{attrs:{type:"text",disabled:5===e.list.length},on:{click:e.add}},[t("i",{staticClass:"el-icon-circle-plus"}),e._v(" 添加网卡")])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")]),t("el-button",{attrs:{type:"default"},on:{click:function(t){e.visibleSync=!1}}},[e._v("取消")])],1)],1)],1)},a=[],o=(s("14d9"),s("e9f5"),s("910d"),s("ab43"),s("9ab4")),r=s("1b40"),n=s("e527");let _=class extends r["e"]{constructor(){super(...arguments),this.list=[],this.dnsObj={main:"",slave:""}}created(){1===this.ecs_list.length?this.ecs_list[0].base_nic_info.length>0&&this.ecs_list[0].base_nic_info.map(e=>(this.list.push({netcard_id:e.netcard_id,vlan_id:e.vlan_id,ip_address:e.ip_address,mask:e.mask}),e)):this.list=[{netcard_id:"",vlan_id:"",ip_address:"",mask:""}]}async get_default_dns(){let e=await n["a"].get_default_dns({ecs_ids:this.ecs_list.map(e=>e.ecs_id)});"Success"===e.code&&(this.dnsObj=e.data,this.ecs_list.length>1&&(this.list[0].mainDns=this.dnsObj.main,this.list[0].dns=this.dnsObj.slave))}add(){this.list.length>=5||this.list.push({netcard_id:"",vlan_id:"",ip_address:"",mask:""})}judge(e,t){if("vlan"===e)return Number(t)>0;if("ip"===e){let e=/^((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)$/;return t&&e.test(t)}return Number(t)>0&&Number(t)<=32}del(e){this.list=this.list.filter((t,s)=>s!==e)}async confirm(){let e={vlan_id:"vlan",ip_address:"ip",mask:"subnet"};for(let i in this.list)for(let t in this.list[i])if("netcard_id"!==t&&!this.judge(e[t],this.list[i][t]))return;let t=[];this.list.map(e=>{const{vlan_id:s,ip_address:i,mask:a,mainDns:o,dns:r,netcard_id:n}=e;t.push({netcard_id:n,vlan_id:Number(s),ip_address:i,mask:Number(a),gateway:"",dns:[]})});let s=await n["a"].set_net({ecs_ids:this.ecs_list.map(e=>e.ecs_id),base_nic_info:t});"Success"===s.code&&this.$message.success(s.message),this.visibleSync=!1}};Object(o["a"])([Object(r["d"])("visible")],_.prototype,"visibleSync",void 0),Object(o["a"])([Object(r["c"])({default:()=>[]})],_.prototype,"ecs_list",void 0),_=Object(o["a"])([r["a"]],_);var c=_,l=c,d=(s("6e78"),s("2877")),u=Object(d["a"])(l,i,a,!1,null,"0d4251ae",null);t["a"]=u.exports},e391:function(e,t,s){"use strict";var i=s("577e");e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:i(e)}},e4d0:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7");t["a"]={get_pub_mirror_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_pub_image_list/",e))},check_name(e){return Object(i["a"])(Object(a["b"])("POST","/img/name_check/",e))},get_mirror_type(e){return Object(i["a"])(Object(a["b"])("GET","/img/image_type/",e))},get_model_image_type(e){return Object(i["a"])(Object(a["b"])("GET","/img/model_image_type/",e))},add_pub_mirror(e){return Object(i["a"])(Object(a["b"])("GET","/img/create_pub_image/",e))},edit_pub_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/edit_image/",e))},change_status(e){return Object(i["a"])(Object(a["b"])("POST","/img/alter_image/",e))},del_pub_mirror_az(e){return Object(i["a"])(Object(a["b"])("POST","/img/delete_pub_image/",e))},del_pub_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/batch_delete_pub_image/",e))},get_pub_operate_record(e){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_operation_list/",e))},get_pub_sync_detail(e){return Object(i["a"])(Object(a["b"])("POST","/img/pub_image_info/",e))},sync_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/sync_pub_image/",e))},get_private_mirror_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_private_image_list/",e))},get_status_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/get_image_status_list/",e))},get_available_az(e){return Object(i["a"])(Object(a["b"])("POST","/img/get_available_az/",e))},get_disk_list(e){return Object(i["a"])(Object(a["b"])("GET","/img/backend_type/",e))},get_product_source(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_product_source/"))}}},e527:function(e,t,s){"use strict";var i=s("81a9"),a=s("bff7"),o=s("4328"),r=s.n(o);t["a"]={get_instance_list(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_list/",e))},operate_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/operate/",e))},delete_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/delete/",e))},recover_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/recover/",e))},destroy_instance(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/destroy/",e))},get_status_list(){return Object(i["a"])(Object(a["b"])("GET","/ecs/ecs_status_list/"))},get_family_data(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_family_data/"))},reset_password(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_reset_password/",e))},update_spec(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_configure/",e))},update_system(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_change_system/",e))},get_usage_ip(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_deleted_ecs_ip/",e))},get_vnc_url(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/vnc_info/",e))},start_charge(e){return Object(i["a"])(Object(a["b"])("POST","/resource/start_charge/",e))},change_config_price(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_config_price/",e))},change_system_price(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/change_system_price/",e))},each_resource_price(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/each_resource_price/",e))},add_common_mirror(e){return Object(i["a"])(Object(a["b"])("POST","/img/create_pub_image_by_ecs/",e))},set_net(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/ecs_set_base_nic/",e))},get_default_dns(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/az_default_dns/",e))},mount_gpu_card(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/instance_gpu_card/",e))},update_gpu_status(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/update_gpu_status/",e))},export_list(e){return Object(i["a"])({method:"GET",url:"/ecs_business/v1/ecs/ecs_list_download/",params:e,paramsSerializer:e=>r.a.stringify(e),responseType:"blob"})},get_tag_list(){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_tag_list/"))},get_rescue_image_list(e){return Object(i["a"])(Object(a["b"])("GET","/ecs/get_rescue_image_list/",e))},enter_rescue(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/enter_rescue/",e))},exit_rescue(e){return Object(i["a"])(Object(a["b"])("POST","/ecs/exit_rescue/",e))}}},e5cb:function(e,t,s){"use strict";var i=s("d066"),a=s("1a2d"),o=s("9112"),r=s("3a9b"),n=s("d2bb"),_=s("e893"),c=s("aeb0"),l=s("7156"),d=s("e391"),u=s("ab36"),p=s("6f19"),h=s("83ab"),m=s("c430");e.exports=function(e,t,s,b){var f="stackTraceLimit",g=b?2:1,v=e.split("."),y=v[v.length-1],w=i.apply(null,v);if(w){var O=w.prototype;if(!m&&a(O,"cause")&&delete O.cause,!s)return w;var k=i("Error"),j=t((function(e,t){var s=d(b?t:e,void 0),i=b?new w(e):new w;return void 0!==s&&o(i,"message",s),p(i,j,i.stack,2),this&&r(O,this)&&l(i,this,j),arguments.length>g&&u(i,arguments[g]),i}));if(j.prototype=O,"Error"!==y?n?n(j,k):_(j,k,{name:!0}):h&&f in w&&(c(j,w,f),c(j,w,"prepareStackTrace")),_(j,w),!m)try{O.name!==y&&o(O,"name",y),O.constructor=j}catch(S){}return j}}},f6ea:function(e,t,s){"use strict";s("62df")},f813:function(e,t,s){"use strict";s("9409")},f847:function(e,t,s){"use strict";s("ce0f")},fb2b:function(e,t,s){"use strict";s("8ee3")}}]);