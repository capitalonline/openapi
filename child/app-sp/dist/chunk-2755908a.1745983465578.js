(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-2755908a"],{"7fd2":function(e,t,a){"use strict";a("c826")},"9d75":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("action-block",{attrs:{search_option:e.search},on:{"fn-search":e.fn_search}}),a("time-group",{on:{"fn-emit":e.getTabTime}}),a("el-table",{ref:"table",staticClass:"event-table",attrs:{data:e.list,border:""},on:{"filter-change":e.fil_info,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"productType",label:"产品类型"}}),a("el-table-column",{attrs:{prop:"instanceID",label:"故障资源ID"}}),a("el-table-column",{attrs:{prop:"createTime",label:"发生时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.createTime?e.moment(t.row.createTime).format("YYYY-MM-DD HH:mm:ss"):"--"))])]}}])}),a("el-table-column",{attrs:{prop:"durationTime",label:"持续时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"m-right10"},[e._v(e._s(t.row.metricPeriodNum?t.row.metricPeriodNum+"个周期":"-"))]),a("span",[e._v(e._s(t.row.metricPeriod?60===t.row.metricPeriod?"1小时1周期":t.row.metricPeriod+"分钟1周期":"-"))])]}}])}),a("el-table-column",{attrs:{prop:"strategyName",label:"策略名称"}}),a("el-table-column",{attrs:{prop:"ruleName",label:"规则名称"}}),a("el-table-column",{attrs:{prop:"alarmType",label:"报警类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!==t.row.alarmType?a("span",[e._v(e._s("metric"===t.row.alarmType?"指标报警":"事件报警"))]):a("span",[e._v("--")])]}}])}),a("el-table-column",{attrs:{prop:"contactGroup",label:"通知对象"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.contactGroup.join(",")))]),a("i",{staticClass:"el-icon-document",on:{click:function(a){return e.view_contact(t.row.notyfyList)}}})]}}])}),a("el-table-column",{attrs:{prop:"alarmMethod",label:"通知方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(2===t.row.alarmMethod.length?"邮箱+短信":e.notice[t.row.alarmMethod[0]]))])]}}])}),a("el-table-column",{attrs:{prop:"dealStatus",label:"处理结果",filters:e.fil_list,"filter-multiple":!1,"filter-placement":"bottom-end","column-key":"dealStatus"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.dealStatus?"已处理":"未处理"))])]}}])}),a("el-table-column",{attrs:{prop:"action",label:"操作栏"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.detail(t.row)}}},[e._v("详情")]),a("el-button",{attrs:{type:"text",disabled:1===t.row.enable},on:{click:function(a){return e.shield(t.row)}}},[e._v("屏蔽")]),a("el-button",{attrs:{type:"text",disabled:!t.row.shieldID||0===t.row.enable},on:{click:function(a){return e.stopShield(t.row)}}},[e._v("停止屏蔽")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.visible?[a("notice-contact",{attrs:{visible:e.visible,list:e.notice_list},on:{"update:visible":function(t){e.visible=t}}})]:e._e(),e.operateVisible&&"detail"===e.operateType?[a("info-detail",{attrs:{visible:e.operateVisible,info:e.info},on:{"update:visible":function(t){e.operateVisible=t}}})]:e._e(),e.operateVisible&&"shield"===e.operateType?[a("info-shield",{attrs:{visible:e.operateVisible,info:e.info},on:{"update:visible":function(t){e.operateVisible=t}}})]:e._e(),a("right-click",{attrs:{multi_rows:e.multi_rows,menus:e.menus,name:e.multi_rows.length>0?e.multi_rows[0].instanceID:""},on:{"fn-click":e.infoClick}})],2)},n=[],l=a("5530"),s=a("1da1"),r=a("d4ec"),o=a("bee2"),c=a("262e"),u=a("2caf"),p=(a("96cf"),a("ac1f"),a("841c"),a("b0c0"),a("d3b7"),a("9ab4")),d=a("1b40"),m=a("c811"),h=a("1f82"),f=a("c1df"),b=a.n(f),v=a("2966"),y=a("8ce4"),_=a("5cb2"),g=a("18c0"),w=a("b520"),k=a("e8c0"),S=a("bd4d"),D=a("cf88"),T=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.notice={email:"邮箱",phone:"短信"},e.type_list=[{type:"metric",label:"指标报警"},{type:"event",label:"事件报警"}],e.search={ruleName:{placeholder:"请输入规则名称"},instanceID:{placeholder:"请输入资源ID"},type:{placeholder:"报警类型",list:e.type_list},contact:{placeholder:"报警联系人组",list:[]},strategyName:{placeholder:"请输入策略名称"}},e.authList=[],e.fil_list=[{text:"已处理",value:"1"},{text:"未处理",value:"0"}],e.list=[],e.current=1,e.size=20,e.total=0,e.moment=b.a,e.search_data={},e.dealStatus=[],e.visible=!1,e.operateVisible=!1,e.operateType="",e.notice_list=[],e.info={},e.multi_rows=[],e.menus=[{label:"详情",value:"infoDetail",single:!0,disabled:!1},{label:"屏蔽",value:"alarm_create",single:!0,disabled:!1},{label:"停止屏蔽",value:"stop",single:!0,disabled:!1}],e}return Object(o["a"])(a,[{key:"created",value:function(){this.getContactGroupList(),this.authList=this.$store.state.auth_info[this.$route.name]}},{key:"FnOperRow",value:function(e){this.$refs.table.toggleRowSelection(e)}},{key:"rowStyle",value:function(e){var t=e.row,a=this.multi_rows.some((function(e){return e.id===t.id}));if(a)return"rowStyle"}},{key:"FnRightClick",value:function(e,t,a){var i=this.multi_rows.some((function(t){return t.id===e.id}));i||this.$refs.table.toggleRowSelection(e),Object(k["a"])(e,t,a)}},{key:"infoClick",value:function(e){e.label;var t=e.value;"infoDetail"===t?this.detail(this.multi_rows[0]):"alarm_create"===t?this.shield(this.multi_rows[0]):this.stopShield(this.multi_rows[0]),Object(D["a"])()}},{key:"getContactGroupList",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,v["a"].get_contact_group_list({});case 2:t=e.sent,"Success"===t.code&&(this.search.contact.list=Object(y["e"])(t.data.datas,"name","id","label","type"));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSelectionChange",value:function(e){this.multi_rows=e}},{key:"getAlarmList",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.search_data,e.next=3,v["a"].get_alarm_list({ruleName:t.ruleName,instanceID:t.instanceID,alarmType:t.type,contactGroupName:t.contact,strategyName:t.strategyName,startTime:t.time?b()(t.time[0]).format("YYYY-MM-DD HH:mm:ss"):b()(new Date).format("YYYY-MM-DD 00:00:00"),endTime:t.time?b()(t.time[1]).format("YYYY-MM-DD HH:mm:ss"):b()(new Date).format("YYYY-MM-DD HH:mm:ss"),dealStatus:0===this.dealStatus.length?"":this.dealStatus[0],page:this.current,pageSize:this.size,clusterID:this.$route.params.id});case 3:a=e.sent,"Success"===a.code&&(this.list=a.data.datas||[],this.total=a.data.total||0);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"view_contact",value:function(e){this.visible=!0,this.notice_list=e}},{key:"fn_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.current=1,this.search_data=Object(l["a"])(Object(l["a"])({},this.search_data),e),this.getAlarmList()}},{key:"handleSizeChange",value:function(e){this.size=e,this.getAlarmList()}},{key:"handleCurrentChange",value:function(e){this.current=e,this.getAlarmList()}},{key:"getTabTime",value:function(e){this.search_data.time=e,this.getAlarmList()}},{key:"fil_info",value:function(e){this.dealStatus=e.dealStatus,this.current=1,this.getAlarmList()}},{key:"detail",value:function(e){this.info=e,this.operateType="detail",this.operateVisible=!0}},{key:"shield",value:function(e){this.info=e,this.operateType="shield",this.operateVisible=!0}},{key:"stopShield",value:function(e){var t=this,a=this.$createElement;this.$msgbox({title:"提示",message:a("p",null,[a("span",null,"确定停止 "),a("i",{style:"color: #455cc6"},"".concat(e.shieldName," ")),a("span",null," 屏蔽策略吗? ")]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(i){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,v["a"].shield_apply({ids:[e.shieldID],enable:0});case 2:n=a.sent,"Success"===n.code&&(t.$message.success(n.message),t.getAlarmList());case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}},{key:"watchOperateVisible",value:function(e){e||this.getAlarmList()}}]),a}(d["e"]);Object(p["a"])([Object(d["f"])("operateVisible")],T.prototype,"watchOperateVisible",null),T=Object(p["a"])([Object(d["a"])({components:{RightClick:S["a"],ActionBlock:m["a"],TimeGroup:h["a"],NoticeContact:_["a"],InfoDetail:g["a"],InfoShield:w["a"]}})],T);var x=T,Y=x,O=(a("7fd2"),a("2877")),j=Object(O["a"])(Y,i,n,!1,null,"3974f308",null);t["default"]=j.exports},c826:function(e,t,a){},e8c0:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a("cf88");function n(e,t,a){a.preventDefault(),document.addEventListener("contextmenu",(function(e){var t=e.target;if(t.closest(".el-table")){var a=document.querySelector("#menu");if(a){a.style.display="block";var n=a.offsetHeight,l=a.offsetWidth;console.log("menuHeight",n);var s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=e.clientX,c=e.clientY,u=o,p=c;r<o+l&&(u=o-l),s<c+n&&(p=s-n),a.style.left=u-250+"px",a.style.top=p-50+"px",a.style.display="block",a.style.zIndex="1000",document.addEventListener("click",i["a"])}}})),document.addEventListener("contextmenu",i["a"])}}}]);
//# sourceMappingURL=chunk-2755908a.1745983465578.js.map