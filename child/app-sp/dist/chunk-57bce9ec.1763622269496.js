(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-57bce9ec"],{1296:function(e,t,a){"use strict";var r=a("81a9"),i=a("bff7");t["a"]={get_event_list(e){return Object(r["a"])(Object(i["b"])("POST","/event/get_event_list/",e))},get_filter_list(e){return Object(r["a"])(Object(i["b"])("POST","/event/get_filter_item/",e))},get_filter_item(e){return Object(r["a"])(Object(i["b"])("POST","/event/get_filter_item/",e))},retry_task(e){return Object(r["a"])(Object(i["b"])("POST","/event/retry_task/",e))},get_error_task_list(e){return Object(r["a"])(Object(i["b"])("POST","/event/get_error_task_list/",e))},ignore(e){return Object(r["a"])(Object(i["b"])("POST","/event/task_status/",e))},get_repair_event_list(e){return Object(r["a"])(Object(i["b"])("POST","/event/get_error_task_list/",e))},getUnderlyingTasks(e){return Object(r["a"])(Object(i["b"])("GET","/event/get_maintask_detail/",e))},getTasksStatus(e){return Object(r["a"])(Object(i["b"])("GET","/event/check_task_resource/",e))},setTasksStatus(e){return Object(r["a"])(Object(i["b"])("POST","/event/repair_task_resource/",e))},setReTasks(e){return Object(r["a"])(Object(i["b"])("POST","/event/repair_task/",e))},getResourceStatus(){return Object(r["a"])(Object(i["b"])("GET","/event/resource_status/"))},task_flow_check(e){return Object(r["a"])(Object(i["b"])("GET","/event/task_flow_check/",e))}}},1928:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("action-block",{attrs:{search_option:e.search},on:{"fn-search":e.fn_search}}),t("div",{staticClass:"prompt_message"},[e._v("重试：支持对失败状态的任务进行重试；忽略：支持对任务进行忽略，忽略的任务不展示")]),t("el-table",{staticClass:"event-table",attrs:{data:e.event_list,border:""},on:{"filter-change":e.filterAttribute}},[t("el-table-column",{attrs:{prop:"cloud_id",label:"资源ID"}}),t("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),t("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),t("el-table-column",{attrs:{prop:"az_name",label:"可用区"}}),t("el-table-column",{attrs:{prop:"task_id",label:"任务ID"}}),t("el-table-column",{attrs:{prop:"task_type",label:"任务名称"}}),t("el-table-column",{attrs:{prop:"task_state",label:"任务状态"}}),t("el-table-column",{attrs:{prop:"error_type",label:"失败类型","filter-multiple":!1,"column-key":"error_type",filters:e.error_type_list},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.error_type))])]}}])}),t("el-table-column",{attrs:{prop:"subtask_name",label:"当前执行流程"}}),t("el-table-column",{attrs:{prop:"detail",label:"失败原因"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tooltip",{attrs:{content:a.row.detail,"popper-class":"tooltip-width",placement:"bottom",effect:"light"}},[t("span",[e._v(e._s(a.row.detail.length>20?a.row.detail.slice(0,21)+"...":a.row.detail))])])]}}])}),t("el-table-column",{attrs:{prop:"create_time",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.create_time?e.moment(a.row.create_time).format("YYYY-MM-DD HH:mm:ss"):"--"))])]}}])}),t("el-table-column",{attrs:{prop:"update_time",label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.update_time?e.moment(a.row.update_time).format("YYYY-MM-DD HH:mm:ss"):"--"))])]}}])}),t("el-table-column",{attrs:{prop:"end_time",label:"完成时间"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.end_time?e.moment(a.row.end_time).format("YYYY-MM-DD HH:mm:ss"):"--"))])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.retry(a.row.task_id,a.row.event_id)}}},[e._v("重试")]),t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.ignore(a.row.task_id,a.row.event_id)}}},[e._v("忽略")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[20,50,100],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},i=[],s=(a("14d9"),a("e9f5"),a("7d54"),a("9ab4")),n=a("1b40"),l=a("c811"),c=a("1296"),o=a("9074"),_=a("8ce4"),u=a("c1df"),p=a.n(u);let h=class extends n["e"]{constructor(){super(...arguments),this.search={az_id:{placeholder:"请选择可用区",list:[]},cloud_id:{placeholder:"请输入资源ID"},task_id:{placeholder:"请输入任务ID"},task_type:{placeholder:"请输入任务名称"},customer_id:{placeholder:"请输入客户ID"},customer_name:{placeholder:"请输入客户名称"},time:{type:"datetimerange",placeholder:["开始时间","结束时间"],clearable:!1,width:360,defaultTime:[p()(new Date).format("YYYY-MM-DD 00:00:00"),p()(new Date).format("YYYY-MM-DD HH:mm:ss")]}},this.event_num=0,this.finish_num=0,this.finished_percent="0.00%",this.fail_num=0,this.error_percent="0.00%",this.err="err",this.current=1,this.size=20,this.total=0,this.moment=p.a,this.event_list=[],this.min_date="",this.search_data={},this.event_detail=!1,this.sort_prop_name="",this.sort_value="",this.error_type_list=[],this.filter_obj={}}created(){this.get_az_list(),this.getFilterList(),this.fn_search()}async get_az_list(){this.search.az_id.list=[];let e=await o["a"].get_region_az_list({});"Success"===e.code&&e.data.forEach(e=>{e.region_list.forEach(e=>{this.search.az_id.list=[...this.search.az_id.list,...Object(_["e"])(e.az_list,"az_name","az_id","label","type")]})})}async getFilterList(){let e=await c["a"].get_filter_item({filed_names:["error_type"]});if("Success"===e.code)for(let t in e.data.error_type)this.error_type_list.push({text:e.data.error_type[t],value:t})}fn_search(e={}){this.current=1,this.search_data={...e,...this.filter_obj},this.get_error_task_list()}async get_error_task_list(){const{search_data:e}=this,t=await c["a"].get_error_task_list({page_index:this.current,page_size:this.size,az_id:e.az_id||"",cloud_id:e.cloud_id||"",task_type:e.task_type||"",task_id:e.task_id||"",customer_id:e.customer_id||"",customer_name:e.customer_name||"",error_type:e.error_type?e.error_type[0]:void 0,start_time:e.time?p()(e.time[0]).format("YYYY-MM-DD HH:mm:ss"):p()(new Date).format("YYYY-MM-DD 00:00:00"),end_time:e.time?p()(e.time[1]).format("YYYY-MM-DD HH:mm:ss"):p()(new Date).format("YYYY-MM-DD HH:mm:ss")});var a,r,i;"Success"===t.code?(this.event_list=(null===(a=t.data)||void 0===a?void 0:a.task_list)||[],this.total=(null===(r=t.data)||void 0===r||null===(i=r.page_info)||void 0===i?void 0:i.count)||0):this.$message.error(t.msg||"操作错误")}handleSizeChange(e){this.size=e,this.get_error_task_list()}handleCurrentChange(e){this.current=e,this.get_error_task_list()}filterAttribute(e){this.filter_obj={...this.filter_obj,...e},this.fn_search(this.search_data)}async retry(e,t){let a=await c["a"].retry_task({task_id:e,event_id:t});"Success"===a.code&&(this.$message.success(a.message),this.get_error_task_list())}async ignore(e){let t=await c["a"].ignore({task_id:e});"Success"===t.code&&(this.$message.success(t.message),this.get_error_task_list())}};h=Object(s["a"])([Object(n["a"])({components:{ActionBlock:l["a"]}})],h);var d=h,b=d,m=a("2877"),f=Object(m["a"])(b,r,i,!1,null,"b091c8d4",null);t["default"]=f.exports},"26f3":function(e,t,a){"use strict";a("4f3f")},4774:function(e,t,a){"use strict";a("835c")},"4f3f":function(e,t,a){},"835c":function(e,t,a){},"8ce4":function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return l}));a("14d9"),a("e9f5"),a("ab43");function r(e,t,a,r,i){let s=[];return e.map(e=>{s.push({[r]:e[t],[i]:e[a]})}),s}function i(e,t,a,r={}){let i=[];return e.map(e=>{let s={};t.map((t,r)=>{s[t]=e[a[r]]}),i.push({...s,...r})}),i}function s(e,t=!1){let a={};for(let r in e){const{billing_scheme_id:i,billing_cycle_id:s,billing_items:n,gic_goods_id:l}=e[r];let c={};for(let e in n){let a={attr_id:n[e].attr_id,name:n[e].name},r={id:n[e].id,key:e};c[e]=t?{...a,...r}:r}a[r]={billing_scheme_id:i,billing_cycle_id:s,billing_items:c,gic_goods_id:t?l:void 0}}return a}function n(e,t){return e.map(e=>e[t])}function l(e){let t="";for(let a in e)e[a]&&(t+=`${a}=${e[a]}&`);return""===t?"":"?"+t.slice(0,t.length-1)}},9074:function(e,t,a){"use strict";var r=a("81a9"),i=a("bff7");t["a"]={get_customer_name(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/get_customer_name/",e))},get_region_az_list(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/region_az_info/",e))},get_net_list(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/net_info/",e))},get_all_cpu_ram(){return Object(r["a"])(Object(i["b"])("GET","/ecs/ram_cpu_list/"))},get_category_list(e){return Object(r["a"])(Object(i["b"])("GET","/ecs/ecs_category_list/",e))},ecs_family_info(e){return Object(r["a"])(Object(i["b"])("GET","/ecs/ecs_family_info/",e))},get_os_list(e){return Object(r["a"])(Object(i["b"])("POST","/img/image_info/",e))},get_price(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/get_price/",e))},create_instance(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/create_ecs/",e))},get_ecs_limit(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/get_ecs_limit/",e))},get_ram_cpu_price_list(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/ecs_spec_attach_price/",e))},difference_price(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/ecs_difference_price/",e))},change_configure_limit(e){return Object(r["a"])(Object(i["b"])("POST","/ecs/change_configure_limit/",e))}}},"9a8d":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-date-picker",{attrs:{type:e.time_option.type,editable:!1,"range-separator":"至","picker-options":{disabledDate:e.dis_date,onPick:e.onPicker},clearable:e.time_option.clearable,"start-placeholder":e.time_option.placeholder[0],"end-placeholder":e.time_option.placeholder[1]},on:{change:e.FnEmit},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})},i=[],s=a("9ab4"),n=a("1b40");let l=class extends n["e"]{constructor(){super(...arguments),this.time=[],this.min_date="",this.day=0}dis_date(e){const{day:t}=this;if(0===t)return;let a=864e5,r=(new Date).getTime(),i=(new Date).getTime(),s=(new Date).getTime();return this.time_option.min_date?(i=new Date(this.time_option.min_date).getTime(),e.getTime()>s||e.getTime()<i-a):e.getTime()>s||e.getTime()>(this.min_date||r)+a*t||this.min_date&&e.getTime()<this.min_date-a*t}onPicker({maxDate:e,minDate:t}){this.min_date=t.getTime()}created(){this.day=this.time_option.dis_day-1||0,this.FnChangeDefaultTime(this.time_option.defaultTime)}FnClear(){this.FnChangeDefaultTime(this.time_option.defaultTime)}FnChangeDefaultTime(e){e.length,this.time=e,this.FnEmit()}FnEmit(){return this.min_date="",this.time}};Object(s["a"])([Object(n["c"])({default:()=>({placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!1,dis_day:31,min_date:"",defaultTime:[new Date,new Date]})})],l.prototype,"time_option",void 0),Object(s["a"])([Object(n["c"])({default:!1})],l.prototype,"clear",void 0),Object(s["a"])([Object(n["f"])("time_option.defaultTime")],l.prototype,"FnChangeDefaultTime",null),Object(s["a"])([Object(n["b"])("fn-emit")],l.prototype,"FnEmit",null),l=Object(s["a"])([n["a"]],l);var c=l,o=c,_=a("2877"),u=Object(_["a"])(o,r,i,!1,null,null,null);t["a"]=u.exports},ab43:function(e,t,a){"use strict";var r=a("23e7"),i=a("c65b"),s=a("59ed"),n=a("825a"),l=a("46c4"),c=a("c5cc"),o=a("9bdd"),_=a("2a62"),u=a("2baa"),p=a("f99f"),h=a("c430"),d=!h&&!u("map",(function(){})),b=!h&&!d&&p("map",TypeError),m=h||d||b,f=c((function(){var e=this.iterator,t=n(i(this.next,e)),a=this.done=!!t.done;if(!a)return o(e,this.mapper,[t.value,this.counter++],!0)}));r({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(e){n(this);try{s(e)}catch(t){_(this,"throw",t)}return b?i(b,this,e):new f(l(this),{mapper:e})}})},c811:function(e,t,a){"use strict";a("e9f5"),a("910d");var r=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"action-box",style:e.isShowBg?{}:{background:"#fff",padding:0,margin:0,border:"none"}},[t("div",{ref:"search",staticClass:"search-box",class:{fold:!e.isOpen}},[e._l(e.search_option,(function(a,r){return t("div",{key:r,staticClass:"search-input",style:a.width?{width:a.width+"px"}:{}},[a.list&&!a.type?t("el-select",{attrs:{placeholder:a.placeholder,multiple:a.multiple,filterable:a.filter,clearable:""},model:{value:e.search_value[r],callback:function(t){e.$set(e.search_value,r,t)},expression:"search_value[key]"}},e._l(a.list,(function(e,r){return t("el-option",{key:Array.isArray(a.list)?e.type:r,attrs:{label:Array.isArray(a.list)?e.label:e,value:Array.isArray(a.list)?e.type:r}})})),1):e._e(),(a.list||a.type||a.multi)&&"composite"!==a.type?e._e():t("el-input",{staticClass:"composite",style:a.width?{width:a.width+"px"}:{},attrs:{placeholder:a.placeholder,clearable:""},model:{value:e.search_value[r],callback:function(t){e.$set(e.search_value,r,t)},expression:"search_value[key]"}},["composite"===a.type?t("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.search_value[r+"sub"],callback:function(t){e.$set(e.search_value,r+"sub",t)},expression:"search_value[key + 'sub']"}},e._l(a.list,(function(e){return t("el-option",{key:e.type,attrs:{label:e.label,value:e.type}})})),1):e._e()],1),a.multi?t("el-popover",{attrs:{placement:"bottom",width:"250",trigger:"click"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:a.placeholder+"（使用回车或英文逗号隔开）"},model:{value:e.search_value[r],callback:function(t){e.$set(e.search_value,r,t)},expression:"search_value[key]"}}),!a.list&&!a.type||a.multi?t("el-input",{staticClass:"multi_input",style:a.width?{width:a.width+"px"}:{},attrs:{slot:"reference",placeholder:a.placeholder,clearable:""},slot:"reference",model:{value:e.search_value[r],callback:function(t){e.$set(e.search_value,r,t)},expression:"search_value[key]"}}):e._e()],1):e._e(),"datetimerange"===a.type||"daterange"===a.type?[t("date-picker",{ref:"datepicker",refInFor:!0,attrs:{time_option:e.search_option[r]},on:{"fn-emit":function(t){return e.FnGetTime(t,r)}}})]:e._e()],2)})),e.type?e._e():t("div",{staticClass:"m-bottom20"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("查 询")]),t("el-button",{attrs:{type:"default"},on:{click:e.FnClear}},[e._v("清 空")])],1)],2),e.type?t("div",{staticClass:"m-bottom5"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("查 询")]),"physical"===e.type?t("el-button",{attrs:{type:"primary"},on:{click:e.FnMultiSearch}},[e._v("批量查询")]):e._e(),t("el-button",{attrs:{type:"default"},on:{click:e.FnClear}},[e._v("清 空")]),t("el-button",{staticClass:"m-bottom10",attrs:{type:"text"},on:{click:e.operate}},[e._v(e._s(e.isOpen?"折叠":"展开"))])],1):e._e(),e._t("default",(function(){return[e.create_btn?t("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.FnShowCreate}},[e._v(e._s(e.create_btn))]):e._e()]})),t("el-dialog",{attrs:{title:"批量查询",visible:e.syncVisible,width:"400px","destroy-on-close":!0,"close-on-click-modal":!1}},[t("el-input",{attrs:{type:"textarea",rows:13,placeholder:"请输入主机ID/名称,格式如下：\nPOD01-CLU01-H001\nPOD01-CLU01-H002\nPOD01-CLU01-H003\n..."},model:{value:e.search_value["host_info"],callback:function(t){e.$set(e.search_value,"host_info",t)},expression:"search_value['host_info']"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("确认")]),t("el-button",{on:{click:function(t){e.syncVisible=!1}}},[e._v("取消")])],1)],1)],2)},i=[],s=a("9ab4"),n=a("1b40"),l=a("9a8d");let c=class extends n["e"]{constructor(){super(...arguments),this.search_value={},this.time=null,this.date_key="",this.syncVisible=!1,this.isOpen=!0}FnGetTime(e,t){this.time=e,this.date_key=t}FnSearch(){return this.syncVisible=!1,this.search_value[this.date_key]=this.time,this.search_value}watch_search_option(){this.type&&this.$nextTick(()=>{let e=this.$refs.search,t=window.getComputedStyle(e).height.replace("px","");parseInt(t)>52&&this.isOpen&&(this.isOpen=!1),this.FnOperate()})}FnMultiSearch(){this.syncVisible=!0}operate(){this.isOpen=!this.isOpen,this.FnOperate()}FnOperate(){}FnShowCreate(){}watch_search_value(e,t){}FnClear(){for(let e in this.search_option)["datetimerange","daterange"].includes(this.search_option[e].type)?this.$refs.datepicker[0].FnClear():this.search_value={};this.FnSearch()}mounted(){let e=0;for(let t in this.search_option)this.search_option[t].default_value&&(this.$set(this.search_value,t,this.search_option[t].default_value),e++),"composite"===this.search_option[t].type&&this.$set(this.search_value,t+"sub",this.search_option[t].list[0].type);(e>0||"physical"===this.type)&&setTimeout(()=>{this.FnSearch()},500)}};Object(s["a"])([Object(n["c"])({default:{}})],c.prototype,"search_option",void 0),Object(s["a"])([Object(n["c"])({default:""})],c.prototype,"create_btn",void 0),Object(s["a"])([Object(n["c"])({default:!0})],c.prototype,"disabled",void 0),Object(s["a"])([Object(n["c"])({default:!1})],c.prototype,"type",void 0),Object(s["a"])([Object(n["c"])({default:!0})],c.prototype,"isShowBg",void 0),Object(s["a"])([Object(n["b"])("fn-search")],c.prototype,"FnSearch",null),Object(s["a"])([Object(n["f"])("search_option",{immediate:!0,deep:!0})],c.prototype,"watch_search_option",null),Object(s["a"])([Object(n["b"])("fn-operate")],c.prototype,"FnOperate",null),Object(s["a"])([Object(n["b"])("fn-create")],c.prototype,"FnShowCreate",null),Object(s["a"])([Object(n["f"])("search_value",{immediate:!0,deep:!0})],c.prototype,"watch_search_value",null),c=Object(s["a"])([Object(n["a"])({components:{DatePicker:l["a"]}})],c);var o=c,_=o,u=(a("4774"),a("26f3"),a("2877")),p=Object(u["a"])(_,r,i,!1,null,"20a86f62",null);t["a"]=p.exports}}]);