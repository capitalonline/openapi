(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-53902ce7"],{"1c50":function(t,e,a){"use strict";var n=a("81a9");e["a"]={get_maintask_list:function(t){return Object(n["a"])({method:"GET",url:"/api/v1/maintask/configuration",params:t})},add_maintask:function(t){return Object(n["a"])({method:"POST",url:"/api/v1/maintask/configuration",data:t})},update_maitask:function(t){return Object(n["a"])({method:"PUT",url:"/api/v1/maintask/configuration",data:t})},delete_maintask:function(t){return Object(n["a"])({method:"DELETE",url:"/api/v1/maintask/configuration",params:t})},get_maintask_detail:function(t){return Object(n["a"])({method:"GET",url:"/api/v1/maintask/configuration/detail",params:t})}}},"2a59":function(t,e,a){"use strict";a("3463")},3463:function(t,e,a){},"6f25":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("action-block",{attrs:{search_option:t.search_con,create_btn:"新建主任务配置",disabled:!t.operate_auth.includes("create")},on:{"fn-search":t.FnGetList,"fn-create":t.FnShowCreate}}),a("el-table",{attrs:{data:t.task_list,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",disabled:!t.operate_auth.includes("main_task_detail")},on:{click:function(a){return t.FnDetail(e.row.id)}}},[t._v(t._s(e.row.id))])]}}])}),a("el-table-column",{attrs:{prop:"maintask_name",label:"名称"}}),a("el-table-column",{attrs:{prop:"priority",label:"优先级"}}),a("el-table-column",{attrs:{prop:"retry",label:"重试次数"}}),a("el-table-column",{attrs:{prop:"timeout",label:"超时时间"}}),a("el-table-column",{attrs:{prop:"callback_url",label:"回退地址"}}),a("el-table-column",{attrs:{prop:"is_valid",label:"is_valid"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",disabled:!t.operate_auth.includes("edit")},on:{click:function(a){return t.FnShowUpdate(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text",disabled:!t.operate_auth.includes("delete")},on:{click:function(a){return t.FnShowDel(e.row.id,e.row.maintask_name)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":t.page_info.page_index,"page-sizes":t.page_info.page_sizes,"page-size":t.page_info.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.page_info.total},on:{"size-change":function(e){return t.FnGetList()},"current-change":function(e){return t.FnGetList()},"update:currentPage":function(e){return t.$set(t.page_info,"page_index",e)},"update:current-page":function(e){return t.$set(t.page_info,"page_index",e)},"update:pageSize":function(e){return t.$set(t.page_info,"page_size",e)},"update:page-size":function(e){return t.$set(t.page_info,"page_size",e)}}}),a("el-dialog",{attrs:{title:t.dialog_title,visible:t.create_dialog,width:"50%"},on:{"update:visible":function(e){t.create_dialog=e},close:t.FnClose}},[a("div",[a("label-block",{attrs:{label:"主任务名称"},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-input",{attrs:{type:"text"},model:{value:t.main_config.main_name,callback:function(e){t.$set(t.main_config,"main_name",e)},expression:"main_config.main_name"}})]},proxy:!0}])}),a("label-block",{attrs:{label:"主任务优先级"},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-input-number",{attrs:{min:1,max:10},model:{value:t.main_config.priority,callback:function(e){t.$set(t.main_config,"priority",e)},expression:"main_config.priority"}})]},proxy:!0}])}),a("label-block",{attrs:{label:"主任务重试次数"},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-input-number",{attrs:{min:1,max:10},model:{value:t.main_config.retry,callback:function(e){t.$set(t.main_config,"retry",e)},expression:"main_config.retry"}}),t._v(" 次 ")]},proxy:!0}])}),a("label-block",{attrs:{label:"主任务超时时间"},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-input-number",{attrs:{min:1,max:600},model:{value:t.main_config.timeout,callback:function(e){t.$set(t.main_config,"timeout",e)},expression:"main_config.timeout"}}),t._v(" 秒 ")]},proxy:!0}])}),a("label-block",{attrs:{label:"主任务回退地址"},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-input",{attrs:{type:"text"},model:{value:t.main_config.callback_url,callback:function(e){t.$set(t.main_config,"callback_url",e)},expression:"main_config.callback_url"}})]},proxy:!0}])}),t.default_id?a("label-block",{staticClass:"switch-box",attrs:{label:"有效"},scopedSlots:t._u([{key:"default",fn:function(){return[a("el-switch",{attrs:{"active-color":"#455cc6","inactive-color":"#ccc"},model:{value:t.main_config.is_valid,callback:function(e){t.$set(t.main_config,"is_valid",e)},expression:"main_config.is_valid"}})]},proxy:!0}],null,!1,1067134834)}):t._e(),a("label-block",{attrs:{label:"子任务配置"},scopedSlots:t._u([{key:"default",fn:function(){return[a("dragger-task",{attrs:{sub_task:t.sub_task_list,rel_task:t.default_sub_task},on:{"fn-rel-task":t.FnGetRelTask}})]},proxy:!0}])})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.FnConfirm}},[t._v("确 定")]),a("el-button",{on:{click:t.FnClose}},[t._v("取 消")])],1)])],1)},i=[],r=a("1da1"),s=a("d4ec"),o=a("bee2"),c=a("262e"),u=a("2caf"),l=(a("96cf"),a("d81d"),a("e9c4"),a("a9e3"),a("b0c0"),a("9ab4")),_=a("1b40"),f=a("98c9"),p=a("b508"),m=a("c811"),d=a("1c50"),g=a("bcc9"),b=function(t){Object(c["a"])(a,t);var e=Object(u["a"])(a);function a(){var t;return Object(s["a"])(this,a),t=e.apply(this,arguments),t.search_con={id:{placeholder:"请输入任务ID"},maintask_name:{placeholder:"请输入任务名称"}},t.create_dialog=!1,t.dialog_title="",t.task_list=[],t.operate_auth=[],t.default_id="",t.default_sub_task=[],t.main_config={main_name:"",main_type:"",priority:1,retry:1,timeout:60,callback_url:"",sub_task:[],is_valid:!0},t.sub_task_list=[],t.page_info={page_sizes:[20,50,100],page_size:20,page_index:1,total:0},t}return Object(o["a"])(a,[{key:"FnShowCreate",value:function(){this.create_dialog=!0,this.dialog_title="新建主任务配置",this.FnGetSubList()}},{key:"FnShowUpdate",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.create_dialog=!0,this.dialog_title="更新主任务配置",t.next=4,this.FnGetSubList();case 4:this.default_id=e.id,this.main_config.main_name=e.maintask_name,this.main_config.retry=e.retry,this.main_config.priority=e.priority,this.main_config.timeout=e.timeout,this.main_config.callback_url=e.callback_url,this.main_config.is_valid=Boolean(e.is_valid),this.default_sub_task=JSON.parse(e.subtask_flow).map((function(t){return t.map((function(t){return t.subtask_index_id}))}));case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"FnClose",value:function(){this.create_dialog=!1,this.main_config.main_name="",this.main_config.main_type="",this.main_config.retry=1,this.main_config.priority=1,this.main_config.timeout=60,this.main_config.callback_url="",this.main_config.sub_task=[],this.main_config.is_valid=!0,this.sub_task_list=[],this.default_id="",this.default_sub_task=[]}},{key:"FnGetList",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,a,n,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{},a={},e.id&&(a.id=e.id),e.maintask_type&&(a.maintask_type=e.maintask_type),e.maintask_name&&(a.maintask_name=e.maintask_name),a.page_number=this.page_info.page_index,a.page_size=this.page_info.page_size,t.next=9,d["a"].get_maintask_list(a);case 9:n=t.sent,"Success"===n.code&&(this.task_list=n.data.maintask_info,this.page_info.total=n.data.total);case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"FnGetSubList",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g["a"].get_subtask_list();case 2:e=t.sent,"Success"===e.code&&(this.sub_task_list=e.data.subtask_info);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"FnGetRelTask",value:function(t){this.main_config.sub_task=t.map((function(t){return t.map((function(t){return{subtask_index_id:t}}))}))}},{key:"FnConfirm",value:function(){var t={maintask_name:this.main_config.main_name,priority:this.main_config.priority,retry:this.main_config.retry,timeout:this.main_config.timeout,callback_url:this.main_config.callback_url,subtask_flow:JSON.stringify(this.main_config.sub_task),is_valid:Number(this.main_config.is_valid)};this.default_id?this.FnUpdate(t):this.FnCreate(t)}},{key:"FnCreate",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].add_maintask(e);case 2:a=t.sent,"Success"===a.code&&(this.FnClose(),this.$message.success(a.msg||"成功新建主任务配置！"),this.FnGetList());case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"FnUpdate",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].update_maitask(Object.assign({},e,{id:this.default_id}));case 2:a=t.sent,"Success"===a.code&&(this.FnClose(),this.$message.success(a.msg||"成功更新主任务配置！"),this.FnGetList());case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"FnShowDel",value:function(t,e){var a=this;this.$confirm("确认删除主任务配置 -- ".concat(e),"删除提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then((function(){a.default_id=t,a.FnDel()})).catch()}},{key:"FnDel",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].delete_maintask({id:this.default_id});case 2:e=t.sent,"Success"===e.code&&(this.$message.success(e.msg||"成功删除主项目配置！"),this.FnGetList());case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"FnDetail",value:function(t){this.$router.push("/mainTaskDetail/".concat(t))}},{key:"created",value:function(){this.operate_auth=this.$store.state.auth_info[this.$route.name],this.FnGetList()}}]),a}(_["e"]);b=Object(l["a"])([Object(_["a"])({components:{LabelBlock:f["a"],draggerTask:p["a"],actionBlock:m["a"]}})],b);var h=b,k=h,v=(a("2a59"),a("2877")),y=Object(v["a"])(k,n,i,!1,null,"0c3d3a9b",null);e["default"]=y.exports},d81d:function(t,e,a){"use strict";var n=a("23e7"),i=a("b727").map,r=a("1dde"),s=r("map");n({target:"Array",proto:!0,forced:!s},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-53902ce7.1741589092878.js.map