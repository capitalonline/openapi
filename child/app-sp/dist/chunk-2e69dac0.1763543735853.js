(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-2e69dac0"],{"024d":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("action-block",{attrs:{search_option:e.search_con,create_btn:"添加POD",disabled:!e.operate_auth.includes("create")},on:{"fn-search":e.FnSearch,"fn-create":e.FnShowAdd}}),t("el-table",{attrs:{data:e.pod_list,border:""},on:{"filter-change":e.handleFilterChange,"sort-change":e.handleSortChange}},[t("el-table-column",{attrs:{prop:"pod_name",label:"POD名称",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"az_id",label:"可用区编号"}}),t("el-table-column",{attrs:{prop:"az_name",label:"可用区"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",filters:[{text:"可用",value:!0},{text:"不可用",value:!1}],"column-key":"status","filter-multiple":!1},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.status?"可用":"不可用")+" ")]}}])}),t("el-table-column",{attrs:{prop:"compute_count",label:"计算机数量",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"storage_count",label:"存储机器数量",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"memo",label:"备注"}}),t("el-table-column",{attrs:{prop:"update_time",label:"更新时间"}}),t("el-table-column",{attrs:{prop:"create_time",label:"创建时间",sortable:"custom"}}),t("el-table-column",{attrs:{prop:"",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",disabled:!e.operate_auth.includes("record")},on:{click:function(t){return e.FnShowRecord(a.row)}}},[e._v("操作记录")]),t("el-button",{attrs:{type:"text",disabled:!e.operate_auth.includes("update")},on:{click:function(t){return e.FnShowEdit(a.row)}}},[e._v("编辑")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.page_info.page_index,"page-sizes":e.page_info.page_sizes,"page-size":e.page_info.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":function(t){return e.FnGetPod()},"current-change":function(t){return e.FnGetPod()},"update:currentPage":function(t){return e.$set(e.page_info,"page_index",t)},"update:current-page":function(t){return e.$set(e.page_info,"page_index",t)},"update:pageSize":function(t){return e.$set(e.page_info,"page_size",t)},"update:page-size":function(t){return e.$set(e.page_info,"page_size",t)}}}),t("add-pod",{attrs:{visible:e.show_add_pod,title:e.add_title,row:e.default_row},on:{"update:visible":function(t){e.show_add_pod=t},"fn-refresh":e.FnGetPod}}),t("pod-record",{attrs:{visible:e.show_record,pod_id:e.default_row.pod_id},on:{"update:visible":function(t){e.show_record=t}}})],1)},i=[],o=a("9ab4"),r=a("1b40"),l=a("c811"),n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{visible:e.syncVisible,title:e.title,"close-on-click-modal":!1},on:{"update:visible":function(t){e.syncVisible=t},close:e.FnClose}},[t("el-form",{ref:"resetForm",attrs:{model:e.data,rules:e.rules,"label-width":"120px","label-position":"left"}},[t("el-form-item",{attrs:{label:"POD名称",prop:"pod_name"}},[t("el-input",{model:{value:e.data.pod_name,callback:function(t){e.$set(e.data,"pod_name",t)},expression:"data.pod_name"}})],1),t("el-form-item",{attrs:{label:"可用区编号",prop:"az_id"}},[t("el-input",{model:{value:e.data.az_id,callback:function(t){e.$set(e.data,"az_id",t)},expression:"data.az_id"}})],1),t("el-form-item",{attrs:{label:"区域"}},[e._v(e._s(e.region))]),t("el-form-item",{attrs:{label:"可用区"}},[e._v(e._s(e.az_name))]),t("el-form-item",{attrs:{label:"管理IP",prop:"ip_address"}},[t("el-input",{attrs:{placeholder:"若有多个管理IP，请以英文逗号隔开"},model:{value:e.data.ip_address,callback:function(t){e.$set(e.data,"ip_address",t)},expression:"data.ip_address"}})],1),t("el-form-item",{attrs:{label:"机房名称",prop:"zoom_name"}},[t("el-input",{model:{value:e.data.zoom_name,callback:function(t){e.$set(e.data,"zoom_name",t)},expression:"data.zoom_name"}})],1),t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-select",{model:{value:e.data.status,callback:function(t){e.$set(e.data,"status",t)},expression:"data.status"}},e._l(e.status_list,(function(a,s){return t("el-option",{key:s,attrs:{value:s,label:a}},[e._v(e._s(a))])})),1)],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.data.remark,callback:function(t){e.$set(e.data,"remark",t)},expression:"data.remark"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnConfirm}},[e._v("确 定")]),t("el-button",{on:{click:e.FnClose}},[e._v("取 消")])],1)],1)},c=[],d=a("c839");let p=class extends r["e"]{constructor(){super(...arguments),this.status_list={available:"可用",unavailable:"不可用"},this.region="",this.az_name="",this.data={pod_name:"",az_id:"",ip_address:"",zoom_name:"",status:Object.keys(this.status_list)[0],remark:""},this.FnCheckPodName=(e,t,a)=>{t||a("请输入POD名称"),a()},this.FnCheckAzId=(e,t,a)=>{t||a("请输入可用区编号"),this.FnGetAzName().then(e=>{e||a("请输入正确的可用区编号"),a()})},this.rules={pod_name:[{required:!0,validator:this.FnCheckPodName,trigger:"blur"}],az_id:[{required:!0,validator:this.FnCheckAzId,trigger:"blur"}],ip_address:[{required:!0,trigger:"blur",message:"请输入管理IP"}],zoom_name:[{required:!0,trigger:"blur",message:"请输入机房名称"}]}}async FnGetAzName(){if(this.region="",this.az_name="",!this.data.az_id)return;const e=await d["a"].get_az_info({az_id:this.data.az_id});return"Success"===e.code&&(this.region=e.data.region,this.az_name=e.data.az_name),this.region}FnConfirm(){this.$refs["resetForm"].validate(e=>{e&&(this.row["pod_id"]?this.FnUpdatePod():this.FnAddPod())})}async FnAddPod(){const e=await d["a"].create_pod({pod_name:this.data.pod_name,az_id:this.data.az_id,manager_ip:this.data.ip_address,host_room:this.data.zoom_name,status:"available"===this.data.status,memo:this.data.remark});"Success"===e.code&&(this.$message.success("添加POD成功！"),this.FnClose(),this.FnEmit())}async FnUpdatePod(){const e=await d["a"].update_pod({pod_id:this.row["pod_id"],pod_name:this.data.pod_name,az_id:this.data.az_id,manager_ip:this.data.ip_address,host_room:this.data.zoom_name,status:"available"===this.data.status,memo:this.data.remark});"Success"===e.code&&(this.$message.success("修改POD成功！"),this.FnClose(),this.FnEmit())}FnClose(){this.syncVisible=!1,this.$refs["resetForm"].resetFields(),this.region="",this.az_name=""}FnEmit(){}FnGetRow(e){e&&(this.data.pod_name=this.row["pod_name"],this.data.az_id=this.row["az_id"],this.data.ip_address=this.row["manager_ip"],this.region=this.row["region"],this.az_name=this.row["az_name"],this.data.zoom_name=this.row["host_room"],this.data.status=this.row["status"]?Object.keys(this.status_list)[0]:Object.keys(this.status_list)[1],this.data.remark=this.row["memo"])}};Object(o["a"])([Object(r["d"])("visible",{type:Boolean})],p.prototype,"syncVisible",void 0),Object(o["a"])([Object(r["c"])({default:"添加POD"})],p.prototype,"title",void 0),Object(o["a"])([Object(r["c"])({default:()=>({})})],p.prototype,"row",void 0),Object(o["a"])([Object(r["b"])("fn-refresh")],p.prototype,"FnEmit",null),Object(o["a"])([Object(r["f"])("syncVisible")],p.prototype,"FnGetRow",null),p=Object(o["a"])([r["a"]],p);var _=p,u=_,h=a("2877"),m=Object(h["a"])(u,n,c,!1,null,"781b1ffe",null),b=m.exports,f=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-dialog",{attrs:{visible:e.syncVisible,title:"操作记录"},on:{"update:visible":function(t){e.syncVisible=t}}},[t("el-table",{attrs:{data:e.history_list,border:""}},[t("el-table-column",{attrs:{prop:"op_user",label:"用户名"}}),t("el-table-column",{attrs:{prop:"op_time",label:"操作时间"}}),t("el-table-column",{attrs:{prop:"content",label:"操作内容"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnClose}},[e._v("关 闭")])],1)],1)},y=[];let v=class extends r["e"]{constructor(){super(...arguments),this.history_list=[]}async FnGetRecord(){const e=await d["a"].get_pod_history({pod_id:this.pod_id});"Success"===e.code&&(this.history_list=e.data.history_record)}FnClose(){this.syncVisible=!1}FnChangeVisible(e){e&&this.FnGetRecord()}};Object(o["a"])([Object(r["d"])("visible",{type:Boolean})],v.prototype,"syncVisible",void 0),Object(o["a"])([Object(r["c"])({default:""})],v.prototype,"pod_id",void 0),Object(o["a"])([Object(r["f"])("visible")],v.prototype,"FnChangeVisible",null),v=Object(o["a"])([r["a"]],v);var g=v,O=g,F=Object(h["a"])(O,f,y,!1,null,"58d3f1c9",null),w=F.exports;let k=class extends r["e"]{constructor(){super(...arguments),this.search_con={pod_name:{placeholder:"请输入POD名称"},az_id:{placeholder:"请输入可用区编号"},az_name:{placeholder:"请输入可用区名称"}},this.search_value={pod_name:"",az_id:"",az_name:"",status:""},this.sort_prop_name="create_time",this.sort_order=1,this.page_info={page_sizes:[20,50,100],page_size:20,page_index:1,total:0},this.operate_auth=[],this.show_add_pod=!1,this.add_title="",this.show_record=!1,this.pod_list=[],this.default_row={}}FnSearch(e){this.search_value.pod_name=e.pod_name,this.search_value.az_id=e.az_id,this.search_value.az_name=e.az_name,this.page_info.page_index=1,this.FnGetPod()}handleFilterChange(e){this.search_value.status=e.status[0],this.FnGetPod()}handleSortChange(e){this.sort_prop_name=e.prop,this.sort_order=Number("ascending"!==e.order),this.FnGetPod()}async FnGetPod(){let e={pod_name:this.search_value.pod_name,az_id:this.search_value.az_id,az_name:this.search_value.az_name,page_index:this.page_info.page_index,page_size:this.page_info.page_size,[this.sort_prop_name+"_sort"]:this.sort_order};""!==this.search_value.status&&(e["status"]=Number(this.search_value.status));const t=await d["a"].get_pod_list(e);"Success"===t.code&&(this.pod_list=t.data.pod_list,this.page_info.total=t.data.page_info.count)}FnShowAdd(){this.add_title="添加POD",this.default_row={},this.show_add_pod=!0}FnShowRecord(e){this.default_row=e,this.show_record=!0}FnShowEdit(e){this.add_title="修改POD",this.default_row=e,this.show_add_pod=!0}created(){this.operate_auth=this.$store.state.auth_info[this.$route.name],this.FnGetPod()}};k=Object(o["a"])([Object(r["a"])({components:{actionBlock:l["a"],AddPod:b,PodRecord:w}})],k);var j=k,z=j,x=Object(h["a"])(z,s,i,!1,null,"0dcaa210",null);t["default"]=x.exports},"26f3":function(e,t,a){"use strict";a("4f3f")},4774:function(e,t,a){"use strict";a("835c")},"4f3f":function(e,t,a){},"835c":function(e,t,a){},"9a8d":function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("el-date-picker",{attrs:{type:e.time_option.type,editable:!1,"range-separator":"至","picker-options":{disabledDate:e.dis_date,onPick:e.onPicker},clearable:e.time_option.clearable,"start-placeholder":e.time_option.placeholder[0],"end-placeholder":e.time_option.placeholder[1]},on:{change:e.FnEmit},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})},i=[],o=a("9ab4"),r=a("1b40");let l=class extends r["e"]{constructor(){super(...arguments),this.time=[],this.min_date="",this.day=0}dis_date(e){const{day:t}=this;if(0===t)return;let a=864e5,s=(new Date).getTime(),i=(new Date).getTime(),o=(new Date).getTime();return this.time_option.min_date?(i=new Date(this.time_option.min_date).getTime(),e.getTime()>o||e.getTime()<i-a):e.getTime()>o||e.getTime()>(this.min_date||s)+a*t||this.min_date&&e.getTime()<this.min_date-a*t}onPicker({maxDate:e,minDate:t}){this.min_date=t.getTime()}created(){this.day=this.time_option.dis_day-1||0,this.FnChangeDefaultTime(this.time_option.defaultTime)}FnClear(){this.FnChangeDefaultTime(this.time_option.defaultTime)}FnChangeDefaultTime(e){e.length,this.time=e,this.FnEmit()}FnEmit(){return this.min_date="",this.time}};Object(o["a"])([Object(r["c"])({default:()=>({placeholder:["开始时间","结束时间"],type:"daterange",width:"360",clearable:!1,dis_day:31,min_date:"",defaultTime:[new Date,new Date]})})],l.prototype,"time_option",void 0),Object(o["a"])([Object(r["c"])({default:!1})],l.prototype,"clear",void 0),Object(o["a"])([Object(r["f"])("time_option.defaultTime")],l.prototype,"FnChangeDefaultTime",null),Object(o["a"])([Object(r["b"])("fn-emit")],l.prototype,"FnEmit",null),l=Object(o["a"])([r["a"]],l);var n=l,c=n,d=a("2877"),p=Object(d["a"])(c,s,i,!1,null,null,null);t["a"]=p.exports},c811:function(e,t,a){"use strict";a("e9f5"),a("910d");var s=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"action-box",style:e.isShowBg?{}:{background:"#fff",padding:0,margin:0,border:"none"}},[t("div",{ref:"search",staticClass:"search-box",class:{fold:!e.isOpen}},[e._l(e.search_option,(function(a,s){return t("div",{key:s,staticClass:"search-input",style:a.width?{width:a.width+"px"}:{}},[a.list&&!a.type?t("el-select",{attrs:{placeholder:a.placeholder,multiple:a.multiple,filterable:a.filter,clearable:""},model:{value:e.search_value[s],callback:function(t){e.$set(e.search_value,s,t)},expression:"search_value[key]"}},e._l(a.list,(function(e,s){return t("el-option",{key:Array.isArray(a.list)?e.type:s,attrs:{label:Array.isArray(a.list)?e.label:e,value:Array.isArray(a.list)?e.type:s}})})),1):e._e(),(a.list||a.type||a.multi)&&"composite"!==a.type?e._e():t("el-input",{staticClass:"composite",style:a.width?{width:a.width+"px"}:{},attrs:{placeholder:a.placeholder,clearable:""},model:{value:e.search_value[s],callback:function(t){e.$set(e.search_value,s,t)},expression:"search_value[key]"}},["composite"===a.type?t("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.search_value[s+"sub"],callback:function(t){e.$set(e.search_value,s+"sub",t)},expression:"search_value[key + 'sub']"}},e._l(a.list,(function(e){return t("el-option",{key:e.type,attrs:{label:e.label,value:e.type}})})),1):e._e()],1),a.multi?t("el-popover",{attrs:{placement:"bottom",width:"250",trigger:"click"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:a.placeholder+"（使用回车或英文逗号隔开）"},model:{value:e.search_value[s],callback:function(t){e.$set(e.search_value,s,t)},expression:"search_value[key]"}}),!a.list&&!a.type||a.multi?t("el-input",{staticClass:"multi_input",style:a.width?{width:a.width+"px"}:{},attrs:{slot:"reference",placeholder:a.placeholder,clearable:""},slot:"reference",model:{value:e.search_value[s],callback:function(t){e.$set(e.search_value,s,t)},expression:"search_value[key]"}}):e._e()],1):e._e(),"datetimerange"===a.type||"daterange"===a.type?[t("date-picker",{ref:"datepicker",refInFor:!0,attrs:{time_option:e.search_option[s]},on:{"fn-emit":function(t){return e.FnGetTime(t,s)}}})]:e._e()],2)})),e.type?e._e():t("div",{staticClass:"m-bottom20"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("查 询")]),t("el-button",{attrs:{type:"default"},on:{click:e.FnClear}},[e._v("清 空")])],1)],2),e.type?t("div",{staticClass:"m-bottom5"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("查 询")]),"physical"===e.type?t("el-button",{attrs:{type:"primary"},on:{click:e.FnMultiSearch}},[e._v("批量查询")]):e._e(),t("el-button",{attrs:{type:"default"},on:{click:e.FnClear}},[e._v("清 空")]),t("el-button",{staticClass:"m-bottom10",attrs:{type:"text"},on:{click:e.operate}},[e._v(e._s(e.isOpen?"折叠":"展开"))])],1):e._e(),e._t("default",(function(){return[e.create_btn?t("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.FnShowCreate}},[e._v(e._s(e.create_btn))]):e._e()]})),t("el-dialog",{attrs:{title:"批量查询",visible:e.syncVisible,width:"400px","destroy-on-close":!0,"close-on-click-modal":!1}},[t("el-input",{attrs:{type:"textarea",rows:13,placeholder:"请输入主机ID/名称,格式如下：\nPOD01-CLU01-H001\nPOD01-CLU01-H002\nPOD01-CLU01-H003\n..."},model:{value:e.search_value["host_info"],callback:function(t){e.$set(e.search_value,"host_info",t)},expression:"search_value['host_info']"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.FnSearch}},[e._v("确认")]),t("el-button",{on:{click:function(t){e.syncVisible=!1}}},[e._v("取消")])],1)],1)],2)},i=[],o=a("9ab4"),r=a("1b40"),l=a("9a8d");let n=class extends r["e"]{constructor(){super(...arguments),this.search_value={},this.time=null,this.date_key="",this.syncVisible=!1,this.isOpen=!0}FnGetTime(e,t){this.time=e,this.date_key=t}FnSearch(){return this.syncVisible=!1,this.search_value[this.date_key]=this.time,this.search_value}watch_search_option(){this.type&&this.$nextTick(()=>{let e=this.$refs.search,t=window.getComputedStyle(e).height.replace("px","");parseInt(t)>52&&this.isOpen&&(this.isOpen=!1),this.FnOperate()})}FnMultiSearch(){this.syncVisible=!0}operate(){this.isOpen=!this.isOpen,this.FnOperate()}FnOperate(){}FnShowCreate(){}watch_search_value(e,t){}FnClear(){for(let e in this.search_option)["datetimerange","daterange"].includes(this.search_option[e].type)?this.$refs.datepicker[0].FnClear():this.search_value={};this.FnSearch()}mounted(){let e=0;for(let t in this.search_option)this.search_option[t].default_value&&(this.$set(this.search_value,t,this.search_option[t].default_value),e++),"composite"===this.search_option[t].type&&this.$set(this.search_value,t+"sub",this.search_option[t].list[0].type);(e>0||"physical"===this.type)&&setTimeout(()=>{this.FnSearch()},500)}};Object(o["a"])([Object(r["c"])({default:{}})],n.prototype,"search_option",void 0),Object(o["a"])([Object(r["c"])({default:""})],n.prototype,"create_btn",void 0),Object(o["a"])([Object(r["c"])({default:!0})],n.prototype,"disabled",void 0),Object(o["a"])([Object(r["c"])({default:!1})],n.prototype,"type",void 0),Object(o["a"])([Object(r["c"])({default:!0})],n.prototype,"isShowBg",void 0),Object(o["a"])([Object(r["b"])("fn-search")],n.prototype,"FnSearch",null),Object(o["a"])([Object(r["f"])("search_option",{immediate:!0,deep:!0})],n.prototype,"watch_search_option",null),Object(o["a"])([Object(r["b"])("fn-operate")],n.prototype,"FnOperate",null),Object(o["a"])([Object(r["b"])("fn-create")],n.prototype,"FnShowCreate",null),Object(o["a"])([Object(r["f"])("search_value",{immediate:!0,deep:!0})],n.prototype,"watch_search_value",null),n=Object(o["a"])([Object(r["a"])({components:{DatePicker:l["a"]}})],n);var c=n,d=c,p=(a("4774"),a("26f3"),a("2877")),_=Object(p["a"])(d,s,i,!1,null,"20a86f62",null);t["a"]=_.exports},c839:function(e,t,a){"use strict";var s=a("81a9"),i=a("bff7");t["a"]={get_pod_list(e){return Object(s["a"])(Object(i["b"])("GET","/pod/get_pod_list/",e))},get_az_info(e){return Object(s["a"])(Object(i["b"])("GET","/pod/get_pod_info/",e))},create_pod(e){return Object(s["a"])(Object(i["b"])("POST","/pod/create_pod/",e))},update_pod(e){return Object(s["a"])(Object(i["b"])("POST","/pod/update_pod/",e))},get_pod_history(e){return Object(s["a"])(Object(i["b"])("GET","/pod/get_pod_history/",e))}}}}]);