(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-5fa8fb75"],{ab43:function(t,e,s){"use strict";var i=s("23e7"),a=s("c65b"),r=s("59ed"),n=s("825a"),o=s("46c4"),l=s("c5cc"),u=s("9bdd"),c=s("2a62"),d=s("2baa"),_=s("f99f"),h=s("c430"),p=!h&&!d("map",(function(){})),b=!h&&!p&&_("map",TypeError),m=h||p||b,f=l((function(){var t=this.iterator,e=n(a(this.next,t)),s=this.done=!!e.done;if(!s)return u(t,this.mapper,[e.value,this.counter++],!0)}));i({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(t){n(this);try{r(t)}catch(e){c(this,"throw",e)}return b?a(b,this,t):new f(o(this),{mapper:t})}})},b721:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("action-block",{attrs:{search_option:t.search_dom},on:{"fn-search":t.search},scopedSlots:t._u([{key:"default",fn:function(){return t._l(t.operate_btns,(function(s){return e("el-button",{key:s.value,attrs:{type:"primary",disabled:!t.auth_list.includes(s.value)},on:{click:function(e){return t.handleBtn(s.label,s.value)}}},[t._v(t._s(s.label))])}))},proxy:!0}])}),e("el-table",{ref:"disk_table",attrs:{data:t.disk_list,border:""},on:{"selection-change":t.handleSelectionChange,"filter-change":t.filterAttribute}},[e("el-table-column",{attrs:{type:"selection"}}),e("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),e("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),e("el-table-column",{attrs:{prop:"disk_id",label:"云盘ID"}}),e("el-table-column",{attrs:{prop:"disk_name",label:"云盘名称"}}),e("el-table-column",{attrs:{prop:"customer_id",label:"云盘状态","filter-multiple":!1,filters:t.disk_state,"column-key":"status"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{class:s.row.status},[t._v(t._s(s.row.status_name))])]}}])}),e("el-table-column",{attrs:{prop:"customer_id",label:"IOPS及吞吐","min-width":"110px"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[t._v("IOPS："+t._s(s.row.disk_iops?`${s.row.disk_iops}${s.row.iops_unit}`:""))]),e("div",[t._v("吞吐量："+t._s(s.row.band_mbps?`${s.row.band_mbps}${s.row.mbps_unit}`:""))])]}}])}),e("el-table-column",{attrs:{prop:"customer_id",label:"地域-可用区","min-width":"110ox"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.region_name)+"  "+t._s(s.row.az_name))])]}}])}),e("el-table-column",{attrs:{prop:"customer_id",label:"属性"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s("data"===s.row.disk_type?"数据盘":"系统盘"))])]}}])}),e("el-table-column",{attrs:{prop:"customer_id",label:"实例ID"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("pre",[t._v(t._s(s.row.ecs_id?s.row.ecs_id:""))])]}}])}),e("el-table-column",{attrs:{prop:"dev_id",label:"dev_id"}}),e("el-table-column",{attrs:{prop:"dev_name",label:"dev_name"}}),e("el-table-column",{attrs:{prop:"cluster_name",label:"集群名称","min-width":"95px"}}),e("el-table-column",{attrs:{prop:"pool_name",label:"存储池名称"}})],1),e("el-pagination",{attrs:{"current-page":t.current,"page-sizes":[20,50,100],"page-size":t.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t.visible?[e("Iops",{attrs:{visible:t.visible,title:t.oper_label,oper_type:t.oper_type,mount_id:t.mount_id},on:{close:t.close_disk}})]:t._e()],2)},a=[],r=(s("e9f5"),s("d866"),s("9ab4")),n=s("1b40"),o=s("c811"),l=s("a03d"),u=s("f33c"),c=s("8ce4");let d=class extends n["e"]{constructor(){super(...arguments),this.disk_list=[],this.current=1,this.size=20,this.total=0,this.filter_obj=null,this.visible=!1,this.oper_type="",this.oper_label="",this.disk_state=[],this.mount_id=[],this.req_data={},this.auth_list=[],this.search_dom={customer_id:{placeholder:"请输入客户ID"},disk_id:{placeholder:"请输入云盘ID"},ecs_id:{placeholder:"请输入实例ID"}},this.operate_btns=[{label:"设置IOPS",value:"iops"},{label:"设置吞吐量",value:"mbps"}]}search(t={}){this.current=1,this.req_data={...t,...this.filter_obj},this.getDataList()}created(){this.auth_list=this.$store.state.auth_info[this.$route.name],this.get_disk_state(),this.search()}async get_disk_state(){let t=await u["a"].get_disk_state({});"Success"===t.code&&(this.disk_state=Object(c["e"])(t.data,"status_name","status","text","value"))}handleBtn(t,e){if(0===this.mount_id.length)return void this.$message.warning("请先勾选云盘!");if(!this.judge_disk("customer_id",this.mount_id[0].customer_id))return void this.$message.warning("只允许对同一客户的云盘进行批量操作！");if(!this.judge_disk("az_name",this.mount_id[0].az_name))return void this.$message.warning("只允许对同一可用区的云盘进行批量操作！");const s=this.mount_id.every((t,e,s)=>"running"===t.ecs_status&&"running"===t.status||"running"===t.disk_status&&"shutdown"===t.ecs_status&&t.no_charge_shutdown_ecs||"waiting"===t.status);if(!s)return void this.$message.warning("仅支持对实例状态为运行中且云盘状态为使用中，或云盘状态为待挂载的云盘进行批量操作！");let i="iops"===e?"IOPS":"吞吐量";this.operate(e,i,this.mount_id)}judge_disk(t,e){return this.mount_id.every((s,i,a)=>s[t]===e)}operate(t,e,s){this.mount_id=s,this.oper_type=t,this.oper_label=e,this.visible=!0}close_disk(t="1"){this.visible=!1,this.mount_id=[],this.oper_type="",this.toggleSelection(),"1"===t&&(this.current=1),this.getDataList()}toggleSelection(){const t=this.$refs.disk_table;t.clearSelection()}handleSelectionChange(t){this.mount_id=t}filterAttribute(t){this.filter_obj={...this.filter_obj,...t},this.search(this.req_data)}handleSizeChange(t){this.size=t,this.getDataList()}handleCurrentChange(t){this.current=t,this.getDataList()}async getDataList(){const{req_data:t}=this;let e=await u["a"].get_disk_list({pod_id:this.$store.state.pod_id,disk_id:t.disk_id||"",ecs_id:t.ecs_id||"",status:t.status?t.status[0]:"",customer_id:t.customer_id||"",page_index:this.current,page_size:this.size});"Success"===e.code&&(this.disk_list=e.data.result||[],this.total=e.data.page_info.count||0)}};d=Object(r["a"])([Object(n["a"])({components:{ActionBlock:o["a"],Iops:l["a"]}})],d);var _=d,h=_,p=s("2877"),b=Object(p["a"])(h,i,a,!1,null,"e3a26a96",null);e["default"]=b.exports}}]);
//# sourceMappingURL=chunk-5fa8fb75.1764214676553.js.map