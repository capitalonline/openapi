(window["webpackJsonp_AppSp"]=window["webpackJsonp_AppSp"]||[]).push([["chunk-9eb9379c"],{"00b4":function(e,t,s){"use strict";s("ac1f");var a=s("23e7"),i=s("da84"),n=s("c65b"),r=s("e330"),o=s("1626"),l=s("861d"),c=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),u=i.Error,_=r(/./.test);a({target:"RegExp",proto:!0,forced:!c},{test:function(e){var t=this.exec;if(!o(t))return _(this,e);var s=n(t,this,e);if(null!==s&&!l(s))throw new u("RegExp exec method returned something other than an Object or null");return!!s}})},"047f":function(e,t,s){},"06c5":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));s("fb6a"),s("d3b7"),s("b0c0"),s("a630"),s("3ca3"),s("ac1f"),s("00b4");var a=s("6b75");function i(e,t){if(e){if("string"===typeof e)return Object(a["a"])(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Object(a["a"])(e,t):void 0}}},"08a8":function(e,t,s){"use strict";s("ef2a")},"0a4c":function(e,t,s){"use strict";s("1bfb")},"0d1b":function(e,t,s){},"14a1":function(e,t,s){"use strict";s("e8bb")},"1bfb":function(e,t,s){},"1c59":function(e,t,s){"use strict";var a=s("6d61"),i=s("6566");a("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},"23af":function(e,t,s){"use strict";s("6a7a")},2909:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var a=s("6b75");function i(e){if(Array.isArray(e))return Object(a["a"])(e)}s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0"),s("a630");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var r=s("06c5");s("d9e2");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return i(e)||n(e)||Object(r["a"])(e)||o()}},"3f8d":function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return o}));var a={building:"创建中",running:"运行中",restarting:"重启中",shutting_down:"关机中",shutdown:"已关机",starting_up:"开机中",deleting:"删除中",deleted:"已删除",destroying:"销毁中",destroy:"已销毁",updating:"更新中",error:"错误",recovering:"恢复中",failed:"创建失败"},i={start_up_ecs:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"开 机"},shutdown_ecs:{auth:["running"],msg:"已选实例需为运行中！",label:"关 机"},restart_ecs:{auth:["running"],msg:"已选实例状态需为运行中！",label:"重 启"},delete_ecs:{auth:["running","shutdown","error"],msg:"已选实例状态需为已关机或运行中或错误！",label:"逻辑删除"},recover_ecs:{auth:["deleted"],msg:"已选实例状态需为已删除！",label:"恢 复"},destroy_ecs:{auth:["deleted","failed"],msg:"已选实例状态需为已删除或创建失败！",label:"销 毁"},update_spec:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换实例规格"},update_system:{auth:["shutdown"],msg:"已选实例状态需为已关机！",label:"更换操作系统"},reset_pwd:{auth:["running"],msg:"已选实例状态需为运行中！",label:"更换密码"},open_bill:{auth:["running","shutdown"],msg:"已选实例状态需为运行中或已关机！",label:"开启计费"},net_set:{auth:["running"],msg:"已选实例状态需为运行中！",label:"网络设置"}},n={start_up_host:{power:["shutdown"],host:["offline","online","exception","maintenance"],msg:"已选主机需为在线、离线、异常或维护状态",label:"开机"},shutdown_host:{power:["running"],host:["maintenance"],vm:1,msg:"已选主机需为维护状态",msg2:"操作关机前，请确保物理机上无云主机运行",label:"关机"},restart_host:{power:["running"],host:["offline","online","maintenance"],msg:"已选主机需为在线、离线或维护状态",label:"重启"},online_maintenance:{power:[],host:["online","exception"],msg:"已选主机需为在线状态",label:"在线维护"},maintenance:{power:[],host:[],msg:"",label:"设置维护"},offline_maintenance:{power:[],host:["offline","online","exception"],vm:1,msg:"已选主机需为在线或离线状态且已选主机上不能有虚拟机运行",label:"离线维护"},finish:{power:[],host:["maintenance","online_maintenance","offline_maintenance"],msg:"已选主机需为维护中状态",label:"完成维护"},shelves:{power:[],host:[],vm:1,msg:"已选主机上不能有虚拟机运行",label:"下架"},disperse:{power:["running"],host:["online"],msg:"已选主机需为在线状态",label:"驱散"},out_of_band:{power:[],host:["offline","online"],msg:"已选主机需为在线或离线状态",label:"进入带外管理"},migrate:{power:["running"],host:["online","storage_error","crash"],msg:"已选主机需为在线、存储异常或宕机状态",label:"迁移"},lock:{power:[],host:[],msg:"",label:"锁定"},unlock:{power:[],host:["lock"],msg:"已选主机需为锁定状态",label:"解锁"},unstore_exception:{power:[],host:["storage_error"],msg:"已选主机需为存储异常状态",label:"解除存储异常"},service:{power:[],host:[],msg:"",label:"服务更新"},rollback:{power:[],host:[],label:"回滚"},physical_detail:{power:[],host:[],msg:"",label:"详情"},data_clear:{power:[],host:["crash_clear"],msg:"",label:"数据清理同步"},down_recover:{power:[],host:["crash_recover"],msg:"",label:"宕机恢复"},sign:{power:[],host:[],msg:"",label:"设备标记"},upload:{power:[],host:[],msg:"",label:"导入"},under_sync:{power:[],host:[],msg:"",label:"底层同步"},cheat:{power:[],host:[],msg:"",label:"欺骗器管理"},business_test:{power:[],host:[],msg:"",label:"业务测试"},record:{power:[],host:[],msg:"",label:"操作记录"},resource:{power:[],host:[],msg:"",label:"分配资源"},remark:{power:[],host:[],msg:"",label:"编辑备注"},add_cluster:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"加入集群"},change_cluster:{power:[],host:[],msg:"",label:"更换集群"},remove_cluster:{power:[],host:["maintenance"],mag:"",label:"移出集群"},set_label:{power:[],host:[],msg:"",label:"添加标签"},set_prepar_host:{power:[],host:["online"],msg:"已选主机需为在线状态",label:"设为备机"},set_resource_pools:{power:[],host:["online"],msg:"",label:"设为资源池"}};t["a"]={getInsOperateAuth:function(e){return i[e]}};var r=function(e){return a[e]},o=function(e){return n[e]}},"408a":function(e,t,s){var a=s("e330");e.exports=a(1..valueOf)},4164:function(e,t,s){},"4fad":function(e,t,s){var a=s("d039"),i=s("861d"),n=s("c6b6"),r=s("d86b"),o=Object.isExtensible,l=a((function(){o(1)}));e.exports=l||r?function(e){return!!i(e)&&((!r||"ArrayBuffer"!=n(e))&&(!o||o(e)))}:o},"542d":function(e,t,s){},5840:function(e,t,s){"use strict";s("fd7f")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,s){var a=s("e330"),i=s("1d80"),n=s("577e"),r=s("5899"),o=a("".replace),l="["+r+"]",c=RegExp("^"+l+l+"*"),u=RegExp(l+l+"*$"),_=function(e){return function(t){var s=n(i(t));return 1&e&&(s=o(s,c,"")),2&e&&(s=o(s,u,"")),s}};e.exports={start:_(1),end:_(2),trim:_(3)}},"5a59":function(e,t,s){"use strict";s("7123")},6062:function(e,t,s){s("1c59")},6566:function(e,t,s){"use strict";var a=s("9bf2").f,i=s("7c73"),n=s("e2cc"),r=s("0366"),o=s("19aa"),l=s("2266"),c=s("7dd0"),u=s("2626"),_=s("83ab"),p=s("f183").fastKey,d=s("69f3"),h=d.set,f=d.getterFor;e.exports={getConstructor:function(e,t,s,c){var u=e((function(e,a){o(e,d),h(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),_||(e.size=0),void 0!=a&&l(a,e[c],{that:e,AS_ENTRIES:s})})),d=u.prototype,m=f(t),b=function(e,t,s){var a,i,n=m(e),r=v(e,t);return r?r.value=s:(n.last=r={index:i=p(t,!0),key:t,value:s,previous:a=n.last,next:void 0,removed:!1},n.first||(n.first=r),a&&(a.next=r),_?n.size++:e.size++,"F"!==i&&(n.index[i]=r)),e},v=function(e,t){var s,a=m(e),i=p(t);if("F"!==i)return a.index[i];for(s=a.first;s;s=s.next)if(s.key==t)return s};return n(d,{clear:function(){var e=this,t=m(e),s=t.index,a=t.first;while(a)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete s[a.index],a=a.next;t.first=t.last=void 0,_?t.size=0:e.size=0},delete:function(e){var t=this,s=m(t),a=v(t,e);if(a){var i=a.next,n=a.previous;delete s.index[a.index],a.removed=!0,n&&(n.next=i),i&&(i.previous=n),s.first==a&&(s.first=i),s.last==a&&(s.last=n),_?s.size--:t.size--}return!!a},forEach:function(e){var t,s=m(this),a=r(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:s.first){a(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!v(this,e)}}),n(d,s?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return b(this,0===e?0:e,t)}}:{add:function(e){return b(this,e=0===e?0:e,e)}}),_&&a(d,"size",{get:function(){return m(this).size}}),u},setStrong:function(e,t,s){var a=t+" Iterator",i=f(t),n=f(a);c(e,t,(function(e,t){h(this,{type:a,target:e,state:i(e),kind:t,last:void 0})}),(function(){var e=n(this),t=e.kind,s=e.last;while(s&&s.removed)s=s.previous;return e.target&&(e.last=s=s?s.next:e.state.first)?"keys"==t?{value:s.key,done:!1}:"values"==t?{value:s.value,done:!1}:{value:[s.key,s.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),s?"entries":"values",!s,!0),u(t)}}},"682f":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"total"},[s("div",{staticClass:"used",style:{height:e.hei&&0!==e.hei?e.hei+"%":0,background:e.hei>=0&&e.hei<50?"#67c23a":e.hei<80?"yellow":"red"}})])},i=[],n=s("bee2"),r=s("d4ec"),o=s("262e"),l=s("2caf"),c=(s("a9e3"),s("9ab4")),u=s("1b40"),_=function(e){Object(o["a"])(s,e);var t=Object(l["a"])(s);function s(){return Object(r["a"])(this,s),t.apply(this,arguments)}return Object(n["a"])(s)}(u["e"]);Object(c["a"])([Object(u["c"])(Number)],_.prototype,"hei",void 0),_=Object(c["a"])([Object(u["a"])({})],_);var p=_,d=p,h=(s("c765"),s("2877")),f=Object(h["a"])(d,a,i,!1,null,"43aeadcd",null);t["a"]=f.exports},"6a7a":function(e,t,s){},"6b75":function(e,t,s){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=e[s];return a}s.d(t,"a",(function(){return a}))},"6d61":function(e,t,s){"use strict";var a=s("23e7"),i=s("da84"),n=s("e330"),r=s("94ca"),o=s("6eeb"),l=s("f183"),c=s("2266"),u=s("19aa"),_=s("1626"),p=s("861d"),d=s("d039"),h=s("1c7e"),f=s("d44e"),m=s("7156");e.exports=function(e,t,s){var b=-1!==e.indexOf("Map"),v=-1!==e.indexOf("Weak"),g=b?"set":"add",y=i[e],k=y&&y.prototype,w=y,O={},j=function(e){var t=n(k[e]);o(k,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(v&&!p(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return v&&!p(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!p(e))&&t(this,0===e?0:e)}:function(e,s){return t(this,0===e?0:e,s),this})},x=r(e,!_(y)||!(v||k.forEach&&!d((function(){(new y).entries().next()}))));if(x)w=s.getConstructor(t,e,b,g),l.enable();else if(r(e,!0)){var C=new w,S=C[g](v?{}:-0,1)!=C,T=d((function(){C.has(1)})),R=h((function(e){new y(e)})),z=!v&&d((function(){var e=new y,t=5;while(t--)e[g](t,t);return!e.has(-0)}));R||(w=t((function(e,t){u(e,k);var s=m(new y,e,w);return void 0!=t&&c(t,s[g],{that:s,AS_ENTRIES:b}),s})),w.prototype=k,k.constructor=w),(T||z)&&(j("delete"),j("has"),b&&j("get")),(z||S)&&j(g),v&&k.clear&&delete k.clear}return O[e]=w,a({global:!0,forced:w!=y},O),f(w,e),v||s.setStrong(w,e,b),w}},7123:function(e,t,s){},"76b1":function(e,t,s){"use strict";s("956e")},"76ff":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"配置详情",visible:e.visible,width:"60%","destroy-on-close":!0},on:{"update:visible":function(t){e.visible=t},close:e.back}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("云服务器ID:")]),s("span",[e._v(e._s(e.detail&&e.detail.ecs_id))])]),s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("地域:")]),s("span",[e._v(e._s(e.detail&&e.detail.region_name))])])],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{staticClass:"name-row",attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("云服务器名称:")]),s("span",[s("pre",[e._v(e._s(e.detail&&e.detail.ecs_name))])])]),s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("可用区:")]),s("span",[e._v(e._s(e.detail&&e.detail.az_name))])])],1),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:10}},[s("span",{staticClass:"label"},[e._v("状态:")]),s("span",[e._v(e._s(e.detail&&e.detail.status_display))])])],1),s("div",{staticClass:"title"},[e._v("计算规格")]),s("el-row",{attrs:{gutter:20}},[e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name?s("el-col",{attrs:{span:20}},[s("span",{staticClass:"label"},[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.conf_name)+":")]),s("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.name))]),e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num?s("span",[e._v("   "+e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.cpu_num)+"vCPU "),s("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.ram)+"GiB")]),e.detail&&e.detail.is_gpu?s("span",[e._v(e._s(e.detail&&e.detail.ecs_rule&&e.detail.ecs_rule.gpu)+"*"+e._s(e.detail&&e.detail.card_name))]):e._e()]):e._e()]):e._e()],1),s("div",{staticClass:"title"},[e._v("操作系统")]),s("div",{staticClass:"content"},[e._v(e._s(e.detail&&e.detail.os_info&&e.detail.os_info.name))]),s("div",{staticClass:"title"},[e._v("存储")]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("系统盘：")]),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf?s("span",{staticClass:"data-disk"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.disk_name))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size?s("span",{staticClass:"data-disk-unit"},[e._v(e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.size)+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.unit))]):e._e(),e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id?s("span",{staticClass:"id_name"},[e._v("("+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.id)+" / "+e._s(e.detail&&e.detail.disk&&e.detail.disk.system_disk_conf&&e.detail.disk.system_disk_conf.name)+")")]):e._e()]),s("div",{staticClass:"content data_disk"},[s("span",{staticClass:"label"},[e._v("数据盘：")]),e.detail&&e.detail.disk&&e.detail.disk.data_disk_conf?s("div",{staticClass:"disk_content"},e._l(e.detail.disk.data_disk_conf,(function(t){return s("div",{key:t.id},[s("span",{staticClass:"data-disk"},[e._v(e._s(t.disk_name))]),s("span",{staticClass:"data-disk-unit"},[e._v(e._s(t.size)+e._s(t.unit))]),s("span",{staticClass:"id_name"},[e._v("("+e._s(t.id)+" / "+e._s(t.name)+")")]),s("span",[e._v(e._s(t.is_follow_delete?"随实例删除":"不随实例删除"))])])})),0):e._e()]),s("div",{staticClass:"title"},[e._v("网络")]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("VPC:")]),e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id?s("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.vpc_name))]):e._e()]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("子网:")]),e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id?s("span",[e._v(e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_id)+" / "+e._s(e.detail&&e.detail.pipe&&e.detail.pipe.subnet_name))]):e._e()]),s("div",{staticClass:"content display-flex"},[s("span",{staticClass:"label"},[e._v("私网IP：")]),e.detail&&e.detail.pipe?s("span",[e.detail.pipe.private_net?[e._v(e._s(e.detail.pipe.private_net)+" （主）")]:e._e(),s("br"),e.detail.pipe.pub_net?[e._v(" "+e._s(e.detail.pipe.pub_net)+" "),e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） ")]:e._e(),s("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(t){return s("span",{key:t},[e._v(" "+e._s(t)+" "),e.detail.pipe.eip_info[t]&&e.detail.pipe.eip_info[t].conf_name?[e._v(" （"+e._s(e.detail.pipe.eip_info[t].conf_name)+"） ")]:e._e(),s("br")],2)}))],2):e._e()]),s("div",{staticClass:"content display-flex"},[s("span",{staticClass:"label"},[e._v("公网IP：")]),e.detail&&e.detail.pipe?s("span",[e.detail.pipe.pub_net&&e.detail.pipe.eip_info[e.detail.pipe.pub_net]&&e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip?[e._v(" "+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].eip_ip)+" （"+e._s(e.detail.pipe.eip_info[e.detail.pipe.pub_net].conf_name)+"） "),s("br")]:e._e(),e._l(e.detail.pipe.virtual_net,(function(t){return s("span",{key:t},[e.detail.pipe.eip_info[t]&&e.detail.pipe.eip_info[t].conf_name?[e._v(" "+e._s(t.eip_ip)+" （"+e._s(e.detail.pipe.eip_info[t].conf_name)+"） ")]:e._e(),s("br")],2)}))],2):e._e()]),s("div",{staticClass:"divider"}),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("所属机房:")]),s("span",[e._v(e._s(e.detail&&e.detail.engine_room))])]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("所属节点:")]),s("span",[e._v(e._s(e.detail&&e.detail.host_name))])]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("所属物理机:")]),e.detail&&e.detail.host_id?s("span",[e._v(e._s(e.detail&&e.detail.host_id)+"   "),e.detail&&e.detail.host_status?s("span",[e._v("( "+e._s(e.detail&&e.detail.host_status)+" )")]):e._e()]):e._e()]),s("div",{staticClass:"content"},[s("span",{staticClass:"label"},[e._v("处理器型号:")]),s("span",[e._v(e._s(e.detail&&e.detail.cpu_type))])]),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("返回")])],1)],1)])],1)},i=[],n=s("1da1"),r=s("d4ec"),o=s("bee2"),l=s("262e"),c=s("2caf"),u=(s("96cf"),s("9ab4")),_=s("1b40"),p=s("d772"),d=function(e){Object(l["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.detail=null,e.loading=!1,e}return Object(o["a"])(s,[{key:"getDetail",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p["a"].get_detail({ecs_id:this.detail_id});case 2:t=e.sent,"Success"===t.code?(this.loading=!1,this.detail=t.data):this.loading=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(){}},{key:"created",value:function(){this.getDetail()}}]),s}(_["e"]);Object(u["a"])([Object(_["c"])(Boolean)],d.prototype,"visible",void 0),Object(u["a"])([Object(_["c"])(String)],d.prototype,"detail_id",void 0),Object(u["a"])([Object(_["b"])("close-detail")],d.prototype,"back",null),d=Object(u["a"])([_["a"]],d);var h=d,f=h,m=(s("d8a7"),s("2877")),b=Object(m["a"])(f,a,i,!1,null,"33b12e64",null);t["a"]=b.exports},"7db0":function(e,t,s){"use strict";var a=s("23e7"),i=s("b727").find,n=s("44d2"),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),a({target:"Array",proto:!0,forced:o},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(r)},8127:function(e,t,s){"use strict";s("0d1b")},"8da7":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("action-block",{attrs:{search_option:e.search_option,type:"physical"},on:{"fn-search":e.fn_search,"fn-operate":e.FnOperate},scopedSlots:e._u([{key:"default",fn:function(){return[e._l(e.operate_btns,(function(t){return[t.subItems&&t.subItems.length>0?s("el-dropdown",{key:t.value,on:{command:e.handleMore}},[s("el-button",{staticClass:"dropdownbtn",attrs:{type:"primary"}},[e._v(" "+e._s(t.text)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(t.subItems,(function(t,a){return s("el-dropdown-item",{key:a,attrs:{command:{label:t.label,value:t.value}}},[e._v(" "+e._s(t.label)+" ")])})),1)],1):["business_test"===t.value&&e.$store.state.is_special_user?e._e():s("el-button",{key:t.value,staticClass:"dropdownbtn",attrs:{type:"primary"},on:{click:function(s){return e.handle(t.label,t.value)}}},[e._v(" "+e._s(t.label)+" ")])]]}))]},proxy:!0}])}),s("div",{staticClass:"icon m-bottom10"},[s("el-tooltip",{attrs:{content:"自定义列表项",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.FnCustom}},[s("i",{staticClass:"el-icon-s-tools"})])],1),s("el-tooltip",{attrs:{content:"刷新",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text"},on:{click:e.refresh}},[s("svg-icon",{staticClass:"refresh",attrs:{icon:"refresh"}})],1)],1),s("el-tooltip",{attrs:{content:"导出",placement:"bottom",effect:"light"}},[s("el-button",{attrs:{type:"text",disabled:!e.auth_list.includes("export")},on:{click:e.down}},[s("svg-icon",{staticClass:"export",attrs:{icon:"export"}})],1)],1)],1),s("el-table",{ref:"table",attrs:{data:e.list,border:"","max-height":e.tableHeight},on:{"selection-change":e.handleSelectionChange,"sort-change":e.FnSortChange,"filter-change":e.filterAttribute,"expand-change":e.FnExpand}},[s("el-table-column",{attrs:{type:"selection"}}),e._l(e.custom_host,(function(t){return s("el-table-column",{key:t.prop,attrs:{"filter-multiple":!t.column_key&&null,prop:t.prop,"column-key":t.column_key?t.column_key:null,filters:t.column_key?t.list:null,sortable:t.sortable?t.sortable:null,width:t.width?t.width:null,type:t.type,"class-name":t.className?t.className:null},scopedSlots:e._u([{key:"header",fn:function(a){return["ecs_num"===t.prop?[s("span",[e._v("虚拟机数量")]),s("el-tooltip",{attrs:{"popper-class":"tooltip-width",content:"云桌面/文件存储转发的虚机未纳入统计，所以主机属性为云桌面/文件存储转发的物理机虚机数量为0不代表无虚机。",effect:"light"}},[s("el-button",{staticClass:"m-left5 m-right5",attrs:{type:"text"}},[s("svg-icon",{staticClass:"more",attrs:{icon:"info",viewBox:"0 0 20 20"}})],1)],1)]:s("span",[e._v(e._s(t.label))])]}},"machine_status_name"===t.prop?{key:"default",fn:function(t){return["maintenance"!==t.row.machine_status&&"lock"!==t.row.machine_status?s("div",{class:"crash"===t.row.machine_status?"error":""},[e._v(e._s(t.row.machine_status_name))]):e._e(),"off_shelves"===t.row.machine_status?s("div",{staticClass:"destroy"},[e._v(e._s(t.row.recycle_department))]):e._e(),"maintenance"===t.row.machine_status||"lock"===t.row.machine_status?s("div",{staticClass:"destroy"},[s("el-popover",{attrs:{placement:"bottom",width:"350",trigger:"click"}},[s("el-table",{attrs:{data:e.reason_list}},[s("el-table-column",{attrs:{width:"150",property:"reason",label:"备注信息"}}),s("el-table-column",{attrs:{width:"90",property:"create_time",label:"时间"}}),s("el-table-column",{attrs:{width:"100",property:"op_user",label:"操作人"}})],1),s("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(s){return e.get_reason_list(t.row.machine_status,t.row.host_id)}},slot:"reference"},[e._v(e._s(t.row.machine_status_name))])],1)],1):e._e()]}}:"net_nic"===t.prop?{key:"default",fn:function(t){return[t.row.net_nic.length>0?s("el-tooltip",{attrs:{effect:"light"}},[s("div",{attrs:{slot:"content"},slot:"content"},e._l(t.row.net_nic,(function(t,a){return s("div",{key:a},[e._v(e._s(t))])})),0),s("div",{staticClass:"tooltip-cell"},[e._v(e._s(t.row.net_nic[0]))])]):s("div")]}}:"cpu"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(parseFloat(t.row.cpu).toFixed(2)+"%"))])]}}:"hugepages_free"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.hugepages_free+"GB"))])]}}:"ram"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(parseFloat(t.row.ram).toFixed(2)+"%"))]),s("br"),s("span",[e._v("("+e._s(parseFloat(t.row.raw_available/1024).toFixed(2)+"GB")+")")])]}}:"ecs_num"===t.prop?{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"}},[e._v(e._s(t.row.ecs_num))])]}}:"gpu_info"===t.prop?{key:"default",fn:function(t){return[t.row.gpu_info.length>0?s("el-tooltip",{attrs:{effect:"light"}},[s("div",{attrs:{slot:"content"},slot:"content"},e._l(t.row.gpu_info,(function(t,a){return s("div",{key:a},[e._v(" "+e._s(t.card_name)+" ")])})),0),s("div",{staticClass:"tooltip-cell"},[e._v(e._s(t.row.gpu_info[0].card_name))])]):s("div")]}}:"exclusive_black_customers"===t.prop?{key:"default",fn:function(t){return[t.row.exclusive_black_customers.length>1?s("el-tooltip",{attrs:{effect:"light"},scopedSlots:e._u([{key:"content",fn:function(){return e._l(t.row.exclusive_black_customers,(function(t){return s("div",[e._v(e._s(t.id+" ("+t.name+")"))])}))},proxy:!0}],null,!0)},[s("span",[e._v(e._s(t.row.exclusive_black_customers.map((function(e){return e.id})).join(",")))])]):1===t.row.exclusive_black_customers.length?s("span",[e._v(e._s(t.row.exclusive_black_customers[0].id+" ("+t.row.exclusive_black_customers[0].name+")"))]):s("span")]}}:"exclusive_customers"===t.prop?{key:"default",fn:function(t){return[t.row.exclusive_customers.length>1?s("el-tooltip",{scopedSlots:e._u([{key:"content",fn:function(){return e._l(t.row.exclusive_customers,(function(t){return s("div",[e._v(e._s(t.id+" ("+t.name+")"))])}))},proxy:!0}],null,!0)},[s("span",[e._v(e._s(t.row.exclusive_customers.map((function(e){return e.id})).join(",")))])]):1===t.row.exclusive_customers.length?s("span",[e._v(e._s(t.row.exclusive_customers[0].id+" ("+t.row.exclusive_customers[0].name+")"))]):s("span",[e._v("全部客户")])]}}:"ecs_num_expand"===t.prop?{key:"default",fn:function(a){return[a.row.ecs_detail?s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:a.row.ecs_detail,"max-height":400}},e._l(e.ecs_fields,(function(a){return s("el-table-column",{key:a.prop,ref:"ecs_list",refInFor:!0,attrs:{label:a.label,prop:a.prop,width:a.width?a.width:null},scopedSlots:e._u(["ecs_name"===a.prop?{key:"default",fn:function(t){return[s("span",{staticClass:"clickble",on:{click:function(s){return e.FnToDetail(t.row.ecs_id)}}},[e._v(e._s(t.row.ecs_name))])]}}:"status"===a.prop?{key:"default",fn:function(t){return[s("span",{class:t.row.status},[e._v(e._s(t.row.status_display))])]}}:"private_net"===a.prop?{key:"default",fn:function(t){return e._l(t.row.private_net.split(";"),(function(a){return s("div",{key:a},[t.row.eip_info[a]?s("span",[e._v(" "+e._s(a)+" （vlan "+e._s(t.row.eip_info[a].vlan_id)+"） ")]):e._e()])}))}}:"pub_net"===a.prop?{key:"default",fn:function(a){return[a.row.pub_net?s("div",[a.row.eip_info[a.row.pub_net]&&a.row.eip_info[a.row.pub_net].conf_name?s("span",{staticClass:"circel-border"},[e._v(" "+e._s(a.row.eip_info[a.row.pub_net].conf_name)+" ")]):e._e(),e._v(" "+e._s(a.row.pub_net)+" （vlan "+e._s(a.row.eip_info[a.row.pub_net].vlan_id)+"） ")]):e._e(),e._l(a.row.virtual_net,(function(i){return s("div",{key:i},[a.row.eip_info[i]&&a.row.eip_info[i].conf_name?s("span",{staticClass:"circel-border"},[e._v(" "+e._s(a.row.eip_info[i].conf_name)+" ")]):e._e(),e._v(" "+e._s(i)+"（vlan "+e._s(a.row.eip_info[t].vlan_id)+"）")])}))]}}:"pub_ip"===a.prop?{key:"default",fn:function(t){return[t.row.eip_info[t.row.pub_net]&&t.row.eip_info[t.row.pub_net].conf_name?s("div",[s("span",{staticClass:"circel-border"},[e._v(" "+e._s(t.row.eip_info[t.row.pub_net].conf_name)+" ")]),e._v(" "+e._s(t.row.eip_info[t.row.pub_net].eip_ip)+" ")]):e._e(),e._l(t.row.virtual_net,(function(a){return s("div",{key:a},[t.row.eip_info[a]&&t.row.eip_info[a].conf_name?[s("span",{staticClass:"circel-border"},[e._v(e._s(t.row.eip_info[a].conf_name))]),e._v(" "+e._s(t.row.eip_info[a].eip_ip)+" ")]:e._e()],2)}))]}}:"ecs_info"===a.prop?{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.ecs_goods_name)+" "),s("br"),e._v(" "+e._s(t.row.cpu_size)+"vCPU | "+e._s(t.row.ram_size)+"GiB "),s("br"),t.row.gpu_size?s("span",[e._v("| "+e._s(t.row.gpu_size)+"*"+e._s(t.row.card_name))]):e._e()]}}:"disk"===a.prop?{key:"default",fn:function(t){return[s("div",[e._v("系统盘："+e._s(t.row.system_disk_type)+e._s(t.row.system_disk_size)+e._s(t.row.system_disk_unit))]),t.row.data_list_list.length>0?s("div",{staticClass:"disk"},[s("span",[e._v("数据盘：")]),s("div",e._l(t.row.data_list_list,(function(t){return s("p",{key:t.feature},[e._v(e._s(t.feature)+"云盘"+e._s(t.size)+e._s(t.unit))])})),0)]):e._e()]}}:null],null,!0)})})),1):e._e()]}}:"cpu_with_model"===t.prop?{key:"default",fn:function(t){return[t.row.cpu_model?s("span",[e._v(e._s(t.row.cpu_model)+" * "+e._s(t.row.cpu_model_count))]):e._e()]}}:"backend_type"===t.prop?{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.backendObj[t.row.backend_type]))])]}}:"remark"===t.prop?{key:"default",fn:function(t){return[t.row.remark.length>40?s("el-tooltip",{attrs:{"popper-class":"tooltip-width",effect:"light",content:t.row.remark,placement:"bottom"}},[s("span",[e._v(e._s(t.row.remark.slice(0,41)+"..."))])]):s("span",[e._v(e._s(t.row.remark))])]}}:"net_card_with_model"===t.prop?{key:"default",fn:function(t){return[s("div",{staticClass:"net-model"},[t.row.net_model?s("el-tooltip",{attrs:{content:t.row.net_model,"popper-class":"tooltip-width",placement:"right",effect:"light"}},[s("span",{staticClass:"id-cell"},[e._v(e._s(t.row.net_model))])]):e._e(),t.row.net_model?s("span",[e._v(" * "+e._s(t.row.net_model_count))]):e._e()],1)]}}:null],null,!0)})})),s("el-table-column",{attrs:{label:"操作栏"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-dropdown",{on:{command:e.handleOperate}},[s("el-button",{attrs:{type:"text"}},[s("svg-icon",{staticClass:"more",attrs:{icon:"more"}})],1),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.rows_operate_btns,(function(a){return s("el-dropdown-item",{key:a.value,attrs:{command:{title:a.label,label:a.value,value:t.row}}},[e._v(e._s(a.label))])})),1)],1)]}}])})],2),s("el-pagination",{attrs:{"current-page":e.page_info.current,"page-sizes":[20,50,100],"page-size":e.page_info.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page_info.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e.visible&&!["upload","migrate","record","resource","update_attribute","business_test","remark","service","rollback"].includes(e.oper_type)?[s("Operate",{attrs:{title:e.oper_label,rows:e.multi_rows,oper_type:e.oper_type,visible:e.visible},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"upload"===e.oper_type?[s("upload-file",{attrs:{visible:e.visible},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"migrate"===e.oper_type?[s("Migrate",{attrs:{visible:e.visible,rows:e.multi_rows},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"record"===e.oper_type?[s("Record",{attrs:{visible:e.visible,type:"physical",record_id:e.multi_rows[0].host_id},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&["resource","service","rollback"].includes(e.oper_type)?[s("Resource",{attrs:{visible:e.visible,title:e.oper_label,oper_type:e.oper_type,rows:e.multi_rows},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.detail_visible?[s("Detail",{attrs:{visible:e.detail_visible,detail_id:e.detail_id},on:{"close-detail":e.closeDetail}})]:e._e(),e.visible&&"update_attribute"===e.oper_type?[s("update-attribute",{attrs:{visible:e.visible,rows:e.multi_rows},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),e.visible&&"business_test"===e.oper_type?[s("business-test",{attrs:{visible:e.visible,az_info:e.az_info},on:{"update:visible":function(t){e.visible=t}}})]:e._e(),e.visible&&"remark"===e.oper_type?[s("remark",{attrs:{visible:e.visible,rows:e.multi_rows[0]},on:{"update:visible":function(t){e.visible=t},close:e.close}})]:e._e(),s("custom-list-item",{attrs:{visible:e.custom_visible,all_item:e.all_item,all_column_item:e.all_column_item},on:{"update:visible":function(t){e.custom_visible=t},"fn-custom":e.get_custom_columns}})],2)},i=[],n=s("5530"),r=s("2909"),o=s("1da1"),l=s("d4ec"),c=s("bee2"),u=s("262e"),_=s("2caf"),p=(s("96cf"),s("b0c0"),s("d81d"),s("99af"),s("d3b7"),s("159b"),s("4de4"),s("caad"),s("2532"),s("a434"),s("ac1f"),s("1276"),s("a15b"),s("e9c4"),s("fb6a"),s("b64b"),s("7db0"),s("9ab4")),d=s("1b40"),h=s("c811"),f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.title,visible:e.visible_sync,width:"760px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",["restart_host"===e.oper_type?s("el-alert",{attrs:{title:"操作重启请检查是否有虚机运行，若有，请谨慎操作！",type:"warning",center:"",closable:!1}}):e._e(),["lock","maintenance"].includes(e.oper_type)?e._e():s("el-alert",{attrs:{title:e.alert_title,type:"warning",center:"",closable:!1}}),["lock","maintenance"].includes(e.oper_type)?s("el-alert",{attrs:{title:"lock"===e.oper_type?"请确认将下述机器置为锁定状态，置为锁定状态后，无法在此机器上开出云主机":"请确认将下述机器置为维护状态，置为维护状态后，机器将屏蔽告警和任务下发等功能",type:"warning",center:"",closable:!1}}):e._e(),s("el-table",{attrs:{data:e.list,border:"","max-height":"253"}},[s("el-table-column",{attrs:{prop:"host_name",label:"主机名",width:"150"}}),["lock","maintenance"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"out_band_address",label:"宿主机带外"}}):e._e(),"finish_validate"===e.oper_type?s("el-table-column",{attrs:{prop:"az_name",label:"区域"}}):e._e(),e.status_list.concat(e.flag_list).includes(e.title)?e._e():s("el-table-column",{attrs:{prop:"machine_status_name",label:"主机状态"}}),["lock"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"ecs_num",label:"虚拟机数量",width:"150"}}):e._e(),["lock","maintenance"].includes(e.oper_type)?e._e():s("el-table-column",{attrs:{prop:"power_status_name",label:"电源状态"}}),["schedule","migrate_flag","cheat"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"machine_status_name",label:"机器状态"}}):e._e(),"finish_validate"===e.oper_type?s("el-table-column",{attrs:{prop:"host_purpose",label:"主机用途"}}):e._e(),["finish_validate","shelves"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"host_source",label:"主机来源"}}):e._e(),["schedule"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"scheduled_display",label:"允许调度"}}):e._e(),["migrate_flag"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"migrated_display",label:"允许迁移"}}):e._e(),["cheat"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"dummy_display",label:"欺骗器"}}):e._e(),["maintenance"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"maintenance",label:"维护原因"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"请输入维护原因",maxlength:"50","show-word-limit":""},model:{value:t.row.maintenanceReason,callback:function(s){e.$set(t.row,"maintenanceReason",s)},expression:"scope.row.maintenanceReason"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.row.maintenanceReason,expression:"!scope.row.maintenanceReason"}],staticClass:"error_message"},[e._v("请输入维护原因")])]}}],null,!1,3682531027)}):e._e(),["lock"].includes(e.oper_type)?s("el-table-column",{attrs:{prop:"lock",label:"锁定原因"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{type:"textarea",placeholder:"请输入锁定原因",maxlength:"50","show-word-limit":""},model:{value:t.row.lockReason,callback:function(s){e.$set(t.row,"lockReason",s)},expression:"scope.row.lockReason"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.row.lockReason,expression:"!scope.row.lockReason"}],staticClass:"error_message"},[e._v("请输入锁定原因")])]}}],null,!1,2858309765)}):e._e()],1),e.notSelectVmList.length>0?s("div",{staticClass:"m-top10"},[s("span",{staticClass:"tip_message"},[e._v("仅支持对状态为“锁定”、“存储异常”或“宕机”且无虚拟机运行的宿主机进行“设置维护”操作，有"+e._s(e.notSelectVmList.length)+"台宿主机不满足要求")])]):e._e(),["shelves","finish_validate","schedule","migrate_flag","cheat"].includes(e.oper_type)?s("el-form",{ref:"form",staticClass:"m-top20",attrs:{model:e.form_data,"label-width":"100px","label-position":"left"}},["finish_validate"===e.oper_type?s("el-form-item",{attrs:{prop:"valid",label:"验证结果:",rules:[{required:!0,message:"请选择验证结果",trigger:"blur"}]}},[s("el-radio-group",{model:{value:e.form_data.valid,callback:function(t){e.$set(e.form_data,"valid",t)},expression:"form_data.valid"}},[s("el-radio",{attrs:{label:"1"}},[e._v("成功")]),s("el-radio",{attrs:{label:"0"}},[e._v("失败")])],1)],1):e._e(),["schedule","migrate_flag","cheat"].includes(e.oper_type)?s("el-form-item",{attrs:{prop:"isFlag",label:e.labelObj[e.oper_type]}},[s("el-radio-group",{model:{value:e.form_data.isSet,callback:function(t){e.$set(e.form_data,"isSet",t)},expression:"form_data.isSet"}},[s("el-radio",{attrs:{label:"1"}},[e._v(e._s(e.valueObj[e.oper_type][0]))]),s("el-radio",{attrs:{label:"0"}},[e._v(e._s(e.valueObj[e.oper_type][1]))])],1)],1):e._e(),["schedule","migrate_flag","cheat"].includes(e.oper_type)||"finish_validate"===e.oper_type&&"0"===e.form_data.valid?s("el-form-item",{attrs:{prop:"reason",label:"说明:"}},[s("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:["schedule","migrate_flag","cheat"].includes(e.oper_type)?128:256},model:{value:e.form_data.reason,callback:function(t){e.$set(e.form_data,"reason",t)},expression:"form_data.reason"}})],1):e._e(),["schedule","migrate_flag","cheat"].includes(e.oper_type)?e._e():s("el-form-item",{attrs:{prop:"recycleId",label:"finish_validate"===e.oper_type?"通知对象：":"回收部门：",rules:[{required:!0,message:"请选择"+("finish_validate"===e.oper_type?"通知对象":"回收部门"),trigger:"blur"}]}},[s("el-select",{model:{value:e.form_data.recycleId,callback:function(t){e.$set(e.form_data,"recycleId",t)},expression:"form_data.recycleId"}},e._l(e.recycle_list,(function(e){return s("el-option",{key:e.department_en,attrs:{label:e.department_name,value:e.department_name}})})),1)],1)],1):e._e()],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",disabled:0===e.list.length},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},m=[],b=s("b85c"),v=s("ade3"),g=(s("a9e3"),s("1477")),y=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.alert_title="是否确定对以下".concat(e.rows.length,"台物理机执行").concat(e.title,"操作？"),e.status_list=["开机","关机","重启"],e.flag_list=["调度标记","迁移标记","欺骗器管理"],e.valid=1,e.isFlag=1,e.selectVmList=[],e.notSelectVmList=[],e.list=[],e.labelObj={schedule:"是否允许调度",migrate_flag:"是否允许迁移",cheat:"欺骗器"},e.op_typ_list={schedule:"set_host_scheduled",migrate_flag:"set_host_migrated",cheat:"set_host_dummy"},e.op_typ_req={schedule:"scheduled",migrate_flag:"migrated",cheat:"dummy"},e.valueObj={schedule:["是","否"],migrate_flag:["是","否"],cheat:["有","无"]},e.recycle_list=[],e.form_data={valid:"",recycleId:"",reason:"",isSet:"cheat"===e.oper_type?"0":"1"},e.operate_info={start_up_host:"host_operate",shutdown_host:"host_operate",restart_host:"host_operate",online_maintenance:"host_maintenance",offline_maintenance:"host_maintenance",finish:"finish_maintenance",shelves:"shelves",disperse:"disperse",finish_validate:"finish_validate",schedule:"set_flag",migrate_flag:"set_flag",cheat:"set_flag",under_sync:"update_ecs_info",data_clear:"crash_clear",down_recover:"crash_recover",lock:"set_lock",unlock:"set_unlock",maintenance:"set_maintenance",unstore_exception:"recover_storage_error"},e}return Object(c["a"])(s,[{key:"created",value:function(){var e=this;["shelves","finish_validate"].includes(this.oper_type)&&this.get_host_recycle_department(),"maintenance"===this.oper_type?(this.rows.forEach((function(t){["lock","storage_error","crash"].includes(t.machine_status)&&0===t.ecs_list.length?e.selectVmList.push(t):e.notSelectVmList.push(t)})),this.list=this.selectVmList.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{maintenanceReason:""})}))):"lock"===this.oper_type?this.list=this.rows.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{lockReason:""})})):(this.list=[],this.list=[].concat(Object(r["a"])(this.list),Object(r["a"])(this.rows)))}},{key:"get_host_recycle_department",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_recycle_department({});case 2:t=e.sent,"Success"===t.code&&(this.recycle_list=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i,r,o,l,c,u,_,p,d,h,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!["shelves","finish_validate"].includes(this.oper_type)){e.next=6;break}if(s=!0,a=this.$refs.form,a.validate((function(e){e||(s=!1)})),s){e.next=6;break}return e.abrupt("return",!1);case 6:if("maintenance"!==this.oper_type){e.next=10;break}if(i=this.list.some((function(e){return!e.maintenanceReason})),!i){e.next=10;break}return e.abrupt("return",!1);case 10:if("lock"!==this.oper_type){e.next=14;break}if(r=this.list.some((function(e){return!e.lockReason})),!r){e.next=14;break}return e.abrupt("return",!1);case 14:if(o=this.list.map((function(e){return{host_id:e.host_id,reason:e.maintenanceReason}})),l=this.list.map((function(e){return{host_id:e.host_id,reason:e.lockReason}})),c=this.status_list.includes(this.title)?{op_type:this.oper_type,host_ids:this.rows.map((function(e){return e.host_id}))}:["schedule","migrate_flag","cheat"].includes(this.oper_type)?(t={host_ids:this.rows.map((function(e){return e.host_id}))},Object(v["a"])(t,this.op_typ_req[this.oper_type],Number(this.form_data.isSet)),Object(v["a"])(t,"description",this.form_data.reason),Object(v["a"])(t,"op_type",this.op_typ_list[this.oper_type]),t):["online_maintenance","offline_maintenance"].includes(this.oper_type)?{maintenance_type:this.oper_type,host_ids:this.rows.map((function(e){return e.host_id}))}:"finish_validate"===this.oper_type?{host_ids:this.rows.map((function(e){return e.host_id})),status:"1"===this.form_data.valid?"READY":"INIT_ERROR",noticer:this.form_data.recycleId,reason:"0"===this.form_data.valid?this.form_data.reason:void 0}:"shelves"===this.oper_type?{host_ids:this.rows.map((function(e){return e.host_id})),department_name:this.form_data.recycleId}:"under_sync"===this.oper_type?{pod_id:this.$store.state.pod_id,host_ecs:{}}:"maintenance"===this.oper_type?{maintenance_detail:o,host_ids:this.list.map((function(e){return e.host_id}))}:"lock"===this.oper_type?{lock_detail:l,host_ids:this.list.map((function(e){return e.host_id}))}:{host_ids:this.rows.map((function(e){return e.host_id}))},"under_sync"===this.oper_type){u=Object(b["a"])(this.rows);try{for(p=function(){var e=_.value;c.host_ecs[e.host_id]=[],e.ecs_list.length>0&&e.ecs_list.map((function(t){c.host_ecs[e.host_id].push(t.ecs_id)}))},u.s();!(_=u.n()).done;)p()}catch(m){u.e(m)}finally{u.f()}}return e.next=20,g["a"][this.operate_info[this.oper_type]](Object(n["a"])({},c));case 20:if(d=e.sent,"Success"!==d.code){e.next=55;break}if("finish_validate"!==this.oper_type&&"disperse"!==this.oper_type&&"under_sync"!==this.oper_type){e.next=27;break}this.$message.success(d.message),this.back("1"),e.next=53;break;case 27:if("data_clear"!==this.oper_type&&"down_recover"!==this.oper_type){e.next=38;break}if(!(d.data.fail_host_list.length>0)){e.next=34;break}return this.$message.warning(d.message+"。"+d.data.error_msg),this.back("1"),e.abrupt("return");case 34:this.$message.success(d.message),this.back("1");case 36:e.next=53;break;case 38:if(!(d.data.fail_host_list.length>0)){e.next=51;break}if("maintenance"!==this.oper_type){e.next=46;break}for(f in h="",d.data.fail_msg_group_by_host)h+=d.data.fail_msg_group_by_host[f]+"\n";this.$message.error(h),this.back("0"),e.next=49;break;case 46:return this.$message.warning(d.message+d.data.fail_msg),d.data.success_host_list.length>0?this.back("1"):this.back("0"),e.abrupt("return");case 49:e.next=53;break;case 51:this.$message.success(d.message),this.back("1");case 53:e.next=56;break;case 55:this.back("0");case 56:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(d["e"]);Object(p["a"])([Object(d["d"])("visible")],y.prototype,"visible_sync",void 0),Object(p["a"])([Object(d["c"])({default:function(){return[]}})],y.prototype,"rows",void 0),Object(p["a"])([Object(d["c"])(String)],y.prototype,"title",void 0),Object(p["a"])([Object(d["c"])(String)],y.prototype,"oper_type",void 0),Object(p["a"])([Object(d["b"])("close")],y.prototype,"back",null),y=Object(p["a"])([Object(d["a"])({components:{ActionBlock:h["a"]}})],y);var k=y,w=k,O=s("2877"),j=Object(O["a"])(w,f,m,!1,null,null,null),x=j.exports,C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"数据批量导入",visible:e.visible_sync,width:"600px","destroy-on-close":!0,"custom-class":"upload","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",{staticClass:"upload"},[s("div",{staticClass:"m-bottom10"},[e._v("请选择需要导入的可用区")]),s("el-select",{attrs:{filterable:"","filter-method":e.getPodList,placeholder:"请选择"},on:{"visible-change":e.change_pod},model:{value:e.az,callback:function(t){e.az=t},expression:"az"}},e._l(e.az_list,(function(t){return s("el-option",{key:t.pod_id,attrs:{label:t.az_name+" ( "+t.pod_name+" ) ",value:t.pod_id}},[e._v(e._s(t.az_name)+" ("+e._s(t.pod_name)+")")])})),1),0===e.az.length?s("span",{staticClass:"error_message m-left10"},[e._v("请选择可用区")]):e._e(),s("div",{staticClass:"flex-between m-top10 m-bottom20 down"},[s("span",[e._v("请选择需要上传的文件")]),s("a",{staticClass:"clickble",on:{click:e.down}},[e._v("下载导入模板")])]),s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/ecs_business/v1/host/import_host/?pod_id="+e.az,"before-upload":e.before_upload,"file-list":e.fileList,accept:".xls,.xlsx",name:"host_template","auto-upload":!1,"on-success":e.FnSuccess,headers:{"Access-Token":e.$store.state.token}}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择文件")])],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},S=[],T=s("c839"),R=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.fileList=[],e.az_list=[],e.az="",e}return Object(c["a"])(s,[{key:"created",value:function(){this.getPodList()}},{key:"change_pod",value:function(e){e||this.getPodList()}},{key:"getPodList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",e.next=3,T["a"].get_pod_list({page_index:1,page_size:20,search_info:t});case 3:s=e.sent,"Success"===s.code&&(this.az_list=s.data.pod_list.filter((function(e){return e.status})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"before_upload",value:function(e){}},{key:"FnSuccess",value:function(e,t,s){if("Success"===e.code){if(e.data.fail_host_list.length>0)return this.$message.warning("物理机导入任务下发失败！"),void this.back("1");this.$message.success("物理机导入任务下发成功！"),this.back("1")}else this.$message.error(JSON.stringify(e.message)),this.back("0")}},{key:"down",value:function(){window.location.href="/ecs_business/v1/host/download_template/"}},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.az){e.next=2;break}return e.abrupt("return");case 2:t=this.$refs.upload,t.submit();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(d["e"]);Object(p["a"])([Object(d["d"])("visible")],R.prototype,"visible_sync",void 0),Object(p["a"])([Object(d["b"])("close")],R.prototype,"back",null),R=Object(p["a"])([Object(d["a"])({})],R);var z=R,$=z,E=(s("cc18"),Object(O["a"])($,C,S,!1,null,null,null)),I=E.exports,F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"迁移",visible:e.visible_sync,width:"1180px","destroy-on-close":!0,"custom-class":"upload","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",{staticClass:"migrate"},[s("div",{staticClass:"left"},[s("div",{staticClass:"m-bottom10"},[s("el-checkbox",{attrs:{indeterminate:e.isIndeterminate,disabled:0===e.useable_list.length},on:{change:e.handleCheckAllChange},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}),e._v(" "+e._s(e.rows[0].host_name)+"("),s("span",{staticClass:"num_message"},[e._v(e._s(e.selected.length))]),e._v("/"+e._s(e.list.length)+") "),s("span",{staticClass:"warning_message"},[e._v("(若是GPU型云主机，建议单选虚拟机)")]),s("el-button",{attrs:{type:"text"},on:{click:e.getHostList}},[s("svg-icon",{attrs:{icon:"refresh"}})],1)],1),s("el-table",{ref:"table",attrs:{data:e.list,border:"","max-height":"500"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",selectable:e.checkSelectable}}),s("el-table-column",{attrs:{prop:"customer_id",label:"客户ID"}}),s("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),s("el-table-column",{attrs:{prop:"ecs_id",label:"实例名称/实例ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[e._v(e._s(t.row.name)+" / ")]),e.useable_list.includes(t.row.ecs_id)?s("span",[e._v(e._s(t.row.ecs_id))]):s("el-tooltip",{attrs:{content:e.getMsg(t.row),effect:"light"}},[s("div",[e._v(e._s(t.row.ecs_id))])])]}}])}),s("el-table-column",{attrs:{prop:"status",label:"状态"}}),s("el-table-column",{attrs:{prop:"genre",label:"计算规格"}}),s("el-table-column",{attrs:{prop:"genre",label:"存储",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.disk_info?s("div",[e._v("系统盘："+e._s(Object.keys(t.row.disk_info.system)[0])+" "+e._s(t.row.disk_info.system[Object.keys(t.row.disk_info.system)[0]])+e._s(t.row.disk_info.unit))]):e._e(),t.row.disk_info&&Object.keys(t.row.disk_info.data).length>0?s("div",{staticClass:"data-item"},[e._v(" 数据盘： "),e._l(t.row.disk_info.data,(function(a,i){return s("div",{key:i},[e._v(e._s(i)+" "+e._s(a)+e._s(t.row.disk_info.unit))])}))],2):e._e()]}}])})],1),0===e.selected.length?s("div",{staticClass:"error_message m-top10"},[e._v("请选择虚拟机")]):e._e()],1),s("div",{staticClass:"center"},[s("div",[e._v("迁移至")]),s("div",[e._v("------------\x3e")])]),s("div",{staticClass:"right"},[s("h4",[e._v("目的主机:")]),s("div",{staticClass:"m-bottom20"},[s("span",{staticClass:"m-right10"},[e._v("可用区:")]),s("span",[e._v(e._s(e.rows[0].az_name))])]),s("div",[e._v("物理机："),s("span",{staticClass:"prompt_message"},[e._v("（若不选择则随机迁移至合适的目的主机）")])]),e.recommend.length>0?s("div",{staticClass:"recommend"},e._l(e.recommend,(function(t){return s("div",{key:t.host_id,staticClass:"item",class:e.physical.includes(t.host_id)?"active":"",on:{click:function(s){return e.handle(t.host_id)}}},[e._v(" "+e._s(t.host_name)),s("br"),e._v(" QEMU："+e._s(t.qemu_version)),s("br"),e._v(" OVS："+e._s(t.ovs_version)+" "),s("el-tooltip",{attrs:{content:t.cpu_usage?parseFloat(t.cpu_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.cpu_usage}}),s("div",[e._v("CPU")])],1)]),s("el-tooltip",{attrs:{content:t.memory_usage?parseFloat(t.memory_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.memory_usage}}),s("div",[e._v("内存")])],1)]),s("el-tooltip",{attrs:{content:t.local_storage_usage?parseFloat(t.local_storage_usage).toFixed(2)+"%":"0.00%",placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:t.local_storage_usage}}),s("div",[e._v("本地存储")])],1)]),s("el-tooltip",{attrs:{content:(t.used_gpu_num?t.used_gpu_num:0)+" / "+(t.total_gpu_num?t.total_gpu_num:0),placement:"bottom",effect:"light"}},[s("div",{staticClass:"title"},[s("CustomIcon",{attrs:{hei:0===t.total_gpu_num?0:100*Number((t.used_gpu_num/t.total_gpu_num).toFixed(2))}}),s("div",[e._v("显卡")])],1)])],1)})),0):e.selected<1?s("div",{staticClass:"error_message m-top10"},[e._v("请选择迁移的虚机")]):s("div",{staticClass:"error_message m-top10"},[e._v("无合适的物理机，无法迁移。可选择单台虚机再次尝试")])])]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",disabled:0===this.recommend.length},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},P=[],L=(s("6062"),s("3ca3"),s("ddb0"),s("682f")),A=s("3673"),N=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.list=e.rows[0].ecs_list,e.selected=[],e.checked=!1,e.allSelect=!1,e.isIndeterminate=!1,e.physical=[],e.physical_list=[],e.recommend=[],e.useable_list=[],e}return Object(c["a"])(s,[{key:"created",value:function(){this.setUsableList(this.rows),this.list=this.rows[0].ecs_list}},{key:"watch_selected",value:function(e){if(!this.allSelect&&e.length>0){var t=[],s=!(this.selected.length>0)||!this.selected[0].is_gpu;this.rows[0].ecs_list.forEach((function(e){e.is_gpu===!s&&t.push(e.ecs_id)})),this.useable_list=this.useable_list.filter((function(e){return t.includes(e)}))}else this.setUsableList(this.rows)}},{key:"setUsableList",value:function(e){var t=e[0].ecs_list.filter((function(e){return["已关机","运行中"].includes(e.status)})),s=[];t.map((function(e){e.is_gpu&&"已关机"===e.status&&!e.no_charge_shutdown_ecs?s.push(e.ecs_id):!e.is_gpu&&e.disk_info&&e.disk_info.system&&("local"!==Object.keys(e.disk_info.system)[0]?["已关机","运行中"].includes(e.status)&&s.push(e.ecs_id):"已关机"===e.status&&s.push(e.ecs_id))})),this.useable_list=s}},{key:"getHostList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_list({host_name:this.rows[0].host_name});case 2:t=e.sent,"Success"===t.code&&(this.list=t.data.host_list[0].ecs_list,this.setUsableList(t.data.host_list));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getMsg",value:function(e){return e.is_gpu||e.disk_info&&"local"===Object.keys(e.disk_info.system)[0]?"仅支持关机迁移":"仅运行中和已关机状态下迁移"}},{key:"checkSelectable",value:function(e,t){return!!this.useable_list.includes(e.ecs_id)}},{key:"judge",value:function(){var e=this.physical_list.filter((function(e){return"CPU"===e.host_purpose})),t=e.map((function(e){return e.host_id})),s=Object(r["a"])(new Set([].concat(Object(r["a"])(t),Object(r["a"])(this.physical)))).length;this.selected.some((function(e){return e.is_gpu}))&&s<[].concat(Object(r["a"])(t),Object(r["a"])(this.physical)).length&&(this.$message.warning("GPU云主机不能被迁移到非GPU物理机上"),this.physical=[])}},{key:"get_recommended_host",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",this.$store.commit("SET_LOADING",!1),e.next=4,g["a"].recommended_host({host_id:this.rows[0].host_id,host_name:t,ecs_ids:this.selected.map((function(e){return e.ecs_id})),is_gpu:"GPU"===this.rows[0].host_purpose?"1":"0",gpu_card_name:this.rows[0].gpu_real_name});case 4:s=e.sent,"Success"===s.code&&(this.recommend=s.data.data,0===this.selected.length&&(this.physical=[]));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCheckAllChange",value:function(e){var t=this.$refs.table;e?t.toggleAllSelection():t.clearSelection(),this.isIndeterminate=!1,this.allSelect=!this.allSelect}},{key:"handleSelectionChange",value:function(e){this.selected=e,this.get_recommended_host(),this.checked=e.length===this.list.length,this.isIndeterminate=e.length>0&&e.length<this.list.length}},{key:"handle",value:function(e){this.physical.includes(e)?this.physical=this.physical.filter((function(t){return t!==e})):this.physical.push(e)}},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.selected.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,g["a"].migrate({ecs_ids:this.selected.map((function(e){return e.ecs_id})),start_host_id:this.rows[0].host_id,end_host_ids:this.physical,is_gpu:"GPU"===this.rows[0].host_purpose?"1":"0"});case 4:t=e.sent,"Success"===t.code?(this.$message.success("物理机迁移任务下发成功！"),this.back("1")):this.back("0");case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(d["e"]);Object(p["a"])([Object(d["d"])("visible")],N.prototype,"visible_sync",void 0),Object(p["a"])([Object(d["c"])({default:function(){return[]}})],N.prototype,"rows",void 0),Object(p["a"])([Object(d["f"])("selected")],N.prototype,"watch_selected",null),Object(p["a"])([Object(d["b"])("close")],N.prototype,"back",null),N=Object(p["a"])([Object(d["a"])({components:{CustomIcon:L["a"],svgIcon:A["a"]}})],N);var H=N,G=H,D=(s("23af"),s("9f1f"),Object(O["a"])(G,F,P,!1,null,null,null)),M=D.exports,U=s("9074"),V=s("e527"),Y=s("8ce4"),B=s("3f8d"),q=s("268f"),K=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:e.title,visible:e.visible_sync,width:"760px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.back}},[s("div",[0!==e.rows.length?s("el-alert",{attrs:{title:e.alert_title,type:"warning",center:"",closable:!1}}):e._e(),0!==e.rows.length?s("el-table",{attrs:{data:e.rows,border:"","max-height":"253"}},[s("el-table-column",{attrs:{prop:"host_name",label:"主机名",width:"150"}}),s("el-table-column",{attrs:{prop:"az_name",label:"节点"}}),s("el-table-column",{attrs:{prop:"machine_status_name",label:"机器状态"}}),s("el-table-column",{attrs:{prop:"host_purpose",label:"主机用途"}}),s("el-table-column",{attrs:{prop:"host_attribution_name",label:"主机归属"}})],1):e._e(),["resource"].includes(e.oper_type)?s("div",{staticClass:"ecs-belong m-top20"},[s("span",{staticClass:"m-right20"},[e._v("设置主机归属：")]),s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ecs_id,callback:function(t){e.ecs_id=t},expression:"ecs_id"}},e._l(e.ecs_list,(function(e){return s("el-option",{key:e.host_attribution_id,attrs:{label:e.name,value:e.host_attribution_id}})})),1)],1):s("el-form",{ref:"form",staticClass:"m-top20",attrs:{model:e.form_data,"label-width":"100px","label-position":"left"}},[["service"].includes(e.oper_type)?s("el-form-item",{attrs:{prop:"tag",label:"tag:",rules:[{required:!0,message:"请输入tag",trigger:"blur"}]}},[s("el-input",{attrs:{maxlength:64},model:{value:e.form_data.tag,callback:function(t){e.$set(e.form_data,"tag",t)},expression:"form_data.tag"}})],1):e._e(),0===e.rows.length?s("el-form-item",{attrs:{prop:"az_id",label:"节点:",rules:[{required:!0,message:"请选择节点",trigger:"blur"}]}},[s("el-select",{staticStyle:{width:"100%"},model:{value:e.form_data.az_id,callback:function(t){e.$set(e.form_data,"az_id",t)},expression:"form_data.az_id"}},e._l(e.az_list,(function(e){return s("el-option",{key:e.az_id,attrs:{value:e.az_id,label:e.az_name}})})),1)],1):e._e(),s("el-form-item",{attrs:{prop:"serviceType",label:"服务类型:",rules:[{required:!0,message:"请选择服务类型",trigger:"blur"}]}},[s("el-radio-group",{model:{value:e.form_data.serviceType,callback:function(t){e.$set(e.form_data,"serviceType",t)},expression:"form_data.serviceType"}},[s("el-radio",{attrs:{label:"cds-os-agent"}},[e._v("agent")]),s("el-radio",{attrs:{label:"monitor-instance",disabled:""}},[e._v("monitor-instance")]),s("el-radio",{attrs:{label:"monitor-host",disabled:""}},[e._v("monitor-host")])],1)],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取消")])],1)])],1)},J=[],Q=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.alert_title="是否确定对以下".concat(e.rows.length,"台物理机执行").concat(e.title,"操作？"),e.ecs_list=[],e.ecs_id="",e.az_list=[],e.form_data={tag:"",az_id:"",serviceType:"cds-os-agent"},e}return Object(c["a"])(s,[{key:"created",value:function(){"resource"===this.oper_type?this.get_host_attribution():this.get_az_list()}},{key:"get_az_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.az_list=[],e.next=3,U["a"].get_region_az_list({need_open_az:"1",employee_no:this.$store.state.employee_no,user_name:this.$store.state.login_name});case 3:t=e.sent,"Success"===t.code&&(t.data.forEach((function(e){e.region_list.forEach((function(e){var t;(t=s.az_list).push.apply(t,Object(r["a"])(e.az_list))}))})),this.form_data.az_id=this.az_list[0].az_id);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_host_attribution",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_attribution({});case 2:t=e.sent,"Success"===t.code&&(this.ecs_list=t.data.host_attribution_list,this.ecs_id=this.ecs_list[0].host_attribution_id);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=!0,"resource"!==this.oper_type){e.next=7;break}return e.next=4,g["a"].set_host_attribution({host_ids:this.rows.map((function(e){return e.host_id})),host_attribution_id:this.ecs_id});case 4:t=e.sent,e.next=21;break;case 7:if(a=this.$refs.form,a.validate((function(e){e||(s=!1)})),s){e.next=11;break}return e.abrupt("return",!1);case 11:if(i={az_id:0===this.rows.length?this.form_data.az_id:this.rows[0].az_id,host_ids:this.rows.map((function(e){return e.host_id})),server_name:this.form_data.serviceType,is_node_update:0===this.rows.length?"1":void 0},"service"!==this.oper_type){e.next=18;break}return e.next=15,g["a"].agent_update(Object(n["a"])(Object(n["a"])({},i),{},{server_tag:this.form_data.tag}));case 15:t=e.sent,e.next=21;break;case 18:return e.next=20,g["a"].agent_rollback(i);case 20:t=e.sent;case 21:"Success"===t.code?"resource"===this.oper_type&&t.data.fail_host_list.length>0?(this.$message.warning(t.message),this.back("1")):(this.$message.success(t.message),this.back("1")):this.back("0");case 22:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(d["e"]);Object(p["a"])([Object(d["d"])("visible")],Q.prototype,"visible_sync",void 0),Object(p["a"])([Object(d["c"])({default:function(){return[]}})],Q.prototype,"rows",void 0),Object(p["a"])([Object(d["c"])(String)],Q.prototype,"title",void 0),Object(p["a"])([Object(d["c"])(String)],Q.prototype,"oper_type",void 0),Object(p["a"])([Object(d["b"])("close")],Q.prototype,"back",null),Q=Object(p["a"])([Object(d["a"])({components:{ActionBlock:h["a"]}})],Q);var W=Q,X=W,Z=(s("bda3"),Object(O["a"])(X,K,J,!1,null,null,null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"设置属性",visible:e.visible_sync,width:"600px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t}}},[s("div",{staticClass:"main-edit"},[s("div",{staticClass:"m-bottom20"},[s("span",[e._v("主机类型")]),s("el-select",{on:{change:e.changeType},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.host_types,(function(e){return s("el-option",{key:e.type,attrs:{value:e.type,label:e.type_name}})})),1)],1),s("div",{staticClass:"m-bottom20"},[s("span",[e._v("主机用途")]),s("el-select",{model:{value:e.use,callback:function(t){e.use=t},expression:"use"}},e._l(e.host_uses,(function(e){return s("el-option",{key:e.use_type,attrs:{value:e.use_type,label:e.use_name}})})),1)],1),s("div",{staticClass:"m-bottom20"},[s("span",[e._v("专属客户")]),s("el-select",{attrs:{multiple:"",filterable:"",remote:"","remote-method":e.getCustomerList},on:{"visible-change":e.changeCustomer},model:{value:e.customer_id,callback:function(t){e.customer_id=t},expression:"customer_id"}},e._l(e.customerList,(function(t){return s("el-option",{key:t.id,attrs:{value:t.id,label:t.id+"("+t.name+")"}},[e._v(e._s(t.id+"("+t.name+")"))])})),1)],1),s("div",{staticClass:"m-bottom20"},[s("span",[e._v("产品规格族")]),s("el-select",{attrs:{multiple:"",filterable:"","filter-method":e.getFamilyList},on:{"visible-change":e.changeFamily},model:{value:e.family,callback:function(t){e.family=t},expression:"family"}},e._l(e.familyList,(function(e){return s("el-option",{key:e.spec_family_id,attrs:{value:e.spec_family_id,label:e.name}})})),1)],1)]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")]),s("el-button",{on:{click:function(t){return e.back("0")}}},[e._v("取 消")])],1)])},se=[],ae=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.type="",e.use="",e.host_types=[],e.host_uses=[],e.customer_id=[],e.customerList=[],e.family=[],e.familyList=[],e.flagFamily=!0,e}return Object(c["a"])(s,[{key:"created",value:function(){this.getHostTypes(),this.getCustomerList("",!0),this.getFamilyList(),this.valBack()}},{key:"getHostTypes",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_type({});case 2:t=e.sent,"Success"===t.code&&(this.host_types=t.data,this.type=this.host_types[0].type,this.host_uses=this.host_types[0].list,this.use=this.host_uses[0].use_type);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeType",value:function(e){this.host_uses=this.host_types.filter((function(t){return t.type===e}))[0].list,this.use=this.host_uses.length>0?this.host_uses[0].use_type:""}},{key:"changeFamily",value:function(e){e||this.getFamilyList()}},{key:"changeCustomer",value:function(e){e&&(this.customerList=[])}},{key:"getFamilyList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"",e.next=3,g["a"].getFamilyList({host_ids:this.rows.map((function(e){return e.host_id})),spec_family_name:t});case 3:s=e.sent,"Success"==s.code&&(this.familyList=s.data.spec_family_list,this.flagFamily&&(this.family=s.data.old_family_data_list),this.flagFamily=!1);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getCustomerList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:"",s=i.length>1&&void 0!==i[1]&&i[1],t||s){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,g["a"].getCustomerList({host_ids:this.rows.map((function(e){return e.host_id})),customer_id:t});case 6:a=e.sent,"Success"==a.code&&(this.customerList=a.data.customer_list);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].update_attribute({host_ids:this.rows.map((function(e){return e.host_id})),host_purpose:this.use,host_type:this.type,customer_ids:this.customer_id,spec_family_ids:this.family});case 2:if(t=e.sent,"Success"!==t.code){e.next=12;break}if(!(t.data.fail_host_list.length>0)){e.next=8;break}return this.$message.warning(t.message),this.back("0"),e.abrupt("return");case 8:this.$message.success(t.message),this.back("1"),e.next=13;break;case 12:this.back("0");case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"valBack",value:function(){1==this.rows.length&&(this.customer_id=this.rows[0].exclusive_customers.map((function(e){return"string"==typeof e?e:e.id})))}},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(d["e"]);Object(p["a"])([Object(d["d"])("visible")],ae.prototype,"visible_sync",void 0),Object(p["a"])([Object(d["c"])({default:function(){return[]}})],ae.prototype,"rows",void 0),Object(p["a"])([Object(d["b"])("close")],ae.prototype,"back",null),ae=Object(p["a"])([Object(d["a"])({})],ae);var ie=ae,ne=ie,re=(s("5840"),s("5a59"),Object(O["a"])(ne,te,se,!1,null,"379d45d3",null)),oe=re.exports,le=s("af7d"),ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"业务测试",visible:e.visible_sync,width:"1000px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t},close:e.cancel}},[s("div",{staticClass:"m-left10"},[s("el-button",{staticClass:"m-bottom10",attrs:{type:"primary",disabled:e.selectedTasks.length===e.selectable.length},on:{click:e.add}},[e._v("新增测试任务")]),s("div",{staticClass:"m-bottom20"},[e._v("将对"),s("span",{staticClass:"m-left10 num_message m-right10"},[e._v(e._s(e.az_info.az_name))]),e._v("未通过业务测试的物理机进行业务测试，已通过业务测试的物理机不会再次进行以下测试。业务测试完成情况可在"),s("span",{staticClass:"clickble m-left10 m-right10",on:{click:function(t){return e.$router.push("/message")}}},[e._v("消息通知")]),e._v("进行查看")]),s("div",{staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:1}}),e._v(e._s(e.first.description?e.first.description:""))],1),e._l(e.selectedTasks,(function(t,a){return s("div",{key:a,staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:a+2}}),s("el-select",{attrs:{placeholder:"请选择测试任务列表"},on:{change:function(t){return e.changeTask(t,a)}},model:{value:t.task_id,callback:function(s){e.$set(t,"task_id",s)},expression:"item.task_id"}},e._l(e.selectable,(function(e){return s("el-option",{key:e.maintask_name,attrs:{value:e.maintask_name,label:e.display_name,disabled:t.disList.includes(e.maintask_name)}})})),1),t.task_id?s("span",{staticClass:"m-left10"},[e._v("该任务需设置参数，请点击"),s("el-button",{attrs:{type:"text"},on:{click:e.setParams}},[e._v("设置参数")])],1):e._e(),s("el-button",{staticClass:"m-left10",attrs:{type:"text"},on:{click:function(t){return e.del(a)}}},[e._v("删除")])],1)})),s("div",{staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:e.selectedTasks.length+2}}),e._v(e._s(e.second.description?e.second.description:""))],1),s("div",{staticClass:"m-bottom10"},[s("circle-icon",{attrs:{num:e.selectedTasks.length+3}}),e._v(e._s(e.third.description?e.third.description:""))],1)],2),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")]),s("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)])},ue=[],_e=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"circle"},[e._v(e._s(e.num))])},pe=[],de=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){return Object(l["a"])(this,s),t.apply(this,arguments)}return Object(c["a"])(s)}(d["e"]);Object(p["a"])([Object(d["c"])()],de.prototype,"num",void 0),de=Object(p["a"])([Object(d["a"])({})],de);var he=de,fe=he,me=(s("76b1"),Object(O["a"])(fe,_e,pe,!1,null,"91dfb8fa",null)),be=me.exports,ve=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.taskList=[],e.selectedTasks=[],e.task="",e.selectable=[],e.first={},e.second={},e.third={},e}return Object(c["a"])(s,[{key:"created",value:function(){this.get_task_list()}},{key:"get_task_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_task_list({});case 2:t=e.sent,"Success"===t.code&&(this.taskList=Object(r["a"])(t.data.task_list),this.taskList.map((function(e){return["CreateEcsGpuInstanceForTestPipeline","DeleteEcsGpuInstanceForTestPipeline","UpdateHostForTestPipeline"].includes(e.maintask_name)||s.selectable.push(e),"CreateEcsGpuInstanceForTestPipeline"===e.maintask_name&&(s.first=e),"DeleteEcsGpuInstanceForTestPipeline"===e.maintask_name&&(s.second=e),"UpdateHostForTestPipeline"===e.maintask_name&&(s.third=e),e})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"set_disList",value:function(){var e=this.selectedTasks.map((function(e){return e.task_id}));this.selectedTasks.map((function(t){return t.disList=e.filter((function(e){return e!==t.maintask_name})),t}))}},{key:"add",value:function(){this.selectedTasks.length!==this.selectable.length&&(this.selectedTasks.push({task_id:"",params:{},disList:[]}),this.set_disList())}},{key:"changeTask",value:function(e,t){this.set_disList()}},{key:"del",value:function(e){var t=[];this.selectedTasks.map((function(s,a){return a!==e&&t.push(s),s})),this.selectedTasks=t,this.set_disList()}},{key:"setParams",value:function(){}},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[Object(n["a"])({},this.first)],this.selectedTasks.map((function(e){return t.push({maintask_name:e.task_id,dep_params:e.params}),e})),t.push(this.second),t.push(this.third),e.next=6,g["a"].create_test_task({az_id:this.az_info.az_id,task_list:t});case 6:s=e.sent,"Success"===s.code&&this.$message.success(s.message),this.visible_sync=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"cancel",value:function(){this.visible_sync=!1}}]),s}(d["e"]);Object(p["a"])([Object(d["d"])("visible")],ve.prototype,"visible_sync",void 0),Object(p["a"])([Object(d["c"])({default:function(){return{az_id:"",az_name:""}}})],ve.prototype,"az_info",void 0),ve=Object(p["a"])([Object(d["a"])({components:{SvgIcon:A["a"],CircleIcon:be}})],ve);var ge=ve,ye=ge,ke=(s("08a8"),Object(O["a"])(ye,ce,ue,!1,null,"7889306c",null)),we=ke.exports,Oe=s("76ff"),je=s("c1df"),xe=s.n(je),Ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"编辑备注-"+e.rows.host_name,visible:e.visible_sync,width:"400px","destroy-on-close":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible_sync=t}}},[s("el-input",{attrs:{type:"textarea",maxlength:"128","show-word-limit":"",rows:"5"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),s("el-button",{on:{click:function(t){e.visible_sync=!1}}},[e._v("取消")])],1)],1)},Se=[],Te=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.value=e.rows.remark,e}return Object(c["a"])(s,[{key:"created",value:function(){}},{key:"confirm",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].set_remark({host_ids:[this.rows.host_id],remark:this.value});case 2:t=e.sent,"Success"===t.code?(this.$message.success(t.message),this.back("1")):this.back("0");case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"back",value:function(e){this.visible_sync=!1}}]),s}(d["e"]);Object(p["a"])([Object(d["d"])("visible")],Te.prototype,"visible_sync",void 0),Object(p["a"])([Object(d["c"])({default:function(){return{host_name:"",remark:""}}})],Te.prototype,"rows",void 0),Object(p["a"])([Object(d["b"])("close")],Te.prototype,"back",null),Te=Object(p["a"])([Object(d["a"])({})],Te);var Re=Te,ze=Re,$e=(s("8127"),Object(O["a"])(ze,Ce,Se,!1,null,"77861e6a",null)),Ee=$e.exports,Ie=function(e){Object(u["a"])(s,e);var t=Object(_["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.search_option={out_band_address:{placeholder:"请输入带外IP"},host_ip:{placeholder:"请输入管理网IP"},host_name:{placeholder:"请输入主机名称"},host_id:{placeholder:"请输入主机ID"},vm_id:{placeholder:"请输入虚拟机ID"},cpu:{placeholder:"请输入CPU型号"},gpu_model:{placeholder:"请输入显卡型号"},nic:{placeholder:"请输入网卡型号"},room:{placeholder:"请选择机房",list:[]},host_rack:{placeholder:"请输入机柜编号"},bare_metal_id:{placeholder:"请输入物理机产品ID"},bare_metal_name:{placeholder:"请输入物理机产品名称"},ovs_version:{placeholder:"请选择OVS版本",list:[]},create_time:{placeholder:["开始时间","结束时间"],type:"datetimerange",width:"360",clearable:!0,dis_day:31,defaultTime:[]}},e.operate_btns=[{label:"导入",value:"upload"},{label:"完成验证",value:"finish_validate"},{label:"开机",value:"start_up_host"},{label:"关机",value:"shutdown_host"},{label:"重启",value:"restart_host"},{label:"设置维护",value:"maintenance"},{label:"完成维护",value:"finish"},{label:"驱散",value:"disperse"},{label:"业务测试",value:"business_test"},{label:"调度标记",value:"schedule"},{label:"迁移标记",value:"migrate_flag"},{label:"欺骗器管理",value:"cheat"},{label:"底层同步",value:"under_sync"},{text:"宕机处理",subItems:[{label:"数据清理同步",value:"data_clear"},{label:"宕机恢复",value:"down_recover"}]},{text:"机器锁定",subItems:[{label:"锁定机器",value:"lock"},{label:"解锁机器",value:"unlock"}]},{text:"解除异常",subItems:[{label:"解除存储异常",value:"unstore_exception"}]},{label:"服务更新",value:"service"},{label:"回滚",value:"rollback"}],e.rows_operate_btns=[{label:"详情",value:"physical_detail"},{label:"迁移",value:"migrate"},{label:"操作记录",value:"record"},{label:"分配资源",value:"resource"},{label:"编辑备注",value:"remark"},{label:"服务更新",value:"service"},{label:"回滚",value:"rollback"}],e.error_msg={start_up_host:"已选主机需为在线或离线状态",shutdown_host:"已选主机需为在线或离线状态",restart_host:"已选主机需为在线或离线状态",online_maintenance:"已选主机需为在线状态",offline_maintenance:"已选主机需为在线或离线状态且已选主机上不能有虚拟机运行",finish:"已选主机需为在线维护中或离线维护中",shelves:"已选主机上不能有虚拟机运行",disperse:"已选主机需为在线状态",migrate:"已选主机需为在线状态",unlock:"已选主机需为锁定状态"},e.host_belongs=[],e.search_data={},e.page_info={current:1,size:20,total:0},e.list=[],e.visible=!1,e.oper_type="",e.oper_label="",e.multi_rows=[],e.auth_list=[],e.filter_data={},e.host_types=[],e.host_uses=[],e.power_list=[],e.machine_list=[],e.host_source=[],e.all_column_item=[],e.all_item=[],e.custom_visible=!1,e.tableHeight=70,e.az_info={},e.loading=!1,e.expand_rows=[],e.new_prop_list=[],e.filter_info={},e.detail_id="",e.detail_visible=!1,e.timer=null,e.reason_list=[],e.multiple_selection_id=[],e.ecs_fields=[{label:"客户ID",prop:"customer_id"},{label:"客户名称",prop:"customer_name"},{label:"云服务器ID",prop:"ecs_id"},{label:"云服务器名称",prop:"ecs_name"},{label:"状态",prop:"status"},{label:"私网IP",prop:"private_net"},{label:"虚拟出网网关IP",prop:"pub_net"},{label:"公网IP",prop:"pub_ip"},{label:"计算规格",prop:"ecs_info"},{label:"存储",prop:"disk",width:"160px"},{label:"操作系统",prop:"os_name"},{label:"更新时间",prop:"update_time"},{label:"创建时间",prop:"create_time"}],e.filed_name_list=["supplier","bios_version","out_bond_version","host_brand","switch_one__name","switch_two__name","switch_three__name","switch_four__name","out_band_switch__name","net_model"],e.custom_host=["host_name","host_ip","out_band_address","machine_status_name","power_status_name","ecs_num","host_type_ch","host_purpose_ch","host_attribution_name","host_source","cpu_model","gpu_model","gpu_count","net_nic","cpu","ram","hugepages_free","create_time"],e.backendList=[{value:"block",text:"云盘"},{value:"local",text:"本地盘"},{value:"local,block",text:"云盘/本地盘"}],e.backendObj={block:"云盘",local:"本地盘","local,block":"云盘/本地盘"},e}return Object(c["a"])(s,[{key:"created",value:function(){for(var e in this.get_room_list(),this.get_az_list(),this.get_status_list(),this.get_host_attribution(),this.getHostTypes(),this.get_host_recycle_department(),this.get_host_list_field(),this.get_ovs_list(),this.auth_list=this.$store.state.auth_info[this.$route.name],delete this.$store.state.host_search[""],this.search_option)this.search_option[e].default_value=this.$store.state.host_search[e];this.$route.query.host_id&&(this.search_option.host_id.default_value=this.$route.query.host_id)}},{key:"mounted",value:function(){this.setHeight()}},{key:"FnOperate",value:function(){this.setHeight()}},{key:"setHeight",value:function(){var e=this;this.$nextTick((function(){var t=e.$refs.table;e.tableHeight=window.innerHeight-t.$el.offsetTop-70;var s=e;window.onresize=function(){s.tableHeight=window.innerHeight-t.$el.offsetTop-70}}))}},{key:"get_host_list_field",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_list_field({});case 2:t=e.sent,"Success"===t.code&&(s=["field_name","show_name"],a=["prop","label"],i=[],t.data.map((function(e){return i=[].concat(Object(r["a"])(i),Object(r["a"])(e.filed)),e})),this.all_item=t.data,this.all_column_item=Object(Y["b"])(i,a,s),this.get_custom_columns(this.$store.state.custom_host),this.get_custom_columns(this.$store.state.custom_host));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_ovs_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.search_option.ovs_version.list=[],e.next=3,g["a"].get_ovs_version({pod_id:this.$store.state.pod_id});case 3:t=e.sent,"Success"===t.code&&(s=t.data,s.forEach((function(e){a.search_option.ovs_version.list.push({label:e,type:e})})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_reason_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,s){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t,"type"),"lock"!==t){e.next=8;break}return e.next=4,g["a"].get_lock_record({host_id:s});case 4:a=e.sent,"Success"===a.code&&(this.reason_list=a.data),e.next=12;break;case 8:return e.next=10,g["a"].get_maintenance_record({host_id:s});case 10:i=e.sent,"Success"===i.code&&(this.reason_list=i.data);case 12:case"end":return e.stop()}}),e,this)})));function t(t,s){return e.apply(this,arguments)}return t}()},{key:"get_custom_columns",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var s,a,i,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return");case 2:if(this.custom_host=this.all_column_item.filter((function(e){return t.includes(e.label)})),this.new_prop_list=this.custom_host.filter((function(e){return n.filed_name_list.includes(e.prop)})).map((function(e){return e.prop})),this.new_prop_list.length>0&&this.get_host_filter_item(),this.custom_host.map((function(e){return["host_name","out_band_address","host_ip","cpu","ram","ecs_num","create_time","gpu_count","gpu_allot","ecs_gpu_count","gpu_ff_count","hugepages_free"].includes(e.prop)&&(e=Object.assign(e,{},{sortable:"custom"}),"ecs_num"===e.prop&&(e=Object.assign(e,{},{className:"physical",width:"140px"}))),["cpu_with_model","net_card_with_model"].includes(e.prop)&&(e=Object.assign(e,{},{width:"180px"})),"host_type_ch"===e.prop&&(e=Object.assign(e,{},{column_key:"host_type",list:n.host_types})),"host_purpose_ch"===e.prop&&(e=Object.assign(e,{},{column_key:"host_purpose",list:n.host_uses})),"host_attribution_name"===e.prop&&(e=Object.assign(e,{},{column_key:"host_attribution_id",list:n.host_belongs})),"host_source"===e.prop&&(e=Object.assign(e,{},{column_key:"host_source",list:n.host_source})),"power_status_name"===e.prop&&(e=Object.assign(e,{},{column_key:"power_status",list:n.power_list})),"machine_status_name"===e.prop&&(e=Object.assign(e,{},{column_key:"machine_status",list:n.machine_list})),"backend_type"===e.prop&&(e=Object.assign(e,{},{column_key:"backend_type",list:n.backendList})),"net_nic"===e.prop&&(e=Object.assign(e,{},{width:"180px"})),"gpu_info"===e.prop&&(e=Object.assign(e,{},{width:"180px"})),["scheduled_display"].includes(e.prop)&&(e=Object.assign(e,{},{column_key:"scheduled",list:[{text:"是",value:1},{text:"否",value:0}]})),["migrated_display"].includes(e.prop)&&(e=Object.assign(e,{},{column_key:"migrated",list:[{text:"是",value:1},{text:"否",value:0}]})),"dummy_display"===e.prop&&(e=Object.assign(e,{},{column_key:"dummy",list:[{text:"有",value:1},{text:"无",value:0}]})),"vgpu_segment_type"===e.prop&&(e=Object.assign(e,{},{column_key:"vgpu_segment_type",list:[{text:"Q",value:"Q"},{text:"B",value:"B"},{text:"C",value:"C"},{text:"A",value:"A"}]})),"host_business_type"===e.prop&&(e=Object.assign(e,{},{column_key:"host_business_type",list:[{text:"KVM",value:"KVM"},{text:"ECI",value:"ECI"}]})),n.filed_name_list.includes(e.prop)&&(e=Object.assign(e,{},{column_key:e.prop,list:[]})),e})),s=this.custom_host.map((function(e){return e.prop})),!s.includes("ecs_num_expand")){e.next=9;break}return e.abrupt("return");case 9:a=s.indexOf("ecs_num"),a>-1&&(i={type:"expand",label:"",prop:"ecs_num_expand"},this.custom_host.splice(a+1,0,i));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"fn_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.search_data=Object(n["a"])({},e),this.page_info.current=1,this.judgeColumns(),this.get_physical_list()}},{key:"beforeDestroy",value:function(){this.FnClearTimer(),this.$store.commit("SET_HOST_SEARCH",this.search_data)}},{key:"FnCustom",value:function(){this.custom_visible=!0}},{key:"refresh",value:function(){this.page_info.current=1,this.get_physical_list()}},{key:"watch_pod",value:function(e){e&&(this.refresh(),this.get_ovs_list())}},{key:"get_physical_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i,r,o,l,c,u,_,p,d,h,f,m,b,v,y,k,w,O=this,j=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=!(j.length>0&&void 0!==j[0])||j[0],t||(this.$store.commit("SET_LOADING",!1),this.multiple_selection_id=this.multi_rows.map((function(e){return e.host_id}))),s=this.search_data,a=s.room,i=s.host_name,r=s.vm_id,o=s.out_band_address,l=s.host_ip,c=s.host_id,u=s.gpu_model,_=s.host_rack,p=s.create_time,d=s.cpu,h=s.nic,f=s.bare_metal_name,m=s.bare_metal_id,b=s.vgpu_segment_type,v=s.host_info,y=s.ovs_version,e.next=5,g["a"].get_host_list(Object(n["a"])({pod_id:this.$store.state.pod_id,machine_room_name:a,host_name:i,vm_id:r,out_band_address:o,host_ip:l,host_id:c,gpu_model:u,host_rack:_,cpu:d,nic:h,bare_metal_name:f,bare_metal_id:m,host_info:v,ovs_version:y,vgpu_segment_type:b?b[0]:void 0,start_time:p&&p[0]?xe()(p[0]).format("YYYY-MM-DD HH:mm:ss"):void 0,end_time:p&&p[1]?xe()(p[1]).format("YYYY-MM-DD HH:mm:ss"):void 0,page_index:this.page_info.current,page_size:this.page_info.size,sort_cpu:this.search_data.sort_cpu,sort_ram:this.search_data.sort_ram,sort_create_time:this.search_data.sort_create_time,sort_gpu_count:this.search_data.sort_gpu_count,sort_gpu_allot:this.search_data.sort_gpu_allot,sort_ecs_num:this.search_data.sort_ecs_num,sort_host_name:this.search_data.sort_host_name,sort_out_band_address:this.search_data.sort_out_band_address,sort_ecs_gpu_count:this.search_data.sort_ecs_gpu_count,sort_gpu_ff_count:this.search_data.sort_gpu_ff_count,sort_host_ip:this.search_data.sort_host_ip,sort_hugepages_free:this.search_data.sort_hugepages_free},this.filter_info));case 5:k=e.sent,"Success"===k.code&&(this.list=k.data.host_list,this.list.map((function(e){return e.ecs_detail=[],e})),w=[],this.multi_rows.length>0&&(w=k.data.host_list.filter((function(e){return O.multiple_selection_id.includes(e.host_id)}))),w&&w.length>0&&this.$nextTick((function(){w.forEach((function(e){O.$refs.table.toggleRowSelection(e)}))})),this.page_info.total=k.data.page_info.count||0),this.FnSetTimer();case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnSetTimer",value:function(){var e=this;this.timer&&this.FnClearTimer(),this.timer=setTimeout((function(){e.get_physical_list(!1)}),3e4)}},{key:"FnClearTimer",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"getHostTypes",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_type({});case 2:t=e.sent,"Success"===t.code&&(s=["type","type_name","list"],a=["value","text","list"],this.host_types=Object(Y["b"])(t.data,a,s),this.setList(this.host_types,"host_type_ch"));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_host_filter_item",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_filter_item({filed_names:this.new_prop_list});case 2:if(t=e.sent,"Success"===t.code)for(i in s=this.custom_host.map((function(e){return e.prop})),a=function(e){var a=s.indexOf(e),i=r.custom_host[a],o=[];t.data[e].map((function(e){o.push({text:e,value:e})})),r.custom_host.splice(a,1,Object(n["a"])(Object(n["a"])({},i),{},{list:o}))},t.data)a(i);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_host_attribution",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_attribution({});case 2:t=e.sent,"Success"===t.code&&(s=["host_attribution_id","name"],a=["value","text"],this.host_belongs=Object(Y["b"])(t.data.host_attribution_list,a,s),this.setList(this.host_belongs,"host_attribution_name"));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"FnToDetail",value:function(e){this.detail_id=e,this.detail_visible=!0}},{key:"closeDetail",value:function(){this.detail_visible=!1}},{key:"FnGetNet",value:function(e){var t=e.split(".");return[t[0],t[1],t[2],"0"].join(".")}},{key:"down",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i,r,o,l,c,u,_,p,d,h,f,m,b,v,g,y,k;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(y in t=this.search_data,s=t.room,a=t.host_name,i=t.vm_id,r=t.out_band_address,o=t.host_ip,l=t.host_id,c=t.gpu_model,u=t.host_rack,_=t.sort_host_ip,p=t.create_time,d=t.cpu,h=t.nic,f=t.bare_metal_name,m=t.bare_metal_id,b=t.ovs_version,v=Object(n["a"])(Object(n["a"])({pod_id:this.$store.state.pod_id,machine_room_name:s,host_name:a,vm_id:i,out_band_address:r,host_ip:o,host_id:l,gpu_model:c,host_rack:u,sort_host_ip:_,cpu:d,nic:h,bare_metal_name:f,bare_metal_id:m,ovs_version:b,start_time:p&&p[0]?xe()(p[0]).format("YYYY-MM-DD HH:mm:ss"):void 0,end_time:p&&p[1]?xe()(p[1]).format("YYYY-MM-DD HH:mm:ss"):void 0},this.filter_info),{},{field_names:JSON.stringify(this.custom_host.map((function(e){return e.prop})))}),g="",v)v[y]&&(g+="".concat(y,"=").concat(v[y],"&"));k=""===g?"":"?".concat(g.slice(0,g.length-1)),window.location.href="/ecs_business/v1/host/host_list_download/".concat(k);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_az_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,U["a"].get_region_az_list({employee_no:this.$store.state.employee_no,user_name:this.$store.state.login_name});case 2:t=e.sent,"Success"===t.code&&t.data.forEach((function(e){e.region_list.forEach((function(e){}))}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_room_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_room_list({});case 2:t=e.sent,"Success"===t.code&&t.data.machine_room.forEach((function(e){s.search_option.room.list.push({label:e,type:e})}));case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_status_list",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_status_list({});case 2:if(t=e.sent,"Success"===t.code){for(s in t.data.power_status)this.power_list.push({text:t.data.power_status[s],value:s});for(a in t.data.machine_status)this.machine_list.push({text:t.data.machine_status[a],value:a})}case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"get_host_recycle_department",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].get_host_recycle_department({});case 2:t=e.sent,"Success"===t.code&&(s=["department_name","department_name"],a=["value","text"],this.host_source=Object(Y["b"])(t.data,a,s),this.setList(this.host_source,"host_source"));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSelectionChange",value:function(e){this.multi_rows=e}},{key:"FnSortChange",value:function(e){this.search_data.sort_cpu=void 0,this.search_data.sort_ram=void 0,this.search_data.sort_host_name=void 0,this.search_data.sort_out_band_address=void 0,this.search_data.sort_host_ip=void 0,this.search_data.sort_ecs_num=void 0,this.search_data.sort_create_time=void 0,this.search_data.sort_gpu_count=void 0,this.search_data.sort_ecs_gpu_count=void 0,this.search_data.sort_gpu_allot=void 0,this.search_data.sort_gpu_ff_count=void 0,this.search_data.hugepages_free=void 0,this.search_data["sort_".concat(e.prop)]="descending"===e.order?"1":"ascending"===e.order?"0":void 0,this.get_physical_list()}},{key:"handleSizeChange",value:function(e){this.page_info.size=e,this.get_physical_list()}},{key:"handleCurrentChange",value:function(e){this.page_info.current=e,this.get_physical_list()}},{key:"judgeColumns",value:function(){var e=this,t=Object.keys(this.filter_data),s=[].concat(Object(r["a"])(this.new_prop_list),["power_status","machine_status","host_attribution_id","host_purpose","host_type","host_source","backend_type","scheduled","migrated","dummy","vgpu_segment_type","host_business_type"]);for(var a in t.map((function(t){s.includes(t)||delete e.filter_data[t]})),this.filter_info={},this.filter_data)this.filter_info[a]=this.filter_data[a][0]}},{key:"filterAttribute",value:function(e){var t=this;if(this.filter_data=Object(n["a"])(Object(n["a"])({},this.filter_data),e),this.judgeColumns(),this.filter_data.host_type&&this.filter_data.host_type.length>0){var s=["use_type","use_name"],a=["value","text"],i=this.host_types.filter((function(e){return e.value===t.filter_data.host_type[0]}));this.host_uses=i.length>0?Object(Y["b"])(i[0].list,a,s):[]}else this.host_uses=[];this.setList(this.host_uses,"host_purpose_ch"),this.fn_search(this.search_data)}},{key:"FnExpand",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,s){var a,i,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=s.map((function(e){return e.host_id})),!(a.includes(t.host_id)&&t.ecs_list.length>0)){e.next=8;break}return s.length>=this.expand_rows.length&&(this.loading=!0),e.next=5,V["a"].get_instance_list({ecs_ids:t.ecs_list.map((function(e){return e.ecs_id}))});case 5:i=e.sent,"Success"===i.code&&(this.list.map((function(e){e.host_id===t.host_id&&n.$set(e,"ecs_detail",i.data.ecs_list)})),this.loading=!1),this.expand_rows=s;case 8:case"end":return e.stop()}}),e,this)})));function t(t,s){return e.apply(this,arguments)}return t}()},{key:"handle",value:function(e,t){if(0!==this.multi_rows.length||["upload","business_test","service","rollback"].includes(t)){if("finish_validate"===t)return this.multi_rows.every((function(e){return["init_error","init","offline"].includes(e.machine_status)}))?(this.oper_type=t,this.oper_label=e,void(this.visible=!0)):void this.$message.warning("物理机需为初始化状态或验证失败状态!");if("data_clear"===t){var s=this.multi_rows.find((function(e){return["crash_clear"].includes(e.machine_status)}));return s?(this.oper_type=t,this.oper_label=e,void(this.visible=!0)):void this.$message.warning("机器状态需为待清理状态!")}if("down_recover"===t){var a=this.multi_rows.find((function(e){return["crash_recover"].includes(e.machine_status)}));return a?(this.oper_type=t,this.oper_label=e,void(this.visible=!0)):void this.$message.warning("机器状态需为待恢复状态!")}if(["upload","resource","update_attribute","business_test","schedule","migrate_flag","cheat","under_sync"].includes(t)){if("business_test"===t){if(0===this.list.length)return void this.$message.warning("当前无宿主机可进行业务测试!");this.az_info={az_id:this.list[0].az_id,az_name:this.list[0].az_name}}return this.oper_type=t,this.oper_label=e,this.visible=!0,void console.log("ccc",this.oper_type)}if(this.judge(t)){if("disperse"===t){var i=this.multi_rows.filter((function(e){return"GPU"===e.host_purpose})),n=i.every((function(e){return e.ecs_list.every((function(e){return e.is_gpu&&"已关机"===e.status||!e.is_gpu}))})),r=i.every((function(e){e.host_business_type}));if(!n)return void this.$message.warning("GPU物理机中的GPU云主机需为关机状态!");if(!r)return void this.$message.warning("GPU物理机中的云主机业务类型需为KVM类型!")}this.oper_type=t,this.oper_label=e,this.visible=!0}else this.$message.warning(this.error_msg[t])}else this.$message.warning("请先勾选物理机!")}},{key:"handleMore",value:function(e){var t=e.label,s=e.value;this.handle(t,s)}},{key:"judge",value:function(e){var t=this,s=Object(B["c"])(e),a=this.multi_rows.every((function(a){var i=0===s.power.length||s.power.includes(a.power_status),n=0===s.host.length||s.host.includes(a.machine_status),r=!s.vm||s.vm===a.ecs_list.length+1;return t.error_msg[e]=Object(B["c"])(e).msg,i&&n&&r}));return a}},{key:"handleOperate",value:function(e){var t=e.title,s=e.label,a=e.value;this.multi_rows=[a],"physical_detail"===s?this.$router.push({name:s,query:{id:a.host_id,name:a.host_name}}):"migrate"===s?this.judge(s)?(this.oper_type=s,this.visible=!0):this.$message.warning(this.error_msg[s]):"out_of_band"===s?this.out_of_band():(this.visible=!0,this.oper_type=s,this.oper_label=t)}},{key:"out_of_band",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g["a"].external_management({host_id:this.multi_rows[0].host_id});case 2:t=e.sent,"Success"===t.code&&window.open(t.data.url.out_bond_addr);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setList",value:function(e,t){this.custom_host.map((function(s){return s.prop===t&&(s.list=e),s}))}},{key:"close",value:function(e){"upload"===this.oper_type&&this.get_room_list(),"1"===e&&this.get_physical_list(),this.visible=!1,this.oper_type="",this.oper_label="",this.multi_rows=[];var t=this.$refs.table;t.clearSelection()}},{key:"crashHandleCommand",value:function(e){"data_clear"===e?this.handle("数据清理同步",e):this.handle("宕机恢复",e)}}]),s}(d["e"]);Object(p["a"])([Object(d["f"])("$store.state.pod_id")],Ie.prototype,"watch_pod",null),Ie=Object(p["a"])([Object(d["a"])({components:{ActionBlock:h["a"],Operate:x,UploadFile:I,Migrate:M,Record:q["a"],SvgIcon:A["a"],Resource:ee,UpdateAttribute:oe,CustomListItem:le["a"],BusinessTest:we,Detail:Oe["a"],Remark:Ee}})],Ie);var Fe=Ie,Pe=Fe,Le=(s("14a1"),s("905d"),Object(O["a"])(Pe,a,i,!1,null,"aaa6ce30",null));t["default"]=Le.exports},"900b":function(e,t,s){},"905d":function(e,t,s){"use strict";s("047f")},9074:function(e,t,s){"use strict";var a=s("81a9"),i=s("bff7");t["a"]={get_customer_name:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/get_customer_name/",e))},get_region_az_list:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/region_az_info/",e))},get_net_list:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/net_info/",e))},get_all_cpu_ram:function(){return Object(a["a"])(Object(i["b"])("GET","/ecs/ram_cpu_list/"))},get_category_list:function(e){return Object(a["a"])(Object(i["b"])("GET","/ecs/ecs_category_list/",e))},ecs_family_info:function(e){return Object(a["a"])(Object(i["b"])("GET","/ecs/ecs_family_info/",e))},get_os_list:function(e){return Object(a["a"])(Object(i["b"])("POST","/img/image_info/",e))},get_price:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/get_price/",e))},create_instance:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/create_ecs/",e))},get_ecs_limit:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/get_ecs_limit/",e))},get_ram_cpu_price_list:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/ecs_spec_attach_price/",e))},difference_price:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/ecs_difference_price/",e))}}},"956e":function(e,t,s){},"9f1f":function(e,t,s){"use strict";s("900b")},a15b:function(e,t,s){"use strict";var a=s("23e7"),i=s("e330"),n=s("44ad"),r=s("fc6a"),o=s("a640"),l=i([].join),c=n!=Object,u=o("join",",");a({target:"Array",proto:!0,forced:c||!u},{join:function(e){return l(r(this),void 0===e?",":e)}})},a434:function(e,t,s){"use strict";var a=s("23e7"),i=s("da84"),n=s("23cb"),r=s("5926"),o=s("07fa"),l=s("7b0b"),c=s("65f0"),u=s("8418"),_=s("1dde"),p=_("splice"),d=i.TypeError,h=Math.max,f=Math.min,m=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!p},{splice:function(e,t){var s,a,i,_,p,v,g=l(this),y=o(g),k=n(e,y),w=arguments.length;if(0===w?s=a=0:1===w?(s=0,a=y-k):(s=w-2,a=f(h(r(t),0),y-k)),y+s-a>m)throw d(b);for(i=c(g,a),_=0;_<a;_++)p=k+_,p in g&&u(i,_,g[p]);if(i.length=a,s<a){for(_=k;_<y-a;_++)p=_+a,v=_+s,p in g?g[v]=g[p]:delete g[v];for(_=y;_>y-a+s;_--)delete g[_-1]}else if(s>a)for(_=y-a;_>k;_--)p=_+a-1,v=_+s-1,p in g?g[v]=g[p]:delete g[v];for(_=0;_<s;_++)g[_+k]=arguments[_+2];return g.length=y-a+s,i}})},a630:function(e,t,s){var a=s("23e7"),i=s("4df4"),n=s("1c7e"),r=!n((function(e){Array.from(e)}));a({target:"Array",stat:!0,forced:r},{from:i})},a9e3:function(e,t,s){"use strict";var a=s("83ab"),i=s("da84"),n=s("e330"),r=s("94ca"),o=s("6eeb"),l=s("1a2d"),c=s("7156"),u=s("3a9b"),_=s("d9b5"),p=s("c04e"),d=s("d039"),h=s("241c").f,f=s("06cf").f,m=s("9bf2").f,b=s("408a"),v=s("58a8").trim,g="Number",y=i[g],k=y.prototype,w=i.TypeError,O=n("".slice),j=n("".charCodeAt),x=function(e){var t=p(e,"number");return"bigint"==typeof t?t:C(t)},C=function(e){var t,s,a,i,n,r,o,l,c=p(e,"number");if(_(c))throw w("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=v(c),t=j(c,0),43===t||45===t){if(s=j(c,2),88===s||120===s)return NaN}else if(48===t){switch(j(c,1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+c}for(n=O(c,2),r=n.length,o=0;o<r;o++)if(l=j(n,o),l<48||l>i)return NaN;return parseInt(n,a)}return+c};if(r(g,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var S,T=function(e){var t=arguments.length<1?0:y(x(e)),s=this;return u(k,s)&&d((function(){b(s)}))?c(Object(t),s,T):t},R=a?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),z=0;R.length>z;z++)l(y,S=R[z])&&!l(T,S)&&m(T,S,f(y,S));T.prototype=k,k.constructor=T,o(i,g,T)}},af7d:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{visible:e.visible,title:"自定义列表项","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t}}},[s("div",{staticClass:"m-bottom10"},[e._v("清除缓存或者更换浏览器，自定义列表失效"),s("span",{staticClass:"warning_message m-left10"},[e._v("(最少选择5项，最多选择25项)")])]),s("div",{staticClass:"item"},[e._l(e.all_item,(function(t){return[s("div",{staticClass:"label"},[e._v(e._s(t.name))]),s("div",{class:[e.newView?"checkbox-box2":"checkbox-box"]},[s("el-checkbox-group",{model:{value:e.select_item,callback:function(t){e.select_item=t},expression:"select_item"}},e._l(t.filed,(function(e){return s("el-checkbox",{key:e.show_name,attrs:{label:e.show_name,disabled:"主机名"===e.show_name}})})),1)],1)]}))],2),s("span",[e._v("已选择："),s("span",{staticClass:"num_message"},[e._v(e._s(e.select_item.length))])]),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.FnConfirm}},[e._v("确 定")]),s("el-button",{on:{click:e.FnClose}},[e._v("取 消")])],1)])},i=[],n=s("2909"),r=s("d4ec"),o=s("bee2"),l=s("262e"),c=s("2caf"),u=(s("d81d"),s("fb6a"),s("9ab4")),_=s("1b40"),p=function(e){Object(l["a"])(s,e);var t=Object(c["a"])(s);function s(){var e;return Object(r["a"])(this,s),e=t.apply(this,arguments),e.select_item=[],e.typeObj={host:{func:"SET_CUSTOM_HOST",value:"custom_host"},nas:{func:"SET_NAS_HOST",value:"nas_host"},cluster:{func:"SET_CLUSTER_HOST",value:"pod"},pod_host:{func:"SET_HOST_LIST",value:"pod"},pod_vm:{func:"SET_VM_HOST",value:"pod"}},e}return Object(o["a"])(s,[{key:"created",value:function(){"cluster"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].cluster_host):"pod_host"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].host_list):"pod_vm"===this.type?this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value].vm_host):this.FnHandleSelectItem(this.$store.state[this.typeObj[this.type].value])}},{key:"FnHandleSelectItem",value:function(e){e.length>0?this.select_item=Object(n["a"])(e):this.select_item=this.all_column_item.slice(0,25).map((function(e){return e.label})),this.FnEmit()}},{key:"FnConfirm",value:function(){this.select_item.length<5||this.select_item.length>25?this.$message.warning("自定义列表项最少为5项，最多为25项"):(this.$store.commit(this.typeObj[this.type].func,this.select_item),this.FnEmit(),this.FnClose())}},{key:"FnClose",value:function(){this.$emit("update:visible",!1)}},{key:"FnEmit",value:function(){return this.select_item}}]),s}(_["e"]);Object(u["a"])([Object(_["c"])({default:!1})],p.prototype,"visible",void 0),Object(u["a"])([Object(_["c"])({default:"host"})],p.prototype,"type",void 0),Object(u["a"])([Object(_["c"])({default:function(){return[]}})],p.prototype,"all_column_item",void 0),Object(u["a"])([Object(_["c"])({default:function(){return[]}})],p.prototype,"all_item",void 0),Object(u["a"])([Object(_["c"])({default:!1})],p.prototype,"newView",void 0),Object(u["a"])([Object(_["b"])("fn-custom")],p.prototype,"FnEmit",null),p=Object(u["a"])([_["a"]],p);var d=p,h=d,f=(s("0a4c"),s("2877")),m=Object(f["a"])(h,a,i,!1,null,"b2dbf330",null);t["a"]=m.exports},b85c:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));s("a4d3"),s("e01a"),s("d3b7"),s("d28b"),s("3ca3"),s("ddb0"),s("d9e2");var a=s("06c5");function i(e,t){var s="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=Object(a["a"])(e))||t&&e&&"number"===typeof e.length){s&&(e=s);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,l=!1;return{s:function(){s=s.call(e)},n:function(){var e=s.next();return o=e.done,e},e:function(e){l=!0,r=e},f:function(){try{o||null==s["return"]||s["return"]()}finally{if(l)throw r}}}}},bb2f:function(e,t,s){var a=s("d039");e.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bda3:function(e,t,s){"use strict";s("4164")},c765:function(e,t,s){"use strict";s("542d")},c839:function(e,t,s){"use strict";var a=s("81a9"),i=s("bff7");t["a"]={get_pod_list:function(e){return Object(a["a"])(Object(i["b"])("GET","/pod/get_pod_list/",e))},get_az_info:function(e){return Object(a["a"])(Object(i["b"])("GET","/pod/get_pod_info/",e))},create_pod:function(e){return Object(a["a"])(Object(i["b"])("POST","/pod/create_pod/",e))},update_pod:function(e){return Object(a["a"])(Object(i["b"])("POST","/pod/update_pod/",e))},get_pod_history:function(e){return Object(a["a"])(Object(i["b"])("GET","/pod/get_pod_history/",e))}}},ca89:function(e,t,s){},cc18:function(e,t,s){"use strict";s("ca89")},d81d:function(e,t,s){"use strict";var a=s("23e7"),i=s("b727").map,n=s("1dde"),r=n("map");a({target:"Array",proto:!0,forced:!r},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},d86b:function(e,t,s){var a=s("d039");e.exports=a((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},d8a7:function(e,t,s){"use strict";s("fceb")},e527:function(e,t,s){"use strict";var a=s("81a9"),i=s("bff7"),n=s("4328"),r=s.n(n);t["a"]={get_instance_list:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/ecs_list/",e))},operate_instance:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/operate/",e))},delete_instance:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/delete/",e))},recover_instance:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/recover/",e))},destroy_instance:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/destroy/",e))},get_status_list:function(){return Object(a["a"])(Object(i["b"])("GET","/ecs/ecs_status_list/"))},get_family_data:function(){return Object(a["a"])(Object(i["b"])("GET","/ecs/get_family_data/"))},reset_password:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/ecs_reset_password/",e))},update_spec:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/ecs_change_configure/",e))},update_system:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/ecs_change_system/",e))},get_usage_ip:function(e){return Object(a["a"])(Object(i["b"])("GET","/ecs/get_deleted_ecs_ip/",e))},get_vnc_url:function(e){return Object(a["a"])(Object(i["b"])("GET","/ecs/vnc_info/",e))},start_charge:function(e){return Object(a["a"])(Object(i["b"])("POST","/resource/start_charge/",e))},change_config_price:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/change_config_price/",e))},change_system_price:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/change_system_price/",e))},each_resource_price:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/each_resource_price/",e))},add_common_mirror:function(e){return Object(a["a"])(Object(i["b"])("POST","/img/create_pub_image_by_ecs/",e))},set_net:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/ecs_set_base_nic/",e))},get_default_dns:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/az_default_dns/",e))},mount_gpu_card:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/instance_gpu_card/",e))},update_gpu_status:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/update_gpu_status/",e))},export_list:function(e){return Object(a["a"])({method:"GET",url:"/ecs_business/v1/ecs/ecs_list_download/",params:e,paramsSerializer:function(e){return r.a.stringify(e)},responseType:"blob"})},get_tag_list:function(){return Object(a["a"])(Object(i["b"])("GET","/ecs/get_tag_list/"))},get_rescue_image_list:function(e){return Object(a["a"])(Object(i["b"])("GET","/ecs/get_rescue_image_list/",e))},enter_rescue:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/enter_rescue/",e))},exit_rescue:function(e){return Object(a["a"])(Object(i["b"])("POST","/ecs/exit_rescue/",e))}}},e8bb:function(e,t,s){},ef2a:function(e,t,s){},f183:function(e,t,s){var a=s("23e7"),i=s("e330"),n=s("d012"),r=s("861d"),o=s("1a2d"),l=s("9bf2").f,c=s("241c"),u=s("057f"),_=s("4fad"),p=s("90e3"),d=s("bb2f"),h=!1,f=p("meta"),m=0,b=function(e){l(e,f,{value:{objectID:"O"+m++,weakData:{}}})},v=function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,f)){if(!_(e))return"F";if(!t)return"E";b(e)}return e[f].objectID},g=function(e,t){if(!o(e,f)){if(!_(e))return!0;if(!t)return!1;b(e)}return e[f].weakData},y=function(e){return d&&h&&_(e)&&!o(e,f)&&b(e),e},k=function(){w.enable=function(){},h=!0;var e=c.f,t=i([].splice),s={};s[f]=1,e(s).length&&(c.f=function(s){for(var a=e(s),i=0,n=a.length;i<n;i++)if(a[i]===f){t(a,i,1);break}return a},a({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},w=e.exports={enable:k,fastKey:v,getWeakData:g,onFreeze:y};n[f]=!0},fceb:function(e,t,s){},fd7f:function(e,t,s){}}]);
//# sourceMappingURL=chunk-9eb9379c.1741589092878.js.map